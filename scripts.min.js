function hexToRGB(e){e=colourNameToHex(e);let t=0,i=0,a=0;return 4==e.length?(t=parseInt(e[1]+e[1],16),i=parseInt(e[2]+e[2],16),a=parseInt(e[3]+e[3],16)):7==e.length&&(t=parseInt(e[1]+e[2],16),i=parseInt(e[3]+e[4],16),a=parseInt(e[5]+e[6],16)),{r:t,g:i,b:a}}function flashColor(e,t){if(0===t)return e;t=Math.min(t,1);var i=hexToRGB(e);return i.r=i.r+t*(255-i.r),i.g=i.g+t*(255-i.g),i.b=i.b+t*(255-i.b),RGBToHex(i.r,i.g,i.b)}function RGBToHex(e,t,i){return e=Math.min(Math.max(Math.round(e),0),255).toString(16),t=Math.min(Math.max(Math.round(t),0),255).toString(16),i=Math.min(Math.max(Math.round(i),0),255).toString(16),1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==i.length&&(i="0"+i),"#"+e+t+i}function colourNameToHex(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==t[e.toLowerCase()]?t[e.toLowerCase()]:e}function makeOverlayPattern(){
return"M1652 2034c4 13 8 24 7 39-3 23 15 48 42 42 25-5 32-33 44-52 14-32-33-46-7-78 24-62-93-67-83-6 6 19-9 36-3 55zM870 2050c38-3 25-68-11-54-31 13-22 56 11 54zM978 2057c-43-15-59 61-13 62 39 5 48-53 13-62zM1772 2439c12 9 17 24 27 35 22 22 56-9 38-33-19-14-24-51-45-52-26-2-45 32-20 50zM1563 3062c8 33 64 32 62-6 3-49-74-41-62 6zM1583 2690c3-5 4-11 4-17 0-37-51-37-56 1-2 24-35 38-23 64 9 23 44 26 55 3 7-17 6-37 20-51zM1514 2827c-9 21-24 38-26 61 0 37 54 31 58-1 2-14 11-25 14-38 7-26-28-45-46-22zM24 3308c10-11 14-25 18-38 13-26 15 33 49 23 32-6 19-56-12-49-7-1-20 8-24-2-2-21-5-45-27-54l-28-13v144c10 0 18-4 24-11zM166 959c-38-1-31 58 2 60 30-10 36-59-2-60zM17 2299c-6 0-11 1-17 3v59c43 17 69-55 17-62zM661 2443c-10-21-35-17-34 7 1 31 46 19 34-7zM497 2450c-42 13-15 65 23 55 74 4 54-78-23-55zM624 2743c-21 3-19 35 2 36 31 1 25-39-2-36zM553 2839c34-1 34-55-1-54-35 0-34 54 1 54zM2115 2905c-17 0-34 2-52 0-20-5-36 16-56 8-18-10-36-6-55 2-20 2-20-34-45-41-9-5-5-18-7-27-6-25-34-14-43 3-51 34-62-70-111-57-16 7-28 13-46 9-25-6-43 26-25 46 17 18 12 21-4 36-11 14 6 36 23 30 13-5 26-4 39 2 18 7 34-2 49-11 25-10 35 40 71 17 27-23 43 17 28 38-10 16-28-1-42 0-24-2-36 23-30 39 6 17 23 25 35 38 23 27 46-15 73-15 26-6 15-52 45-48 18 8 41-7 56 6 14 19 46 35 65 14 7-8 12-18 23-22 17-4 28-15 33-32 5-18 37-15 34-37-12-37-37 2-58 2zM2192 2970c-31-19-69 15-49 47 22 26 4 36-23 27-17-4-30 10-39 22-17 10-24-35-50-31-21 2-83 37-53 60 18 9 42 4 59 21 16 16 41 9 62 14 9 2 17-3 24-10 14-29 44-23 57 3 1 23 16 41 40 34 25-2 48 12 74 1 6-1 9 6 12 11 7 20 21 36 33 53 7-17 101-2 71-65-17-18-58-41-83-29-7 2-17 8-22-1-28-70-73 6-96-33-10-69 58 5 69-64 1-14-3-28 3-42 6-13 5-30-6-41-11-10-18-23-26-35-19-25-62-2-50 27 6 15 26 50-7 31zM1008 2800c13-2 33-8 37-21-2-20-11-42-33-46-46-9-53 69-4 67zM1652 3023c10 40 43-3 66 3 37 2 51-50 20-64-18-7-38-14-56-19-49 4-30 49-30 80zM2258 3425c5 18 7 46 33 42 42 6 53-63 11-68-15 0-43 8-44 26zM523 3749c-26-20-60 8-58 34 5 53 63 35 93 17 29-25-16-42-35-51zM2266 3694c23-1 22-36-1-35-24 1-21 36 1 35zM0 2895v74c11-14 18-35 21-51 2-17-8-21-21-23zM578 3721c22-1 23-33 3-36-28-4-30 37-3 36zM2695 3065c-11 13-30 14-43 25-24 18-44 39-60 64-27 35 15 71 49 47 23-10 37 22 60 16 22-2 43-28 28-56-25-30-16-35 17-47 21-8 45 1 66-10 16 1 27 17 44 18 2 0 4 3 4 6-12 31 4 50 29 66 14 14 39 15 48-4 7-10-2-31 13-36 27 2 48-28 29-48-15-12-26-28-41-41-22-15-51 6-48 31 5 16-4 30-22 25-6-2-2-11-2-16 1-15-8-30-5-45 9-49-46-69-80-88-18-9-36 0-48 14-14 16-2 35 1 52-3 16-30 12-39 27zM2566 2915c-21-14-40 15-49 31-14 31 21 33 26 49-15 20-26 50-3 67 15 11 24 27 46 26 28-2 43-37 22-58-12-14-26-26-44-33-5-2-13-5-10-11 9-20 32-51 12-71zM2924 3556c-27 10-18 52 11 50 19-5 55 6 59-21 2-12-9-21-21-22-17 0-32-12-49-7zM1914 3205c20-2 39 10 59 7 17-2 29 10 44 12 50 9 59-69 11-75-43 4-38 16-76-17-16-11-12-36-30-45-21-14-50 2-51 27 0 20 20 33 13 54-4 20 9 40 30 37zM1710 3227a40 40 0 00-8 53c37 41 57-5 79 7 10 17 27 16 44 17 74 20 70-68-3-55-22-1-43 5-47-23-7-19 22-21 28-36 23-32-18-45-9-67 23-21 22-62-13-68-18 0-35 2-53-4-65-1-33 82 16 84 20 5-13 39 4 61 14 25-27 18-38 31zM2401 3374c-9 17-27 31-27 51 0 29 41 61 64 35 28-20 3-54 3-81-3-23-31-25-40-5zM2468 3064c-10 7-16 19-29 21-25 0-44 23-33 47 6 15 33 12 27 33h-1c-3 22 19 43 40 37 8-1 20-10 26 0 14 56 78 26 46-21-2-33 33-46-8-83-18-21-36-59-68-34zM2842 3196c-11-18-28-36-46-48-36-5-34 49-26 71 2 29-33 31-53 33-27 11-8 43 16 37 19-1 28 18 48 17 25-1 39-24 33-48-5-28 43-29 28-62zM3048 3947c-42 41-65 18-80 53h115c6-26-9-59-35-53zM3698 3860c-39-7-67 65-22 73 45 4 72-60 22-73zM3872 3939c13-27-12-48 0-72 8-15 4-32 6-48 7-23 58 34 74-26-5-41 9-39 44-33l4-1v-70c-8-2-18-2-29 1-25 1-15-34-31-46-8-10-39-45-27-55 14-3 31-23 44-10 19 19 2 60 32 69l11 1v-165c-5 3-9 7-12 14-6 12 2 28-7 39-17 21-38 16-38-12 0-8 7-14 11-21 21-51-61-61-46 4-4 22-28 15-24-7 3-34-45-35-45-66-2-23 1-45 4-68 6-15 30-9 43-14 11-2 38 12 26 24-86 65 42 115 24 8-2-3-2-11 4-9 31 13 34 62 60 73v-255c-6 2-12-1-12-11 11-55-23-43-28-70 36-43-35-77-43-25 0 12 10 20 17 29 6 10-6 20-13 24-13 4-19-14-27-22-6-8-7-19-8-29 0-31-49-34-12-59 35-30-12-60 8-77 10-4 25-14 34-4 27 71 63 13 77 44l7 20v-104c-7-8-17-12-28-9-21 5-48 41-58 4-21-34-45-17-31-70 5-16 28-8 41-13 23-4 39 24 64 13 6-1 10-5 12-9v-114c-14 0-30 16-42 4-34-54-70-13-73 33-6 13-12 57-27 57-14 1-41-3-35-23 11-23 18-48 31-70 7-19 32-15 43-30 22-27 43-65-12-59-61-3-43 25-67 60-18 16-41 28-55 48-6 9-14 17-24 22a35 35 0 00-14 51c12 22 0 63 37 63 38-10 43-5 71 23 2 6-5 9-9 11-26 13-52 28-73 50-10 6-9-14-12-19-10-40-36-29-56-44 26-21 33-60-5-65-13-6-37 24-39 9 4-18 3-41 14-57 25-15 28-60-5-65-46 1-29 38-43 63-18 26-30 65-69 53-30-1-35 42-65 44-23-4-13-32 0-43 19-28-8-45-34-46-8-4 0-16 1-23 5-20 26-30 30-51 2-6 6-14 12-16 16-12 49 0 35 21-22 11-38 29-31 55 23 55 98 22 69-45 10-25 47-33 22-70-19-16-25-41-45-55-7-5-13-11-12-20 1-17 0-34-15-43-32-14-57-39-78-65-16-20-39-61-7-76 14-8 21-7 31 6 12 11 8 27 7 42-1 31 43 43 58 16 14-35-28-55 22-100 15-7 13-29 26-34 13 7 41 27 24 43-18 10-49 18-37 45 6 16 29 16 31 33 7 24 1 49 4 73 1 10 0 19-5 28-16 24 1 47 7 71 6 19 21 24 35 21 8-2 24-6 24 8-11 51 28 60 69 52 31-6 30-44 10-64-5-15 17-22 24-32 19-10 37 22 58 7 56-51-16-49-13-73 4-31 40-38 42-2-4 28-2 42 27 52 28 13 68-20 52-49-14-19-22-41-28-64-1-18 26-9 31 2 7 14 40 17 31 36-8 14-19 27-16 44 2 21-10 42-5 63 13 26 52 13 72 30l2 1v-132c-15-6-32-19-30-24 29-41-1-57-12-96-3-17-24-21-28-37-2-22 35-22 44-7 18 18 23 30 26 41v-81c-5-7-4-10 0-11v-54l-4 7c-8 24-24 17-41 8-24-9 30-32 15-59-13-24-10-50 21-31l8 4v-64h-3c-24 1-53-20-67 11-3 31-112 76-106 26 16-31 65-45 56-86-5-35 25-59 57-62 18 10 3 50 46 43 7-1 13-6 17-12v-65c-9 2-17 8-27 14-18 4-8-25-14-36-7-31-48-36-69-12-13 12-32 60-46 25-2-21-41-31-25-50 12-21 36-27 49-45 12-20 0-42-14-49-13-6-29 3-43-5-12-9-25-8-38-1-17 7-36 6-49 20-28 18-44-31-72-28-62 14-26 68 20 76 22 3 48 30 67 7 8-9 31-53 41-28-6 16-11 33 0 48 35 45-42 4-56 25-17 16-40 10-59 19-44 29 4 77-31 127-5 21-35 9-38-7-2-21-10-42-34-45-131-52-42 54-119 36-24-2 1-54 16-54 24 0 40-5 41-33 0-14 2-32 20-35 9-1 22-3 27 7 8 18 19 39 42 35 32-5 29-42 30-67 1-18-15-27-28-36-15-15 16-34 4-52-9-27-43-18-60-37-18-22-56-17-67 10-20 34 36 48 20 75-10 15-29 24-30 44s-16 33-26 49c-8 11-25 5-38 9-26 1-25 36-47 41-17 2-37-1-35-22-2-21-21-32-29-50-5-20-39-23-31-46 20-51-46-72-67-24-12 21-29 25-49 9-28-12-74 8-74 42-2 9-8 23-19 19-36-17 20-29 14-51-1-22-30-34-11-55 22-29-12-45-29-63-35-41-42-33-85-53-20-14-48-2-36-37 3-25-31-39-46-25-16 14-31 29-44 46-13 15-38 34-22 55 17 19 47 52 70 24 6-5 9-20 18-18 16 11 30 25 45 37 187 51 28 46 87 114 20 28-37 23-6 77 3 20-26 20-35 35-29 33-22-23-36-37-5-6-11-15-5-22 16-24 40-72 7-91-24-9-35-41-63-41-31 1-41 35-29 59 6 20-21 26-23 45-5 34 36 42 61 27 43 1-13 42-30 44-25 7-60-29-77 6-11 48-64 78 2 112 14 17-22 29-29 43-14 14-36 0-54 3-4 0-9-2-12-5-18-22 2-32 19-43 24-16 5-45 15-66 16-25-9-59-36-43-95 57-15 66-42 112-16 7-34 12-46 27-13 6 12-35 3-46-10-52-58-15-76-51-6-9-15-14-25-18-23-10-3-45-27-57-14-7-31-28-8-34 12-1 25 1 35-6 23-10 12-35 26-39 17 5 1 25 6 36 6 38-11 89 48 87 33-1 71 13 67-36 0-14 13-19 22-27 33-25-17-64-38-43-7 4-12 16-21 15-65-67-12-37-36-101-9-25 30-33 26-58 0-13 11-20 19-28 15-14 15-39-2-50-21-11-54-10-52-43 5-27 1-47 25-15 24 18 33-19 54-22 32 0 42-52 73-18 3 19-32 25-20 56 9 25 41 21 62 27 49-7 2-46-11-66-10-22 54-32 21-72-15-18-42-18-57-34-15-27 32-38 20-71-4-17 38-41 41-18-4 16-10 31-5 47 5 60 20 39 32 76-3 19 7 40 30 42 36 1 40-42 16-62-16-23 60-44 7-86-12-7-39-10-34-30 3-11 15-28 28-20 40 51 54 9 58 43 1 19 15 34 16 53 0 12 6 21 11 31 6 31-39 52 13 81 42 17-35 38-6 74 17 26 57 0 72 27 8 37 64 45 68 2 8-16-39-48-9-51 31 4 31 52 65 47 29-12 41 20 18 27-9 1-19-1-28 4-29 11-22 53 7 59 38 20 70 40 91-15 8-21 32-40 20-65-14-24-33-58-66-46-32-2-52-42-51-72 19-32 58 48 104-7 16 0-3 46 40 57 31 2 49 32 80 35 32 3 53-52 23-64-13-7-26-6-40-7-13-3-11-19 1-21 35-3 42-39 39-68-2-14-13-22-24-29-15-8-20-26-33-37-23-27 17-69 7-101-13-47-62-12-88-48-29-20-47 29-78 22-52 8-28 47-33 80-14 20-5 55 23 51 32-4 19-38 31-56 14-24 59-55 70-13-1 43-65 50-14 99 10 16-15 28-19 43-4 5-10 9-17 8-41-17-81-35-118-60-13-4-9-54-6-66 17-24 6-67-28-63-55 23-30-23-73-34-22 1-51-33-24-46 13-2 27 2 40 0 21 3 17 36 38 41 22 4 37 33 61 21 27-15 13-39 0-55-7-18 21-25 29-38 34-20 36 49 69 46 32-1 80 15 91-26 14-12 26 19 39 24 15 9 13 32 30 41 25 17 53-16 36-39-40-30 2-74-39-93-11-5-35-10-30-26 10-20 27-33 50-35 43-18 1-60-9-86-12-16-35-4-35 14 0 11 0 31-12 14-7-15-46-15-39-28 21-18 35-55-4-61-11 0-25 4-32-7-9-25-74-15-54-49 47-43 63 39 96 24 17-11 4-30 1-44 0-25 35-34 31-62-5-33-52-41-74-19-24 14-57-8-81 14-19 19-27-19-46-21-28-10-45 15-48 40-10 24-49 13-48 53-1 22 13 54 38 37 26-13 23-49 41-58 36-11 43-12 53 27 3 20-28 24-31 43-4 17-15 25-32 26-16 1-24 15-33 26-49 47-26-35-81-30-60-25 45-101-57-116-40-17 35-28 22-75-13-41 35-74 2-104-22-20-55-6-80-1-25 13-16 48 9 53 30 18-7 43-4 65 4 22 12 38-12 50-33 29-11 60 26 68 26 18-16 66-38 41-27-19-29-86-73-57-7 4-13 19-23 12-19-20-43-15-67-16-15-3-30-5-42 5-13 10-26 2-38-3-26-18-54 36-69 4-5-15-21-34-7-48 15-14 54-33 25-54-9-5-23-7-23-20 6-30-30-39-23-59 32-39-7-53-2-88 6-45-46-37-13-86 13-14 39 19 59-1 36-22 23-83-23-72-22 3-34-23-56-21-36-3-72 24-39 58 12 21-6 48 15 67 8 13-20 44-30 25-6-59-45-33-58-65-1-20-33-39-11-55 19-14 23-37 30-59 4-11 17-7 27-5 69 0 41-69 1-93-25-13-5-44-24-62-11-11-23-22-20-39 11-69-44-40-59-64-17-49 48-21 43-72-10-42 34-7 47-45 5-19 22-26 40-16 20 7 38-7 50-21 2-4 2-9 1-13h-126c-2 7-5 14-11 19-22 14 4 62-34 45-6-3-8-10-8-17 1-16-10-31-8-47h-76l-3 4c-20 21 26 58-5 68-50-14-81 31-38 66 20 35-29 33-47 45-29 17-36-12-38-35-6-27 30-25 40-44 14-18-7-37-3-57 5-17-3-38-17-47h-33c-57 34-27 67-62 79-21 2-48 6-50 32 2 51-41 2-61 51-7 25-17 14-34 6-53-16-61 62-96 82-18 12-40 13-60 23-9 4-19 0-24-10-6-16 1-34-8-50-3-17 55-4 65-1 47 12 69-58 19-74-23-3-46-10-70-12-27-3-15-14 3-21 43-23 3-65 27-91 17-9 32 44 34 57 5 27 38 24 57 36 21 11 40-2 56-15 10-4 16 9 26 11 13 5 28-10 23-23-10-26-34 1-47-10-6-13-32-29-17-43 21-13 61 2 74 21 29 24 57-11 48-41l2-7h-466c2 2 3 6 4 9 5 29 18 45-1 73-10 35 33 64 61 72 32 5 23 34 63 46 10 11-14 28-6 45 5 14 2 28-3 41-6 26 20 51 45 41 29-25 50 12 79-4 19-13 49-9 59-33 3-12 53-70 59-45-2 21 5 39 20 54 19 51-53 0-67 47-6 14-6 27-25 22-22-6-48 5-48 29-1 20 18 37 3 56-17 48-50-18-72 31-4 12-4 27-17 34-32 16-12-64-42-70-23-14-41 10-50 28-10 10-26-3-37-6-16-7-16-26-21-40-5-19 38-17 51-27 24-5 44 33 66 4 29-39-54-63-53-102 0-18-9-32-16-47 0-20 41-13 38-43 1-43-59-21-82-45-19-22-66-5-54 26l16 30c5 18 26 30 21 50-12 19 19 64-6 63-48-30-43-4-85 2-18-5-69 5-73-16-3-44 58-29 66-66 0-27 35-21 41-43 15-34-5-85-47-75-37 4-28 36-24 61-2 20-32 27-49 34-18 2-34 11-41 28-13 28-17 57-1 85-6 25-43-8-43-23-3-13 9-21 17-29 17-16 5-43-12-55-11-12-51-1-41-26 11-16 47-23 41-48-4-24-28-35-36-57-4-21-20-35-41-36-28-9-36-37-72-32-16-6-7-29-9-43h-55c-6 7-10 15-13 24-18 9-52-34-79 13-16 50-20 18-50 2-15-10-16-27-23-39h-91l5 12c-2 50 53 20 58 56-1 23 3 46 31 49 24 5 39-12 53-28 29 4 25 50 85 11 18-11 7-48 26-52 13 3 35-1 39 14 0 19-1 45-27 39-60-4-18 60-41 63-72-49-51 12-104 10-22-1-34 12-44 30-14 20-47-2-60 22-14 26 14 39 34 46 17 4 25 41 3 42-51 8-80-41-118 5-17 17-82-30-81 47 5 31 44 39 51 63-5 20 5 37 5 57-2 10-8 20-3 30 17 57 101 28 74-27-30-35 34-63-22-91-14 1-37-19-15-26 12 0 23 5 35 5 31 7 21 50 29 73 7 31 42 19 60 34 13 17 32 31 53 19 34-13 17-66-13-66-24 2-50-17-42-43 14-17 26 23 76 0 25 0 23 38 31 56 4 11-2 21-9 29-21 23 17 39 10 60-22 38 4 53 37 58 21 15-11 43 7 63 10 14 5 29 6 45 2 30 49 29 50-1 1-15-9-29-2-43 5-13 5-25 0-38-6-15 4-28 9-42 12-74-93-18-75-68 11-15-6-40 12-48 17-1 19 25 35 30 34 22 108-73 65 47-5 14 4 26 11 38 5 9-4 16-10 23-16 15-7 39-16 58-9 21 16 44-3 62-10 10-11 33-28 35-21-5-48 8-43 31 32 50 49-7 68-4 21 10 43 8 64-1 23-7 23-31 31-50 25 0 45 36 67 48 16 7 16 39-2 41-18-5-36-20-54-8-34 19-3 48-13 72l-34 56c-9 22-55 24-40 55 4 12 27 25 13 37-43 9-46 11-76 43-10 25-32 50-27 79 5 32 16 82-36 64-20-20-55-3-33 23 12 8 38 13 25 34-16 22-53 15-62 45-22 28-61 21-43 73 3 12-7 21-14 30-23 35 32 54 51 75 38 27 51-37 77-16 14 22 9 44 35 60 18 17 15 44 8 65-11 14-35-3-51 0-24-9-19-58-65-41-57 44-21-33-36-61-11-26-37-11-56-5-28 1-26-46-1-51 43-25 6-55-25-67-5-12 17-26 17-40 10-28 52-14 56-52 6-30-34-46-57-32-7 3-20 17-23 2-9-71 33-31 55-77 13-41-49-66-56-104-3-23 31-27 29-51-2-27 21-66-12-81-35-15-36 29-60 30-7-1-14-3-21-1-14 5-17 27-2 33 9 5 25 3 28 17 1 9 2 20-7 26-14 5-29 26-44 17-50-60-117 26-49 58 16 2 24 12 27 28 6 18 33 25 45 9 7-9 16-27 29-16 12 13 26 43 12 57-20 8-32 25-47 40-24 24-4 56-10 85-5 41 77 30 30 68-23 23 4 50-5 75v18c7 41 54 17 58 55 14 40 66 36 19 86-20 23 10 64-39 55-45-18-16-80-99-33-37 20-29 41-78 16-18-20 26-31 29-51 8-24 25-31 48-41 13-4 16 15 27 18 39 6 27-45-8-33-21-5-22-52-5-63 51-26 22-90-29-69-27 12-66-18-80 22-4 45-49 30-60 68-12 31-2 59 31 70 13 12 9 41-7 49-24 15-44 35-72 44-20 2-38 10-58 14-14 2-19-19-6-24 49-15 20-40 29-72 8-15 7-34 19-46 24-18 19-59-12-63-54-5-26 54-55 58-16-2-33 6-50 1-15-6-32-12-48-4-12 7-25 13-39 15-21 3-30 24-24 43 6 16-3 33 1 50 16 42 60 11 90 6 25-4 29-69 60-27 10 29-38 22-37 49 0 9-4 22 7 28 10 5 20 14 14 27-8 14-19-8-21-16-2-15-17-17-30-20-28-4-43 23-42 47-8 26-47 9-48 45-4 23 14 36 31 47 20 31-41 13-51 34-7 9-14 18-24 24-28 17-44 91-83 54-22-18-37 0-52 9v62c34 17 64 64 100 26 10-15 19-32 40-32 27 5 59-9 50-41-3-10-12-24-2-32 42-20 32-44 55-51 20 1 37-5 47-24 16-33 40 1 63 2 9 0 18-1 26 4 22 14-44 69 35 85 13 0 30-2 32 15 1 19 33 28 21 47-15 24-27-5-42-12-21-11-44 5-45 26 2 28-7 29-32 35-33 14-20 50-1 70-3 15-28 20-34 37-19 29-33-37-87-2-10 5-31 2-31-11 9-19 19-39 38-50 21-15 17-50 49-51 37-7 32-75-10-65-21 5-32 29-55 30-21 1-30 20-36 38-16 38-64-21-77 55-3 10-9 16-19 18-17 1-17-25-30-34-13-13-10-39-31-44-9-3-16-1-24 1v73c6-3 14-3 26 3 15 15 46 5 45 31-2 24 40 31 24 52-4 4-10 16-17 11-17-31-47-19-73-32l-5-2v72l9-3c25-10 41 5 64-18 14-7 18 16 29 21 20 16 49 0 52-26 2-5 1-14 8-14 34 12 33 54 1 67-21 20-58 21-61 56-67 136-38 10-95 23l-7 2v58h1c30 12 15 21 2 39l-3 4v65c15 3 31 1 42 11 19 29 67 28 69-12 0-41-89-51 16-71 17 11-4 42 14 56 48 63 99-72 34-80-15-2-41 13-33-14 12-35 42-56 71-76 18-12 13-32 15-50 8-20 33 7 29 20-9 21-20 45 1 62 31 25 76-13 112 3 27 9 43-32 69-11 23 5 27-19 21-35 1-19 21-34 33-46 17-9 38-30 57-14 18 22 52 25 55-6-7-42-16-37 30-45 40-10 26-60-4-73-49-22-46 40-88 37-19 1-30 19-49 22-11 2-22 7-30 16-14 20-47 53-68 46-15-10-33-1-49-5-9-5-9-19 0-24 14-6 32 1 44-10 15-14 36-24 44-43 14-50-48-31-68-54-3-4 0-9 4-11 18-17 39-20 62-12 30 8 12 55 47 62 30 6 58-26 87-35 23-10 17-39 34-54 14-12 25-29 44-32 28-11 70-36 60-72-13-121-63-23-90-64-6-21-17-39-27-59-7-23-45-10-45-35 2-37 30-6 50-7 27-4 30 45 61 33 10-2 21-12 30-4 12 13 27 24 38 38 38 39 27 23 41 75 2 18-23 24-23 42-5 43 60 49 62 9 5-16-15-33-1-46 45-35-4-55 15-71 46-4 37-71-6-57-15 5-22 28-41 12-29-22-37-100-86-71-14 14-30 22-49 17-22-13-19-57-59-39-15 4-18 29-34 27-27-2-57-16-81-3-9 5-18 16-28 9-48-33-2-31 17-58 18-26 59-44 86-25 10 10 22 21 37 19 29-3 56 22 82-4 19-8 34 20 55 16 41-1 49 31 81 43 22 6 34 42 61 29 13-6 25-18 41-14 18 3 36-7 53 3 24 17 54 9 66-18 6-11 14-21 21-32 14-23 1-57-26-60-31-6-45 34-76 28-25-5-16-46-45-50-21 1-51-49-23-54 18 11 44 0 58 16 13 41 50 42 75 11 13-6 19 13 25 21 20 30 69 5 57-28-2-11-10-23-6-35 6-19-2-42 12-58 10-10 13-24 17-38 5-12 19-2 27 0 17 5 31-4 40-17 16-19-16-51-19-75 2-11 21 4 30 3 20 5 35-8 41-23 16-47-54-70-83-40-16 8-28-14-45-13-34-2-49 34-38 63-3 28-17 35-8 66-7 18-28-4-37-10-15-16-20-46-5-64 31-35-20-63-11-101 2-23 25-38 22-63 0-5 3-10 8-11 23-4 42 15 64 19 3 1 3 4 1 6-39 18-31 80 17 66 16-14 56-14 52-42-12-26 13-47 9-74 12-12 34 22 52 13 30-12 32 16 58 18 50-2 18-41 80-12 41 2 45-53 11-63-24-14-36 29-58 17-11-8-19-19-19-34 2-22-19-37-29-55-47-96-137 1-47 33 11 4 14 31-2 28-15-10-28-25-47-14-32 13-6 44-23 53-42 9-17-48-54-60-8-3-26-11-15-21 18-14 33-32 56-36 41-27-9-45-5-67 7-27 61-45 85-59 22-2 3 44 26 53 14 8 17 19 17 34 2 22 34 20 38 0 0-18 10-28 25-11 5 6 3 14 0 20-10 21-5 46-9 68 3 37 57 45 64 5 8-28 2-61 14-87 8-10 10-24 15-35 14-14 38 6 62-12 15-3 34 33-9 32-25 4-33 32-22 53 7 24-18 63 19 72 11 5 28-2 34 10 5 28 24 45 51 27 35-18 58 49 95 34 33-20 31 27 68 21 18-2 37 10 53 0 7-8 24-8 16 6-14 9-28 17-29 35-5 19 15 36 3 54-15 26 17 41 10 61-31 24-26 80 19 78 12-1 33-12 38 5 2 17-6 35 5 50 4 7 9 14 6 22-18 22-11 43 9 60 13 17-50 51-65 35-12-8 2-25-4-36-4-16-23-26-40-16-15 8-18 31-3 44 9 7 27 11 21 26-4 21-16 41-35 16-23-22-49 7-74 9-21 6-18 37-15 54-1 23-31 10-34-6-5-22 10-44 32-49 15-14 15-41 35-53 19-16 2-50 33-54 18-5 28-24 48-27 26-6 36-39 13-54-32-10-23-32-45-47-19-12-43 5-40 27 1 11 8 25-2 35-13 10-23 50-43 27-9-18-21-32-41-37-21-15 20-42-7-65-30-22-2-29 5-54 6-25-34-37-50-21-31 40-45-36-85 14-9 18-29 28-35 48-3 5-3 17-12 14-36-14-5-75-55-79-36-7-45 29-41 56 15 26 27 48 24 79 3 51-53 2-61 50-4 28 38 45 53 19 5-7 7-23 18-22 19 5 18 31 4 42-15 7-27 17-36 31-17 21-45 1-68 5-13-5-7-28-23-33-21-10-44-31-67-15-13 8-19 24-14 39 12 23 21 43-3 63-17 21-8 57 19 60 36 0 46-29 71 17 4 25-29 59 22 71 50-16 56 32 86 14 8-7 17-16 30-15 10 2 30 2 31 16-2 28-13 56-5 84 9 25-31 40-17 67 8 29 41 13 60 25 20 21 42 17 62-2 22-1 10 43 39 40 13 0 25-2 36-10 30-22 82 32 91-61 5-40-47-59-68-25-18 17-43-9-62 8-18 17-25 7-40-5-19-16-47 23-58-5-4-19 24-29 21-49-5-31 24-61 55-49 24 11 50 20 48 51 4 19 35 17 36-3 0-12-3-26 3-38 17-36-39-86 41-48 36 13 37 55 62 78 15 18 52 16 60-7 6-31-33-45-22-62 10-8 21-16 25-28 7-28 48-31 44-64 1-5 5-10 10-9 22 7 44-31 59-7 24 77 88 65 74 101-8 13-6 39-25 42-17 3-25-8-27-24-9-38-41-19-28-69-2-30-52-35-58-5-5 28 39 34 26 61-16 50 34 38 39 66 1 22-20 23-37 18-19-5-33-28-55-20-30 3-24 40-4 52 18 7 35 16 37 37-3 30 24 57 49 36 9-8 8-21 8-32 3-47 30-35 50-5 18 18 51 4 52-21 0-25-29-41-20-68 1-9 12-11 19-14 48-25-1-43 89-74 21-13 43-1 62 9 21 6 41-13 41-34 1-13-3-28 9-36 11-10 28-19 38-3 25 19 27 65 43 68 26 1 45-26 30-49-11-19-1-43-17-60-21-18 2-29 17-39 24-19 7-59-19-68-31-9-37 39-77 51-29 10-68-16-74 34 1 107 2 44-60 70-61 41-77-15-112-41-11-13-37-16-37-37-2-21 19-20 33-11 30 13 35-27 57-36 26-8 37-36 19-58-2-6-19-14-11-21 13-3 29-21 40-11 17 31-5 60-8 90 2 21 4 77 37 52 12-15 8-36 21-49 31-46 82 32 99-39 3-18-22-38 6-45 33-12 15-43 18-67 7-19-4-36-21-44-16-11-13-35-9-52 7-17-3-36 5-53 15-22 7-56-23-59-30-1-35 24-76 19-16 2-34 18-34 34 6 28 27 48 57 45 15 7-2 24-14 18-20-13-42-2-64-6-14-2-40 8-37 25 6 22 29 31 46 44 18 15 41 13 59-1 74-25 86 92 36 55-26-19-58 0-84 9-28 10-30-88-81-48-14 14-6 34-3 50 1 14 20 24 20 36-21 10-38 22-42 47-17 41-64 3-75-25-18-20-2-38 12-55 16-21 11-49 45-49 30-7 23-46 48-59 25-19-9-55-33-46-23 12-42-22-63-1-9 17-16 14-30 5-22-6-61-23-43-51 30-21 17 21 84-24 49-25 21-52 83-8 11 8 6 22 9 34 7 39 70 21 61-15-2-11 8-19 13-29 14-26-10-47-36-47-14-2-19-29-2-28 19 6 38 11 55-2 11-8 23-13 36-12 23-4 24-34 23-53 3-16 26-19 39-12 10 6 1 16-4 22-14 13-9 42-30 47-38-5-43 57-5 57 16 0 25-19 42-18 15 2 34-12 45 1 12 17 12 45 34 52 21 6 32 28 54 32 14 3 16 8 12 21-5 10 3 33-10 36-18-6-43-6-47 17-2 18 10 35 3 53-4 11 7 29-5 37-15 3-39 18-23 35 14 15 33 1 39-14 15-11 20 15 18 25-2 19 22 32 34 15 7-18 5-37 18-54 16-34-35-45-35-75 4-10-2-31 10-34 20 7 40 14 38 39 3 22 26 24 44 27 35 24-29 66 3 93 5 7 18 12 15 21-11 9-19 28-35 29-19-2-41-3-50 18-7 21-1 43-16 62-11 26 17 53 42 42 7-3 14-7 22-7 26 0 15 29-3 36-28 7-64-11-69 37 7 28-4 40-26 56-14 13-32-3-44-12-28-4-53 8-76 22-24 14-55-9-73 19-15 35-27 18-55 19-30 4-43 39-26 62 15 23 31 58 63 40 14-9 19 9 29 18 28 26 62-26 28-42-15-10-34 13-46 0-7-14-7-42 13-44 24 9 48-9 72-1 16 7 32 0 46-6 35-14 46 37 18 40-30-10-66 14-51 47 29 36 22 40-5 73-25 11-23-32-84-32-14-2-26 5-38 11-19 3-35-22-54-6-23 26-51 11-71-10-23-19-60 2-54 31 3 14 21 36-1 43-21 7-57-5-59 27-2 11 6 28-7 34-17 6-35 16-35 36 0 24-15 55 5 74 29 23 70-6 60-43-2-19 5-43 29-38 36-1 70-40 65-76 12-22 36 8 47 18 24 23 60 2 61-31 0-6 3-16 11-14 18 11 37 19 56 26 33 17 69 52 87-5 17-32 35-8 45-60 25-40 65-2 83-35 9-12-7-32 7-39 18 3 51-24 58-5 21 35 50 45-6 65-16 8-19 25-19 41-3 22-25 34-30 55-22 14-8-29-19-38-12-22-47-17-53 7-4 20-8 46-32 50-40-4-74 52-28 74 51 12 26 27-1 49-44 12-70 13-39-39 15-25-12-52-38-44-27 14-41-20-67-19-66 2-18 110-48 116-80-43 3-48-36-91-32-23-49 28-81 26-37 7-23 43-34 68-13 29-21 45-51 59-3 2-7 1-9-3-5-11-12-22-22-31-12-11-6-36-24-42-21-9-48 11-37 35 6 12 16 21 18 34 5 35 40 37 63 17 24 9 3 42 55 34 17 0 24 21 33 32 13 25-10 58 29 73 48 7 2 56 44 72 60 15 37-49 60-59 37-11 22-40 41-45 58 17-76 83 10 122 11 8 11 26 2 34-34 15-25 68-59 79-15-2-30-2-45 1-36-16 37-44 4-66-27-15-88-24-74 26 7 19-1 42 14 58 3 4 5 9 2 13-11 11-27 6-35-6-22-17-56-37-83-21-15 10-30 9-45 1-30-11-42 29-71 5-46-16-31 47-60 62-8 7-13 16-13 27-5 29-7 57-15 85-7 40 53 53 64 16 1-45-44-57 20-98 28-7 22-48 48-44 14 4 28 3 42 3 26 1 48 17 75 18 19 6 38-15 55-1 12 10 30 13 35 30 3 10 8 20 15 28 11 12 7 31 20 42 43 32 42-65 84-3 19 18 47 8 55-17 7-26 24-67-15-74-27 2-52-14-78-7-17 9-33-5-50-7-5-1-10-4-12-9-3-11-24-24-15-36 21-16 22 10 32 23 18 26 44 9 57-8 19-17 47 16 69-10 12-13 19-30 32-43 14-34-14-32 28-61 18-19 1-46 28-60 20-19 9-49-4-68-14-21-44-6-63-17-24-13 14-37 0-57-6-15-17-27-20-43-7-29-49-27-63-5-7 9-14 21-28 22-22-1-52 40-64 7 6-31-33-52-11-81 17-19 38 36 80-9 18-6 33 29 56 12 18-3 15-35 35-28 10 8-22 23-7 54 7 15 32 13 43 4 10-7 18-18 31-17 15 2 28-2 40-10 8-8 28 0 25 12-30 16-74 46-59 85 8 16 8 39 23 50 18 8 35 40 55 21 21-24-31-34-14-58 52-86-5-76 10-101 15-6 29-15 31-32 2-16 12-30 14-46 6-31-42-29-35-47 27-37 102 27 108-38 5-24 44-21 43-50-4-27 44-80 57-45-1 17 8 31 18 44 6 14-13 27-9 42 3 18 16 26 33 25 16-3 28-8 28 14 3 26 19 63 51 58 19-5 37-1 50 13 12 16-16 33-7 50 9 18 27 33 48 30 30-2 79-7 61-50-23-38 34-33 46-61 13-14 34-18 41-37 4-9 9-18 18-24 22-11 26-38 46-51 41-53 73 11 105-21 122-120-18 58 129 23 27-7 30-46 4-56-12-8-44-8-38-28 7-24 24-23 45-16 22 3 30-31 52-17 38 12 35-51-1-31-7 3-13 11-21 7-22-10-7-53 16-47 16 12 42 7 52 26 8 17 27 23 37 39 7 18 32 16 38 32 6 62-64 19-49 77 6 10 15 19 15 32-5 50 62 34 40 70-63 18-46 6-77-32-13-17-37-16-52-32-1-2-4-3-7-3-27-6-52 17-42 44 5 10-1 21-11 14-8-18-20-37-43-35-32 7-26-9-32-33-9-20-40-20-55-6-7 7-16 11-26 8-26-10-58 6-58 35 0 18 14 33 4 51-10 19 16 44 30 23 9-29 18-37 41-56 16-14 39-3 58-7 12 6 5 25-6 29-20 2-36 25-16 38 9 5 21 4 28 12 9 17-34 24-28 49 12 52 54 2 81 25 19 10 45-8 44-29-1-16-13-35 8-41 9-4 15-10 19-19 9-28 36 3 56-1 25-8 26 22 40 35 17 22 18 65 57 57 18-4 56-12 58 15-1 57-53 30-39 107 2 27 33 41 30 69 2 10-6 37-18 24 2-26-21-53-46-35-23 22 2 47 27 50 13 20-9 34 21 64 12 24-30 21-43 31-15 2-11-23-17-32-12-28-50-29-71-10-7 9-18 4-11-6 17-23 44-69 8-86-29-19-83-21-75 25 16 34-6 31-22 52-21 30 34 99 68 80 13-7 26-9 31 7 12 21 43 22 48 48 7 16-11 28-25 31-20 4-23-28-43-27-12-2-24-3-37 0-22 2-35 36-14 49 18 9 38 10 58 7 6-1 13-2 18 3 21 25-28 51-49 39-16-8-46-1-42-28 0-29-47-40-35-70 41-58-42-96-62-28-27 29-55-22-57-47 14-42-14-68-56-55-69 30-63-30-99-2-12 21-34 33-43 54-7 23-28 39-26 64-1 11 4 34-11 37-19-4-28-20-22-38 5-28-34-45-50-20-12 16-4 33 11 44 13 15-7 60-29 41-8-13 5-29 2-43 0-11-10-18-18-24-22-16-30-43-47-63-24-48 42-45 65-66 14-16 11-47-18-54-17-2-34-5-47-18-25-19-59 4-51 34 3 12 6 26-9 31-52 6-39 35-82 44-31 6-30 72-69 53-48-30-35-22-18-72 14-15 51 9 53-32 1-21-23-35-41-25-15 7-13 37-35 29-12-5-25-4-38-6-19-8-1-44-28-51-36-15-65 40-34 59 9 4 36 3 30 18-6 14-28 30-35 9-4-15-8-29-26-28-18-3-42 13-35 34 1 17 41 31 20 48-30 5-58 23-45 57 9 19-15 22-21 36-8 19 18 30 22 46 10 22 28 28 46 23 20-5 37-17 47-34 17-20 18 22 11 31-21 25-2 66 29 47 14-10 15-30 30-39 12-8 17-21 20-34 6-23 37-12 53-23 32-16 47 2 31 32-9 10-14 29-30 29-23-5-54 1-56 29-4 29 32 51 56 31 11-8 21-31 37-15 24 24-28 43-19 73 6 58-59-30-86 35-5 13-1 25 3 38 5 11-4 19-11 26-10 12-3 34 15 31 10-1 16-9 21-18 13-16 41 10 56-11 46-33 18-55 45-68 35-8 36-45 51-72 11-28-24-46-24-74 1-47 29-29 57-18 23 9 26 48 58 40 22-13 86 15 64 44-33 19-21 59-18 91 11 33 52 17 71 0 15-12 5-30 0-45-4-19 21-27 36-21 16 7 33 11 46-4 11-13 21-26 39-20 22 3 33-14 47-27 23-14 32 24 42 38 1 13-22 9-29 17-40 21-3 85 35 58 22-13 18-39 6-58-6-27 45-6 50 8 11 17-3 39 10 56 7 11 6 24 5 37 1 46 86 60 87 9-14-24-6-54-26-75-49-45-3-67-44-95-23-6-37-24-58-34-27-6-7-48 12-29 9 18 27 36 49 28 17-6 34-20 52-6 17 7 7 21 1 33-10 23 11 48 35 43 14-3 29-10 40 3 10 15 21 29 40 34 20 6 18 33 36 41 36 15 38-22 58-30 13 7 22 20 37 24 8 3 12 10 14 18 3 20 9 47-7 62-21 6-23 46-47 31-47-14-47-68-97-41-23 6-31-67-78-16-25 20 22 39 1 59-16 16-36 32-40 55-5 26-15 66 18 76 25 14 63-42 72-3-2 16-13 32-2 47 16 33 72 60 84 10 7-24-22-38-15-60 22-69-47-40-61-84-2-17-24-34-15-50 9-12 27-21 34-2 10 16 32 20 38 39 5 11 13 18 23 23 15 8 28 21 46 25 19 3 31 20 50 23 19 5 41 12 54 28 23 49 58 15 73 38 6 16-12 27-27 26-18-3-46 11-56-11-7-37-51-51-83-40-35 23 17 52-1 80-3 7-6 12-16 7-76-32-54 91 2 39 18-42 23-12 63-15 24 8 48 3 73 5 22 2 39-16 60-18 31-12 15-51 55-62 18-3 17 24 9 34-9 11-19 21-22 36-5 31-20 91 27 95 7 2 17-3 21 5 4 16 6 33 18 44 19 24 57-6 73 22 2 3 1 8-2 11-25 18-11 54-46 22-40-23-67 28-101-35-5-9-9-18-9-27-2-25-19-44-15-70-3-44-66-44-71 0-1 9 4 17 8 25 12 21 3 45 16 67 1 20-21 28-22 53-5 11-19 11-28 14-16 3-19 26-35 25-20-7 0-25 11-30 18-13 17-45-3-56-74-40 63-40 23-101-15-24-96-46-80 6 8 28-31 32-41 55-3 15 15 30 27 38 8 5 22 12 12 23-16 10-33 22-53 21-49-10-62 50-18 68 37-1 17-20 76-1 35 17-5 58-11 83-4 15-26 17-27 0 4-21 13-45-8-61-9-5-20-17-31-9-25 20-28 31-57 6-51-22-63 57-97 79-8 8-24 14-21 27 5 20 26 38 46 25 20-19 48-26 62-51 6-12 16-21 27-30 15-11 40 17 35 32-21 31-3 77 38 70 78-6-14 84 84 83 21 8 1 30-6 41-21 31 33 64 54 33 7-10 7-22 6-33 3-29 46-38 42-71-4-17 1-31 7-47 8-25-13-50-38-51-17-4-32 27-46 11-29-45 37-12 63-37 20-11 22-34 12-54 1-44 77 21 80-55 11-31 46-8 54 13 6 23 25 38 49 34 37 3-36 60 29 78 19 3 36 13 55 16 27 4 36-62 63-34 4 16 5 35 22 43 8 4 18 7 19 17 6 20-18 38-34 21-13-22-37-48-64-35-45 68-35 5-84 32-22 33-71-5-50-27 23-12 31-49 0-54-17-3-32 12-49 7-45-9-54 38-29 66 10 17 2 34-12 46-24 39 36 59 50 14 19-14 26 26 29 38-4 31-43 2-54 54-10 18-73-39-72 41 0 12-5 16-12 17h115c2-17-1-36 23-38 13 3 36-8 40 10 3 11-2 20-8 28h318c0-42-32-35-35-61zm32-205c-1-28 24-21 23 2 2 19-27 15-23-2zm-200-1681c12-25 25-71 59-62 35 15-24 35-17 59 0 13-1 30 13 37 17 14 14 39 24 57-7 35-45-8-35-28 10-48-48-27-44-63zm-68 58c30-17 69 26 58 57 4 68 62 17 74 46 6 26 16 49 44 57 22 7 56 19 68-10 3-13 10-34 27-25 7 8 41 15 28 28a98 98 0 00-25 34c-13 26-71 10-54 66 29 32-1 42 7 75 18 45-36 17-51 1-9-8-1-21 1-31 6-17-9-49-34-48-39 1-97 68-61 102 15 26-25 60 27 77 37 3 17 45-9 21-12-11-28-6-42-1-59 6-65-17-28-60 22-31-20-44-30-68-1-22 27-41 9-64-6-8-16-18-10-29 6-12 14-21 28-23 18-1 34-16 50-5 13 9 28 6 43 1 19-1 22 37 47 29 49-14 18-87-26-51-6 3-11 2-14-2-12-20-34-25-52-35s-35 6-53 3c-25-12 5-40 7-58 2-14-3-26-14-36-20-10-28-31-15-51zm-205 94c27-59-36-94 61-41 20 14 58 0 56-26-2-24-26-30-39-46-2-23 67-8 55 27 0 9 0 19-4 28-24 42 63 67 15 99-34 17-13 57-31 61-15-4-32-6-43 8-6 12-70 47-63 16 4-54 7-37 33-77 10-15 31 1 44-11 12-9 15-26 7-38-16-25-43-9-51 13-6 18-44 6-40-13zM1608 114c-24-1-36-26-44-46 2-17 28-2 38 1 16 9 41 46 6 45zM897 1436c-15-3-24-21-13-32 9-9 13-21 19-31 8-14 32-15 32 4-2 15-18 67-38 59zm-540 368c-3 8-13 9-18 3-8-9-27-23-16-35 12 3 39 15 34 32zm-199 423c-7 7-38-13-32-23 8-14 7-37 26-39 49 8 8 31 6 62zm302-373c20 9 32 30 57 28 20 5 33 41 45 58 22 30-26 41-27 70-2 6-2 13-9 16-60-8 25-61-44-82-35 5-25-34-45-52-15-14 4-44 23-38zm398-109c5 21-30 20-41 11-19-9-56-59-16-60 34-3 47 22 57 49zm435 19c-13 5-30 11-38-5-2-4-2-10 3-11 5-2 10-1 15 0 16 8 30-6 46-4 33 9 12 35-26 20zm157-319c13-17 29-30 43-46 11-10 23 4 31 11 6 5 1 12-4 17-12 11-19 27-25 42-11 25 30 74-49 42-25-16-58 8-60-34 3-62 32 1 64-32zm38 349c-23 11-49-15-69 9-6 5-23 19-26 6-3-36 41-42 44-73 1-9-1-21 8-26 32-6 44-43 55-32 5 5 7 12 8 19 3 17 17 29 20 45-1 27-18 42-40 52zm52-174v-1c-21-4-35 9-46 25-18 12-40-24-64-3-24 11-5 49-29 56-13 2-24-1-26-15-3-13-8-24-16-35-16-34 26-41 43-60 15-11 32 10 50 6 29-5 60 16 84-9 64-29 70 41 4 36zm135 146c-43 2 13-55 23-29 5 19-9 29-23 29zm179-391c2-3 6-5 9-3 7 5 25 8 22 20-9 14-9 41-29 42-36-3-12-42-2-59zm434 580c-10 0-17 7-26 10-19 4-23-25-1-19 12 4 23-5 33 0 6 4-1 9-6 9zm726-441c10-5 16 5 21 12 8 17 34 16 38 35-8 14-29 17-36 34-7 11-15 15-26 2-23-19-37-26-45-57-1-23 35-15 48-26zm-65-121c16 3 34-19 47-5 19 23 9 53-16 66-25 9-22-26-36-37-17-23-56 18-55-22 7-63 32-1 60-2zm267-330c8-4 23-7 23 6-2 15 6 31 8 45 2 31-44 21-43 52-4 35 41 26 40 52-5 13-29-12-44-3-16 6-28-2-37-15-15-19-36-9-50 4-14 7-30-15-21-27 6-12 15-21 28-25 25-7 37-33 63-40 23-9 14-39 33-49zM2213 99c49 3 57 35 4 42-26 3-27-40-4-42zm-116 157c9-20 38-10 54-23 15-9 18 7 17 19 3 20-7 37-22 50-14 7-28-12-41-17-9-6-12-18-8-29zm-312 226c6-1 12 2 18 4 18 6 35-7 54-3 29 4 51-35 32-58-7-9-18-20-10-32 10-34 62-22 64-61-6-52 64-39 37-91-30-45-40 7-73-5-12-11-43-1-46-17 2-8 4-32 17-25 21 19 50 6 73 20 8 4 14-5 18-10 17-20-9-33-17-49-1-11 30-8 39-12 8-1 16 2 19 10 2 25 28 39 24 65 6 35-48 80-2 103 16 7 36-1 48 15 37 40 49-30 82 7 17 13 43 7 53-12 8-22 2-56 35-58 17 2 4 22 3 32-7 36 34 43 59 30 30-5 18 35 26 52 0 20-28 5-39 2-60-14-49 37-49 76-4 16 2 30 9 44 0 5-6 5-8 1-27-35-49-7-73-14-6-17-28-42-4-53 31-16 18-69-20-62-17 6-33 2-48-7-36-13-53 36-87 36-30 3-52-42-81-15-19 16-14 43 3 58 13 13 14 33 26 46 6 6 2 13-4 16-72 67-25 10-79-13-23-11-34 26-54 19-12-8-22-20-38-18-20 5-28-12-7-21zm-33 85c19-7 37 20 57 6 14-8 28-28 44-11 15 16 52-1 51 27 3 31-38 43-26 76 1 8 10 22-1 26-14 2-31 10-42-2-31-21 9-60-21-82-19-18-48-9-72-19-16-6 0-19 10-21zm106 305c-12-4-31-31-12-35l32 2c23 6-2 47-20 33zm-748-417c4-27-24-38-42-52-37-25-53 18-71 11-9-22-9-51-39-54-10-2-23-2-28-13-16-24-24-51-33-78-7-15 15-13 24-14 37-9 19 41 50 49 15 6 27 13 38 25 14 17 37-2 55 1 39 5 56-46 23-66a88 88 0 00-49-19c-24-1-43-16-67-16-18-5 20-36 19-50 9-9 31 20 49 12 52-10 4-72 36-69 15 2 37-2 43 15 2 18 21 38 10 55-13 13-25 32-12 49 10 18 40 8 45 28 9 30 24 45-13 61-27 17-6 50-18 73-18 28 5 49 29 62 4 6-1 12-7 8-13-9-40 4-42-18zm871 646c-16 10-36 11-47 28-12 14-36 12-43 31-15 23 35 46 13 62-27-4-59-2-52-40 6-36-41-61-63-29-10 12-6 43-27 42-15-10-31-22-37-41-7-19-34-28-22-52 4-23 32-20 44-37 12-16 28-5 40 5 28 21 70-11 60-41-5-21-28-30-34-50-8-28-43-40-63-17-10 12-13 28-23 40-10 18-31 26-37 46-3 7-7 13-14 15-18 11-55 0-40-24 36-18 27-77-16-66-54 23 1 56-14 77-15 16-5 34 13 41 20 25 2 36 46 44 18 9 1 64-19 46-22-20-39-70-76-49-11 6-22 18-34 7-20-16-62-3-38-43 43-42-7-59 14-83 22-10 21-36 34-54 22-22-2-52-26-30-18 28-51 48-60 2 0-21 31-30 24-56-5-17 4-35-2-52-7-11-7-23 0-34 18-29 48-31 43-73 13-13 48 18 62-25 4-10-4-25 5-32 22-3 49-19 35-44-10-17-37-15-44 3-7 14-1 39-25 30-18-3-10-25-17-37-14-28-55-13-52 17 0 22-18 40-4 61-3 30-46 39-70 52-11 5-18-8-28-11-23-9-35 29-10 35 10 2 24-3 30 9 8 15 21 37 2 50-21 3-36-36-64-3-16 25 14 55 40 39 15-14 30-12 34 10 5 24 10 48-24 36-21-5-35 10-46 25-12 13-32 7-48 9-12 0-17-13-19-24 0-19-12-33-28-43-41-40 48-29 24-74-45-52 58-11 32-86-16-73 95 33 142-39 20-31-20-65-51-49-22 7-70-13-55-41 10-19 3-33-17-39-26-9-48 19-34 42 16 16 14 34-9 41-20-1-16-40-46-33-44 16-3 44-3 70-4 11 4 32-8 38-19-9-42-27-61-7-7 5-11 19-20 15-33-25-47-59-3-81 31-8 38-44 27-71-8-9-12-43 6-35 8 15 19 31 39 30 29 0 43-40 23-59-13-16-5-41-25-53-27-9-35-56 4-35 18 10 36-14 54-1 40 36 80-14 118-26 22-5 27 23 36 37 5 17-4 36-8 53-11 19-49 0-54 30-2 18 2 35-4 52-2 7 0 11 5 15 13 11 29 17 44 7 22-14 48-21 73-21 28 6 52-30 77-14 14 11 31 17 48 7 8-3 17-15 25-8 17 17 34 24 24 51-2 40 41 30 49 52-5 10-32 1-42 13-41 40 4 75 50 57 18 8-1 37 3 52 0 9-11 16-20 12-35-29-46 16-70-3-17-34-64-37-80 0-12 20-49 16-49 46 1 18 21 29 23 48 4 25 31 33 44 52 17 28 46 1 64 16 21 31 56 13 83 5 33-10 24-64-10-62-21 2-41 6-60 15-6 3-14 7-20 3-16-10-29-30-20-49 5-5 11 2 15 4 27 23 50 11 72-11 16-7 35 10 51-2 29-13 4-45 17-65 9-9 16-30 31-24 17 14 36 33 37 56 7 31-22 17-39 28-29 18-5 50 5 72 15 31 51 46 83 48 13 14-4 40 15 57 15 21-7 62 35 55v-1c21-3 30 20 49 27 3 3 10 7 8 11zm123-57c-21 19-6 46-21 55-11 3-13-9-14-18-2-53-92-30-36-86 11 9 22 21 38 18 18-6 44 10 33 31zm10-64c-25 7-44-36-68-9-14 19-17 18-33 1-36-26-45 17-86-33-7-9 11-16 16-22 29-22-6-59 13-74 47-4 22-64-7-31-6 26-20 26-43 19-10-9-1-27 2-38 15-17 46 1 55-34 13-33-30-40-26-58 50-63 56 33 104-8 21-23-4-47-17-66-7-55 45-39-32-108-19-18 37-43 51-49 47-20 18 53 67 53 32 8 65-25 69 7 7 43 40 48 37 86 6 48 77 45 81-3 4-44 18 1 30 14 7 9 1 17-7 22-24 12-2 65-27 52-6-9-10-19-21-21-37-3-12 33-21 49-14 14-17 46-42 41-42-6-28 36-53 45-62-4-38 39-71 48-27-6 3-37-3-55 0-18 3-37 22-43 18-9 30-25 49-30 23-7 52-16 52-44-2-30-6-68-40-79-18-11 2-38-17-51-18-17-44-4-48 18-4 16-15 25-23 38-20 30 10 54 38 61 20 26-43 9-52 41-13 46-71 26-42 94 12 29-26 42-23 69 6 55 49 27 79 37 14 11 30 10 46 11 12 4 10 22 11 33 0 11-11 14-20 17zm74-110c40 5 45-31 44-60 3-17 26-7 24 7-10 32 22 50 49 51 37-2 38-51 14-71-15-27 35-29 34-55 0-20-17-52 14-54 48 3 59 3 34 51-4 19 10 32 25 42 28 22 28 54-14 53-16 3-27 13-31 28-8 69-49-24-84 50-18 13-41-18-65 6-8 8-18 19-29 10a62 62 0 00-52-15c-32-13 14-53 37-43zm127 331c6 35-39 27-42-2-14-34-53-8-57-27 12-27 53-34 27-75-11-20-42-10-46-36-5-33-37-17-47-35 0-12-1-33 14-36 9 1 14 11 18 19 10 23 33 37 48 57 20 21 49-13 69 1 5 11 10 22 17 32 2 4 1 10-2 13-40 33-22 54 1 89zm73 169c-28-11-4-56-36-67-9-4-26-4-24-17 2-12 9-38 25-26 13 16 28 29 50 27 22 0 1 83 59 65 31-14 13-64-15-70-10-4-25 0-24-16 7-49-19-31-17-59 19-63 37-19 79-38 12-3 20 6 27 13 50 76 60-1 114 45 17 14 5 51 38 50 40 3 31-42 35-68 1-32-44-26-36-62-1-30-40-40-58-17-17 28-30 4-42-12-14-18 7-44-10-61-20-26-81-8-64 29l11 29c-3 20-31-4-44 2-50 3-37-25-60-45-13-7-27-6-41-8-30-10 19-64-39-71-15 2-52 11-40-17 10-10 15-33 31-31 21 14 54-2 63 26 7 14 29 14 34 1 6-12 4-27 13-36 16-10 33 17 51 15 26 3 20 39 44 44 41 16 67-54 106-38 5 5 31 7 25 17-42 21-110 86-32 109 17 2 32 9 49 12 20-1 25 13 23 30 9 60 90 38 83-18-4-28 18-55-6-79-8-10-26-8-30-22-2-17-26-68 6-63 24 17 4 65 41 69 13 1 26 1 34 11 25 20-3 32-12 50-10 23 13 42 12 65 2 15 6 35 24 37 32 9 40-25 61-39 34-10 27-44 21-72-3-16-18-24-30-34-8-17 40-25 45-3 11 20 42 18 41 45 16 60 76 24 98-12 9-11 23-19 29-33 3-9 10-17 19-16 20 2 43-12 60 4 8 6 9 22-2 26-26 3-42 24-67 31-26 5-34 34-61 37-20 2-21 32-42 31-26-8-55 18-34 42 22 29 65-36 72 17-6 14-7 34-22 41-11 6-26 10-32-3-8-19-26-28-46-21-11 3-21-2-31-7-23-12-49 0-74-7-10-1-17-7-23-16-19-27-67 4-44 32 15 11 28 23 26 44 4 28 35 26 56 15 21-4 22 29 5 36-37 9-33 33-57 40-28-10-48 17-74 9-24-7-50 7-48 36 13 47-35 13-56 28-44 33 18 84-11 128-9 9-23 35-32 12-4-16-31-26-25-44 12-19 18-46-4-60-20-15-44 2-54 21-8 13-26 14-40 20-10 1-10-15-7-21 8-15 28-20 30-39 5-36-32-45-59-37-21 2-17-29-35-36zm-17 538c-4-24-46-31-23-58 14-16-18-51 13-55 52 15-27 51 27 82 60 20-8 85-17 31zm56-312c25-7 17-32 3-46-3-5-12-9-8-15 46-50 28 8 67-2 26-16 42-3 19 21-11 18-34 17-50 30-15 16 1 43-36 39v1c-46-5-30-23 5-28zm9 251c-3-16-24-31-13-48 15-11 9-47 32-44 26 17 64-29 69 1-12 57-75 30-55 101 0 4-5 6-9 6-11-1-19-5-24-16zm-122 910c-5 17-31 10-31-6-1-16-1-32-13-43-37-30 11-34 33-36 12 0 12 8 10 16-6 23 9 46 1 69zm228 21c-22-26-48 15-70-5-18-12-59-7-30-37 24-17 32-61 63-66 33 2 9 47 34 60 42 16 54 106 3 48zm282 56c-20-1-27 30-45 23-17-16-40-6-58-16-10-7-6-17 3-24 14-8 13-28 27-35 63 40 72-34 103 17 8 19-13 35-30 35zm126-70c-20-10-40-17-59-29-20-22-60 28-65-11 37-80 24-33 76-26 14-2 28-1 32 16 3 14 18 20 25 33 4 7 0 20-9 17zm845 243c19 5 29 25 44 36 2 2 3 6 1 9-17 19-37-4-57-4-22 1-33-19-35-38 1-31 31-5 47-3zm-63 73c22-1 23 28 44 32 29 3 57-8 66 31 3 11 3 23 13 29 25 21 43-12 61-3 8 18 37 25 37 46-5 21 0 78-35 63-20-11-13-36-21-54-13-29-42-7-56-23-5-10-6-22-16-28-25-18-38-43-73-31-3 0-6-2-7-5-2-28-41-56-13-57zm2 115c25-17 48 14 63 32 6 10-7 20-13 27-18 12-37-12-56-5-27 11-36-11-36-34 1-20 30-7 42-20zm-52-191c-1 11-12 17-23 14-25-13 23-49 23-14zm-114-80c14-13 20-32 35-43 24-9 39-55 47-3-1 3-5 6-8 7-49 7-6 59-43 74-14 1-21-19-31-26-2-3-2-7 0-9zm-153-357c47 2 94 42 36 76-17 5-23-23-38-28-19-9-29-50 2-48zm-83-302c-22-1-17-32 4-28 44 4 37 30-4 28zm34-110c-11 28-44 26-44-7 1-18-47-47-11-55 19 6 41-6 58 6 14 15 37 11 49 25 4 11-39 2-52 31zm-21 994c-14-2-49-17-30-35 12-5 18-29 33-21 10 14 27 55-3 56zm145 52c-3 15-22 33-32 13-5-17-26-27-25-45 2-14 4-28 4-42 0-21 27-24 37-7 10 21 44 12 48 33 0 21-27 28-32 48zm23-142c-17-7-35 11-51 0-49-27-2-68-49-76-31 3-79 1-69-42-5-14-27-17-34-32-18-35-61-26-63 13-25 29-51-24-15-34 24-8 7-40 27-50 28-10 44-33 70-5 34 19 56-27 33-51-11-16 10-30 2-46-4-13-3-30 9-39 20-11 31 18 16 31-25 20-10 50 19 54 6 2 19-1 20 7-4 16-1 37-16 46-27 9-32 38-51 56-11 11-14 25-14 41 11 20 47 26 63 6 11-15 25-26 41-35 25-11 27 29 8 38-22 21-13 59 20 61 38-6 33-23 76 1 27 25 6 58 65 54 20 4 28 32 35 49 82 155-38 21-38 130-1 11 4 26-7 29-24-6-31-27-35-48-6-22 22-33 21-54 1-24-20-35-40-40-20-18-1-54-43-64zm116 371c-4 21-37 0-52 4-11 1-14-10-13-17 5-103 48-74 53-137 5-15 36 13 53 3 41-17 24 59 82 38 14-5 22-27 38-23 19 4 55 26 27 43-13 2-26 2-38 7-9 4-19 4-28 2-26-12-48 31-60 10-44-80-80 26-62 70zm74 228c-8 24-41-10-66-3-9-1-5-12-5-18 7-23-27-47-8-68 60 19 14 68 73 81 3 1 6 5 6 8zm77 257c-64-9-35 131-112 45-4-8-9-18-18-19-14-3-35 7-44-6-16-28 0-42 15-65 10-19 38-11 49-31 15-25 33 12 54 6 31-8 44 31 76 19 43-5 10 63-20 51zm15-252c-20 8-28-25-49-25-17-2-17-19-18-33-9-37 68-59 5-102-11-5-28-7-28-22 0-25-27-48-7-71 6-7 16 0 21 5 14 22 38 29 57 45 22 23 2 52 38 72 24 20-46 71 20 82 10 0 24-10 31 0 1 17 30 64-1 63-22-20-40-38-69-14zM2936 3967c27-23 47 8 65-45 23-26 57 25 81-5 7-4 14-12 22-7 24 18 69 58 81 8-3-40 6-35 40-33 29-4 32-49 3-61-25-13-63-57-85-15-4 37-23 38-45 64-49 20 8-81-63-74-50 23-30-15-63-22-12-1-31 13-39 0-3-20-20-50 0-64 13-6 26-10 37-16 4-3 13 0 10 6-17 17-19 59 9 66 35 0 60-33 28-59-25-15-1-26 4-44 7-22-17-42-39-33-22 22-63 2-75 35-4 11-5 25-18 30-81 51-29-13-65-37-19-12-39 2-59-3-33 1-32 19-67-4-33-12-38 31-60 44-19 9-23 38-3 49 12 6 27 9 36 21 14 20-54 20-31 68 7 23 26 35 49 38 13 2 21 13 31 21 21 18 49-7 41-32-7-23-42-4-50-25-5-15-3-32-15-44-29-26 20-24 16-54-5-19 3-50 27-33 15 11 64 2 39 32-13 17 2 36-5 52-31 34 1 78 37 86 16 3 27-10 40-17 26-12 29 38 55 34 17 0 31-8 34-25 3-10 4-23 16-24 15 1 31-12 45-5 21 15 6 58-19 55-24-7-44 3-53 26-19 18-34-23-56-16-20 2-33 11-40 30-14 50-43-34-77 26-44 41-38-9-67-25-31-7-20-40-32-62-19-25-54 3-79-10-20-9-46-5-56 17-5 32-44 29-52 58-3 7-3 22-14 20-39-38-51-11-95-3-20 7-19 26-20 44h448c5-5 10-8 18-9s16 5 23 9h27c24-23 64 1 80-33zm-97-149c-34-4-30-36 5-34 13-1 21 6 27 17 1 13-22 15-32 17zm74 7c-11 1-32-5-25-17 11-3 31-18 40-5 4 11-4 23-15 22zm-315 163c-15 24-24-6-22-21 6-59 34-9 22 21zM1382 4000h26c-7-4-16-5-26 0zM815 3988c-5-20 21-32 13-51-6-34-56-39-65-4 1 25-20 41-25 64l-1 3h79l-1-12zM2158 3978c30-32-7-58 51-54 26-4 37 37 65 22 8-3 17-12 27-8 52 34 36-28 64-62 11-16 37-6 53-18 26-3 47 46 84 0 5-10 9-22 22-25 16-3 28-19 45-16 14 3 29 6 40-6 22-23-12-58-38-40-28 18-45-9-76 17-20 2-5-54 28-40 23-2 30-19 29-36-1-15-1-18 14-26 19-10 23-37 48-39 23-8 28-31 22-53-6-20 12-37 10-58-1-20 21-22 33-10 15 13-3 37 13 50 28 39 98 26 82-29-10-20-29-54 10-52 25 3 26 61 72 30 8-5 14-24 25-17 18 22 47 34 69 9 11-10 24-1 35 4 41 13 63-39 31-64-17-13-38 6-53 13-40 6 8-51-27-74-30-36 5-53 29-76 12-7 17 8 15 18-1 22 20 39 12 62 4 79 61 16 70 52-29 68 23 56-4 93-17 20-8 48-14 72-2 28 35 37 48 15 11-20 22-39 45-46 51-15-7-41 21-66 9-9 9-22 13-34 15-29 42 24 63 2 27-16-15-35-17-62-5-21-27-26-46-29-31-16-11-53-68-47-17-1-17-60-56-14-8 5-12-8-17-13-8-12 9-17 16-23 43-41-10-67-37-89-63-30-38 123-122 66-24-16-62 22-69 44-5 31 44 32 36 66-5 20-45-1-57 22-22 33-55 24-55 72-15 19-34-15-52-14-10-2-21-7-18-20 6-39 48-9 64-35 7-16 20-23 36-27 18-8 23-31 9-46-13-15-34-8-46 4-20 18-48-17-68 5-29 39-36 7-70 12-9 3-21 6-29-2-7-12-37-21-26-37 17-6 36-16 54-11 20 12 53 3 51-24-6-45-48-14-73-24-10-5-23-7-33-1-22 15-52 14-70 36-40 55 49 43 27 117-2 13-14 19-25 25-20 10-24 41-52 35-25 17-44 49-15 71 35 17 21 62-9 52-35-34-75-9-65 38 3 26 35 16 48 33 32 40 61 7 90-16 21-12 25-35 20-57-2-17 7-33 5-50 0-15 21-67 39-50 65 57-31 48 27 107 17 29-31 34-29 60 0 10 2 23-9 27-21 5-26 36-49 29-31-10-93 36-107-6-2-16-12-32-29-31-41 2-36 52 0 61 20 16-7 32-21 37-16 16-46 5-53 22-5 12 1 27 16 30 11 1 27 5 20 19-9 11-1 46-17 45-34-2-26-37-47-53-14-11-42-6-52 12a84 84 0 00-19 52c-4 17-35 5-34-11 2-15-10-35 5-47 18-20 45-32 57-56 5-17 9-21 25-12 60 38 73-70 10-55-22 3-21 41-35 38-40-17-5-63-15-95 0-10 9-16 18-20 18-6 25-25 38-37 14-11 23-25 29-42 7-20 51 39 72-11 3-27 22-28 33-47 5-25-30-29-40-9-17 21-59 4-60 40-1 3-4 9-8 6-18-13 5-22 11-33 6-44-5-41-36-58-22-25 30-31 16-55-5-35-43-37-65-15-15 11-48-13-31-28 16-7 33-6 45-21 32-33 35 18 59 26 17 6 38-5 51 12 5 7 13 12 21 12 32 2 35-33 53-50 40-52-22-51-31-76-1-15-11-27-14-40-24-4-56 14-49 41 2 17 15 24 30 29 11 5 10 25-3 27-15-2-20-22-36-23-9-2-19-4-24-12-16-18-7-38-6-59-1-22-25-32-43-23-21 15-24-7-33-21-15-23-53-16-64 10-11 18-39 27-36 52 8 27-19 42-43 36-27-20-78-13-69 28 4 16 24 29-1 38-19 9-22 31-30 48-27 44 49 54 3 85-6 5-11-1-14-5-28-24-34-58-34-93-6-42-71-36-68 6 9 53-17 33-47 18-44-31 35-27 31-57 5-33-30-52-53-27-8 10-15 23-29 23-34-8-50 41-69 12-7-9 7-13 13-17 52-46-50-89-45-15-3 20-80-29-74 60-11 28-12-58-102-17-26 12-16 43-8 63 10 20-4 44 9 62 6 16 56 45 13 45-20-2-44-7-47-31-13-32-35-24-42-66-33-50-91 15-38 48 17 26 7 65 28 91 7 10-2 21-4 31-12 40 35 49 59 21 7-8 39 31 30 35-47 30-14 50 10 78 4 12 27 20 19 34-5 7-15 14-23 8-23-27-69-27-77 13-20 92-29-46-89 9-8 11-19 39-35 23-17-33-52-25-30-68 7-26 39 3 67-23 13-8 19 7 26 14 19 28 68 10 62-24-11-62-68-10-73-32-3-91-80-28-90 25-7 10-23 4-34 6-34 4-67 13-98-5-15-5-17-22-26-33-13-19-42-2-55-21-18-38-59-13-69-41-2-10 5-18 9-27 12-21-6-41-27-48-13-7-6-24-11-35-17-39-69-30-81 8-6 11-19 11-30 15a31 31 0 00-11 50c60 43-8 21-15 59 0 15 0 31-12 41-10 10-23 3-34-2-18-8-36 9-55 5-20-4-45 12-39 36 5 16 12 30 8 47-3 40 25 33-16 66-9 21-32 17-48 28-21 16-16 56 15 56 31-4 37 8 62 21 20 4 31 27 52 26 39-5 29-46 6-63-4-13 31-21 38-32 25-21 96-54 50-90-23-22-44 13-68 11-19 0-53-33-27-45 12-2 24-4 35-10 24-10 44 26 69 9 32-12 19-63 32-59 11 24 39 42 63 25 6-3 15-16 22-10 2 33 19 73 57 51 11-7 20-19 34-16 17 5 41 8 42 30 1 27-35 21-49 35-38 22-84-9-115-30-24-16-50-2-61 20-10 22 9 45 14 66 25 39 53-7 72 9 13 18 6 51-17 56-21-1-57 6-51 34 5 21 25 26 41 35h132c4-5 5-13 2-22-5-11-13-27 3-33 17-4 35 6 52-2 22-8 40 15 63 9 36-3 16 27 14 46v2h80l-1-5c-6-12-19-25-11-39 10-16 9-44 33-45 40 4 50-32 66-21 54 81-9 26-36 50-26 23-7 41 0 60h47l1-3c14-26 0-56 34-45 58 9 8-105 70-21 7 13 18 21 34 23 9 0 20 7 14 18l-10 28h219c-10-14-25-28-30-42-18-30-50 0-65-21-5-14-24-30-13-45 6-7 15-15 25-11 18 18 42 12 45-15 7-15 25-22 35-35 3-3 9-3 12 0 24 21 15 52 53 64 13 8 33 45 7 47-37 2-37 30-36 58h177c0-13-11-28-24-38-11-19 9-42-22-52-17-10-22-32-41-40-23-13-23-44-6-61 11-17 7-38 8-57 5-26-35-36-17-42 15 0 25 18 42 18 40 7 58-40 36-69-3-6-2-11 1-16 18-17 8-46 28-59 10-6 17 4 23 10 17 16 43 14 64 23 22 6 28 31 48 40 12 6 15 18 16 30 2 12 10 20 21 25 12 5 57 42 40 54-19 16-41 0-61 2-30 11-4 37 15 43 11 7 23 27 12 39-21 19-54-17-75 1-19 17-6 58-29 64-42 8-9-32-32-49-24-13-7-38 15-33 43 20 62 10 66-38-1-18 13-32 11-50 0-29-39-47-59-24-15 15-16 36-20 55-14 25-48-12-67 16-13 25-65 57-25 83 39 7 35 33 69 41 13 8-4 36 1 51 2 16-13 23-23 33h132l-8-4c-20-9-70 11-31-30 7-5 16-4 24-4 28 7 54-55 63-26-1 14 0 27 2 40 1 8-2 16-5 24h67c-7-5-7-15 0-22zm887-632c7 5 42 16 34 25-14 26-56-6-34-25zm-186 113c7-12 4-32 13-42 14 4 15 24 21 36 3 13-6 26-15 36-13 6-23-19-19-30zm-303-17c5-10 11-30 25-26s34 36 13 42c-10-3-37-3-38-16zM839 3638c-9 6-28-13-19-21 34-6 18-40 44-44 46 11-9 51-25 65zm293 167c-28 46 20 73-35 83-19 2-32-15-23-31 11-14 24-27 19-47-6-30 41-37 39-5zm681-352c8-14 23 5 24 14-1 24-39 3-24-14zm-218-50c22-4 56 25 24 36-23 6-74-37-24-36zm-133 258c49-22 29-31 52-68 18-24-1-48-22-63-4-7 9-13 12-20 27-24-22-64 2-64 27 16 43 45 72 56 6 10-11 21-13 32-8 19 12 44 35 41 26-2 60-10 57-43 1-8 3-16 9-22 13-12 16-29 26-43s38-11 37 9c-4 17-7 33 0 49 2 19-20 28-25 44-16 21-76 7-51 67 38 44 10 48-24 71-13 14-19-9-25-18-7-12 3-21 10-30 16-39-33-24-52-33-17-7-33-5-46 8-24 21 35 61 3 72-18-9-63-20-57-45zm9 202c-1-12-41-28-15-34 28 24 60-2 63 38-2 39-42 26-48-4zm224-65c-6 8-15 3-22-1-21-12-47-8-68-19-32-9-37 32-63 38-19 3-23-32-40-42-8-8 23-45 32-38 48 32 47 12 85-9 15 20 34 40 61 25 19-9 41-2 59-14 7-4 15-3 14 7 2 36-44 24-58 53zm153-231c-4 25-52 22-31 57 8 6 22 27 1 22-13-10-23-18-43-18-16 3-49 21-53-8-3-21 25-17 35-30 17-22-7-57 37-57 17 2 32-4 45-13 31-5 11 32 9 47zm268-289c25-7 70-96 80-30-3 34-46 36-64 59-21 13-40-22-16-29zm-56 298c-27 9-36-35-64-32-30-2-49-7-77 8-31-5-8-41 7-52 16-5 27 22 45 15 20-8 58 14 60-19-4-19-18-37-24-56-4-14 11-19 20-25 29-21 10-54-19-62-4-2-12-6-7-12 34-31 109 36 104 74-3 25 60 55 9 63-30 8-16 40-26 59-11 11-14 30-28 39zm40 80c-22-8-12-47 7-53 21-6 33-23 28-45-6-21 13-36 18-56 1-4 5-8 9-7 12 10 60 12 46 33-23 14-28 41-46 59-6 6-10 15-12 24-1 18-32 47-50 45zM1991 3670c1-48-72-41-63 5 7 35 62 33 63-5zM2448 1196c-20-3-35 38-8 37 26 7 34-34 8-37zM2475 1015c-1-15-12-29-28-29-33 0-33 44-38 66-5 37 46 38 64 17 12-14-2-36 2-54zM1298 459c-42-17-58 54-9 52 27-3 35-41 9-52zM2757 1285c-1-28-50-31-51-3-5 36 53 41 51 3zM2599 1380c-6 24 37 30 36 4 0-22-31-24-36-4zM2564 1362c-9-38 67-21 61-69-8-50-94-24-91 19 12 29-31 32-29 59 2 95 108 70 59-9zM816 541c-25-3-60 0-67 30-3 19-9 39-30 45-15 1-31 21-45 11-18-20-2-64-37-70-30-5-24 38-47 43-33 2-32-14-27-40 0-34-41-42-65-22-22 12-40-56-80-7-6 9-10 22-22 23-24 5-82 20-52-23 17-33-16-64-49-58-17-3-18-27-35-30-21-6-36 16-31 35 4 18 1 18-13 24-34 16-26 42 4 57 8 11-8 26-11 38-9 13-26 0-38-3-31-14 25-43 4-64-20-37-110 0-95 37 25 35 9 71 45 83 44 6 102 52 67 99-12 17-5 34 3 51 0 20-42 16-38 54 2 12 4 34-13 34-10-2-27 2-31-10-2-31-29-63-58-36-6 6-22 16-23 1 2-13 14-22 20-32 19-15 44 35 74-21 4-26 40-34 38-62-3-31-45-40-60-14-8 26-31 36-48 54-21 14-33-17-26-34 7-28-20-38-30-48v265h4c24 18 11 67 61 54 21-5 56-30 30-51-20-9-47-31-20-50 40-28 32 35 67 17 18-17 38 0 54-19 19-25 50-55 20-85-5-18 31-18 28 1-1 10-2 21 6 29 24 24 50 28 14 60-14 19-14 44-28 63-12 28 23 56 45 40 13-8 28-25 42-11 7 8-4 21-1 31 0 18 19 27 35 25 17-2 32 11 49 9 49 0 34-86-11-71-13 6-44 17-47-5 6-19 3-36-7-52-11-28 25-44 26-71 5-13 20-5 29-3 67 5 40-57 43-97-2-23-37-35-53-20-23 17-6 86-34 93-24-4-49-43-37-65 31-31 6-78-36-68-39 1-39-55-25-80 14-13 27-30 10-47-41-27-18-18-17-56-1-10-5-23 7-24 8-2 17-1 20 7 7 14 11 29 24 38 16 12 15 15 5 30-6 9-13 21-8 32 13 23-14 44-3 65 14 33 45-5 55 18 5 22 30 43 52 27 13-9 11-32 28-37 19-3 35-12 36-33 5-19 15-36 15-56 2-39 33 8 51 11 14 10-3 29 4 43 10 45 70 9 62 39-3 10-6 21-6 32 0 9-6 17-13 23-8 7-13 17-20 25-9 8-19-4-16-14 13-24 5-53-20-65-32-16-76 26-71 59 3 19 31 23 28 46-2 19 13 41-5 56-21 19-7 65-42 67-55-8-60 67-11 68 18-6 49-42 56-6-2 16-1 31 7 45 10 22 9 48-21 49-76 43 60 72-37 104-16 4-17-22-30-28-16-10-16-32-30-44-35-28-70 23-42 47 16 10 24 23 19 42-1 19 15 32 17 51 2 8 6 15 12 22 5 8 13 16 8 26-15 24-25 50-2 73 8 13-11 27-22 16-15-21-7-52-25-74-15-33-66 0-52-22 71-62-11-66 7-113 7-46-47-37-26-97 6-34-31-43-53-23-16 8-26-15-39-22-23 10-63 18-64 49 3 17 2 33-11 47-14 19 8 55 31 47 17-9 23-26 21-44-2-19 31-43 37-16 3 12 10 22 20 29 18 15 21 40 34 58 2 27-37 6-50 20-19 17-20 13-30-7-27-54-93-10-66 37 37 53 65-14 80-8 7 10 14 29-3 31-16 2-26 20-42 18-32-26-81 14-49 48 17 15 13 52 41 53 42-9 33 45 12 43-11-10-18-29-35-28-21 3-83 13-61-25 6-13 1-26-5-39-5-36 38-39 5-87-7-11 4-20 10-28 28-28-22-51-4-75 40-36 23-144-37-94v351c3 0 5 2 6 5-4 20-2 44 23 49 24 0 44 13 67 16 32 15-15 53-34 31-15-17-39-25-57-13l-5 3v63l2 3c1 6 1 10-2 12v149c11 10 27 14 41 2 9-5 18-28 30-15 12 19 64 35 33 61-8 5-15 12-19 21-18 31-62 8-85 27v50c8 7 18 10 28 9 20-9 34 2 51 10 41 4 7-47 33-59 40-11 18-40 43-56 27-7 37-42 13-62-38-18-10-79-61-81-22-6-50 30-49 17 12-20-13-70 15-63 12 2 24 2 35-5 34-16 43-71 86-70 67 20 33-34 106 0 50 1 41-42 40-73 5-14 21-23 36-14 19 10 39-5 58 6 23 11 42-10 66-7 17 1 34-11 31-30-5-37-45-12-68-19-9-5-33 2-34-11 10-17 13-36 11-56 0-18 21-21 33-31 22-14 4-37 8-57 14-49 96-4 40 24-24 22 14 40 6 63-10 25 4 55 33 53 16-4 32-5 48 0 24 6 39-21 36-43 4-20-21-34-13-54 24-41-21-55-14-94-9-49-104-13-113-60-8-53 61-7 47-87 12-38 53 31 79-15 11-20-2-46-25-47-16-1-35 15-48 0-11-14-10-34-22-49-5-6-6-14-5-22 3-12-4-33 11-38 23-3 38 23 60 22 40-11-15-49 10-70 27-15 10-60 45-52 18 8 69-36 54 8-13 31-76 20-65 64 3 12 13 19 21 28 9 20-46 20-33 52 12 29 76 37 89 5 4-34 28-37 56-46 31 9-32 34 52 75 26 20 47-10 71-19 30-7 36-48 11-62-20-11-37 7-55 15-16 8-34-8-20-23 30-42 16-112-42-63-5 3-9 8-15 5-7-3-5-10-4-15 5-20-5-38-3-58 1-10-3-20-9-29-29-43 40-38 49-6 5 29 37 34 47 59 6 19 26 30 28 50 1 8 4 15 9 21 48 60 104-15 52-58-21-14-21-41-42-54-18-13-5-43-25-52-17-7-37-13-41-34-4-25 16-61-25-70zM386 657c-18 0-43 20-44-10 0-31 65-53 68-14-3 16-7 24-24 24zm-153 715c-2 9-5 19-13 25-22 11-13-26-24-36-21-21 7-42 29-38 68-6 10 12 8 49zM950 1014c-11-24-39-28-63-29-35-3-83 44-37 68 16 6 35 1 51 8 49 31-24 42-48 44-34 10-28 49-24 76 2 40 60 51 69 9-3-40 38-34 41-71 8-24 54-12 54-44 3-31-29-39-43-61zM849 1253c-16 26 36 36 35 7 0-20-27-26-35-7zM1045 998c26-20 12-63 39-81 61-29 14-86-37-87-29 0-68 22-58 54 4 13 9 26 5 39-7 34 1 114 51 75zM406 2559c23-1 22-37-2-35-22 0-21 36 2 35zM1234 2332c28 10 48-25 29-46-16-26-57-61-59-7-1 21 6 47 30 53zM925 616c-23-10-41 36-11 36 21 1 31-27 11-36zM259 2539c-22-6-46-3-56 20-15 41-34-17-59 7-9 5-16 13-20 23-17 55-67 8-89 54-9 9-23 10-35 13v192c34 20 70-26 43-56-12-18 1-39-9-56-9-23 7-58 33-59 34-12 64 14 45 48-13 24 20 45 6 68-14 20-37 43-18 67 48 48 80-36 76-76 3-18 29-14 43-17 47 7-5 70 58 74 12 2 18 12 24 21 14 20 45 22 58-1 20-37-16-56-45-54-34-11-21-46 14-40 39-5 27-54 46-79 5-17 20-32 15-51-2-21-14-67-41-40-6 8-3 17-3 26-7 31-51 18-73 20-29-13 7-49 5-71-5-45 45 2 62-44 7-24 27-31 50-35 56-32-10-102-49-45-32 25-48-50-87-15-28 19-16 56 10 72 10 8 17 37-4 34zm-69 160c-18-9-3-39-2-55 5-7 30 18 49 13 16-2 16 14 17 26 3 41-40 26-64 16zM0 623v51l14-8c20-17 0-31-14-43zM319 3218c-1-6-5-14-11-18-14-9-17-25-25-38-23-32-73 7-51 38 10 19 35 14 49 28 13 16 38 13 38-10zM415 3151c-4-27-45-28-49-2-7 41 55 40 49 2zM570 3983c-13-17-12-45-30-57-15-9-41-1-46-21 3-36-33-46-50-72-40-36-76 11-52 51 6 13-9 38-23 28-11-16-14-43-40-41-12 1-22 11-34 11-9 0-23-6-20-15 8-13 14-31 31-35 9-2 18-6 26-12 19-18 52 7 66-15 27-64-34-46-47-67-4-11-5-24-17-29-19-15-41 6-61-1-14-9-36-3-45-18-19-31-1-123 42-66 1 19-31 18-24 45 9 39 47 24 55-7 7-17 30-6 44-7 15 2 12 19 10 29-4 21 17 38 37 30 12-4 17-16 24-26 29-36 16 46 92 36 15-5 31-18 31-36-6-22 14-30 31-39 19-8 39 49 75 4 20-22-19-42-1-58 9-5 29-18 33-1-9 30-13 55 23 70 21 8 57-15 51-39-6-30-42-45-14-77 8-10 11-22 15-33 14-24 52-37 47-71-15-45-75-8-78 25-8 21-33 28-41 50-27 34-42 1-36-30 2-12 19-8 28-11 17-2 25-21 20-35-10-24-43-22-55-44-1-28 43-11 59-24 27-7 44 41 75 13 14-12 12-30 11-47 0-10 11-14 18-18 15-7 14-26 25-36 51-53 35 1 89-3 32 4 9 56 44 58 29 2 29-30 29-50 4-26 25-26 45-26 19-3 33 14 51 15 25 5 72 3 60-35-44-71-78-14-91-65-31-42-35 36-63 17a88 88 0 00-40-19c-24-8-6-52-46-53-25-7-32 28-51 23-11-5-21-16-33-10-13 3-21 23-34 19-21-14 12-46-11-67-29-26 21-34 13-66-3-55 31-11 57-10 41 1 15 46-12 50-51 32 19 90 42 30 11-18 40-14 45-37 3-18 13-33 20-50 8-32-26-50-54-41-14 1-26-8-34-19-6-10 8-20 10-31 9-23-15-50-41-39-14 7-27 17-43 9-20-8-34 13-52 13-17-5-51-1-41-28 13-35 74-26 84-67 21-52 39 62 87 23 11-7 21-35 33-13 23 30 52 15 38 66 17 66 101-47 42-64-21-5-27-26-40-40-27-50 23-47 55-61 19-5 29-31 51-21 11 7 27-7 36 3 7 22 25 48 51 39 8-2 18-12 27-6 9 7 16 27 0 31-19 2-32 27-52 20-10-3-20-10-31-6-7 2-18 4-15 14 5 15 8 31 10 47 13 25 6 93 51 55 17-14 47-12 50-39 4-23 25-41 19-66-6-15 5-23 19-26 34-11 16-45 36-59 12-4 24-9 33-19 35-22 8 32 18 46 9 14 5 30 4 45 1 14 11 40-12 41-55-19-75 16-84 65-1 8 0 18-9 22-17 6-38 10-44 30-16 71-43-4-88 16-16 1-30-9-40-20-3-6 5-11 7-17 18-24-26-46-33-18 1 32 32 23-5 54-15 20-3 47 19 52 15 3 36-1 42 16 6 39-70-21-69 44 5 19 22 32 21 53 16 54 60 8 80 37 8 27 32 36 54 49 22 19 45 4 66-10 22-3 13 39 31 50 32 19 51-26 76-37 10-4 16-13 19-23 14-54 49-16 49 21 0 22-56 5-45 56 19 45-34 32-58 21-21-1-31-27-51-23-43 3-24 50-61 62-36 19-1 70-46 80-27 3-46 16-40-23-6-34-58-4-79 0-23 11-58 6-73-16-24-19-75-55-100-23-16 25 8 50 8 76 3 23 27 42 53 31 19-12 36-3 50 11 17 12-5 26-9 40-17 70 83 20 82 47-25 61 23 45 33 80-3 60 70 53 75 11-2-27-43-38-27-58 14-18 8-51-22-48-13 2-27 10-41 5-14-7 18-40-6-61-58-42-2-15 37-49 20 12-17 56 18 79 13 17 40-2 50 14 1 22-11 50 17 60 39 15 63-60 26-75-5-2-11-4-17-4-24-1-14-35 1-41 10-2 24-17 34-7 16 26 11 65 39 83 38 25-28 32-30 64-13 24-49 10-64 35-26 28 32 78 61 47 12-13 23-25 41-27 39-11 22-72 58-85 31-8 46-53 11-67-11-5-31-6-33-22 0-15-2-36 13-44 61-21-10-65 68-78 40-20 6-49 17-69 12-5 25-27 39-19 24 40 50 21 86 21 24 3 37-17 41-39 12-24 41-2 49 15 7 13 18 28 35 22 10-4 8-15 9-24-13-48 54-48 46-93-3-16-3-32-4-48-7-31-50-30-53 3-4 18-30 55-40 22-6-21-37-17-39-36 11-37-11-67-50-66-15 0-24-23-5-21 37 19 53-28 88-24 41-8 23-69-13-55-13 5-25 17-40 10-21-9-20-44-50-36-36 4-13 39-31 52-35 13-46-50-65-70-10-14-9-18-3-32 12-14-13-49 11-49 20 4 26 32 48 29 23-1 36-29 21-46-13-12-39-31-14-45 33-7 58-15 33-53-8-23 29-7 39-20 27-22 4-59-26-57-29-6-36-39-72-20-10 3-20-4-29-7-23-9-38 18-60 17-16 0-26 11-37 22-16 12-39-9-55 6-20 12-6 44-30 50-31 13-35 17-55-12-23-26-54 12-63-5-4-23 19-38 40-33 23 1 31-22 45-35 22-21 52 23 72-8 14-21-6-47-30-47-5-1-25 4-19-8 9-4 20-3 29-9 30-21 56 16 86 11 14-3 27 2 38 10 23 10 50-1 74 5 62-8-11-77 50-71 18 13 40 19 58 2 21-16 32 22 55 21 36 7-13 35-29 35-55 15-12 102 30 67 43-50 53 45 96 14 41-28-31-48-15-81 11-79-64-13-52-64 6-25-29-36-24-60 5-16 26-4 38-3 14 3 11 18 12 29 1 22 21 35 41 36 16 3 28 15 41 24 14 10 14 30 19 45-1 32-66 41-17 83 34 30 76-14 61-50-5-7 3-17 9-9 9 13 23 21 36 29 21 16 51 3 50-21 0-11-1-22 8-30 20-13 22-47-6-52-26-4-32 34-59 30-19 0-21-26-36-34-20-12-11-37-20-55-40-80-50-33-79-60-3-30 40-65-1-87-18-6-45-25-18-39 17-12 24-35 49-33 22-3 47-25 36-50-15-35-69-40-82 3-3 17-15 32-34 28-6-1-2-8-1-12 24-46-23-54-37-92-19-36-62 5-80-20-9-84-113-12-47 24 12 4 30 4 32 20 13 55-67 10-64 68 6 13-6 74-23 40-3-15-14-32-5-46 27-31-7-59-17-88-26-48 1-79-48-87-67-11-28-35-63-70-19-14-12-54 14-48 9 4 18 10 27 9 46-2 21-75-15-53-25 36-40-8-70 8-39 20 9 40-35 84-6 10-20 16-28 4-7-12-29-30-10-42 15-5 29-10 39-23 22-31-29-55-27-86-4-26-34-27-47-46-11-18-44-6-35 16 21 39 4 30-26 39-44 20 1 84 35 53 5-6 13-17 19-9 7 26-24 25-38 37-21 7-42-11-64-5-34 1-60-60-87-9-5 9 0 26-11 29-21 0-50-3-60 20-21 65 72 70 75 12 1-8-1-22 12-20 16 5 21 24 27 38 2 12-13 12-21 16-40 15-14 76 25 61 26-19 38 16 63 17 43-3 37 106 25 131-20 26-40-61-85-2-11 22 12 39 29 50 4 11-19 19-27 25-18 3-11-30-20-40-3-9-4-17-1-26 10-35-28-57-40-86-30-38-53 16-80-16-20-17-43 2-65 2-20-2-32 18-49 20-26-5-63 6-52 37 14 47 68 15 74 50-3 18 7 51-20 52-12 3-22 9-28 19-9 19-32 24-41 43-10 23-29 47-56 36-35-9-57 42-24 58 16 9 34 11 50 18 27 14 36-26 41-45 6-22 46-29 33 2-6 30 24 38 48 36 30 4 66-39 91-9 3 11 7 35-11 37-17-1-34 9-51 7-35-18-87-9-71 39 11 36 59 13 66 40-1 21 12 45 36 43 28-11 47 7 54 34-4 22-36 13-47 0-8-7-18-9-29-10-18 0-30-17-47-20-22-3-24-34-48-30-22 9-34-16-54-14-34 11-67-14-90 22-9 11-22 2-32-1-30-6-42 25-30 47 4 22-25 35-22 66-2 17-21 12-33 16-26 7-24 34-13 54 5 16-4 32 1 48 1 10-2 20-4 30 4 69 32 13-7 107-4 26 36 37 52 17 9-13 19-26 25-41 9-20-15-35-9-55 3-12 6-24 2-36-11-21 8-38 10-59 1-5 5-12 11-10 30 18 50 16 63-19 7-17 1-35-11-48-12-15-17-34-26-52 1-35 41 3 60 0 14 3 24 47 25 62-2 55 40 43 77 27 16-4 24-25 8-35-12-7-32-6-31-24 1-14-2-27-11-39-16-22 21-40 36-25 20 14 7 48 32 59 30 14 29 59 69 57 7 0 15 2 14 10-5 24-31 36-33 62-1 6-6 9-12 8-17-1-28-13-42-22-18-13-54 2-51 25 16 48 2 62-43 75-22 3-31 28-52 30-15 0-30 7-37 21-10 21-40 28-38 55 2 23-19 46-41 48-17-1-39-3-47 17-6 26-21 20-42 17-25-3-33 30-58 29-12-1-23 4-32 11-15 2-5-14 4-16 14-8 23-25 25-41 5-67 90 19 102-42 3-36-27-101-70-78-14 10-27 22-43 29-30 9-38-36-55-51-27-27-73 2-63 38 11 25 35 43 52 64 12 14-9 27-21 29-16 5-24-13-35-21-21-17-6-50-27-67-17-17-41-7-52 11-10 35-59 22-67 57-8 37 15 83 57 70 14-3 23 9 32 18 49 45 56-66 84 10-5 22-37 3-51 16-35 7-85 20-55 66 16 13 28 30 41 45 24 20 51-4 50-33 3-17 18-28 25-43 11-18 37-7 52-21 18-5 30 23 51 15 21-6 32-28 57-24 10 0 18-5 24-14 8-9 8-30 22-31 20 8 42-6 56 2 8 22 52 39 39 54-50 30-12 61-56 86-18 13-53-9-52 27 1 8 5 18-3 23-19 16-44 38-70 20-11-8-24-19-40-15-25 4-33 28-40 50-12 41 68 22 54 60-9 79-68 21-42 104 2 14-19 14-26 22-24 18-11 50 12 62 8 4 6 18-4 18-7-2-15-5-22-3-31 11-24 66-46 88-31 53 24 45 35 71 2 21 17 37 21 57 8 26 19 53 34 75-1 24-33 25-22 59 2 18 34 21 28 40-7 11-13 22-12 34h126c-12-20-20-52 7-50 14 7 27 13 42 10 17-4 23 15 6 21-10 3-17 12-26 19h70c5-9 15-14 26-6l5 6h108c-15-7-36-2-48-17zm651-578c-13 5-42 31-44 4-5-28 53-32 44-4zm230-218l29-53c19-21 28 0 25 20h-1c3 47-13 97-67 61-7-9 11-19 14-28zm-49-537c10 10 32 5 36 20-1 2-3 4-6 3-19-4-41 0-56-15-9-16 18-17 26-8zm-184 278c3-15 20-5 18 7-4 17 34 48 4 52-33-1-20-37-22-59zm49 178c-7 15-4 31-5 47-1 14-24 21-30 7-4-13-4-28-17-36-30-25-76 52-78-23h1c4-35-25-43-53-36-18-6-10-42 9-45 12-6 24-1 34 6 17 9 34-2 51 2 33 9 57 34 83 52 10 6 9 17 5 26zm153 110c-10 19-28 36-37 5-5-15 32-15 37-5zm-59-222c21 5 17 32 33 43 18 13 19 36 22 56-5 29-37 2-46-11-8-12-16-25-32-30-22-4-29-26-39-43-6-11 2-19 10-24 17-12 34 8 52 9zm-45-80c-2 32-38-4-51-11-10-36 59-19 51 11zm196-728c-1-21 29-29 41-13 31 37-24 50-12 90 6 17-12 21-26 17-15-9-6-34-18-48-6-17 15-29 15-46zm-93 146c9-8 18-29 32-24 14 9 32 11 44 24 23 30 67 12 62-26h-1c-4-44 69 21 49 36-18 10-30 23-38 41-9 10-23 0-33 1-38-6-38 36-59 54-11 7-24 25-36 11-15-16-21-37-5-55 20-29-27-41-15-62zm-89 159c-33-1-43-36-11-48 17-5 16-44 36-34 19 17 0 47 14 69-3 14-30 9-39 13zm-111-399c22-35-45-74 28-83 26 4 5 39 22 54 8 10 17 16 15 31 0 27-35 23-52 35-32 13-28-20-13-37zm-188-118c-11-2-21 5-31 9-9 4-23-10-14-18 30-5 81-44 104-11 8 14 14 29 30 36 29 7-2 41-18 39-48 4-25-53-71-55zm-269 341c-3 17-27 19-41 24-23-13 45-65 41-24zm7-35c-13 4-18-25-5-27 12 1 38-15 41 3-5 14-25 16-36 24zm55-65c-16 0-28-36-9-39 35 1 56-30 64 23-2 18-40 8-55 16zm12 96c-1-26 29-24 46-35 10-7 34-2 28 13l-13 24c-10 37 36 65-37 65-7-1-10-8-11-15 2-19-11-34-13-52zm14 206c-10-1-7-13-5-19 12-73-4-43 76-57 47-20 6-53 24-74 17-9 54-65 56-14 1 26 15 50 24 74 29 33 75-14 48-47-10-18 0-42-17-58-9-8-14-18-11-31 4-17 3-40-14-50-5-5-23-8-19-17 7-7 19-16 27-8 7 11 13 24 27 26 25 2 44-1 66 14 29 11 53-28 34-50-12-19-53-51-41-74 18 15 13 27 46 29 24 2 30 39 58 33 64-14 27 23 61 37 31 1 24-29 6-42-8-12 4-27 5-39 21-28 33 23 39 38 5 20-17 40 0 59 28 22 12 52 29 79 8 18-18 24-26 9-14-19-41-22-56-6-13 19-2 48-25 63-17 12-33-16-53-14-16 0-30-6-42-16-6-8 9-13 13-19 29-25 19-58-19-64-24-3-41 25-34 46 1 18 30 22 30 37-31 21-11 47-21 76-5 27 10 55 15 82 8 15-10 18-21 21-23 10-27 40-49 53-42 25-54-74-5-61v1c66 3 44-85-14-57-34 4-25-53-76-22-10 7-22 11-34 11-41 0-31 43-54 50-16-1-32-1-48 1zm33 130c-2-30 39-30 60-37 31 8 81-19 73 36-8 17-39-17-61 7-10 8-19 17-30 24-10 7-13 19-16 30-10 20-46 12-55-6-18-24 31-24 29-54zm-380 985c-8 17-33 10-47 15-21 0-19-40-45-45-21-2-26-32-1-31 33 11 57-3 91 17 16 9 4 31 2 44zm263-431c19-16 44-27 48 7-2 52-64 49-63 85-1 11 4 25-7 32-20 19-51 1-35-23 16-15 15-38 31-53 15-12 11-35 26-48zm-214-238c13-24 36-47 65-44 16 4 45-33 52-7-4 19 3 36 16 49 19 20 45-31 62-11 8 21-1 66-31 50-12-10-20-35-39-27-19 5-39 7-51 24-23 13-56-3-62 36-2 8 5 28-9 27-21-6-30-27-27-47h-1c-4-23 18-32 25-50zm-28 296c62-23 17-33 19-62 16-24-5-57 23-74 20-13 3-43 19-51 53 3 47-67 76-24 4 19 23 42 41 22 10-24 21-24 35-2-2 23-35 36-48 55-14 21 10 35 29 31 34-5 32 29-1 24-28-4-41 48-57 28-7-12 1-26 0-39-1-43-63-50-75-12-8 16 0 31 9 44 11 16 2 34 7 51 5 18-6 35-8 53-4 20-32 48-32 11 1-29-57-33-37-55zm-180 169c12-1 21 8 31 13 21 12 51-10 40-33-6-17-22-20-38-21-18-5-27-26-45-35-4-12 20-9 27-13 25-3 30 39 58 30 29-9 24 6 22 28-9 118 123-21 35-38-9-2-23 7-30-1 0-12-8-46 9-46 30 5 49 32 78 36 9 1 20 4 19 16-1 73 54 70 52 110-34 45 5 44 5 80-13 21 18 33 4 45-24 11-10-19-16-30-10-15-28-24-35-41-5-13-16-25-32-24-21 0-43 8-64-3-12-7-26-7-39-2-22 7-44-8-67 0-16-1-43-10-47-27 0-21 8-44 33-44zM766 161c15 37 72 20 62-20-3-20-26-28-33-47-7-14-17-25-35-25-24 0-45 27-31 50 10 16 29 23 37 42zM38 3087c-14-18-26-17-38-12v65c29 3 55-22 38-53zM459 43c21-2 33-20 33-41V0H385c8 12 18 23 22 35 11 16 35 9 52 8zM195 31c13 1 24 7 29 19 20 23-18 57-29 37-10-39-45-34-62-67-11-17-40-21-59-5-17 16-50 11-56 39-2 16-9 20-18 18v56c14-6 26-3 35 14 1 16-33 31-5 49 9 4 16 0 21-5 14-11-5-28 3-39 34-12 40-50 59-41 10 7 30 27 9 34-64 20-17 62-40 76-44 0-53 30-38 68-4 23-32 15-44 37v239c22 28 60 11 66-17 10-25 37-40 48-65 26-18 50 9 67-39 17-37 36-21 65-23 32-9 35-51 11-70-8-12 2-49 16-52 35-8 10 18 9 36-7 38 48 52 66 21 6-8 7-27 20-24 24 12 56 1 51-30-16-30 7-57 31-25 25 21-8 73 36 80 9 1 26-3 22 11-5 20-15 30-28 9-23-28-67-1-83 23-10 19-29 11-44 6-47-9-45 76 1 61 15-5 29-5 44 1 17 8 35-10 53-2 23 12 51-2 49-30-5-30 15-10 30-5 13 5 21 14 23 28 7 25 34 34 40 60 15 31 74 3 51-27-26-21-22-52-48-68-20-13-7-42-25-57-10-19-54-7-47-24 27-26 66-14 46-71-3-19 24-27 24-47 5-34 32 5 36 20 12 27 44 21 68 25 22 2 38-24 24-41-9-12-25-14-33-26-14-20 22-31 14-52-8-18-3-38-9-57-1-7-4-18 4-23 19-4 34-27 11-39-24-11-34 44-58 9a68 68 0 01-16-36H517c2 6 5 11 9 16 21 32 7 83 65 60 23-4 30 26 39 42 4 24-37 26-34 52 1 23-6 33-26 15-15-24 45-37-7-88-17-13-41 11-57-4-27-40-84-2-48 34 31 23-2 59 47 77 4 3 9 9 6 14-10 5-25-12-42-4-44 29-49-29-73-53-34-42 33-52 17-92-5-22-24-22-42-16-17 6-19 24-23 40-8 17-34 4-49 11-9 2-16-2-21-11-6-33 72-4 12-80-6-7-13-11-20-13h-97c0 14 3 27 22 31zm-86 397c-5 30-45 9-54 40-3 9-12 29-22 15-18-23-36-55 1-68 19-5 20-35 40-32 18 6 36 23 35 45zm249-173c16 1 21 16 12 27-6 8-9 25-21 25-14-4-27-12-42-13-19-10 44-36 51-39zm-76-73c9-29 62-9 40 14-30 16-72 28-81 65-8 17-34 8-43 25-10 15-9 39-33 31-18-4-42 10-57-7-12-17 20-37 9-62-1-7-6-18 2-22 11-4 30-13 37-1 4 17 12 34 31 35s29-23 21-38c-11-16-11-28 8-38 22-11 45 28 66-2zM2488 88c-22 14-8 58-38 39-19-11-43-2-63-12s-46 10-37 31c4 11 13 16 22 20 16 7 25 20 35 33 8 13 4 32 20 40 4 4 14 7 12 14-7 17-13 42 8 53 8 7 34 0 28 17-7 17-9 36-19 52-5 9-10 17-8 27 14 63 67 4 80 40 8 41 36 22 47 47-3 32 31 44 35 73 2 19 32 24 29 40-14 15-29 30-29 52-2 16-19 26-11 43 7 34 80 3 59 51-15 22-45 29-64 48-26 18-16 61 16 63 16 2 28-8 40-17 25-14 55 6 83-6 31 0 25-49 56-45 13 3 28 6 40-4 10-9 6-24 1-34-7-16-26-8-40-13-12-5-2-17 1-25 7-16-14-35-28-23-7 6-8 15-11 22-3 12-25 20-30 6 2-22-2-41-15-58 5-21 45 11 61 0 32-14 21-53-6-68-13-15 15-21 25-22 38 3 53 59 93 59 23 1 35-31 18-47l-29-25c-27-15-62-13-80-42-54-43-56 65-123 12-12-10-22-20-26-35-2-25-37-20-42-41 4-56-46-36-45-67 6-23 36-21 54-15 18 10 6 41 29 49 26 9 17 22 24 41 9 16 36 7 34-12-9-24-9-27 13-42 18-17 10-44-11-52-16-5-33 4-49 0-18-6-5-30-14-43-12-28-49-28-69-9-17 11-38 4-57 9-28 4-28-6-15-29 11-14 29 6 44 1 40 1 21-72 63-60 18 10 32 37 56 24 28-22 46 14 40 39 1 21 26 25 37 39 51 46 58-62 102 4 24 25 61 5 87-5 23 1 29 58 74 23 41-53 71 45 46 74-17 37 40 45 42 83 2 43-27 11-48 8-20-5-23-31-41-39-25-17 24-72-49-75-39 5-85-45-117-3-11 21-30 0-49 2-32 1-64 39-35 67 16 20 44-3 60 16 11 14 28 23 46 15 38-30 39 22 85 3 2 0 5 1 6 3-4 15-21 23-23 39-8 31 24 37 44 49 26 15 5 45 17 67 7 13-6 22-16 29-38 30-2 46-29 87-10 26 17 42 31 60 10 11 29 16 43 3 16-30 79-39 43-84-48-32 33-48 0-88-27-26-30-53 3-74 17-8 19-45 34-43 63 28 48-29 57-68 10-25-28-37-20-59 22-27 7-53-22-68-26-20 2-37 25-30 17 4 28-13 44-16 18-1 12 20 13 32 0 22 26 41 47 29 13-5 20-27 36-22 59 19 42 42-7 58-25 11-53-23-74 9-33 48 64 65 14 109-22 38 45 59 50 17 3-12-9-27 3-36 22-19 67-2 72-40 2-14-4-37 14-40 10-2 25-1 23 12-9 27 0 51 18 71 8 18-24 46-39 28-33-34-72 20-75 51 6 42 50 28 66 1 26-23 1 33 30 48 5 5 14 11 10 19-24 24-23 67 18 67 11-1 22-6 32 0 15 13 37 10 51 22 6 11 36 19 31 31-36 53-38-25-71 15-5 15-13 26-26 34-20 17-14 52 14 54 52 4 24-46 47-65 17-7 21 24 32 32 13 22-61 46-4 90 17 10 45-2 48 25 4 30 49 26 26 60-18 55 51 34 61 75 2 3-1 7-3 8-36 3-37 34-55 57-25 39 5 34-49 36-13 4-22 21-15 35 7 15 29 17 31 36 0 15 6 27 22 29 31 11 41-33 20-48-11-7-24-15-19-30 20-22 72 39 97-11 10-20 32-32 31-58 7-30-59-32-11-57 17-11 11-38 32-44 26-2 8 31-5 38-18 20-7 56 22 58 31 6 43-25 48-50 10-20 25-16 19 7 0 29 24 41 43 37 25-1 35-31 61-30 20 2 28-23 46-23 16 2 35-4 38-22 5-45-34-27-42-46 12-68 26-33 50-74l7-8v-80c-22-1-46-2-55 20-3 8 2 17 5 24 14 22-2 57-30 52-23-3-36 19-54 29-28 5-12-32-6-46 12-20 63-4 59-58-4-12-11-25 0-36 16-17 25-52 55-38 9 9 18 13 26 16v-82c-2-3-4-6-5-11-3-15-13-23-23-33-5-21 32-31-3-61-15-12-34-1-45 12-10 12-24-3-23-15 0-18 1-39-19-46-62-12-21 48-50 45-38-27-53 16-88 10-6-1-15-7-12-14 11-19 3-43 17-61 35-30-12-67-36-86-28-16-21-56-48-70-52-18-41 38-65 39-45-19-51 27-93 19-34 0-16 59-35 56-26-23-46-30-35-68 6-13-15-29-1-37 6-1 7 7 7 11 6 32 62 41 66 3 7-31-29-45-54-33-17-1-14-32-20-44-3-13 3-26 9-37 30-28 8-74-33-65-34 16-65-17-87 27-14 17-42 1-55 20-9 12-22 22-36 11-36-18 16-66-53-76-18-1-24-25-41-26-39 4-34 49-72 55-29 10-48-37-78-14-8 4-17 21-27 12-50-65-51 24-99 15-20 0-30-21-49-26-57-15 20-61-39-80-48 7-45-64-6-68 32 6 60 52 94 25 10-9 16-22 30-27 12-2 15 15 16 24-5 16-18 29-27 44-7 7-18 3-28 3-19 0-37 20-31 39 4 20 29 31 47 20 18-10 18-38 44-30 22 6 37-18 58-14 32 12 51-32 71-9 14 16 40 17 50-4 8-24-7-57 23-71 22-10 15-36 26-53 8-15 5-29 1-44h-248v7c7 33-22 13-40 21-21 11-42-2-64-1-15-1-22-8-24-23l1-4h-98c-6 38 41 36 21 71-4 9-5 19-4 29 1 36-43 61 8 90 13 12 39-11 41 15-1 7-10 4-14 3-20-14-39 27-54 2-45-78-48-30-117-49-35-1-27 42-45 60-13 16-16 47-42 26-3-2-5-6-2-10 36-27-1-56 7-89 4-10 15-1 22 1 45 20 43-30 75-25 67 33 63-23 78-68 6-22-15-34-33-40-7-6-10-11-10-16h-130l-6 8c-6 42 61 50 23 80zm1087 750c-21-6-17-26-22-42-5-26-60-22-20-51 25-4 23 52 84 18 19-5 31 20 45 29 4 4 4 10 1 14-22 16-14 58-44 59-18-3-27-22-44-27zm38-176c7-12 35-17 34 3-9 16 3 46-14 55-16-4-27-23-42-31-2-11 16-18 22-27zm280 381c-6 12-16 22-24 33-11 9-28-6-23-19 8-29 28-46 47-14zm-116-138c8-16 21-27 38-34 33-15 15-59-11-72-16-21 16-50-23-66-27-12-52 27-35 49 3 6 17 16 8 22-27 6-33-26-41-45-7-26-19-54 20-54 61 20 78-50 124-10 41 23 44-23 68-24 40 13 15 46-16 49-37 9-22 49-36 75-7 26 10 43-22 60-26 33 8 34-48 54-30 25 13 50-28 98-32 20-12-71-75-50-26 8-46 27-57 51-12 13-27-8-38-13-12-11 7-26 12-36 17-19 52-18 56-49 18-82 43 62 104-5zm-180-398c11-13 19-52 37-23 24 21 12 43 31 60 19 10 23 33-3 33-60 0 8-44-43-59-34-19-42 35-18 48 17 6 26 18 5 27-12 1-33 15-41 2-2-26-27-42-28-67 2-35 43-10 60-21zm-180 139c23-15 27-38 23-63 14-48 49 10 66 26 24 24 59-17 59 31 4 45-40 0-47 38-2 8-2 19-12 21-26 6-37-33-65-24-16 4-38-14-24-29zM2916 33c39 3 72-17 109-17 19 3 22 34 33 49 1 16-22 19-31 31-23 17-32-35-63-27-18-1-48 21-58-1-2-12-10-39 10-35zm-177 193c3-16 23 1 22 12-4 12 0 35-20 34-22-6 0-31-2-46zM2565 35c20-3 23 25 5 27-21 1-31-26-5-27zM3772 552c-1 47 73 58 71 8 11-45-66-46-71-8zM4000 678v-10 10zM3859 219c-20 9-29 24-54 16-30-7-41 40-15 51 29 14 42-27 74-13 42 3 36-65-5-54zM4000 3120v-77a62 62 0 000 77zM3438 50c31 28-11 48-24 15-3-22-24-38-46-31-28 6-22 47-51 50-18 2-12-26-15-38 5-16 25-29 31-46h-141c5 27-35 28-32 57 12 43 60 44-8 76-28 10-32 43-9 61 11 7 27 0 40 0 11-1 21-6 28-15 13-19 41-25 46-50-2-19 34-43 44-24 3 34-37 79 24 87 13 0 26 4 39 7 20 3 42-19 35-37-9-17-42-24-26-48 5-8 16-8 20 0 19 22 10 56 37 71 20 16 54 2 54-25 3-18-14-29-17-46 2-18 55 14 53-42-3-26-23-46-25-72h-81c7 14-1 38 24 50zM3909 14c-23-5-42 16-46 39-5 14-23 12-34 19l-33 16c-25 9-24 64-51 20-28-44-95 17-116-31-9-12-20-16-34-15-24 3-35 31-23 51 19 22-1 47-6 70-10 5-23-7-34-5-20 0-31 19-33 37-4 21-29 33-25 57 5 16-7 34 3 49 15 21 37 0 38-20 8-24 28-24 37-1 17 28-20 51-17 78 19 75 105 1 95-48-4-20 13-16 22-6 17 25 61 4 64 30-5 27 1 53 28 64 23 21 6 66 56 59 62-18 36 45 54 61 17 11 38 19 56 5 50-50 36 51 78 55l12 2V431c-33-19 5-46-11-71a58 58 0 01-4-78c6-4 11 1 15 5v-34c-4 7-9 13-16 12-56-55-69 4-103 42-20 50 31 42 46 69 4 11 10 21 16 30 10 18-15 36-6 56 20 63-43 15-42-12 1-12 2-23-3-34-6-24-44-17-45-37 11-25 0-58-31-55-15 1-39 19-48-3-8-23-15-51-25-72-20-19-42 25-65 8-43-32-42-16-84-4-11-3-47 4-38-15 26-75 3-30 85-36 30 5 37-38 65-33 26 4 11 40 29 54 35 27 57-23 64-51 4-18 17-25 33-28 20-4 28 19 43 27 13 7 17 21 22 34 11 19 42 23 53 3 32-41-49-53-9-85 23-18-9-56 21-57 12-4 26-7 38-12V0h-32c-20 12-45 19-59 14zM63 3996l8 4h111c1-9 6-17 21-24 33-35-15-42-14-65 6-12 9-25 7-39-3-20 13-44-4-61-19-22-41-5-63-1-35-10-1-32 14-43 61-110-156-32-73-103 22-16 59 31 77-25 7-34-16-96-52-51-8 12-14 38-33 32-16-10-57-7-30-33 17-22 27-48 33-75 32-35 46 64 90 43 38-10 33-65-5-70-35-4-21-47-55-56-12-4-24-10-35-16-14-11 6-29 10-41 16-14 36 4 47-28 11-12 34 7 50 4 19 2 11 22 6 34-9 88 127 45 59-24-23-12-1-37-18-53-117-63-79 36-110 24-14-3-25 5-34 14-17 8-37-15-54 0-44 38 17 55 9 75-8 11-16 11-25 6v54l4 3c1 3-1 6-4 7v251c16 4 27 15 35 31 18 30-58 53-1 85 48-7 31 13 66 15 26-5 38-11 40 22 4 21 38 26 22 48-6 12-2 25 0 37-2 12-21 9-23-1-5-38-30-37-46-63-6-13-11-29-27-34-19-10-39-7-60-11l-6-1v133h45c7-4 13-6 18-4zM3945 1143c5 34 32 31 55 39v-100c-22 18-60 24-55 61zM3905 1820c13 5 12 20 15 31 11 45 76 34 77-5l3-18v-130h-1c-30 10-57 64-88 59-22-3-35-32-59-25-10 3-24 9-26 20-4 49 48 49 79 68zM3799 20c8 19 37 12 35-9 0-5-2-8-5-11h-25c-5 4-8 11-5 20zM3534 13c30 37 54-11 78 3 23 30 49 39 76 9 19-12 57 43 85-19l1-6h-250l10 13zM3406 1187c22 23 48-8 60-26 20-23 61-1 60-49-9-61-39-80-96-50-24 13-21 40-32 61-14 20-8 46 8 64zM2536 768c44 14 63-32 50-65-2-16 12-29 9-46h1c7-74-97-68-81 7 17 35-30 87 21 104zM3310 976c0 32 49 33 50 0 1-34-50-33-50 0zM3375 857c-13-12-8-30-8-46 1-25 0-63-34-64-9 0-22 6-29-3-26-29 3-91-51-94-33 6-59-25-65-55-24-59-93-14-59 37 1 37-26 37-1 84-2 14-29 9-36 24-14 20 6 48 29 43 44-12 8-50 22-60 17-3 47-12 55 10 4 92 91-2 103 56 4 17-5 37 6 53 3 5 3 12 2 18-8 24-3 53 22 63 40 16 73-34 44-66zM3252 223c-1 21 36 24 35 0 1-24-36-22-35 0zM3413 1833c49-17 3-77-33-35-52 2 24-93-73-85v-1c-24-4-57 9-50 38 3 24 45 24 35 49-13 18-28 41-10 61 45 49 88 9 85 54 22 81 99-32 31-47-9-1-22 2-25-9-16-66 15-21 40-25zM3737 1587c-3-30-49-27-51-1-1 40 54 39 51 1zM3453 1044c8-13 18-24 34-17 20 4 34-25 15-36-9-5-19 0-28 3-15 5-27-14-42-12-71 9-9 97 21 62zM3409 909c-26 1-16 37 5 35 24-1 19-39-5-35zM3814 1693c9-7 19-15 24-26 7-16 21-24 36-31 11-4 17 10 24 16 41 32 61-41 102-22v-70c-19 0-40 6-55 15-18 20-50 29-33-10 6-19 26-27 36-44 7-10 16-16 27-18 9-2 18-4 25-9v-86c-17 8-13 38-33 42-12 1-35-8-20-21 21-21 24-65 53-77v-87c-12 5-25 10-39 4-22-10 9-65-55-49-21 6-38-15-59-11-8 0-14-3-19-9-18-29-48-19-59 10-16 16-22-34-45-33-13-2-32 1-36 15-7 19 2 38 19 48 16 5 32 50 10 54-12 2-23 5-34 9-23 3-33-33-60-21-34 11-70 46-54 84 10 23-12 48 11 66 15 20-14 42-19 13-1-11 7-24-2-33-15-11-14-31-26-44-12-10-5-22 2-33 20-38-26-56-52-72-34-15-44 26-67 41-19 12-23 40-49 42-24 8-29 37-16 58 6 13-1 26 1 38 1 19 23 30 38 19 36-45 18-14 61-2 10 2 20 6 20 17 0 21 10 41 2 61-3 14 5 27 7 40 1 13-16 14-25 15-29-3-31-28-10-46 20-25-14-62-42-46-44 27 12 53-15 79-9 12-16 36 1 44 16 10 52-2 47 27-2 12-13 19-19 29-19 32 22 45 47 48 73 4 7-88 52-74 21 20 61 17 65-16-4-36 25-53 57-44 25-1 20-31 31-46 12-20 2-42-19-51-21-12 16-34-7-69-4-16 17-20 29-19 18 5 15 32 32 40s14 19 7 34c-11 24 12 51 36 47 21-4 57-8 68 15 0 17 27 29 17 46-12 27-42 32-60 52-12 15-25 0-38-4-30-18-37 42-60 27-17-29-62-34-72-2-3 12-3 27-17 32s-29 13-31 29c-6 40 47 50 60 18 2-36 48-45 55-7 1 28 29 55 61 36 11-6 19-21 33-17 17 6 34 8 49-5 17-16-15-41 2-56zm-329-303c-24-4-27-35-1-37 31-3 24 39 1 37zm129 142c-2 19-25 6-24-9 1-13 5-41 25-32 21 6-1 27-1 41zm169-106c37 48-64 53-33 3 8-39-27-35-36-53 69-51-16-72 74-81 12 25-17 33 17 75 1 19-36 30-22 56zm27-152c-13 7-14-16-13-24 4-15 23-10 23 4 0 9-3 15-10 20zm88-7c6 2 30 9 22 18l-35 6c-20-3 0-27 13-24zm-64 238c3-19-5-30-12-44 2-27 39-26 16-66-16-20 3-28 19-37 14-10 49 45 32 56-30 17-38 39-14 66 28 31-44 68-41 25zm-77 204c-23-5 16-51 22-17-2 9-13 15-22 17zM2765 1851c-7-11 0-22 2-34 6-28-25-42-46-29-21 14-20-12-17-26 2-23-24-40-43-25-13 13-19 32-40 35-40 16-6 51 2 77 8 28 39 44 67 35 19-2 37 27 23 41-11 12-36 22-29 41 8 23 35 23 56 28 30 7 53-28 40-55-27-32 10-57-15-88zM3940 4000h60v-31c-24-3-37 27-60 31zM2713 2384v-1c-23-3-40 13-46 35-8 24 27 38 14 68-6 16-6 36 10 46 18 14 36 2 51-10 50-22 28 60 72 61 27 5 43-30 32-52-9-15-1-38-17-47-21-12-29-39-54-45-17-4-31-16-32-34 2-14 19-6 28-9 65-15 12-62 34-76 16-13 32-23 53-21 27-6 14-39-7-36-16 7-30 9-46 3-46 0-19 39-33 55-65 17-16 65-59 63zM2288 2522c102 80 39-63 145 32 8 13 19 26 36 25 29 1 42-38 24-59-12-14-37-6-49-23-21-28-59-55-83-14-14 12-25-10-34-19-40-37-84 30-39 58zM2894 2360c-17-9-38-37-57-19-13 13 2 30 9 42 7 11 1 24-3 35-10 20 2 41 1 63 0 4 1 9 4 12 99 63 65-53 86-49 57 3 46 27 57 70 9 23-13 58-25 19-61-75-93 62-16 41 55-41 12 46 46 57 31 17 74-16 69-50-8-24 0-47 2-71 1-6-2-16 6-18 65 10 78 13 82-57 11-13 26 9 39 10 15 4 23 16 34 26 30 27 69 12 59-32 5-67-26-62-79-65-23-7-35 22-54 20-54-41-100-55-77 33 7 19-6 36-10 54-10 14-34-10-33-23 7-35 0-60-38-66-21-12 8-47-17-62-21-12-23-40-43-51-15-8-38 1-43 18-5 15 5 30 15 41 11 12 9 29 16 43 10 19-16 49-19 15 2-14 2-28-11-36zM3194 2292c-22-1-26 35-2 35 23 3 25-34 2-35zM2692 2630c13 40 79 32 77-13 4-67-93-43-77 13zM2350 2387c49-32 37 21 63 36 29 9 20 51 52 54 17 2 24 18 37 26 26 13 54-2 59-30 6-14-6-26-10-39 5-19 24 9 24 18 11 40 71 44 81 2 7-20 4-23-12-36-26-15-24-56-58-60-19-4-33 23-52 8-39-29-45-30-85-4-66 11-22-49-97-63-45-1-30 50-42 77-6 26 28 32 40 11zM2833 3584c1 23 35 22 36 0 2-22-36-26-36 0zM3305 3993c-19-12-14-25-5-42 11-26-15-53-39-51-23 0-35 24-51 37-9 9-7 25-3 36 3 9 3 18 2 27h101l-5-7zM3131 2995c9-12 1-29-15-29-34 3-7 58 15 29zM3213 2108c-4-38-64-21-49 14 5 33 53 13 49-14zM2419 2174a36 36 0 00-51-2c-6 5-9 11-10 19 1 24-34 11-36 35-4 14 14 29 27 20 10-5 12-20 24-21 15 1 44 4 39 25-18 40 14 62 49 39 6-1 7 8 10 12 19 38 63-11 22-22-10-3-22 9-29 2-12-22-6-37 0-58 2-31-30-30-45-49zM2572 2343c55-19 19-84-24-57-26 18-7 57 24 57zM1213 1457c-35 6-39 50-1 56 41 7 43-59 1-56zM1234 31c-29 1-39 36-25 57 91 94-4 69 34 110 18 14 33-6 34-23 4-16 24-18 37-23 76-14-1-46 8-65 11-17 21-46 46-39 16 2 12 18 14 30 3 23 36 29 48 8 16-29 24-67 52-86h-209c2 5 4 9 8 13 6 31-30 20-47 18zM1680 378c0-24-36-24-36-1-1 22 35 24 36 1zM3954 3957c15-6 32-1 46-6v-163l-6 5c-19 12-6 40-24 52-28 8-27 39-47 55-26 22-3 66 31 57zM1204 0h-74c5 38 70 44 74 0zM1293 1350c13-2 16-24 32-20 25 7 50 15 75 20 30-2 40-41 10-54-25-20-53-58-85-25-16 26-34 16-58 6-26-9-55 11-52 39 0 35 49 41 78 34zM1447 1324c7 6 15 13 24 8 17-8 13-32 29-42 12-9 19-23 18-38-12-96-106-56-66 25 10 16-18 32-5 47zM1668 1284c-18 3-20 45-40 30-10-15-18-39-40-37-18 2-30 14-30 31-3 19 17 31 18 50 0 10 5 17 11 23 8 8 19 17 13 30-15 19 7 48 27 28 10-10 2-31 21-30 22 1 48-9 50-34 0-25 20-37 21-62-1-21-26-41-51-29zM317 1907c-46 3-90 51-33 79 8 3 15 7 21 13 17 18 47 4 42-21 2-32 18-66-30-71z"
}function LevelConsts(e){STATE.mode="constructing",FIELD.tileWidth=ResetConsts.resize(),FIELD.tileHeight=FIELD.tileWidth,SCENARIO.journal=!1;var t=!1;if("tut1"===e){t=!0,SCENARIO.title="T.A: Wired",SCENARIO.info=[],SCENARIO.info.push("• Send bits from A to D using blue wire."),SCENARIO.info.push("• Send qubits from B to C using red wire."),SCENARIO.info.push("• Wires are selected via the top-right menu and placed by left-click + drag."),SCENARIO.info.push("• Remove wires by right-click + drag or using the erasor tool (`E` key)."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,1,1,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0]),SCENARIO.menuGrey=[[0,1,1,1,1,1],[0,1,1,1,1,1],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(var i=0;i<10;i++){var a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a);var r=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(r)}SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=30,SCENARIO.numCorrect=30,SCENARIO.maxTicks=9999}else if("tut2"===e){t=!0,SCENARIO.title="T.B: Gate Keeping",SCENARIO.info=[],SCENARIO.info.push("• Invert bits from A and send to D."),SCENARIO.info.push("• Rotate qubits from B by -π/2 (or -90°) and send to C."),SCENARIO.info.push("• Suitable inversion and rotation gates have been pre-placed."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,1,1,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0]),SCENARIO.menuGrey=[[0,1,1,1,1,1],[0,1,1,1,1,1],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.editable[99]=2,SCENARIO.editable[156]=2,SCENARIO.editable[99]=2,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<10;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(1-a);r=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(r),SCENARIO.QINPUTS[1].push((r+12)%16)}SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=30,SCENARIO.numCorrect=30,SCENARIO.maxTicks=9999}else if("tut3"===e){t=!0,SCENARIO.title="T.C: The Manipulator",SCENARIO.info=[],SCENARIO.info.push("• Send bits from A to D WITHOUT inversion."),SCENARIO.info.push("• Send qubits from B to C WITHOUT rotation."),SCENARIO.info.push("• Left-click on gates to edit their properties."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,1,1,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"fixed"),SCENARIO.menuGrey=[[1,1,1,1,1,1],[1,1,1,1,1,1],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.editable[99]=2,SCENARIO.editable[156]=2,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<10;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(a);r=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(r),SCENARIO.QINPUTS[1].push(r)}SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=30,SCENARIO.numCorrect=30,SCENARIO.maxTicks=9999}else if("tut4"===e){t=!0,SCENARIO.title="T.D: CTRL-Z",SCENARIO.info=[],SCENARIO.info.push("• Send bits from A to D WITHOUT inversion."),SCENARIO.info.push("• Send qubits from B to C WITHOUT rotation."),SCENARIO.info.push("• Pre-existing gates cannot be edited on this level."),SCENARIO.info.push("• Use mouse scroll or L/R arrow keys to re-orient gates before placing.");var s=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,23,22,22,22,22,22,25,-1,-1,-1,-1,-1,4,2,2,2,2,2,78,-1,-1,4,2,5,-1,53,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,63,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,4,2,6,-1,-1,-1,53,24,22,22,22,22,12,22,22,22,22,22,94,1,-1,-1,-1,63,-1,23,26,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,3,2,2,2,2,2,2,2,6,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57];SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,1,1,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"partial",s),SCENARIO.menuGrey=[[1,1,1,1,0,1],[1,1,1,1,1,0],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.editable[139]=1,SCENARIO.editable[156]=1,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<10;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(1-a);r=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(r),SCENARIO.QINPUTS[1].push((r+12)%16)}SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=30,SCENARIO.numCorrect=30,SCENARIO.maxTicks=9999}else if("tut5"===e){t=!0,SCENARIO.title="T.E: Wasted Potential",SCENARIO.info=[],SCENARIO.info.push("• Incinerate all bits and qubits."),SCENARIO.info.push("• Wires and gates can be removed by right-click + drag or via the eraser tool (`E` key)."),SCENARIO.info.push("• Gates with GREEN tabs can connect to both blue and red wires."),SCENARIO.channelsDir=[-1,-1,1,1,1,1],SCENARIO.channelsCol=[2,1,1,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0]),SCENARIO.menuGrey=[[0,1,1,1,1,1],[0,1,1,1,1,1],[1,1,1,1,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.victoryCond=1,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<10;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(1-a);r=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(r),SCENARIO.QINPUTS[1].push((r+12)%16)}SCENARIO.starCond=function(){return Helper.countGates()<2},SCENARIO.starText="Star bonus: complete with a single incinerator and no other gates",SCENARIO.overlayType,SCENARIO.maxTrials=30,SCENARIO.numCorrect=30,SCENARIO.maxTicks=9999}else if("tut6"===e){t=!0,SCENARIO.title="T.F: Making Amends",SCENARIO.info=[],SCENARIO.info.push("• The manager has prepared a contraption for you to run! Access by pressing the purple `blueprint-Z` button on the bottom-left of the console."),SCENARIO.info.push("• The contraption has been built in the wrong spot and must be moved! Hold SHIFT then click+drag to select a region to duplicate (or hold CTRL/CMD while clicking to reposition items)."),SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[2,0,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0]),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<30;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a)}for(i=0;i<30;i++){a=SCENARIO.CINPUTS[0][i];i%4==1?SCENARIO.CINPUTS[1].push(1-a):SCENARIO.CINPUTS[1].push(a),i%2==1&&1===SCENARIO.CINPUTS[1][i]&&(SCENARIO.CINPUTS[1][i-1]=1-SCENARIO.CINPUTS[1][i-1])}SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=30,SCENARIO.numCorrect=30,SCENARIO.maxTicks=9999}else if("class1"===e){t=!0,SCENARIO.title="CI.A: Straight Shooter",SCENARIO.info=[],SCENARIO.info.push("• Set all bits from A to the 1-state, then send to C."),SCENARIO.info.push("• For more information about a gate press the ? icon once selected to open the corresponding handbook entry."),SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[2,0,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],0),SCENARIO.menuGrey=[[0,1,1,1,0,0],[1,1,1,1,1,1],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<30;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(1)}SCENARIO.starCond=function(){return TIMER.victoryTick<=80},SCENARIO.starText="Star bonus: complete in 80 or fewer ticks",SCENARIO.overlayType,SCENARIO.maxTrials=30,SCENARIO.numCorrect=30,SCENARIO.maxTicks=9999}else if("class2"===e){t=!0,SCENARIO.title="CI.B: Zippidty-split",SCENARIO.info=[],SCENARIO.info.push("• Combine A and B into a single stream by alternating entries (starting with an entry from A)."),SCENARIO.info.push("• Output the combined stream to C and an identical copy of the stream to D."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,2,2,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0),SCENARIO.menuGrey=[[0,1,0,0,1,1],[1,1,1,1,1,1],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<24;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a);r=Math.round(Math.random());SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[2].push(a),SCENARIO.CINPUTS[2].push(r)}SCENARIO.starCond=function(){return TIMER.victoryTick<=85},SCENARIO.starText="Star bonus: complete in 85 or fewer ticks",SCENARIO.overlayType,SCENARIO.maxTrials=60,SCENARIO.numCorrect=60,SCENARIO.maxTicks=9999}else if("class3"===e){t=!0,SCENARIO.title="CI.C: The ol'Switch-a-roo",SCENARIO.info=[],SCENARIO.info.push("• For each `0` bit from A, send a bit from B to C."),SCENARIO.info.push("• For each `1` bit from A, send a bit from B to D."),SCENARIO.info.push("• You may incinerate un-needed bits from A after use."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,2,2,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0),SCENARIO.menuGrey=[[0,0,0,1,1,1],[1,1,1,1,1,1],[1,1,1,1,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<44;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a);r=Math.round(Math.random());SCENARIO.CINPUTS[1].push(r),0===a?SCENARIO.CINPUTS[2].push(r):SCENARIO.CINPUTS[3].push(r)}SCENARIO.starCond=function(){return TIMER.victoryTick<=175},SCENARIO.starText="Star bonus: complete in 175 or fewer ticks",SCENARIO.overlayType,SCENARIO.maxTrials=50,SCENARIO.numCorrect=50,SCENARIO.maxTicks=9999}else if("class4"===e){t=!0,SCENARIO.title="CI.D: nSync",SCENARIO.info=[],SCENARIO.info.push("• Combine A and B into a single stream by alternating entries (starting with an entry from A) and output to C."),SCENARIO.info.push("• Note: channel B is here much slower to produce bits than channel A."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[2,2,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[0,1,0,1,1,1],[1,1,1,1,1,1],[1,1,1,0,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<44;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a);r=Math.round(Math.random());SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[2].push(a),SCENARIO.CINPUTS[2].push(r)}SCENARIO.starCond=function(){return TIMER.victoryTick<=125},SCENARIO.starText="Star bonus: complete in 125 or fewer ticks",SCENARIO.overlayType,SCENARIO.maxTrials=50,SCENARIO.numCorrect=50,SCENARIO.maxTicks=9999}else if("class5"===e){t=!0,SCENARIO.title="CI.E: The Waiting game",SCENARIO.info=[],SCENARIO.info.push("• Send A to C (12 bits total), then afterwards send B to C."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[2,2,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[0,1,0,1,1,1],[1,1,1,1,1,1],[1,1,0,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<6;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[2].push(a)}SCENARIO.CINPUTS[2].push(1),SCENARIO.CINPUTS[2].push(0),SCENARIO.CINPUTS[2].push(1),SCENARIO.CINPUTS[2].push(0),SCENARIO.CINPUTS[2].push(1),SCENARIO.CINPUTS[2].push(1);for(i=0;i<6;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[1].push(a),SCENARIO.CINPUTS[2].push(a)}SCENARIO.starCond=function(){return Helper.countGates()<=3},SCENARIO.starText="Star bonus: use 3 or fewer gates.",SCENARIO.overlayType,SCENARIO.maxTrials=24,SCENARIO.numCorrect=24,SCENARIO.maxTicks=9999}else if("class6"===e){t=!0,SCENARIO.title="CI.F: Genesis",SCENARIO.info=[],SCENARIO.info.push("• Output to C and D bits matching the requested outputs shown."),SCENARIO.info.push("• Hint: the `creation` gate can be configured to produce different output patterns."),SCENARIO.channelsDir=[1,1,-1,-1,1,1],SCENARIO.channelsCol=[0,0,2,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[0,0,-1,-1,0,0],0),SCENARIO.menuGrey=[[0,1,0,0,0,0],[1,1,1,1,1,1],[0,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<30;i++)SCENARIO.CINPUTS[0].push(1),SCENARIO.CINPUTS[1].push(1),SCENARIO.CINPUTS[1].push(0);SCENARIO.starCond=function(){return Helper.countGates(["cCreate"])<=1},SCENARIO.starText="Star bonus: use only a single creation gate.",SCENARIO.overlayType,SCENARIO.maxTrials=60,SCENARIO.numCorrect=60,SCENARIO.maxTicks=9999}else if("class7"===e){t=!0,SCENARIO.title="CI.G: The Count",SCENARIO.info=[],SCENARIO.info.push("• Send the first 8 bits from A to C, and then send the rest from A to D."),SCENARIO.info.push("• Hint: the `creation` gate can be configured to produce a finite number of outputs."),SCENARIO.channelsDir=[-1,1,-1,-1,1,1],SCENARIO.channelsCol=[2,0,2,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,-1,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<30;i++){var o=Math.round(Math.random());SCENARIO.CINPUTS[0].push(o)}SCENARIO.starCond=function(){return RBOARD[TIMER.tick].bitList.length<=1},SCENARIO.starText="Star bonus: finish with 1 or fewer bits in play.",SCENARIO.overlayType,SCENARIO.maxTrials=40,SCENARIO.numCorrect=40,SCENARIO.maxTicks=9999}else if("classPuzzle1"===e){t=!0,SCENARIO.title="CII.A: Bandwidth",SCENARIO.info=[],SCENARIO.info.push("• Send A to C and send B to D."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,2,2,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,-1,-1],[0,0,0,0,0,0,-1,0,0,0,0,0,0,0]),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=2,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<100;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(r)}SCENARIO.starCond=function(){return TIMER.victoryTick<=650},SCENARIO.starText="Star bonus: success in fewer than 650 ticks",SCENARIO.overlayType,SCENARIO.maxTrials=200,SCENARIO.numCorrect=200,SCENARIO.maxTicks=9999}else if("classPuzzle2"===e){t=!0,SCENARIO.title="CII.B: Half Adder",SCENARIO.archive="https://en.wikipedia.org/wiki/Adder_(electronics)#Half_adder",SCENARIO.info=[],SCENARIO.info.push("For each bit-pair from (A,B):"),SCENARIO.info.push("• Output their `XOR` to C:"),SCENARIO.info.push("   (0,0)--> 0  (0,1)--> 1        (1,0)--> 1  (1,1)--> 0"),SCENARIO.info.push("• Output their `AND` to D:"),SCENARIO.info.push("   (0,0)--> 0  (0,1)--> 0        (1,0)--> 0  (1,1)--> 1"),SCENARIO.info.push("Hint: use bit-controls with inversion and re-zero gates."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,2,0,0,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<296;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[2].push((a+r)%2),SCENARIO.CINPUTS[3].push(Math.floor((a+r)/2))}SCENARIO.starCond=function(){return Helper.countGates(["switch"])<=2},SCENARIO.starText="Star bonus: use 2 or fewer control gates",SCENARIO.overlayType,SCENARIO.maxTrials=200,SCENARIO.numCorrect=200,SCENARIO.maxTicks=9999}else if("classPuzzle3"===e){t=!0,SCENARIO.title="CIII.B: AND Frugality",SCENARIO.info=[],SCENARIO.info.push("• Output to D the logical AND of A with B:"),SCENARIO.info.push("   (0,0)--> 0  (0,1)--> 0        (1,0)--> 0  (1,1)--> 1"),SCENARIO.info.push("• Due to a critical shortage, `re-zero` gates are currently unavailable."),SCENARIO.channelsDir=[-1,-1,1,-1,1,1],SCENARIO.channelsCol=[2,2,0,0,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,0,-1,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,1],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<100;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[3].push(Math.floor((a+r)/2))}SCENARIO.starCond=function(){return 0===Helper.countGates(["delay"])},SCENARIO.starText="Star bonus: don't use any delay gates",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("classPuzzle3B"===e){t=!0,SCENARIO.title="CIII.C: XOR Frugality",SCENARIO.info=[],SCENARIO.info.push("• Output to D the logical XOR of A with B:"),SCENARIO.info.push("   (0,0)--> 0  (0,1)--> 1        (1,0)--> 1  (1,1)--> 0"),SCENARIO.info.push("• Due to a critical shortage, `invert` gates are currently unavailable."),SCENARIO.channelsDir=[-1,-1,1,-1,1,1],SCENARIO.channelsCol=[2,2,0,0,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,0,-1,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,1,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<100;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[3].push((a+r)%2)}SCENARIO.starCond=function(){return 0===Helper.countGates(["cCreate"])},SCENARIO.starText="Star bonus: don't use any creation gates",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("classPuzzle4"===e){t=!0,SCENARIO.title="CII.C: Memory",SCENARIO.info=[],SCENARIO.info.push("• For each bit from input stream A: output a `0` to C if it matches the previous bit in the stream, else output a `1` to C if they differ."),SCENARIO.info.push("• Assume that the memory is initialized in the `0` state."),SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[2,0,2,0,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.CINPUTS[0].push(0),SCENARIO.CINPUTS[1].push(0);for(i=0;i<50;i++){var n=SCENARIO.CINPUTS[0].length;a=SCENARIO.CINPUTS[0][n-1],r=Math.round(Math.random());SCENARIO.CINPUTS[0].push(r),a===r?SCENARIO.CINPUTS[1].push(0):SCENARIO.CINPUTS[1].push(1)}SCENARIO.starCond=function(){return TIMER.victoryTick<=400},SCENARIO.starText="Star bonus: success in fewer than 400 ticks",SCENARIO.overlayType,SCENARIO.maxTrials=50,SCENARIO.numCorrect=50,SCENARIO.maxTicks=9999}else if("classPuzzle5"===e){t=!0,SCENARIO.title="CII.D: Ternary",SCENARIO.info=[],SCENARIO.info.push("• Output every THIRD bit from A to D, and output the rest to C."),SCENARIO.channelsDir=[-1,1,-1,-1,1,1],SCENARIO.channelsCol=[2,0,2,2,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,-1,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<50;i++){a=Math.round(Math.random()),r=Math.round(Math.random());var l=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[0].push(r),SCENARIO.CINPUTS[0].push(l),SCENARIO.CINPUTS[1].push(a),SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[2].push(l)}SCENARIO.starCond=function(){return 0===Helper.countGates("trash")},SCENARIO.starText="Star bonus: don't use any incinerators.",SCENARIO.overlayType,SCENARIO.maxTrials=60,SCENARIO.numCorrect=60,SCENARIO.maxTicks=9999}else if("classPuzzle6"===e){t=!0,SCENARIO.title="CII.E: Repetition",SCENARIO.archive="https://en.wikipedia.org/wiki/Repetition_code",SCENARIO.info=[],SCENARIO.info.push("• Send A to C."),SCENARIO.info.push("• The channels across the board each have a 20% chance of flipping bits that pass through."),SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[2,0,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],0,"correctionC"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.device=8,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<500;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a)}SCENARIO.starCond=function(){return RBOARD[TIMER.tick].success>=480},SCENARIO.starText="Star bonus: get 480 or more correct.",SCENARIO.overlayType,SCENARIO.maxTrials=500,SCENARIO.numCorrect=440,SCENARIO.maxTicks=9999}else if("classPuzzle7"===e){t=!0,SCENARIO.title="CII.F: Swap Meet",SCENARIO.info=[],SCENARIO.info.push("• Send bits from A to D and send bits from B to C."),SCENARIO.info.push("• Temporary safety regulations prevent direct wire crossings."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,2,2,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"canal"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=8,SCENARIO.scoreHeightRaw=5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<100;i++){var h=Math.floor(2*Math.random());SCENARIO.CINPUTS[0].push(h);r=Math.floor(2*Math.random());SCENARIO.CINPUTS[1].push(r)}SCENARIO.starCond=function(){return Helper.countGates(["switch"])<=3},SCENARIO.starText="Star bonus: use 3 or  fewer control gates",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("classPuzzle8"===e)t=!0,SCENARIO.title="CIII.A: Strict Equality",SCENARIO.info=[],SCENARIO.info.push("• Inputs A and B both contain a sequence of 8 bits."),SCENARIO.info.push("• Output a `1` if the sequences from A and B are identical, else output a `0`."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[2,2,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.device=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return 0===Helper.countGates(["delay"])},SCENARIO.starText="Star bonus: don't use any delay gates",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999,SCENARIO.repetitions=10,SCENARIO.successRep=10,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("classPuzzle9"===e)t=!0,SCENARIO.title="CIII.D: Haystack",SCENARIO.info=[],SCENARIO.info.push("• Input A contains a total of 10 bits."),SCENARIO.info.push("• If the input contains a sequence of 4 or more `1` in a row then output a `1`, else output a `0`."),SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[2,0,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.device=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return Helper.countGates(["switch"])<=5},SCENARIO.starText="Star bonus: use 5 or  fewer control gates",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999,SCENARIO.repetitions=10,SCENARIO.successRep=10,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("vaziraniClassic"===e)t=!0,SCENARIO.title="CII.G: Quality Control",SCENARIO.info=[],SCENARIO.info.push("• Devices take as input three control bits (top channels) and a target bit (bottom)."),SCENARIO.info.push("• From bottom-to-top control channels: output a `1` if the channel implements a controlled inversion on the target bit. Output a `0` if the channel does not effect the target bit."),SCENARIO.channelsDir=[1,1,-1,1,1,1],SCENARIO.channelsCol=[0,0,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[0,0,-1,0,0,0],0,"deviceA"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.device=1,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=3,SCENARIO.numCorrect=3,SCENARIO.maxTicks=9999,SCENARIO.repetitions=10,SCENARIO.successRep=10,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("quant1"===e){t=!0,SCENARIO.title="QI.A: Inversion",SCENARIO.info=[],SCENARIO.info.push("▲ Access the journal notes   | via the yellow `J` button  | for additional level clues | and advice."),SCENARIO.info.push("• Send A to C and send B to D after inverting the tranformations enacted on them."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[1,1,1,1,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"inversion"),SCENARIO.menuGrey=[[1,1,1,1,1,1],[0,1,1,1,0,0],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.device=10,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<100;i++){r=Math.floor(16*Math.random()),l=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(r),SCENARIO.QINPUTS[1].push(l)}SCENARIO.starCond=function(){return Helper.countGates()<=8},SCENARIO.starText="Star bonus: use only two gates.",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("quant2"===e){t=!0,SCENARIO.title="QI.B: Wires Crossed",SCENARIO.info=[],SCENARIO.info.push("• Send bits from A to C."),SCENARIO.info.push("• Send qubits (guaranteed to be either state ◀ or ▶) from B to D."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[2,1,2,1,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"cross"),SCENARIO.menuGrey=[[0,1,1,1,1,1],[0,1,1,0,1,1],[1,1,1,1,0,0]],SCENARIO.division=6,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<100;i++){r=Math.round(Math.random()),l=4+8*Math.round(Math.random());SCENARIO.CINPUTS[0].push(r),SCENARIO.QINPUTS[0].push(l)}SCENARIO.starCond=function(){return TIMER.victoryTick<=130},SCENARIO.starText="Star bonus: success in fewer than 130 ticks",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("quant3A"===e)t=!0,SCENARIO.title="QI.C: Dice Roll",SCENARIO.archive="https://en.wikipedia.org/wiki/Quantum_logic_gate#Measurement",SCENARIO.info=[],SCENARIO.info.push("Adjust the measurement gates such that:"),SCENARIO.info.push("• 69% (±3%) of outputs to C are in the `1` state."),SCENARIO.info.push("• 75% (±3%) of outputs to D are in the `1` state."),SCENARIO.info.push("Hint: use the state analyzer (click on a qubit while constructing or while factory is paused) to examine measurement outcome probs."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[1,1,2,2,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"fixed"),SCENARIO.menuGrey=[[1,1,1,1,1,1],[1,1,1,1,1,1],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.editable[104]=2,SCENARIO.editable[161]=2,SCENARIO.editable[164]=2,SCENARIO.editable[202]=2,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=2e3,SCENARIO.numCorrect=2e3,SCENARIO.maxTicks=9999,SCENARIO.victoryCond=2,SCENARIO.outputC=[66,72],SCENARIO.outputD=[72,78];else if("quant3"===e){t=!0,SCENARIO.title="QI.D: Lossy",SCENARIO.info=[],SCENARIO.info.push("• Send A to C. Qubits in A start in either state ▲ or ▶."),SCENARIO.info.push("• Correct transfer of all qubits is not possible; just do as well as you can!"),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[1,0,1,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],partition=[0,0,0,0,0,0,-1,0,0,0,0,0,0,0]),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,1,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=2,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<300;i++){l=4*Math.round(Math.random());SCENARIO.QINPUTS[0].push(l)}SCENARIO.starCond=function(){return 0===Helper.countGates(["rotate","qFlip"])},SCENARIO.starText="Star bonus: don't use any rotate or flip gates.",SCENARIO.overlayType,SCENARIO.maxTrials=300,SCENARIO.numCorrect=240,SCENARIO.maxTicks=9999}else if("quant4"===e){t=!0,SCENARIO.title="QI.E: Straight Shooter II",SCENARIO.info=[],SCENARIO.info.push("• Set all qubits from A to state ▲ and then output to C."),SCENARIO.info.push("• Hint: recall that a measurement will output qubits either aligned or anti-aligned with the measurement axis."),SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[1,0,1,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,
SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<50;i++){l=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(l),SCENARIO.QINPUTS[1].push(0)}SCENARIO.starCond=function(){return TIMER.victoryTick<=250},SCENARIO.starText="Star bonus: success in 250 or fewer ticks",SCENARIO.overlayType,SCENARIO.maxTrials=50,SCENARIO.numCorrect=50,SCENARIO.maxTicks=9999}else if("quant5"===e){t=!0,SCENARIO.title="QI.F: Quantum Control",SCENARIO.info=[],SCENARIO.info.push("• Output to C qubits with rotation that is the sum of the rotations from A and B (starting from 12'o'clock)."),SCENARIO.info.push("• Input A only contains qubits in state ▲ or ▼, while B only contains state ▲ or ▶."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,1,1,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[1,1,1,1,1,1],[0,0,1,1,1,0],[1,1,1,1,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<100;i++){r=8*Math.round(Math.random()),l=4*Math.round(Math.random());SCENARIO.QINPUTS[0].push(r),SCENARIO.QINPUTS[1].push(l),SCENARIO.QINPUTS[2].push(r+l)}SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("quant6"===e){t=!0,SCENARIO.title="QI.G: Quantum Control II",SCENARIO.archive="https://en.wikipedia.org/wiki/Controlled_NOT_gate",SCENARIO.info=[],SCENARIO.info.push("• Output to C qubits with rotation that is the sum of the rotations from A and B (starting from 12'o'clock)."),SCENARIO.info.push("• Input A only contains qubits in state ▲ or ▼, while B only contains state ▲ or ▶."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,1,1,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[1,1,1,1,1,1],[0,0,1,1,0,1],[1,1,1,1,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<100;i++){r=8*Math.round(Math.random()),l=4*Math.round(Math.random());SCENARIO.QINPUTS[0].push(r),SCENARIO.QINPUTS[1].push(l),SCENARIO.QINPUTS[2].push(r+l)}SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("quant6B"===e){t=!0,SCENARIO.title="QI.H: Superposition",SCENARIO.info=[],SCENARIO.info.push("• Qubits from A begin in the (▲,▼) basis, while those from B begin in the (◀,▶) basis."),SCENARIO.info.push("• Transform inputs from A to match with the expected outputs at C, and inputs from B to match with the expected outputs at D."),SCENARIO.info.push("• Hint: clicking on a qubit allows you to change its basis."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[1,1,1,1,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0),SCENARIO.menuGrey=[[1,1,1,1,1,1],[0,1,1,1,0,0],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<100;i++)SCENARIO.QINPUTS[0].push(0),SCENARIO.QINPUTS[1].push(0);SCENARIO.starCond=function(){return Helper.countGates("qFlip")<=3&&Helper.countGates("rotate")<=1},SCENARIO.starText="Star bonus: use only one 'flip' and one 'rotate'.",SCENARIO.overlayType,SCENARIO.maxTrials=200,SCENARIO.numCorrect=200,SCENARIO.maxTicks=9999}else if("quant7"===e){t=!0,SCENARIO.title="QII.A: Measure x1, Cut x2",SCENARIO.archive="https://en.wikipedia.org/wiki/Quantum_logic_gate#The_effect_of_measurement_on_entangled_states",SCENARIO.info=[],SCENARIO.info.push("• Inputs from A and B each contain 50 qubits, which are then entangled in pairs."),SCENARIO.info.push("• Output to C and D each 50 qubits in the ▲ state."),SCENARIO.info.push("• Only a single measurement gate (pre-placed) is given."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],FIELD.channelsDir=[...SCENARIO.channelsDir],SCENARIO.channelsCol=[1,1,1,1,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"onetwo"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,1,1,1,0,0],[1,1,1,1,1,0]],SCENARIO.division=0,SCENARIO.device=6,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<100;i++)SCENARIO.QINPUTS[0].push(0);SCENARIO.starCond=function(){return TIMER.victoryTick<=250},SCENARIO.starText="Star bonus: success in 250 or fewer ticks",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("quantChallengeA"===e){t=!0,SCENARIO.title="QIII.A: Try,Try,Try Again",SCENARIO.info=[],SCENARIO.info.push("• Flip the (◀ and ▶) qubits from A and output to C."),SCENARIO.info.push("• Methods for creating new qubits as well as qubit rotation / flip gates have been disabled."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[1,0,2,0,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,1,0,0,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<400;i++){h=Math.round(Math.random());SCENARIO.QINPUTS[0].push(4+8*h),SCENARIO.QINPUTS[1].push(4+8*(1-h))}SCENARIO.starCond=function(e){return 100===e},SCENARIO.starText="Star bonus: achieve perfect success rate.",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=70,SCENARIO.maxTicks=9999}else if("quantChallengeB"===e){t=!0,SCENARIO.title="QII.F: Analysis",SCENARIO.archive="https://en.wikipedia.org/wiki/Quantum_logic_gate#Unitary_inversion_of_gates",SCENARIO.info=[],SCENARIO.info.push("• Undo the (hidden) unitary transforms on the qubits from A and B, then output to C and D respectively."),SCENARIO.info.push("• Hint: try to find a controlled flip or rotate that the reduces the created qubits back to their original state ▲."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[1,1,1,1,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"analysis"),SCENARIO.menuGrey=[[1,1,1,1,1,1],[0,0,0,0,0,0],[1,1,1,1,1,0]],SCENARIO.division=0,SCENARIO.device=4,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<400;i++){a=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(a);r=Math.floor(16*Math.random());SCENARIO.QINPUTS[1].push(r),SCENARIO.QINPUTS[2].push(0)}SCENARIO.starCond=function(e){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=200,SCENARIO.numCorrect=200,SCENARIO.maxTicks=9999}else if("quantChallengeC"===e){t=!0,SCENARIO.title="QII.G: Magic Mirror",SCENARIO.info=[],SCENARIO.info.push("• Send to C qubits in their ORIGINAL state as first output from A."),SCENARIO.info.push("Hint: the action of a (free or controlled) `rotate` or `flip` gate can always be undone by another gate of the same type."),SCENARIO.channelsDir=[-1,-1,-1,1,-1,1],SCENARIO.channelsCol=[1,1,1,0,1,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,-1,0],[0,0,0,0,0,0,-1,-1,-1,0,0,0,0,0],"halffrozen"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=7,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<50;i++){a=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(a);r=Math.floor(16*Math.random());SCENARIO.QINPUTS[1].push(r);l=Math.floor(16*Math.random());SCENARIO.QINPUTS[2].push(l)}SCENARIO.starCond=function(e){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=50,SCENARIO.numCorrect=50,SCENARIO.maxTicks=9999}else if("quantChallengeD"===e){t=!0,SCENARIO.title="QII.H: Even Odds",SCENARIO.info=[],SCENARIO.info.push("• Qubits from α and β begin in either EVEN (a▲▲+b▼▼) or ODD (a▲▲-b▼▼) superpositions, with `a` and `b` as positive numbers."),SCENARIO.info.push("• Output to C either `0` or `1` bits for each EVEN or ODD superposition respectively."),SCENARIO.info.push("• Hint: try viewing the qubits in the (◀,▶) basis."),SCENARIO.channelsDir=[1,1,-1,1,-1,-1],SCENARIO.channelsCol=[0,0,2,0,1,1],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[0,0,-1,0,-1,-1],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<200;i++){a=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a)}SCENARIO.starCond=function(){return Helper.countGates("measure")<=1},SCENARIO.starText="Star bonus: use only a single measure gate.",SCENARIO.overlayType,SCENARIO.maxTrials=200,SCENARIO.numCorrect=165,SCENARIO.maxTicks=9999}else if("quantChallengeE"===e){t=!0,SCENARIO.title="QIII.B: Swap Meet II",SCENARIO.info=[],SCENARIO.info.push("• Send qubits from A to D and send qubits from B to C."),SCENARIO.info.push("• Temporary safety regulations prevent direct wire crossings."),SCENARIO.channelsDir=[-1,-1,-1,-1,1,1],SCENARIO.channelsCol=[1,1,1,1,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,0],0,"canal"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=8,SCENARIO.scoreHeightRaw=5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<100;i++){h=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(h);r=Math.floor(16*Math.random());SCENARIO.QINPUTS[1].push(r)}SCENARIO.starCond=function(){return Helper.checkFlipAlign()},SCENARIO.starText="Star bonus: don't use flip gates with vertical or horizontal alignment.",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("quantChallengeF"===e)t=!0,SCENARIO.title="QIII.C: Relay",SCENARIO.info=[],SCENARIO.archive="https://en.wikipedia.org/wiki/Quantum_network#Quantum_repeaters",SCENARIO.info.push("• A Bell pair is an even superposition of ▲▲ and ▼▼ states."),SCENARIO.info.push("• Generate Bell pairs and output half of each to C and D."),SCENARIO.journal=!0,SCENARIO.channelsDir=[1,1,-1,-1,1,1],SCENARIO.channelsCol=[0,0,1,1,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[0,0,-1,-1,0,0],0,"relay"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=9,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=50,SCENARIO.numCorrect=50,SCENARIO.maxTicks=9999;else if("quantChallengeG"===e){t=!0,SCENARIO.title="H.D: Back-to-front",SCENARIO.info=[],SCENARIO.info.push("• For each `0` from B: output a ▼ qubit to C."),SCENARIO.info.push("• For each `1` from B: output a ▶ qubit to C."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,2,1,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0,"btf"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,1,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<50;i++){h=Math.round(Math.random());SCENARIO.CINPUTS[0].push(h),0===h?SCENARIO.QINPUTS[0].push(8):1===h&&SCENARIO.QINPUTS[0].push(4)}SCENARIO.starCond=function(){return Helper.countGates("qFlip")<=2},SCENARIO.starText="Star bonus: use two or fewer flip gates",SCENARIO.overlayType,SCENARIO.maxTrials=50,SCENARIO.numCorrect=50,SCENARIO.maxTicks=9999}else if("quantErrorA"===e){t=!0,SCENARIO.title="H.C: Correction I",SCENARIO.archive="https://en.wikipedia.org/wiki/Quantum_error_correction#Bit_flip_code",SCENARIO.info=[],SCENARIO.info.push("• Send qubits from A to C."),SCENARIO.info.push("• The channels across the board each have a 25% chance of rotating qubits (with rotation of either 90°, 180° or 270°)."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[1,0,1,0,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],0,"correctionB"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.device=5,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<1e3;i++){h=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(h)}SCENARIO.starCond=function(e){return RBOARD[TIMER.tick].success>=96},SCENARIO.starText="Star bonus: 96 or more correct outputs.",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=85,SCENARIO.maxTicks=9999}else if("quantErrorB"===e){t=!0,SCENARIO.title="H.C+: Correction II",SCENARIO.info=[],SCENARIO.info.push("• Send qubits from A to C."),SCENARIO.info.push("• The channels across the board rotate any qubit that passes through by a random angle."),SCENARIO.info.push("• Qubits from α and β begin in (perfect) bell pairs."),SCENARIO.channelsDir=[-1,1,-1,1,-1,-1],SCENARIO.channelsCol=[1,0,0,0,1,1],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,-1,-1],0,"correctionD"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.device=9,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<96;i++){h=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(h)}SCENARIO.starCond=function(e){return RBOARD[TIMER.tick].success>=100},SCENARIO.starText="Star bonus: perfect success rate.",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=80,SCENARIO.maxTicks=9999}else if("adderB"===e){t=!0,SCENARIO.title="QII.C: Drive-by XOR",SCENARIO.info=[],SCENARIO.info.push("• Send A to C and send B to D. Send the logical-XOR of (A,B) to β:"),SCENARIO.info.push("   (▲,▲)--> ▲  (▲,▼)--> ▼        (▼,▲)--> ▼  (▼,▼)--> ▲"),SCENARIO.info.push("• Channel α contains ancilla qubits (initialised in the ▲ state) for your use."),SCENARIO.channelsDir=[-1,-1,-1,-1,-1,-1],SCENARIO.channelsCol=[1,1,1,1,1,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,-1,-1],0),SCENARIO.menuGrey=[[1,1,1,1,1,1],[0,0,0,0,0,0],[1,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<96;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.QINPUTS[0].push(8*a),SCENARIO.QINPUTS[1].push(8*r),SCENARIO.QINPUTS[2].push((a+r)%2*8)}SCENARIO.starCond=function(){return Helper.countGates("qControl")<3},SCENARIO.starText="Star bonus: use no more than two control gates.",SCENARIO.overlayType,SCENARIO.maxTrials=300,SCENARIO.numCorrect=300,SCENARIO.maxTicks=9999}else if("adderC"===e){t=!0,SCENARIO.title="QII.D: Drive-by AND",SCENARIO.info=[],SCENARIO.info.push("• Send A to C and send B to D. Send the logical-AND of (A,B) to β:"),SCENARIO.info.push("   (▲,▲)--> ▲  (▲,▼)--> ▲        (▼,▲)--> ▲  (▼,▼)--> ▼"),SCENARIO.info.push("• Channel α contains ancilla qubits (initialised in the ▲ state) for your use."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,-1,-1,-1,-1,-1],SCENARIO.channelsCol=[1,1,1,1,1,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,-1,-1],0),SCENARIO.menuGrey=[[1,1,1,1,1,1],[0,0,0,0,0,0],[1,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<96;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.QINPUTS[0].push(8*a),SCENARIO.QINPUTS[1].push(8*r),SCENARIO.QINPUTS[2].push(8*(a+r>1.5))}SCENARIO.starCond=function(){return 0===Helper.countGates("qFlip")},SCENARIO.starText="Star bonus: use no qubit flip gates.",SCENARIO.overlayType,SCENARIO.maxTrials=300,SCENARIO.numCorrect=300,SCENARIO.maxTicks=9999}else if("measure"===e){t=!0,SCENARIO.title="QII.B: Discernment",SCENARIO.archive="https://en.wikipedia.org/wiki/Quantum_tomography",SCENARIO.info=[],SCENARIO.info.push("• Inputs A and B contain a copy of the same set of qubits."),SCENARIO.info.push("• Output to C a `0` for every ▲-qubit from A/B and a `1` for every ▶-qubit."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,1,0,0,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<296;i++){h=Math.round(Math.random());SCENARIO.QINPUTS[0].push(4*h),SCENARIO.CINPUTS[0].push(h)}SCENARIO.starCond=function(){return Helper.countGates("measure")<=1},SCENARIO.starText="Star bonus: use only a single measure gate.",SCENARIO.overlayType,SCENARIO.maxTrials=300,SCENARIO.numCorrect=270,SCENARIO.maxTicks=9999}else if("measureB"===e){t=!0,SCENARIO.title="QIII.E: Cascade",SCENARIO.info=[],SCENARIO.info.push("• Input A consists of a sequence of groups, with each group containing 4 identical qubits."),SCENARIO.info.push("• Output to C a `0` for each group of ▲-qubits and a `1` for each group of ▶-qubits."),SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[1,0,2,0,0,0],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<400;i++){h=Math.round(Math.random());SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h),SCENARIO.CINPUTS[0].push(h)}SCENARIO.starCond=function(){return RBOARD[TIMER.tick].success>=390},SCENARIO.starText="Star bonus: get 390 or more correct.",SCENARIO.overlayType,SCENARIO.maxTrials=400,SCENARIO.numCorrect=370,SCENARIO.maxTicks=9999}else if("preDenseB"===e){t=!0,SCENARIO.title="H.A: Superdense?",SCENARIO.info=[],SCENARIO.info.push("Input β contains 400 random bits. For each bit `i` from β:"),SCENARIO.info.push("• if i=0, then send a bit from A to C and discard a bit from B."),SCENARIO.info.push("• if i=1, then send a bit from B to C and discard a bit from A."),SCENARIO.channelsDir=[-1,-1,-1,1,1,-1],SCENARIO.channelsCol=[2,2,2,0,0,2],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,0,-1],[0,0,0,0,0,0,-1,0,0,0,0,0,0,0]),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=2,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<400;i++){a=Math.round(Math.random()),r=Math.round(Math.random()),l=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[2].push(l),0===l?SCENARIO.CINPUTS[3].push(a):SCENARIO.CINPUTS[3].push(r)}SCENARIO.starCond=function(e){return e>=340},SCENARIO.starText="Star bonus: get 340 or more correct.",SCENARIO.overlayType,SCENARIO.maxTrials=400,SCENARIO.numCorrect=325,SCENARIO.maxTicks=9999}else if("simpleDistill"===e)t=!0,SCENARIO.title="QIII.D: Distillary",SCENARIO.info=[],SCENARIO.archive="https://en.wikipedia.org/wiki/Entanglement_distillation",SCENARIO.info.push("• A Bell pair is an even superposition of ▲▲ and ▼▼ states."),SCENARIO.info.push("• Tranform the 3-qubit entangled states into a Bell pair on 2 of the qubits."),SCENARIO.info.push("• Output half of each Bell pair to C and to D."),SCENARIO.journal=!0,SCENARIO.channelsDir=[1,1,-1,-1,1,1],SCENARIO.channelsCol=[0,0,0,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,-1,0,0],0,"simpleDistill"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,1,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=3,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType="standard",SCENARIO.maxTrials=50,SCENARIO.numCorrect=50,SCENARIO.maxTicks=9999;else if("dense"===e){t=!0,SCENARIO.title="H.A+: Super-dense!",SCENARIO.info=[],SCENARIO.archive="https://en.wikipedia.org/wiki/Superdense_coding",SCENARIO.info.push("• Send an identical copy of A into C (100 bits total)."),SCENARIO.info.push("• Send an identical copy of B into D (100 bits total)."),SCENARIO.info.push("• Only 100 qubits total can be sent across the partition."),SCENARIO.info.push("• Qubits from α and β begin in (perfect) bell pairs."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,-1,-1,-1,-1,-1],SCENARIO.channelsCol=[2,2,2,2,1,1],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,-1,-1,-1],[0,0,0,0,0,0,-1,0,0,0,0,0,0,0]),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=2,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[],[]];for(i=0;i<296;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(r)}SCENARIO.starCond=function(){return TIMER.victoryTick<=1e3},SCENARIO.starText="Star bonus: success in fewer than 1000 ticks",SCENARIO.overlayType,SCENARIO.maxTrials=200,SCENARIO.numCorrect=200,SCENARIO.maxTicks=9999}else if("teleport"===e){t=!0,SCENARIO.title="H.B: Beam me up",SCENARIO.info=[],SCENARIO.archive="https://en.wikipedia.org/wiki/Quantum_teleportation",SCENARIO.info.push("• Output an identical copy of A into C."),SCENARIO.info.push("• Only classical bits can be sent across the partition."),SCENARIO.info.push("• Qubits from α and β begin in (perfect) bell pairs."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,1,-1,1,-1,-1],SCENARIO.channelsCol=[1,0,0,0,1,1],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,-1,-1],[0,0,0,0,0,0,-1,-1,0,0,0,0,0,0]),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=1,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<96;i++){h=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(h)}SCENARIO.starCond=function(){return TIMER.victoryTick<=500},SCENARIO.starText="Star bonus: success in fewer than 500 ticks",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("distill"===e){t=!0,SCENARIO.title="H.B+: Beam me up II",SCENARIO.info=[],SCENARIO.info.push("• Output an identical copy of A into C."),SCENARIO.info.push("• Only classical bits can be sent across the partition."),SCENARIO.info.push("• Qubits in α and β begin in (weakly) entangled pairs."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,1,-1,1,-1,-1],SCENARIO.channelsCol=[1,0,0,0,1,1],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,-1,-1],[0,0,0,0,0,0,-1,-1,0,0,0,0,0,0]),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=1,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<96;i++){h=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(h)}SCENARIO.starCond=function(){return 20==RBOARD[TIMER.tick].success},SCENARIO.starText="Star bonus: achieve perfect success rate",SCENARIO.overlayType,SCENARIO.maxTrials=20,SCENARIO.numCorrect=15,SCENARIO.maxTicks=9999}else if("vaziraniQuantum"===e)t=!0,SCENARIO.title="H.D+: Quality Control II",SCENARIO.archive="https://en.wikipedia.org/wiki/Bernstein%E2%80%93Vazirani_algorithm",SCENARIO.info=[],SCENARIO.info.push("• From bottom-to-top on control channels: output a `1` if the channel implements a controlled flip on the target qubit. Output a `0` if the channel does not effect the target qubit."),SCENARIO.info.push("• Each device can only be tested with a single input."),SCENARIO.channelsDir=[1,1,-1,1,1,1],SCENARIO.channelsCol=[0,0,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[0,0,-1,0,0,0],0,"deviceA"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.device=1,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=3,SCENARIO.numCorrect=3,SCENARIO.maxTicks=9999,SCENARIO.repetitions=10,SCENARIO.successRep=10,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("quantumAdv1"===e)t=!0,SCENARIO.title="H.E: Correlation",SCENARIO.info=[],SCENARIO.info.push("• Inputs from A/B are either entangled states (▲▲+▼▼) or they are in an unentangled state."),SCENARIO.info.push("• Output a `0` for an entangled state or a `1` for an unentangled state."),SCENARIO.info.push("• You are give 10 identical copies of each input state."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,1,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0,"threebox"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=10,SCENARIO.device=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return SCENARIO.correctReps>=30},SCENARIO.starText="Star bonus: 30 or more correct.",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999,SCENARIO.repetitions=32,SCENARIO.successRep=26,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("quantumAdv2"===e)t=!0,SCENARIO.title="H.E+: Correlation II",SCENARIO.info=[],SCENARIO.info.push("• Inputs from A/B are either entangled states, (▲▲+▼▼) or (▲▼-▼▲), or they are in an (unknown) product state."),SCENARIO.info.push("• Output a `0` for an entangled state or a `1` for a product state."),SCENARIO.info.push("• You are give 11 identical copies of each input state."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,1,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0,"threebox"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=10,SCENARIO.device=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return SCENARIO.correctReps>=30},SCENARIO.starText="Star bonus: 30 or more correct.",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999,SCENARIO.repetitions=32,SCENARIO.successRep=26,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("quantumAdv3"===e)t=!0,SCENARIO.title="QIII.G: Statistics",SCENARIO.info=[],SCENARIO.info.push("• Inputs from A/B are either in an unknown maximally entangled state or they are in product state (of ▲▲, ▶▶, ▼▼ or ◀◀ qubits)."),SCENARIO.info.push("• Output a `0` for an entangled state or a `1` for a product state."),SCENARIO.info.push("• You are give 12 identical copies of each input state."),SCENARIO.journal=!0,SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,1,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0,"cornerbox"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=11,SCENARIO.device=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return SCENARIO.correctReps>=46},SCENARIO.starText="Star bonus: 46 or more correct.",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999,SCENARIO.repetitions=50,SCENARIO.successRep=38,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("entChallengeA"===e){t=!0,SCENARIO.title="QII.E: Lock and Key",SCENARIO.info=[],SCENARIO.info.push("• The device measures a pair of qubits on either the horizontal or vertical axis (randomly chosen), then returns `0` if both measurements produce the same result."),SCENARIO.info.push("• Construct a two-qubit input for the device such that the output is always a `0`."),SCENARIO.journal=!0,SCENARIO.channelsDir=[1,1,-1,1,1,1],SCENARIO.channelsCol=[0,0,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[0,0,0,0,0,0],0,"key"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=12,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<400;i++)SCENARIO.CINPUTS[0].push(0);SCENARIO.starCond=function(e){return 0===Helper.countGates(["rotate"])},SCENARIO.starText="Star bonus: use no rotate gates.",SCENARIO.overlayType,SCENARIO.maxTrials=100,SCENARIO.numCorrect=100,SCENARIO.maxTicks=9999}else if("entChallengeB"===e)t=!0,SCENARIO.title="H.F: GHZ",SCENARIO.info=[],SCENARIO.archive="https://en.wikipedia.org/wiki/Greenberger%E2%80%93Horne%E2%80%93Zeilinger_state",SCENARIO.info.push("You are initially given (8 copies of) either:"),SCENARIO.info.push("• a GHZ state, (▲▲▲▲+▼▼▼▼)."),SCENARIO.info.push("• a product of two bell-pair states."),SCENARIO.info.push("• a product state of four qubits."),SCENARIO.info.push("Output a `0` for a GHZ state else output a `1` for all other states."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,1,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0,"GHZ"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=13,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return SCENARIO.correctReps>=30},SCENARIO.starText="Star bonus: achieve perfect success rate.",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999,SCENARIO.repetitions=30,SCENARIO.successRep=25,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("entChallengeC"===e)t=!0,SCENARIO.title="H.F+: GHZ II",SCENARIO.info=[],SCENARIO.info.push("You are initially given (8 copies of) either:"),SCENARIO.info.push("• a GHZ state, (▲▲▲▲+▼▼▼▼)."),SCENARIO.info.push("• a product of two bell-pair states or a product state of four qubits."),SCENARIO.info.push("Output a `0` for a GHZ state else output a `1` for all other states."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[1,1,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0,"GHZ"),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,1,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=13,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,
SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return SCENARIO.correctReps>=45},SCENARIO.starText="Star bonus: get at least 45 correct!",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999,SCENARIO.repetitions=50,SCENARIO.successRep=42,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("extraA"===e){t=!0,SCENARIO.title="Clone-a-saurus",SCENARIO.info=[],SCENARIO.archive="https://en.wikipedia.org/wiki/No-cloning_theorem",SCENARIO.info.push("• Input A consists of a sequence of groups, with each group containing 4 identical qubits in ▲, ▶, ▼ or ◀ state."),SCENARIO.info.push("• Output to each C and D an identical copy of the inputs from A."),SCENARIO.channelsDir=[-1,1,-1,-1,1,1],SCENARIO.channelsCol=[1,0,1,1,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,-1,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<500;i++){h=Math.floor(4*Math.random());SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h)}SCENARIO.starCond=function(e){return e>=900},SCENARIO.starText="Star bonus: get 900 or more correct.",SCENARIO.overlayType,SCENARIO.maxTrials=1e3,SCENARIO.numCorrect=750,SCENARIO.maxTicks=9999}else if("extraB"===e)t=!0,SCENARIO.title="Refinery",SCENARIO.info=[],SCENARIO.info.push("• Channels α and β contain 500 weakly entangled qubit pairs."),SCENARIO.info.push("• Output to A/C strongly entangled qubit pairs (Ent > 0.85 in the qubit analyzer)."),SCENARIO.info.push("• The scenario ends when 2 or fewer qubits remain on the board."),SCENARIO.channelsDir=[-1,1,-1,1,-1,-11],SCENARIO.channelsCol=[0,0,0,0,1,1],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[-1,0,-1,0,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.device=11,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.victoryCond=3,SCENARIO.starCond=function(e){return e>=50},SCENARIO.starText="Star bonus: 50 or more entangled pairs.",SCENARIO.overlayType,SCENARIO.maxTrials=9999,SCENARIO.numCorrect=30,SCENARIO.maxTicks=9999;else if("extraC"===e){t=!0,SCENARIO.title="Addition++",SCENARIO.info=[],SCENARIO.info.push("• Inputs A and B each represent an integer, ranged 0-15, encoded as a 4-bit binary string (from least to most significant bit). "),SCENARIO.info.push("• Output to C the product of the integers from A and B, encoded as an 8-bit binary string (from least to most significant bit)."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[2,2,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(a=[],r=[],i=0;i<4;i++)a.push(Math.round(Math.random())),r.push(Math.round(Math.random())),SCENARIO.CINPUTS[0].push(a[i]),SCENARIO.CINPUTS[1].push(r[i]);var d=a[0]+2*a[1]+4*a[2]+8*a[3],u=r[0]+2*r[1]+4*r[2]+8*r[3],c=(d*u).toString(2),I=c.length;SCENARIO.CINPUTS[2]=[0,0,0,0,0,0,0,0];for(i=0;i<I;i++)SCENARIO.CINPUTS[2][i]=parseInt(c[I-i-1]);SCENARIO.starCond=function(){return FIELD.cleanTiles>=(FIELD.cols-2)*(FIELD.rows-2)*.4},SCENARIO.starText="Star bonus: use <60% of floor space (current:",SCENARIO.overlayType,SCENARIO.maxTrials=8,SCENARIO.numCorrect=8,SCENARIO.maxTicks=9999,SCENARIO.repetitions=16,SCENARIO.successRep=16,SCENARIO.currentRep=1,SCENARIO.correctReps=0,SCENARIO.victoryCond=4}else if("binaryencode"===e)t=!0,SCENARIO.title="CIII.E: Unary <<< Binary",SCENARIO.info=[],SCENARIO.info.push("• Input A contains a string of N bits in state `1` (with 4 < N < 16) followed by a `0` bit."),SCENARIO.info.push("• Output to C the integer N encoded as a 4-bit binary string (from least to most significant bit)."),SCENARIO.channelsDir=[-1,1,-1,1,1,1],SCENARIO.channelsCol=[2,0,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return FIELD.cleanTiles>=(FIELD.cols-2)*(FIELD.rows-2)*.6},SCENARIO.starText="Star bonus: use <40% of floor space (current:",SCENARIO.overlayType,SCENARIO.maxTrials=4,SCENARIO.numCorrect=4,SCENARIO.maxTicks=9999,SCENARIO.repetitions=10,SCENARIO.successRep=10,SCENARIO.currentRep=1,SCENARIO.correctReps=0,SCENARIO.victoryCond=4;else if("adder"===e){t=!0,SCENARIO.title="CIII.F: Calculon",SCENARIO.info=[],SCENARIO.info.push("• Inputs A and B each contain a 64-bit string representing an integer in binary (from least to most significant bit)."),SCENARIO.info.push("• Output to C the 64-bit string corresponding to the sum of the input integers (from least to most significant bit)."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[2,2,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];var E=0;for(i=0;i<58;i++){if(57===i)a=0,r=0,l=(a+r+E)%2;else a=Math.round(Math.random()),r=Math.round(Math.random()),l=(a+r+E)%2;SCENARIO.CINPUTS[0].push(a),SCENARIO.CINPUTS[1].push(r),SCENARIO.CINPUTS[2].push(l),E=Math.floor((a+r+E)/2)}SCENARIO.starCond=function(){return FIELD.cleanTiles>=(FIELD.cols-2)*(FIELD.rows-2)*.6},SCENARIO.starText="Star bonus: use <40% of floor space (current:",SCENARIO.overlayType,SCENARIO.maxTrials=64,SCENARIO.numCorrect=64,SCENARIO.maxTicks=9999,SCENARIO.victoryCond=4}else if("extraD"===e)t=!0,SCENARIO.title="Magnum Opus",SCENARIO.info=[],SCENARIO.info.push("• Input A contains a string of at least 15 bits, while input B contains a string of exactly 9 bits."),SCENARIO.info.push("• Output to C a `1` if ANY substring from A exactly matches B, else ouput a `0`."),SCENARIO.info.push("• Four sequential `1` bits (uniquely) marks the termination of the string from A."),SCENARIO.channelsDir=[-1,-1,-1,1,1,1],SCENARIO.channelsCol=[2,2,2,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[-1,-1,-1,0,0,0],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[1,1,1,1,1,1],[0,1,0,0,1,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie! You deserve it...",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999,SCENARIO.repetitions=25,SCENARIO.successRep=25,SCENARIO.currentRep=1,SCENARIO.correctReps=0;else if("chsh"===e)t=!0,SCENARIO.title="QIII.F: Jolly Cooperation",SCENARIO.archive="https://en.wikipedia.org/wiki/CHSH_inequality#CHSH_game",SCENARIO.info=[],SCENARIO.info.push("• Adjust the measurement gates to win >84% of rounds."),SCENARIO.info.push("• Each round, Alice and Bob each RECEIVE a random bit from the center, then must SEND another bit back to the center."),SCENARIO.info.push("• To win the round: sent bits must DIFFER if the received bits were both '1' state, else sent bits must MATCH."),SCENARIO.journal=!0,SCENARIO.channelsDir=[1,1,1,1,-1,-1],SCENARIO.channelsCol=[0,0,0,0,1,1],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!0,[0,0,0,0,0,0],0,"fixed"),SCENARIO.menuGrey=[[1,1,1,1,1,1],[1,1,1,1,1,1],[1,1,1,1,1,1]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]],SCENARIO.editable[138]=2,SCENARIO.editable[174]=2,SCENARIO.editable[146]=2,SCENARIO.editable[186]=2,SCENARIO.editable[177]=2,SCENARIO.editable[183]=2,SCENARIO.starCond=function(){return!0},SCENARIO.starText="Star bonus: freebie!",SCENARIO.overlayType,SCENARIO.maxTrials=1800,SCENARIO.numCorrect=1800,SCENARIO.maxTicks=9999,SCENARIO.victoryCond=2,SCENARIO.outputC=[84,100],SCENARIO.outputD=[0,100],SCENARIO.device=12;else if("freeA"===e){t=!0,SCENARIO.disableOverlay=!0,SCENARIO.title="Free-form",SCENARIO.info=[],SCENARIO.info.push("• Template used for level design."),SCENARIO.info.push("• Overlay is semi-transparent in order to faciliate placement of hidden elements."),SCENARIO.channelsDir=[0,0,0,0,0,0],SCENARIO.channelsCol=[0,0,0,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!1,[1,1,1,1,1,1],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<400;i++){h=Math.floor(4*Math.random());SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h),SCENARIO.QINPUTS[0].push(4*h),SCENARIO.CINPUTS[0].push(h)}SCENARIO.starCond=function(){return RBOARD[TIMER.tick].success>=390},SCENARIO.starText="Star bonus: get 390 or more correct.",SCENARIO.overlayType,SCENARIO.maxTrials=1e3,SCENARIO.numCorrect=1e3,SCENARIO.maxTicks=9999,SCENARIO.starCond=function(){return!0},SCENARIO.starText="",SCENARIO.overlayType,SCENARIO.maxTrials=200,SCENARIO.numCorrect=200,SCENARIO.maxTicks=9999}else if("freeB"===e){t=!0,SCENARIO.disableOverlay=!0,SCENARIO.title="Free-form",SCENARIO.info=[],SCENARIO.info.push("• Each round, Alice and Bob each RECEIVE a random bit from the center, then SEND another bit back to the center."),SCENARIO.info.push("• To win the round: sent bits must DIFFER if the received bits were both '1' state, else sent bits must MATCH."),SCENARIO.info.push("• Adjust the measurements to maximize the win rate."),SCENARIO.channelsDir=[0,0,0,0,0,0],SCENARIO.channelsCol=[1,1,1,1,1,1],SCENARIO.hasEntanglers=!0,SCENARIO.editable=BoardData.makeEditable(!1,[1,1,1,1,1,1],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<96;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.QINPUTS[0].push(8*a),SCENARIO.QINPUTS[1].push(8*r),SCENARIO.QINPUTS[2].push(8*(a+r));var f=Math.round(Math.random()),S=Math.round(Math.random());SCENARIO.CINPUTS[0].push(f),SCENARIO.CINPUTS[1].push(S),SCENARIO.CINPUTS[2].push((f+S)%2)}SCENARIO.starCond=function(){return!0},SCENARIO.starText="",SCENARIO.overlayType,SCENARIO.maxTrials=20,SCENARIO.numCorrect=15,SCENARIO.maxTicks=9999}else if("freeC"===e){t=!0,SCENARIO.disableOverlay=!1,SCENARIO.title="Free-form",SCENARIO.info=[],SCENARIO.info.push("• Empty factory for testing and experimentation."),SCENARIO.channelsDir=[1,1,1,1,1,1],SCENARIO.channelsCol=[0,0,0,0,0,0],SCENARIO.hasEntanglers=!1,SCENARIO.editable=BoardData.makeEditable(!0,[1,1,1,1,1,1],0),SCENARIO.menuGrey=[[0,0,0,0,0,0],[0,0,0,0,0,0],[0,0,0,0,0,0]],SCENARIO.division=0,SCENARIO.scoreHeightRaw=4.5,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SCENARIO.QINPUTS=[[],[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(i=0;i<96;i++){a=Math.round(Math.random()),r=Math.round(Math.random());SCENARIO.QINPUTS[0].push(8*a),SCENARIO.QINPUTS[1].push(8*r),SCENARIO.QINPUTS[2].push(8*(a+r));f=Math.round(Math.random()),S=Math.round(Math.random());SCENARIO.CINPUTS[0].push(f),SCENARIO.CINPUTS[1].push(S),SCENARIO.CINPUTS[2].push((f+S)%2)}SCENARIO.starCond=function(){return!0},SCENARIO.starText="",SCENARIO.overlayType,SCENARIO.maxTrials=1,SCENARIO.numCorrect=1,SCENARIO.maxTicks=9999}return!!t&&(ResetConsts.all(),Menu.initialize(),Timer.initialize(),ResetConsts.refresh(),CTRLMENU.reset(CANV.menu2),!0)}function LevelGates(e,t,i){var a=!1,r=[],s=[],o=[];if(solution=!1,void 0===i&&(i=STATE.blueprint),"tut1"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[18,8,3,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[18,9,3,1,"halt",1,0,!0],[0,3,1,3,"move",1,0,!1],[18,10,3,1,"halt",1,0,!0],[0,2,1,3,"move",1,0,!1],[18,11,3,1,"halt",1,0,!0],[0,1,1,3,"move",1,0,!1],[18,12,3,1,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[18,13,3,1,"halt",0,0,!0]],o=[[0,8,3,2,"move",0,!1],[0,9,3,1,"move",-2.7488935718910694,!1],[18,4,1,3,"halt",-2.7488935718910694,!0],[0,10,3,1,"move",-1.1780972450961722,!1],[18,3,1,3,"halt",-1.1780972450961722,!0],[0,11,3,1,"move",2.356194490192345,!1],[18,2,1,3,"halt",2.356194490192345,!0],[0,12,3,1,"move",1.5707963267948966,!1],[18,1,1,3,"halt",1.5707963267948966,!0],[0,13,3,1,"move",-1.5707963267948968,!1],[18,0,1,3,"halt",-1.5707963267948968,!0]];var n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,9],[0,13,"qCreate","free",3,0,0,1,9],[18,13,"cCreate","free",3,0,0,2,9],[18,0,"qCreate","free",1,0,0,2,9],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,5,"qCompare","free",0,0,0,2,-1]]}else if("tut2"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[18,8,3,-1,"freeze",1,0,!0],[0,4,1,3,"move",1,0,!1],[18,9,3,1,"halt",0,0,!0],[0,3,1,3,"move",1,0,!1],[18,10,3,1,"halt",0,0,!0],[0,2,1,3,"move",0,0,!1],[18,11,3,1,"halt",1,0,!0],[0,1,1,3,"move",1,0,!1],[18,12,3,1,"halt",0,0,!0],[0,0,1,3,"move",1,0,!1],[18,13,3,1,"halt",0,0,!0]],o=[[0,8,3,2,"move",0,!1],[0,9,3,1,"move",1.5707963267948966,!1],[18,4,1,3,"halt",0,!0],[0,10,3,1,"move",1.1780972450961724,!1],[18,3,1,3,"halt",-.39269908169872486,!0],[0,11,3,1,"move",1.5707963267948966,!1],[18,2,1,3,"halt",0,!0],[0,12,3,1,"move",.3926990816987241,!1],[18,1,1,3,"halt",-1.1780972450961722,!0],[0,13,3,1,"move",-.7853981633974486,!1],[18,0,1,3,"halt",-2.356194490192345,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,23,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,9],[0,13,"qCreate","free",3,0,0,1,9],[18,13,"cCreate","free",3,1,0,2,9],[18,0,"qCreate","free",1,1,0,2,9],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,5,"qCompare","free",0,-1.5707963267948968,0,2,-1],[4,8,"rotate","free",0,-1.5707963267948966,0,0,-1],[4,5,"cInvert","free",0,0,0,0,-1]]}else if("tut3"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[18,8,3,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[18,9,3,1,"halt",1,0,!0],[0,3,1,3,"move",1,0,!1],[18,10,3,1,"halt",1,0,!0],[0,2,1,3,"move",0,0,!1],[18,11,3,1,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[18,12,3,1,"halt",1,0,!0],[0,0,1,3,"move",1,0,!1],[18,13,3,1,"halt",1,0,!0]],o=[[0,8,3,2,"move",0,!1],[0,9,3,1,"move",1.5707963267948966,!1],[18,4,1,3,"halt",1.5707963267948966,!0],[0,10,3,1,"move",1.1780972450961724,!1],[18,3,1,3,"halt",1.1780972450961724,!0],[0,11,3,1,"move",1.5707963267948966,!1],[18,2,1,3,"halt",1.5707963267948966,!0],[0,12,3,1,"move",.3926990816987241,!1],[18,1,1,3,"halt",.3926990816987241,!0],[0,13,3,1,"move",-.7853981633974486,!1],[18,0,1,3,"halt",-.7853981633974486,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,23,22,22,22,52,22,22,22,25,4,2,2,2,2,2,2,2,2,78,-1,-1,-1,-1,-1,-1,-1,4,13,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,2,62,2,2,6,23,22,22,22,22,22,22,22,22,22,94,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,9],[0,13,"qCreate","free",3,0,0,1,9],[18,13,"cCreate","free",3,0,0,2,9],[18,0,"qCreate","free",1,0,0,2,9],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,5,"qCompare","free",0,0,0,2,-1],[4,8,"rotate","free",0,-1.5707963267948966,0,0,-1],[4,5,"cInvert","free",0,0,0,0,-1]]}else if("tut4"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[18,8,3,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[18,9,3,1,"halt",1,0,!0],[0,3,1,3,"move",1,0,!1],[18,10,3,1,"halt",1,0,!0],[0,2,1,3,"move",0,0,!1],[18,11,3,1,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[18,12,3,1,"halt",1,0,!0],[0,0,1,3,"move",1,0,!1],[18,13,3,1,"halt",1,0,!0]],o=[[0,8,3,2,"move",0,!1],[0,9,3,1,"move",1.5707963267948966,!1],[18,4,1,3,"halt",1.5707963267948966,!0],[0,10,3,1,"move",1.1780972450961724,!1],[18,3,1,3,"halt",1.1780972450961724,!0],[0,11,3,1,"move",1.5707963267948966,!1],[18,2,1,3,"halt",1.5707963267948966,!0],[0,12,3,1,"move",.3926990816987241,!1],[18,1,1,3,"halt",.3926990816987241,!0],[0,13,3,1,"move",-.7853981633974486,!1],[18,0,1,3,"halt",-.7853981633974486,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,23,22,22,22,22,22,25,-1,-1,-1,-1,-1,4,2,2,2,2,2,78,-1,-1,4,2,5,-1,53,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,63,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,4,2,6,-1,-1,-1,53,24,22,22,22,22,12,22,22,22,22,22,94,1,-1,-1,-1,63,-1,23,26,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,3,2,2,2,2,2,2,2,6,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,9],[0,13,"qCreate","free",3,0,0,1,9],[18,13,"cCreate","free",3,0,0,2,9],[18,0,"qCreate","free",1,0,0,2,9],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,5,"qCompare","free",0,0,0,2,-1],[4,7,"rotate","free",1,1.5707963267948966,0,0,-1],[4,9,"rotate","free",1,.7853981633974483,0,0,-1],[6,6,"cInvert","free",1,0,0,0,-1],[6,8,"cInvert","free",1,0,0,0,-1]]}else if("tut5"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[0,4,1,3,"move",1,0,!1],[0,3,1,3,"move",1,0,!1],[0,2,1,3,"move",0,0,!1],[0,1,1,3,"move",1,0,!1],[0,0,1,3,"move",1,0,!1]],o=[[0,8,3,2,"move",0,!1],[0,9,3,1,"move",1.5707963267948966,!1],[0,10,3,1,"move",1.1780972450961724,!1],[0,11,3,1,"move",1.5707963267948966,!1],[0,12,3,1,"move",.3926990816987241,!1],[0,13,3,1,"move",-.7853981633974486,!1]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,22,22,22,25,-1,-1,-1,-1,-1,4,2,2,2,2,10,-1,-1,-1,4,2,5,-1,53,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,63,-1,53,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,4,2,6,-1,63,-1,53,24,22,22,22,22,12,22,22,22,22,30,-1,1,-1,-1,-1,63,-1,23,26,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,3,2,2,2,2,2,2,2,6,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"cCreate","free",1,0,0,1,9],[0,13,"qCreate","free",3,0,0,1,9],[4,7,"rotate","free",1,1.5707963267948966,0,0,-1],[4,9,"rotate","free",1,.7853981633974483,0,0,-1],[6,6,"cInvert","free",1,0,0,0,-1],[6,8,"cInvert","free",1,0,0,0,-1],[4,8,"rotate","free",1,3.9269908169872414,0,0,-1],[6,7,"cInvert","free",1,1,0,0,-1]]}else if("tut6"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[18,5,1,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[18,4,1,3,"halt",1,0,!0],[0,3,1,3,"move",1,0,!1],[18,3,1,3,"halt",1,0,!0],[0,2,1,3,"move",0,0,!1],[18,2,1,3,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[18,1,1,3,"halt",1,0,!0],[0,0,1,3,"move",1,0,!1],[18,0,1,3,"halt",1,0,!0]],o=[];if(2===i)n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,40,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,52,40,89,25,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,22,47,22,52,22,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,42,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"cCreate","free",1,0,0,1,24],[18,0,"cCreate","free",1,1,0,2,24],[18,5,"compare","free",0,.785398163397,0,2,-1],[13,8,"cCreate","free",0,1,0,0,-1],[14,8,"switch","free",0,1,0,1,-1],[15,8,"trash","free",0,.785398163397,0,0,-1],[14,9,"cInvert","free",0,1,0,0,-1],[14,9,"cInvert","free",0,0,1,0,-1],[15,9,"switch","free",0,1,0,1,-1],[16,9,"delay","free",0,0,0,3,-1],[11,10,"cCombine","free",0,0,0,0,-1],[13,10,"cCombine","free",0,0,0,0,-1],[13,10,"cCombine","free",3,0,1,0,-1],[15,10,"cInvert","free",0,1,0,0,-1],[15,10,"cInvert","free",0,0,1,0,-1],[17,10,"cCombine","free",0,0,0,0,-1],[12,11,"cCreate","free",0,1,0,0,-1],[13,11,"switch","free",2,1,0,1,-1],[14,11,"trash","free",0,.785398163397,0,0,-1]];else n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"cCreate","free",1,0,0,1,24],[18,0,"cCreate","free",1,1,0,2,24],[18,5,"compare","free",0,.785398163397,0,2,-1]]}else if("class1"===e){a=!0;s=[[0,5,1,2,"move",1,0,!1],[18,5,1,-1,"freeze",1,0,!0],[0,4,1,3,"move",1,0,!1],[18,4,1,3,"halt",1,0,!0],[0,3,1,3,"move",0,0,!1],[18,3,1,3,"halt",1,0,!0],[0,2,1,3,"move",1,0,!1],[18,2,1,3,"halt",1,0,!0],[0,1,1,3,"move",1,0,!1],[18,1,1,3,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[18,0,1,3,"halt",1,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"cCreate","free",1,0,0,1,24],[18,0,"cCreate","free",1,1,0,2,24],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("class2"===e){a=!0;s=[[0,5,1,-1,"halt",0,0,!1],[0,8,3,-1,"halt",0,0,!1],[18,5,1,-1,"freeze",0,0,!0],[18,8,3,-1,"freeze",0,0,!0],[0,1,1,-1,"halt",1,0,!1],[0,12,3,-1,"halt",1,0,!1],[18,4,1,3,"halt",0,0,!0],[18,9,3,1,"halt",0,0,!0],[18,3,1,3,"halt",1,0,!0],[18,10,3,1,"halt",1,0,!0],[1,0,2,-1,"wait",1,0,!1],[1,13,2,-1,"wait",0,0,!1],[18,2,1,3,"halt",1,0,!0],[18,11,3,1,"halt",1,0,!0],[18,1,1,3,"halt",1,0,!0],[18,12,3,1,"halt",1,0,!0],[18,0,1,3,"halt",0,0,!0],[18,13,3,1,"halt",0,0,!0]],n=[24,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[1,13,"delay","transform",0,0,0,3,-1],[1,0,"delay","transform",0,0,0,3,-1],[2,0,"cCreate","free",2,0,0,1,12],[2,13,"cCreate","free",2,1,0,1,12],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,0,"cCreate","free",1,2,0,2,24],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,13,"cCreate","free",3,2,0,2,24]]}else if("class3"===e){a=!0;s=[[0,5,1,2,"move",1,0,!1],[0,8,3,2,"move",1,0,!1],[18,8,3,-1,"freeze",1,0,!0],[18,5,1,-1,"freeze",0,0,!0],[0,4,1,3,"move",0,0,!1],[0,9,3,1,"move",0,0,!1],[18,9,3,1,"halt",1,0,!0],[18,4,1,3,"halt",1,0,!0],[0,3,1,3,"move",1,0,!1],[0,10,3,1,"move",1,0,!1],[18,10,3,1,"halt",0,0,!0],[18,3,1,3,"halt",0,0,!0],[0,2,1,3,"move",0,0,!1],[0,11,3,1,"move",1,0,!1],[0,1,1,3,"move",0,0,!1],[0,12,3,1,"move",0,0,!1],[0,0,1,3,"move",1,0,!1],[0,13,3,1,"move",0,0,!1]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,44],[0,13,"cCreate","free",3,1,0,1,44],[18,13,"cCreate","free",3,3,0,2,-1],[18,0,"cCreate","free",1,2,0,2,-1],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("class4"===e){a=!0;s=[[0,8,3,-1,"halt",0,0,!1],[18,5,1,4,"move",1,0,!0],[0,4,1,-1,"halt",1,0,!1],[0,12,3,-1,"halt",1,0,!1],[18,4,1,3,"halt",0,0,!0],[0,2,1,-1,"halt",1,0,!1],[18,3,1,3,"halt",1,0,!0],[0,0,2,-1,"halt",1,0,!1],[1,13,2,-1,"wait",0,0,!1],[18,2,1,3,"halt",1,0,!0],[18,1,1,-1,"halt",1,0,!0],[18,0,1,-1,"halt",0,0,!0]],n=[24,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[2,13,"cCreate","free",2,1,0,1,22],[1,13,"delay","transform",0,1,0,3,-1],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,0,"cCreate","free",1,2,0,2,44],[1,0,"cCreate","free",2,0,0,1,22]]}else if("class5"===e){a=!0;s=[[0,8,3,2,"move",1,0,!1],[0,9,3,1,"move",0,0,!1],[0,10,3,1,"move",1,0,!1],[0,11,3,1,"move",0,0,!1],[0,5,1,2,"move",0,0,!1],[18,5,1,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[18,4,1,3,"halt",1,0,!0],[0,3,1,3,"move",0,0,!1],[18,3,1,3,"halt",0,0,!0],[0,2,1,3,"move",0,0,!1],[18,2,1,3,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[0,12,3,1,"move",1,0,!1],[18,1,1,3,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",1,0,!1],[18,0,1,3,"halt",0,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"cCreate","free",1,0,0,1,6],[0,13,"cCreate","free",3,1,0,1,6],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,0,"cCreate","free",1,2,0,2,18]]}else if("class6"===e){a=!0;s=[[18,8,3,-1,"freeze",1,0,!0],[18,5,1,-1,"freeze",1,0,!0],[18,9,3,1,"halt",0,0,!0],[18,4,1,3,"halt",1,0,!0],[18,10,3,1,"halt",1,0,!0],[18,3,1,3,"halt",1,0,!0],[18,11,3,1,"halt",0,0,!0],[18,2,1,3,"halt",1,0,!0],[18,12,3,1,"halt",1,0,!0],[18,1,1,3,"halt",1,0,!0],[18,13,3,1,"halt",0,0,!0],[18,0,1,3,"halt",1,0,!0]],
n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,13,"cCreate","free",3,1,0,2,24],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,0,"cCreate","free",1,0,0,2,24]]}else if("class7"===e){a=!0;s=[[18,8,3,-1,"freeze",0,0,!0],[0,5,1,2,"move",1,0,!1],[18,5,1,-1,"freeze",1,0,!0],[18,9,3,1,"halt",1,0,!0],[0,4,1,3,"move",0,0,!1],[18,4,1,3,"halt",0,0,!0],[18,10,3,1,"halt",1,0,!0],[0,3,1,3,"move",0,0,!1],[18,3,1,3,"halt",0,0,!0],[18,11,3,1,"halt",0,0,!0],[0,2,1,3,"move",1,0,!1],[18,2,1,3,"halt",1,0,!0],[18,12,3,1,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[18,1,1,3,"halt",1,0,!0],[18,13,3,1,"halt",0,0,!0],[0,0,2,3,"move",0,0,!1],[18,0,0,3,"halt",0,0,!0],[1,0,2,0,"move",1,0,!1],[17,0,0,2,"halt",1,0,!0],[2,0,2,0,"move",1,0,!1],[16,0,0,2,"halt",1,0,!0],[3,0,2,0,"move",0,0,!1],[4,0,2,0,"move",1,0,!1],[5,0,2,0,"move",1,0,!1],[6,0,2,0,"move",0,0,!1],[7,0,2,0,"move",0,0,!1],[8,0,2,0,"move",0,0,!1]],n=[24,22,22,22,22,22,22,22,56,-1,-1,-1,-1,-1,-1,-1,54,22,25,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,13,"cCreate","free",3,0,0,2,26],[8,0,"cCreate","free",2,0,0,1,26],[16,0,"cCreate","free",0,0,0,2,0]]}else if("classPuzzle1"===e){a=!0;s=[[18,5,1,-1,"freeze",1,0,!0],[18,8,3,-1,"freeze",1,0,!0],[0,5,1,2,"move",1,0,!1],[0,8,3,2,"move",1,0,!1],[18,4,1,3,"halt",0,0,!0],[18,9,3,1,"halt",0,0,!0],[0,4,1,3,"move",0,0,!1],[0,9,3,1,"move",0,0,!1],[18,3,1,3,"halt",1,0,!0],[18,10,3,1,"halt",0,0,!0],[0,3,1,3,"move",1,0,!1],[0,10,3,1,"move",0,0,!1],[18,2,1,3,"halt",0,0,!0],[18,11,3,1,"halt",1,0,!0],[0,2,1,3,"move",0,0,!1],[0,11,3,1,"move",1,0,!1],[18,1,1,3,"halt",0,0,!0],[18,12,3,1,"halt",1,0,!0],[0,1,1,3,"move",0,0,!1],[0,12,3,1,"move",1,0,!1],[18,0,1,3,"halt",0,0,!0],[18,13,3,1,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",1,0,!1]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[9,6,"cCombine","free",0,0,0,1,-1],[18,0,"cCreate","free",1,0,0,2,94],[18,13,"cCreate","free",3,1,0,2,94],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[0,0,"cCreate","free",1,0,0,1,94],[0,13,"cCreate","free",3,1,0,1,94]]}else if("classPuzzle2"===e){a=!0;s=[[0,5,1,2,"move",1,0,!1],[0,8,3,2,"move",0,0,!1],[18,5,1,-1,"freeze",1,0,!0],[18,8,3,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[0,9,3,1,"move",1,0,!1],[18,4,1,3,"halt",0,0,!0],[18,9,3,1,"halt",1,0,!0],[0,3,1,3,"move",1,0,!1],[0,10,3,1,"move",0,0,!1],[18,3,1,3,"halt",1,0,!0],[18,10,3,1,"halt",0,0,!0],[0,2,1,3,"move",1,0,!1],[0,11,3,1,"move",0,0,!1],[18,2,1,3,"halt",1,0,!0],[18,11,3,1,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[0,12,3,1,"move",1,0,!1],[18,1,1,3,"halt",0,0,!0],[18,12,3,1,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",1,0,!1],[18,0,1,3,"halt",1,0,!0],[18,13,3,1,"halt",0,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,94],[0,13,"cCreate","free",3,1,0,1,94],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,0,"cCreate","free",1,2,0,2,94],[18,13,"cCreate","free",3,3,0,2,94]]}else if("classPuzzle3"===e){a=!0;s=[[0,5,1,2,"move",1,0,!1],[0,8,3,2,"move",0,0,!1],[18,8,3,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[0,9,3,1,"move",1,0,!1],[18,9,3,1,"halt",1,0,!0],[0,3,1,3,"move",1,0,!1],[0,10,3,1,"move",0,0,!1],[18,10,3,1,"halt",0,0,!0],[0,2,1,3,"move",1,0,!1],[0,11,3,1,"move",0,0,!1],[18,11,3,1,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[0,12,3,1,"move",1,0,!1],[18,12,3,1,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",1,0,!1],[18,13,3,1,"halt",0,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,94],[0,13,"cCreate","free",3,1,0,1,94],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,0,"cCreate","free",1,2,0,2,94],[18,13,"cCreate","free",3,3,0,2,94]]}else if("classPuzzle3B"===e){a=!0;s=[[0,5,1,2,"move",1,0,!1],[0,8,3,2,"move",0,0,!1],[18,8,3,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[0,9,3,1,"move",1,0,!1],[18,9,3,1,"halt",1,0,!0],[0,3,1,3,"move",1,0,!1],[0,10,3,1,"move",0,0,!1],[18,10,3,1,"halt",0,0,!0],[0,2,1,3,"move",1,0,!1],[0,11,3,1,"move",0,0,!1],[18,11,3,1,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[0,12,3,1,"move",1,0,!1],[18,12,3,1,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",1,0,!1],[18,13,3,1,"halt",0,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,13,"cCreate","free",3,1,0,1,94],[0,0,"cCreate","free",1,0,0,1,94],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,13,"cCreate","free",3,3,0,2,94]]}else if("classPuzzle4"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[18,5,1,-1,"freeze",1,0,!0],[0,4,1,3,"move",0,0,!1],[18,4,1,3,"halt",1,0,!0],[0,3,1,3,"move",0,0,!1],[18,3,1,3,"halt",1,0,!0],[0,2,1,3,"move",1,0,!1],[18,2,1,3,"halt",0,0,!0],[0,1,1,3,"move",1,0,!1],[18,1,1,3,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[18,0,1,3,"halt",0,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"cCreate","free",1,0,0,1,44],[18,0,"cCreate","free",1,1,0,2,44],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("classPuzzle5"===e){a=!0;s=[[0,5,1,2,"move",1,0,!1],[18,5,1,-1,"freeze",1,0,!0],[18,8,3,-1,"freeze",0,0,!0],[0,4,1,3,"move",0,0,!1],[18,4,1,3,"halt",0,0,!0],[18,9,3,1,"halt",1,0,!0],[0,3,1,3,"move",0,0,!1],[18,3,1,3,"halt",1,0,!0],[0,2,1,3,"move",1,0,!1],[18,2,1,3,"halt",0,0,!0],[0,1,1,3,"move",0,0,!1],[0,0,1,3,"move",1,0,!1]],o=[],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,54],[18,0,"cCreate","free",1,1,0,2,36],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,13,"cCreate","free",3,2,0,2,18]]}else if("classPuzzle6"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[18,5,1,-1,"freeze",0,0,!0],[0,4,1,3,"move",0,0,!1],[18,4,1,3,"halt",0,0,!0],[0,3,1,3,"move",1,0,!1],[18,3,1,3,"halt",1,0,!0],[0,2,1,3,"move",0,0,!1],[18,2,1,3,"halt",0,0,!0],[0,1,1,3,"move",0,0,!1],[18,1,1,3,"halt",0,0,!0],[0,0,1,3,"move",1,0,!1],[18,0,1,3,"halt",1,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"cCreate","free",1,0,0,1,494],[18,0,"cCreate","free",1,0,0,2,494],[18,5,"compare","free",0,.785398163397,0,2,-1],[6,12,"cInvert","free",0,0,0,3,-1],[6,11,"cInvert","free",0,0,0,3,-1],[6,10,"cInvert","free",0,0,0,3,-1],[6,9,"cInvert","free",0,0,0,3,-1],[6,7,"cInvert","free",0,0,0,3,-1],[6,8,"cInvert","free",0,0,0,3,-1],[6,6,"cInvert","free",0,0,0,3,-1],[6,5,"cInvert","free",0,0,0,3,-1],[6,4,"cInvert","free",0,0,0,3,-1],[6,3,"cInvert","free",0,0,0,3,-1],[6,2,"cInvert","free",0,0,0,3,-1],[6,1,"cInvert","free",0,0,0,3,-1]]}else if("classPuzzle7"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[0,8,3,2,"move",0,0,!1],[18,8,3,-1,"freeze",0,0,!0],[18,5,1,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[0,9,3,1,"move",0,0,!1],[18,9,3,1,"halt",1,0,!0],[18,4,1,3,"halt",0,0,!0],[0,3,1,3,"move",0,0,!1],[0,10,3,1,"move",0,0,!1],[18,10,3,1,"halt",0,0,!0],[18,3,1,3,"halt",0,0,!0],[0,2,1,3,"move",1,0,!1],[0,11,3,1,"move",0,0,!1],[18,11,3,1,"halt",1,0,!0],[18,2,1,3,"halt",0,0,!0],[0,1,1,3,"move",0,0,!1],[0,12,3,1,"move",1,0,!1],[18,12,3,1,"halt",0,0,!0],[18,1,1,3,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",1,0,!1],[18,13,3,1,"halt",0,0,!0],[18,0,1,3,"halt",1,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,25,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,91,-1,23,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,26,-1,-1,24,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,25,-1,24,26,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,94,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57],l=[[0,0,"cCreate","free",1,0,0,1,44],[0,13,"cCreate","free",3,1,0,1,44],[18,13,"cCreate","free",3,0,0,2,44],[18,0,"cCreate","free",1,1,0,2,44],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[2,6,"cCombine","free",0,0,0,1,-1],[2,7,"cCombine","free",0,0,0,1,-1],[16,6,"cCombine","free",0,0,0,1,-1],[16,7,"cCombine","free",0,0,0,1,-1]]}else if("classPuzzle8"===e){a=!0;s=[[18,5,1,-1,"freeze",0,0,!0],[0,5,1,2,"halt",0,0,!1],[0,8,3,2,"halt",0,0,!1],[0,4,1,3,"halt",0,0,!1],[0,9,3,1,"halt",0,0,!1],[0,3,1,3,"halt",0,0,!1],[0,10,3,1,"halt",0,0,!1],[0,2,1,3,"halt",0,0,!1],[0,11,3,1,"halt",0,0,!1],[0,1,1,3,"halt",0,0,!1],[0,12,3,1,"halt",0,0,!1],[0,0,2,3,"halt",0,0,!1],[0,13,2,1,"halt",0,0,!1],[1,0,2,0,"halt",0,0,!1],[1,13,2,0,"halt",0,0,!1],[2,0,2,0,"halt",0,0,!1],[2,13,2,0,"halt",0,0,!1]],n=[24,22,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,0,"cCreate","free",1,0,0,0,0],[2,0,"cCreate","free",2,0,0,0,0],[2,13,"cCreate","free",2,0,0,0,0]]}else if("classPuzzle9"===e){a=!0;s=[[18,5,1,-1,"freeze",0,0,!0],[0,5,1,2,"halt",0,0,!1],[0,4,1,3,"halt",0,0,!1],[0,3,1,3,"halt",0,0,!1],[0,2,1,3,"halt",0,0,!1],[0,1,1,3,"halt",0,0,!1],[0,0,2,3,"halt",0,0,!1],[1,0,2,0,"halt",0,0,!1],[2,0,2,0,"halt",0,0,!1],[3,0,2,0,"halt",0,0,!1],[4,0,2,0,"halt",0,0,!1]],n=[24,22,22,22,22,22,30,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,0,"cCreate","free",1,0,0,0,0]]}else if("vaziraniClassic"===e){a=!0;s=[[18,4,1,-1,"halt",1,0,!0],[18,3,1,-1,"halt",1,0,!0],[18,2,1,-1,"move",1,0,!0]],n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,44,22,22,22,22,22,22,25,-1,24,44,-1,-1,-1,21,-1,-1,-1,-1,44,22,22,22,25,-1,24,31,22,31,44,-1,-1,-1,21,-1,-1,-1,-1,44,25,-1,24,31,22,31,31,22,31,44,-1,-1,-1,21,-1,-1,-1,-1,-1,23,40,26,23,40,26,23,40,26,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,44,52,22,22,52,22,22,52,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[6,5,"switch","free",0,1,0,1,-1],[9,5,"switch","free",0,1,0,1,-1],[12,5,"switch","free",0,1,0,1,-1],[12,6,"cInvert","free",0,1,0,0,-1],[12,6,"cInvert","free",0,0,1,0,-1],[9,6,"cInvert","free",0,1,0,0,-1],[9,6,"cInvert","free",0,0,1,0,-1],[6,6,"cInvert","free",0,1,0,0,-1],[6,6,"cInvert","free",0,0,1,0,-1],[4,4,"cCombine","free",0,0,0,1,-1],[4,3,"cCombine","free",0,0,0,1,-1],[4,2,"cCombine","free",0,0,0,1,-1],[14,4,"cCombine","free",0,0,0,1,-1],[14,3,"cCombine","free",0,0,0,1,-1],[14,2,"cCombine","free",0,0,0,1,-1],[18,5,"compare","free",0,.7853981633974483,0,0,-1],[18,0,"cCreate","free",1,0,0,2,0],[13,6,"cCombine","free",0,0,0,1,-1],[5,6,"cCombine","free",0,0,0,1,-1]]}else if("quant1"===e){a=!0;o=[[0,5,1,2,"move",.7853981633974484,!1],[0,8,3,2,"move",-1.5707963267948966,!1],[0,4,1,3,"move",-.3926990816987246,!1],[18,4,1,3,"halt",-.3926990816987246,!0],[0,9,3,1,"move",2.748893571891069,!1],[18,9,3,1,"halt",2.748893571891069,!0],[0,3,1,3,"move",3.141592653589793,!1],[18,3,1,3,"halt",3.141592653589793,!0],[0,10,3,1,"move",2.748893571891069,!1],[18,10,3,1,"halt",2.748893571891069,!0],[0,2,1,3,"move",-1.5707963267948966,!1],[18,2,1,3,"halt",-1.5707963267948966,!0],[0,11,3,1,"move",1.5707963267948966,!1],[18,11,3,1,"halt",1.5707963267948966,!0],[0,1,1,3,"move",1.1780972450961724,!1],[18,1,1,3,"halt",1.1780972450961724,!0],[0,12,3,1,"move",1.1780972450961724,!1],[18,12,3,1,"halt",1.1780972450961724,!0],[0,0,1,3,"move",-1.178097245096172,!1],[18,0,1,3,"halt",-1.178097245096172,!0],[0,13,3,1,"move",-1.178097245096172,!1],[18,13,3,1,"halt",-1.178097245096172,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,2,2,62,68,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,62,68,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,79,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77],l=[[0,0,"qCreate","free",1,0,0,1,44],[18,0,"qCreate","free",1,0,0,2,44],[0,13,"qCreate","free",3,1,0,1,44],[18,13,"qCreate","free",3,1,0,2,44],[18,5,"qCompare","free",0,.7853981633974484,0,2,-1],[18,8,"qCompare","free",1,-1.5707963267948966,0,4,-1],[3,8,"qFlip","free",0,5.497787143782138,0,0,-1],[4,8,"rotate","free",0,3.9269908169872414,0,0,-1],[5,8,"qFlip","free",0,4.71238898038,0,0,-1],[3,5,"rotate","free",0,1.5707963267948966,0,0,-1],[5,5,"rotate","free",0,5.497787143782138,0,0,-1],[4,5,"qFlip","free",0,1.5707963267948966,0,0,-1]]}else if("quant2"===e){a=!0;s=[[0,5,1,2,"move",0,0,!1],[18,5,1,-1,"freeze",0,0,!0],[0,4,1,3,"move",0,0,!1],[18,4,1,3,"halt",0,0,!0],[0,3,1,3,"move",0,0,!1],[18,3,1,3,"halt",0,0,!0],[0,2,1,3,"move",1,0,!1],[18,2,1,3,"halt",1,0,!0],[0,1,1,3,"move",0,0,!1],[18,1,1,3,"halt",0,0,!0],[0,0,1,3,"move",0,0,!1],[18,0,1,3,"halt",0,0,!0]],o=[[0,8,3,2,"move",1.5707963267948966,!1],[0,9,3,1,"move",1.5707963267948966,!1],[18,9,3,1,"halt",1.5707963267948966,!0],[0,10,3,1,"move",-1.5707963267948966,!1],[18,10,3,1,"halt",-1.5707963267948966,!0],[0,11,3,1,"move",1.5707963267948966,!1],[18,11,3,1,"halt",1.5707963267948966,!0],[0,12,3,1,"move",-1.5707963267948966,!1],[18,12,3,1,"halt",-1.5707963267948966,!0],[0,13,3,1,"move",1.5707963267948966,!1],[18,13,3,1,"halt",1.5707963267948966,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,64,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,79,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77],l=[[9,10,"cCombine","free",0,0,0,1,-1],[9,3,"qCombine","free",0,0,0,1,-1],[0,13,"qCreate","free",3,0,0,1,44],[18,13,"qCreate","free",3,0,0,2,44],[0,0,"cCreate","free",1,0,0,1,44],[18,0,"cCreate","free",1,0,0,2,44],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,8,"qCompare","free",1,1.5707963267948966,0,4,-1]]}else if("quant3A"===e){a=!0;o=[[0,5,1,2,"move",0,!1],[0,4,1,3,"move",0,!1],[0,3,1,3,"move",0,!1],[0,2,1,3,"move",0,!1],[0,1,1,3,"move",0,!1],[0,0,1,3,"move",0,!1],[0,8,3,2,"move",0,!1],[0,9,3,1,"move",0,!1],[0,10,3,1,"move",0,!1],[0,11,3,1,"move",0,!1],[0,12,3,1,"move",0,!1],[0,13,3,1,"move",0,!1]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,25,-1,-1,-1,-1,-1,-1,-1,3,2,2,2,2,2,2,2,2,60,84,23,22,22,22,22,22,22,96,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,2,2,2,2,2,2,60,5,4,60,84,24,22,22,22,96,1,-1,-1,-1,-1,-1,-1,-1,-1,43,65,6,44,22,26,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,84,3,2,60,84,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"cOneCompare","free",0,0,0,0,0],[18,8,"cOneCompare","free",0,0,0,0,0],[0,0,"qCreate","free",1,0,0,0,994],[9,5,"measure","free",0,0,0,0,-1],[10,5,"trash","free",0,.7853981633974483,0,0,-1],[0,13,"qCreate","free",3,0,0,0,994],[9,8,"measure","free",0,0,0,0,-1],[9,9,"switch","free",3,1,0,1,-1],[10,9,"qCombine","free",0,0,0,0,-1],[10,9,"qCombine","free",1,0,1,0,-1],[9,10,"trash","free",0,.7853981633974483,0,0,-1],[12,8,"measure","free",0,0,0,0,-1],[12,10,"measure","free",0,0,0,0,-1],[12,9,"cCombine","free",0,0,0,0,-1],[13,8,"trash","free",0,.7853981633974483,0,0,-1],[13,10,"trash","free",0,.7853981633974483,0,0,-1]]}else if("quant3"===e){a=!0;o=[[0,5,1,2,"move",1.5707963267948966,!1],[0,4,1,3,"move",0,!1],[18,4,1,3,"halt",0,!0],[0,3,1,3,"move",0,!1],[18,3,1,3,"halt",0,!0],[0,2,1,3,"move",1.5707963267948966,!1],[18,2,1,3,"halt",1.5707963267948966,!0],[0,1,1,3,"move",0,!1],[18,1,1,3,"halt",0,!0],[0,0,1,3,"move",0,!1],[18,0,1,3,"halt",0,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"qCreate","free",1,0,0,1,300],[18,0,"qCreate","free",1,0,0,2,300],[9,6,"cCombine","free",0,0,0,1,-1],[18,5,"qCompare","free",0,1.5707963267948966,0,2,-1]]}else if("quant4"===e){a=!0;o=[[0,5,1,2,"move",1.1780972450961724,!1],[0,4,1,3,"move",-.7853981633974484,!1],[18,4,1,3,"halt",0,!0],[0,3,1,3,"move",.7853981633974484,!1],[18,3,1,3,"halt",0,!0],[0,2,1,3,"move",1.1780972450961724,!1],[18,2,1,3,"halt",0,!0],[0,1,1,3,"move",0,!1],[18,1,1,3,"halt",0,!0],[0,0,1,3,"move",1.1780972450961724,!1],[18,0,1,3,"halt",0,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"qCreate","free",1,0,0,1,44],[18,0,"qCreate","free",1,1,0,2,44],[18,5,"qCompare","free",0,0,0,2,-1]]}else if("quant5"===e){a=!0;o=[[0,5,1,2,"move",0,!1],[0,8,3,2,"move",0,!1],[0,4,1,3,"move",0,!1],[0,9,3,1,"move",0,!1],[18,4,1,3,"halt",0,!0],[0,3,1,3,"move",3.141592653589793,!1],[0,10,3,1,"move",1.5707963267948966,!1],[18,3,1,3,"halt",-1.5707963267948966,!0],[0,2,1,3,"move",3.141592653589793,!1],[0,11,3,1,"move",0,!1],[18,2,1,3,"halt",3.141592653589793,!0],[0,1,1,3,"move",0,!1],[0,12,3,1,"move",0,!1],[18,1,1,3,"halt",0,!0],[0,0,1,3,"move",0,!1],[0,13,3,1,"move",0,!1],[18,0,1,3,"halt",0,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"qCreate","free",1,0,0,1,94],[0,13,"qCreate","free",3,1,0,1,94],[18,5,"qCompare","free",0,0,0,2,-1],[18,0,"qCreate","free",1,2,0,2,94]]}else if("quant6"===e){a=!0;o=[[0,5,1,2,"move",0,!1],[0,8,3,2,"move",0,!1],[0,4,1,3,"move",0,!1],[0,9,3,1,"move",0,!1],[18,4,1,3,"halt",0,!0],[0,3,1,3,"move",3.141592653589793,!1],[0,10,3,1,"move",1.5707963267948966,!1],[18,3,1,3,"halt",-1.5707963267948966,!0],[0,2,1,3,"move",3.141592653589793,!1],[0,11,3,1,"move",0,!1],[18,2,1,3,"halt",3.141592653589793,!0],[0,1,1,3,"move",0,!1],[0,12,3,1,"move",0,!1],[18,1,1,3,"halt",0,!0],[0,0,1,3,"move",0,!1],[0,13,3,1,"move",0,!1],[18,0,1,3,"halt",0,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"qCreate","free",1,0,0,1,94],[0,13,"qCreate","free",3,1,0,1,94],[18,5,"qCompare","free",0,0,0,2,-1],[18,0,"qCreate","free",1,2,0,2,94]]}else if("quant6B"===e){a=!0;s=[],o=[[0,5,1,2,"move",3.141592653589793,!1],[0,8,3,2,"move",0,!1],[0,4,1,3,"move",3.141592653589793,!1],[18,4,1,3,"halt",3.141592653589793,!0],[0,9,3,1,"move",.39269908169872403,!1],[18,9,3,1,"halt",.39269908169872403,!0],[0,3,1,3,"move",-2.748893571891069,!1],[18,3,1,3,"halt",-2.748893571891069,!0],[0,10,3,1,"move",-2.356194490192345,!1],[18,10,3,1,"halt",-2.356194490192345,!0],[0,2,1,3,"move",1.9634954084936207,!1],[18,2,1,3,"halt",1.9634954084936207,!0],[0,11,3,1,"move",.39269908169872403,!1],[18,11,3,1,"halt",.39269908169872403,!0],[0,1,1,3,"move",0,!1],[18,1,1,3,"halt",0,!0],[0,12,3,1,"move",-.3926990816987246,!1],[18,12,3,1,"halt",-.3926990816987246,!0],[0,0,1,3,"move",-1.178097245096172,!1],[18,0,1,3,"halt",-1.178097245096172,!0],[0,13,3,1,"move",2.748893571891069,!1],[18,13,3,1,"halt",2.748893571891069,!0]],
n=[4,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,74,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,79,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,74,6],l=[[18,5,"qCompare","free",0,3.14159265359,0,2,-1],[18,8,"qCompare","free",1,0,0,4,-1],[1,0,"qFlip","free",0,0,0,3,-1],[1,13,"qFlip","free",0,1.570796326795,0,3,-1],[2,0,"qCreate","free",2,2,0,1,94],[2,13,"qCreate","free",2,3,0,1,94],[17,0,"qCreate","free",0,0,0,2,94],[17,13,"qCreate","free",0,1,0,2,94]]}else if("quant7"===e){a=!0;o=[[0,8,3,2,"move",0,!1],[0,9,3,1,"move",0,!1],[18,4,1,3,"halt",0,!0],[18,9,3,1,"halt",0,!0],[0,10,3,1,"move",0,!1],[18,3,1,3,"halt",0,!0],[18,10,3,1,"halt",0,!0],[0,11,3,1,"move",0,!1],[18,2,1,3,"halt",0,!0],[18,11,3,1,"halt",0,!0],[0,12,3,1,"move",0,!1],[18,1,1,3,"halt",0,!0],[18,12,3,1,"halt",0,!0],[0,13,3,1,"move",0,!1],[18,0,1,3,"halt",0,!0],[18,13,3,1,"halt",0,!0],[0,5,1,2,"move",1.5707963267948966,!1],[0,4,1,3,"move",1.5707963267948966,!1],[0,3,1,3,"move",1.5707963267948966,!1],[0,2,1,3,"move",1.5707963267948966,!1],[0,1,1,3,"move",1.5707963267948966,!1],[0,0,2,3,"move",1.5707963267948966,!1]],n=[4,62,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,5,-1,-1,-1,-1,-1,-1,60,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,3,70,2,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,68,2,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,79,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77],l=[[0,13,"qCreate","free",3,0,0,0,44],[2,6,"qControl","free",0,0,0,0,-1],[1,0,"rotate","free",0,1.5707963267948966,0,0,-1],[2,0,"qCreate","free",2,0,0,3,44],[2,7,"qFlip","free",0,.7853981633974483,0,0,-1],[2,7,"qFlip","free",0,.7853981633974483,1,0,-1],[4,6,"qCombine","free",0,0,0,1,-1],[4,7,"qCombine","free",0,0,0,1,-1],[18,5,"qCompare","free",0,0,0,2,-1],[18,8,"qCompare","free",1,0,0,4,-1],[18,0,"qCreate","free",1,0,0,2,44],[18,13,"qCreate","free",3,0,0,2,44],[8,5,"measure","free",0,0,0,0,-1]]}else if("quantChallengeA"===e){a=!0;o=[[0,5,1,2,"move",1.5707963267948966,!1],[0,4,1,3,"move",-1.5707963267948966,!1],[18,4,1,3,"halt",1.5707963267948966,!0],[0,3,1,3,"move",1.5707963267948966,!1],[18,3,1,3,"halt",-1.5707963267948966,!0],[0,2,1,3,"move",1.5707963267948966,!1],[18,2,1,3,"halt",-1.5707963267948966,!0],[0,1,1,3,"move",1.5707963267948966,!1],[18,1,1,3,"halt",-1.5707963267948966,!0],[0,0,1,3,"move",1.5707963267948966,!1],[18,0,1,3,"halt",-1.5707963267948966,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"qCreate","free",1,0,0,1,94],[18,0,"qCreate","free",1,1,0,2,94],[18,5,"qCompare","free",0,-1.5707963267948966,0,2,-1]]}else if("quantChallengeB"===e){a=!0;o=[[0,5,1,2,"move",1.5707963267948966,!1],[0,8,3,2,"move",-1.9634954084936211,!1],[0,4,1,3,"move",1.5707963267948966,!1],[0,9,3,1,"move",2.356194490192345,!1],[18,4,1,3,"halt",1.5707963267948966,!0],[18,9,3,1,"halt",2.356194490192345,!0],[0,3,1,3,"move",1.1780972450961724,!1],[0,10,3,1,"move",-.3926990816987246,!1],[18,3,1,3,"halt",1.1780972450961724,!0],[18,10,3,1,"halt",-.3926990816987246,!0],[0,2,1,3,"move",-.3926990816987246,!1],[0,11,3,1,"move",-.7853981633974484,!1],[18,2,1,3,"halt",-.3926990816987246,!0],[18,11,3,1,"halt",-.7853981633974484,!0],[0,1,1,3,"move",3.141592653589793,!1],[0,12,3,1,"move",-.3926990816987246,!1],[18,1,1,3,"halt",3.141592653589793,!0],[18,12,3,1,"halt",-.3926990816987246,!0],[0,0,1,3,"move",2.748893571891069,!1],[0,13,3,1,"move",1.9634954084936207,!1],[18,0,1,3,"halt",2.748893571891069,!0],[18,13,3,1,"halt",1.9634954084936207,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,74,2,2,68,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,2,2,2,72,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,2,68,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,79,1,74,2,2,72,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77],l=[[18,0,"qCreate","free",1,0,0,2,94],[18,13,"qCreate","free",3,1,0,2,94],[18,5,"qCompare","free",0,5.497787143782138,0,2,-1],[18,8,"qCompare","free",1,.7853981633974483,0,4,-1],[4,9,"qControl","free",2,1.5707963267948966,0,0,-1],[4,8,"qFlip","free",0,2.356194490192345,0,0,-1],[4,8,"qFlip","free",0,.7853981633974483,1,0,-1],[1,4,"qCreate","free",0,0,0,0,-1],[4,5,"qControl","free",2,.7853981633974483,0,0,-1],[1,9,"qCreate","free",0,0,0,0,-1],[4,4,"qFlip","free",0,1.5707963267948966,0,0,-1],[4,4,"qFlip","free",0,.7853981633974483,1,0,-1],[0,0,"qCreate","free",1,0,0,4,94],[0,13,"qCreate","free",3,1,0,4,94]]}else if("quantChallengeC"===e){a=!0;o=[[0,5,1,2,"move",-2.748893571891069,!1],[0,8,3,2,"move",-2.356194490192345,!1],[5,13,0,1,"move",1.5707963267948966,!1],[0,4,1,3,"move",1.5707963267948966,!1],[0,9,3,1,"move",-1.5707963267948966,!1],[4,13,0,2,"move",-1.178097245096172,!1],[18,4,1,3,"halt",1.5707963267948966,!0],[0,3,1,3,"move",1.9634954084936207,!1],[0,10,3,1,"move",-.3926990816987246,!1],[3,13,0,2,"move",3.141592653589793,!1],[18,3,1,3,"halt",1.9634954084936207,!0],[0,2,1,3,"move",3.141592653589793,!1],[0,11,3,1,"move",-1.9634954084936211,!1],[2,13,0,2,"move",-.3926990816987246,!1],[18,2,1,3,"halt",3.141592653589793,!0],[0,1,1,3,"move",.3926990816987241,!1],[0,12,3,1,"move",-2.748893571891069,!1],[1,13,0,2,"move",-2.356194490192345,!1],[18,1,1,3,"halt",.3926990816987241,!0],[0,0,1,3,"move",-2.748893571891069,!1],[0,13,3,1,"move",3.141592653589793,!1],[18,0,1,3,"halt",-2.748893571891069,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,3,70,2,68,2,62,2,62,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,62,2,70,2,72,2,68,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,6,4,2,68,2,62,2,72,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,3,2,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,74,2,2,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"qCreate","free",1,0,0,1,44],[0,13,"qCreate","free",3,1,0,1,44],[1,13,"qCreate","free",0,2,0,1,45],[9,6,"qCombine","free",0,0,0,1,-1],[9,7,"qCombine","free",0,0,0,1,-1],[9,8,"qCombine","free",0,0,0,1,-1],[2,6,"qControl","free",0,.7853981633974483,0,0,-1],[4,7,"qControl","free",0,0,0,0,-1],[6,7,"qControl","free",2,-1.5707963267948966,0,0,-1],[8,8,"qControl","free",2,-2.356194490192345,0,0,-1],[4,6,"qFlip","free",0,0,0,0,-1],[4,8,"qFlip","free",0,1.5707963267948966,0,0,-1],[4,8,"qFlip","free",0,.7853981633974483,1,0,-1],[6,8,"rotate","free",0,1.5707963267948966,0,0,-1],[2,7,"rotate","free",0,1.5707963267948966,0,0,-1],[2,7,"rotate","free",0,.7853981633974483,1,0,-1],[8,6,"rotate","free",0,5.497787143782138,0,0,-1],[6,6,"rotate","free",0,3.9269908169872414,0,0,-1],[6,6,"rotate","free",0,.7853981633974483,1,0,-1],[8,7,"qFlip","free",0,.7853981633974483,0,0,-1],[8,7,"qFlip","free",0,.7853981633974483,1,0,-1],[18,5,"qCompare","free",0,-2.748893571891069,0,2,-1],[18,0,"qCreate","free",1,0,0,2,44]]}else if("quantChallengeD"===e){a=!0;s=[[18,5,1,-1,"freeze",1,0,!0],[18,4,1,3,"halt",0,0,!0],[18,3,1,3,"halt",1,0,!0],[18,2,1,3,"halt",0,0,!0]];var h=new Entangled(2);h.setQubits([new Qubit(5,13,0,1,"halt",0),new Qubit(13,13,0,1,"halt",0)]);var d=new Entangled(2);d.setQubits([new Qubit(4,13,0,2,"halt",0),new Qubit(14,13,0,0,"halt",0)]);var u=new Entangled(2);u.setQubits([new Qubit(3,13,0,2,"halt",0),new Qubit(15,13,0,0,"halt",0)]);var c=new Entangled(2);c.setQubits([new Qubit(2,13,0,2,"halt",0),new Qubit(16,13,0,0,"halt",0)]);r=[h,d,u,c],n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,85,70,2,2,6,-1,-1,-1,-1,-1,-1,-1,3,2,2,68,76,-1],l=[[17,13,"qCreate","free",2,0,0,0,196],[2,13,"qControl","free",0,0,0,2,-2],[16,13,"qFlip","free",0,1.5707963267948966,0,0,-2],[1,13,"upgrade","free",0,.39269908169872414,0,2,-1],[0,13,"cCreate","free",0,0,0,1,196],[18,0,"cCreate","free",1,0,0,2,196],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("quantChallengeE"===e){a=!0;o=[[0,5,1,2,"move",3.141592653589793,!1],[0,8,3,2,"move",2.356194490192345,!1],[0,4,1,3,"move",-2.748893571891069,!1],[0,9,3,1,"move",1.9634954084936207,!1],[18,4,1,3,"halt",1.9634954084936207,!0],[18,9,3,1,"halt",-2.748893571891069,!0],[0,3,1,3,"move",-.7853981633974484,!1],[0,10,3,1,"move",2.748893571891069,!1],[18,3,1,3,"halt",2.748893571891069,!0],[18,10,3,1,"halt",-.7853981633974484,!0],[0,2,1,3,"move",-1.178097245096172,!1],[0,11,3,1,"move",1.1780972450961724,!1],[18,2,1,3,"halt",1.1780972450961724,!0],[18,11,3,1,"halt",-1.178097245096172,!0],[0,1,1,3,"move",2.356194490192345,!1],[0,12,3,1,"move",3.141592653589793,!1],[18,1,1,3,"halt",3.141592653589793,!0],[18,12,3,1,"halt",2.356194490192345,!0],[0,0,1,3,"move",1.1780972450961724,!1],[0,13,3,1,"move",.3926990816987241,!1],[18,0,1,3,"halt",.3926990816987241,!0],[18,13,3,1,"halt",1.1780972450961724,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,78,-1,3,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,64,6,-1,-1,4,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,64,5,-1,4,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,79,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77],l=[[0,0,"qCreate","free",1,0,0,1,44],[0,13,"qCreate","free",3,1,0,1,44],[18,0,"qCreate","free",1,1,0,2,44],[18,13,"qCreate","free",3,0,0,2,44],[18,5,"qCompare","free",0,2.356194490192345,0,2,-1],[18,8,"qCompare","free",1,3.141592653589793,0,4,-1],[2,6,"qCombine","free",0,0,0,1,-1],[2,7,"qCombine","free",0,0,0,1,-1],[16,6,"qCombine","free",0,0,0,1,-1],[16,7,"qCombine","free",0,0,0,1,-1]]}else if("quantChallengeF"===e){a=!0;n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,65,-1,-1,-1,-1,47,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,95,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,95,-1,-1,-1,-1,-1,67,-1,-1,-1,-1,45,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"qDubCompare","free",0,0,0,0,-1],[18,8,"qDubCompare","free",0,0,0,0,-1],[0,13,"qCreate","free",3,0,0,0,-1],[5,4,"qCombine","free",1,0,0,1,-1],[5,9,"qCombine","free",3,0,0,1,-1],[10,4,"cCombine","free",3,0,0,1,-1],[10,9,"cCombine","free",1,0,0,1,-1]]}else if("quantChallengeG"===e){a=!0;s=[[0,8,3,2,"move",0,0,!1],[0,9,3,1,"move",1,0,!1],[0,10,3,1,"move",0,0,!1],[0,11,3,1,"move",0,0,!1],[0,12,3,1,"move",1,0,!1],[0,13,3,1,"move",0,0,!1]],o=[[0,5,1,2,"move",0,!1],[0,4,1,3,"move",0,!1],[18,4,1,3,"halt",1.5707963267948966,!0],[0,3,1,3,"move",0,!1],[18,3,1,3,"halt",3.141592653589793,!0],[0,2,1,3,"move",0,!1],[18,2,1,3,"halt",3.141592653589793,!0],[0,1,1,3,"move",0,!1],[18,1,1,3,"halt",1.5707963267948966,!0],[0,0,1,3,"move",0,!1],[18,0,1,3,"halt",3.141592653589793,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,2,2,2,2,2,70,2,2,2,2,2,70,2,2,2,2,2,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"qCreate","free",1,0,0,0,44],[18,5,"qCompare","free",0,3.141592653589793,0,2,-1],[18,0,"qCreate","free",1,0,0,2,44],[6,5,"qControl","free",0,0,0,0,-1],[12,5,"qControl","free",0,0,0,0,-1],[0,13,"cCreate","free",3,0,0,1,44]]}else if("quantErrorB"===e){a=!0;h=new Entangled(2);h.setQubits([new Qubit(5,13,0,1,"halt",0),new Qubit(13,13,0,1,"halt",0)]);var I=new Entangled(2);I.setQubits([new Qubit(4,13,0,2,"halt",0),new Qubit(14,13,0,0,"halt",0)]);var E=new Entangled(2);E.setQubits([new Qubit(3,13,0,2,"halt",0),new Qubit(15,13,0,0,"halt",0)]);r=[h,I,E],o=[[0,5,1,2,"move",1*Math.PI/8,!1],[0,4,1,3,"move",5*Math.PI/8,!1],[18,4,1,3,"halt",5*Math.PI/8,!0],[0,3,1,3,"move",1.1780972450961724,!1],[18,3,1,3,"halt",1.1780972450961724,!0],[0,2,1,3,"move",-1.9634954084936214,!1],[18,2,1,3,"halt",-1.9634954084936214,!0],[0,1,1,3,"move",1.1780972450961724,!1],[18,1,1,3,"halt",1.1780972450961724,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,74,70,2,2,6,-1,-1,-1,-1,-1,-1,-1,3,2,2,68,76,-1],l=[[0,0,"qCreate","free",1,0,0,1,95],[18,0,"qCreate","free",1,0,0,2,95],[18,5,"qCompare","free",0,3.534291735289,0,2,-2],[1,13,"qCreate","free",0,3,0,0,-1],[17,13,"qCreate","free",2,0,0,0,-1],[2,13,"qControl","free",0,0,0,2,-2],[16,13,"qFlip","free",0,1.570796326795,0,0,-2],[7,12,"rotate","free",0,.785398163397,0,2,-1],[7,11,"rotate","free",0,.785398163397,0,2,-1],[7,10,"rotate","free",0,.785398163397,0,2,-1],[7,9,"rotate","free",0,.785398163397,0,2,-1],[7,8,"rotate","free",0,.785398163397,0,2,-1],[7,7,"rotate","free",0,.785398163397,0,2,-1],[7,6,"rotate","free",0,.785398163397,0,2,-1],[7,5,"rotate","free",0,.785398163397,0,2,-1],[7,3,"rotate","free",0,.785398163397,0,2,-1],[7,4,"rotate","free",0,.785398163397,0,2,-1],[7,2,"rotate","free",0,.785398163397,0,2,-1],[7,1,"rotate","free",0,.785398163397,0,2,-1]]}else if("quantErrorA"===e){a=!0;o=[[0,5,1,2,"move",-.7853981633974484,!1],[18,4,1,3,"halt",-2.748893571891069,!0],[0,4,1,3,"move",-2.748893571891069,!1],[18,3,1,3,"halt",.7853981633974484,!0],[0,3,1,3,"move",.7853981633974484,!1],[18,2,1,3,"halt",0,!0],[0,2,1,3,"move",0,!1],[18,1,1,3,"halt",-1.178097245096172,!0],[0,1,1,3,"move",-1.178097245096172,!1],[18,0,1,3,"halt",1.9634954084936207,!0],[0,0,1,3,"move",1.9634954084936207,!1]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[4,1,"rotate","free",0,0,0,1,-1],[4,2,"rotate","free",0,0,0,1,-1],[4,3,"rotate","free",0,0,0,1,-1],[4,4,"rotate","free",0,0,0,1,-1],[4,5,"rotate","free",0,0,0,1,-1],[4,6,"rotate","free",0,0,0,1,-1],[4,7,"rotate","free",0,0,0,1,-1],[4,8,"rotate","free",0,0,0,1,-1],[4,9,"rotate","free",0,0,0,1,-1],[4,10,"rotate","free",0,0,0,1,-1],[4,11,"rotate","free",0,0,0,1,-1],[4,12,"rotate","free",0,0,0,1,-1],[4,12,"rotate","free",0,0,0,1,-1],[4,10,"rotate","free",0,0,0,1,-1],[4,8,"rotate","free",0,0,0,1,-1],[4,9,"rotate","free",0,0,0,1,-1],[18,5,"qCompare","free",0,1.5707963267948966,0,2,-1],[18,0,"qCreate","free",1,0,0,2,94],[0,0,"qCreate","free",1,0,0,1,94]]}else if("adderB"===e){a=!0;o=[[0,5,1,2,"move",3.141592653589793,!1],[0,8,3,2,"move",3.141592653589793,!1],[5,13,0,1,"move",0,!1],[0,4,1,3,"move",3.141592653589793,!1],[0,9,3,1,"move",0,!1],[4,13,0,2,"move",0,!1],[18,4,1,3,"halt",3.141592653589793,!0],[18,9,3,1,"halt",0,!0],[14,13,2,0,"halt",Math.PI,!0],[0,3,1,3,"move",3.141592653589793,!1],[0,10,3,1,"move",0,!1],[3,13,0,2,"move",0,!1],[18,3,1,3,"halt",3.141592653589793,!0],[18,10,3,1,"halt",0,!0],[15,13,2,0,"halt",Math.PI,!0],[0,2,1,3,"move",3.141592653589793,!1],[0,11,3,1,"move",0,!1],[2,13,0,2,"move",0,!1],[18,2,1,3,"halt",3.141592653589793,!0],[18,11,3,1,"halt",0,!0],[16,13,2,0,"halt",Math.PI,!0],[0,1,1,3,"move",0,!1],[0,12,3,1,"move",3.141592653589793,!1],[18,1,1,3,"halt",0,!0],[18,12,3,1,"halt",3.141592653589793,!0],[17,13,2,0,"halt",Math.PI,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,79,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,77,-1,74,2,2,6,-1,-1,-1,-1,-1,-1,-1,78,2,2,2,76,77],l=[[13,13,"qCompare","free",0,0,0,3,-1],[18,5,"qCompare","free",0,3.141592653589793,0,2,-1],[18,8,"qCompare","free",1,3.141592653589793,0,4,-1],[0,0,"qCreate","free",1,0,0,1,95],[0,13,"qCreate","free",3,1,0,1,95],[2,13,"qCreate","free",0,0,0,0,96],[18,0,"qCreate","free",1,0,0,2,95],[18,13,"qCreate","free",3,1,0,2,95],[17,13,"qCreate","free",2,2,0,2,95]]}else if("adderC"===e){a=!0;o=[[0,5,1,2,"move",3.141592653589793,!1],[0,8,3,2,"move",3.141592653589793,!1],[5,13,0,1,"move",0,!1],[0,4,1,3,"move",3.141592653589793,!1],[0,9,3,1,"move",0,!1],[4,13,0,2,"move",0,!1],[18,4,1,3,"halt",3.141592653589793,!0],[18,9,3,1,"halt",0,!0],[14,13,2,0,"halt",0,!0],[0,3,1,3,"move",3.141592653589793,!1],[0,10,3,1,"move",0,!1],[3,13,0,2,"move",0,!1],[18,3,1,3,"halt",3.141592653589793,!0],[18,10,3,1,"halt",0,!0],[15,13,2,0,"halt",0,!0],[0,2,1,3,"move",3.141592653589793,!1],[0,11,3,1,"move",0,!1],[2,13,0,2,"move",0,!1],[18,2,1,3,"halt",3.141592653589793,!0],[18,11,3,1,"halt",0,!0],[16,13,2,0,"halt",0,!0],[0,1,1,3,"move",0,!1],[0,12,3,1,"move",3.141592653589793,!1],[18,1,1,3,"halt",0,!0],[18,12,3,1,"halt",3.141592653589793,!0],[17,13,2,0,"halt",0,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,79,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,77,-1,74,2,2,6,-1,-1,-1,-1,-1,-1,-1,78,2,2,2,76,77],l=[[13,13,"qCompare","free",0,3.141592653589793,0,3,-1],[18,5,"qCompare","free",0,3.141592653589793,0,2,-1],[18,8,"qCompare","free",1,3.141592653589793,0,4,-1],[0,0,"qCreate","free",1,0,0,1,95],[0,13,"qCreate","free",3,1,0,1,95],[2,13,"qCreate","free",0,0,0,0,96],[18,0,"qCreate","free",1,0,0,2,95],[18,13,"qCreate","free",3,1,0,2,95],[17,13,"qCreate","free",2,2,0,2,95]]}else if("measure"===e){a=!0;o=[[0,5,1,2,"move",1.5707963267948966,!1],[0,8,3,2,"move",1.5707963267948966,!1],[0,4,1,3,"move",0,!1],[0,9,3,1,"move",0,!1],[0,3,1,3,"move",0,!1],[0,10,3,1,"move",0,!1],[0,2,1,3,"move",0,!1],[0,11,3,1,"move",0,!1],[0,1,1,3,"move",1.5707963267948966,!1],[0,12,3,1,"move",1.5707963267948966,!1],[0,0,1,3,"move",1.5707963267948966,!1],[0,13,3,1,"move",1.5707963267948966,!1]],s=[[18,5,1,-1,"freeze",1,0,!0],[18,4,1,3,"halt",0,0,!0],[18,3,1,3,"halt",0,0,!0],[18,2,1,3,"halt",0,0,!0],[18,1,1,3,"halt",1,0,!0],[18,0,1,3,"halt",1,0,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[0,0,"qCreate","free",1,0,0,1,294],[0,13,"qCreate","free",3,0,0,1,294],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,0,"cCreate","free",1,0,0,2,294]]}else if("measureB"===e){a=!0;o=[[0,5,1,2,"move",0,!1],[0,4,1,3,"move",0,!1],[0,3,1,3,"move",0,!1],[0,2,1,3,"move",0,!1],[0,1,1,3,"move",0,!1],[0,0,2,3,"move",0,!1],[1,0,2,0,"move",0,!1],[2,0,2,0,"move",0,!1],[3,0,2,0,"move",1.5707963267948966,!1],[4,0,2,0,"move",1.5707963267948966,!1],[5,0,2,0,"move",1.5707963267948966,!1],[6,0,2,0,"move",1.5707963267948966,!1],[7,0,2,0,"move",0,!1],[8,0,2,0,"move",0,!1],[9,0,2,0,"move",0,!1],[10,0,2,0,"move",0,!1],[11,0,2,0,"move",0,!1],[12,0,2,0,"move",0,!1],[13,0,2,0,"move",0,!1],[14,0,2,0,"move",0,!1]],s=[[18,5,1,-1,"freeze",0,0,!0],[18,4,1,3,"halt",0,0,!0],[18,3,1,3,"halt",1,0,!0],[18,2,1,3,"halt",0,0,!0],[18,1,1,3,"halt",0,0,!0]],n=[4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,76,55,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[17,0,"qCreate","free",2,0,0,1,1580],[18,0,"cCreate","free",1,0,0,2,395],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("preDenseB"===e){a=!0;s=[[0,5,1,2,"move",1,0,!1],[0,8,3,2,"move",0,0,!1],[18,5,1,-1,"freeze",1,0,!0],[13,13,2,1,"move",0,0,!1],[0,4,1,3,"move",1,0,!1],[0,9,3,1,"move",1,0,!1],[18,4,1,3,"halt",1,0,!0],[14,13,2,0,"move",1,0,!1],[0,3,1,3,"move",1,0,!1],[0,10,3,1,"move",0,0,!1],[18,3,1,3,"halt",0,0,!0],[15,13,2,0,"move",1,0,!1],[0,2,1,3,"move",0,0,!1],[0,11,3,1,"move",1,0,!1],[18,2,1,3,"halt",0,0,!0],[16,13,2,0,"move",0,0,!1],[0,1,1,3,"move",1,0,!1],[0,12,3,1,"move",0,0,!1],[18,1,1,3,"halt",1,0,!0],[17,13,2,0,"move",0,0,!1],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",0,0,!1],[18,0,1,3,"halt",0,0,!0],[18,13,2,0,"move",0,0,!1]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,22,22,56],l=[[0,0,"cCreate","free",1,0,0,1,394],[0,13,"cCreate","free",3,1,0,1,394],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,0,"cCreate","free",1,3,0,2,394],[9,6,"qCombine","free",0,0,0,2,400],[18,13,"cCreate","free",2,2,0,1,394]]}else if("simpleDistill"===e){a=!0;h=new Entangled(3);h.setQubits([new Qubit(4,11,0,2,"halt",0),new Qubit(4,10,0,2,"halt",0),new Qubit(4,9,0,2,"halt",0)]);r=[h];s=[];n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,75,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,95,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,73,63,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,73,63,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,95,-1,73,63,3,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,2,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"qDubCompare","free",0,0,0,0,-1],[18,8,"qDubCompare","free",0,0,0,0,-1],[1,7,"qControl","free",3,1.570796326795,0,0,-1],[4,9,"qCombine","free",0,0,0,1,-1],[4,10,"qCombine","free",0,0,0,1,-1],[4,11,"qCombine","free",0,0,0,1,-1],[2,8,"qControl","free",3,0,0,0,-1],[3,8,"rotate","free",1,4.712388980385,0,0,-1],[3,8,"rotate","free",1,.785398163397,1,0,-1],[1,9,"qControl","free",3,1.570796326795,0,0,-1],[2,7,"rotate","free",1,3.14159265359,0,0,-1],[2,7,"rotate","free",1,.785398163397,1,0,-1],[2,9,"rotate","free",1,1.570796326795,0,0,-1],[2,9,"rotate","free",1,.785398163397,1,0,-1],[3,2,"qCreate","free",1,0,0,5,-1],[2,2,"qCreate","free",1,0,0,5,-1],[1,2,"qCreate","free",1,0,0,5,-1]]}else if("dense"===e){a=!0;h=new Entangled(2);h.setQubits([new Qubit(5,13,0,1,"halt",0),new Qubit(13,13,0,1,"halt",0)]);I=new Entangled(2);I.setQubits([new Qubit(4,13,0,2,"halt",0),new Qubit(14,13,0,0,"halt",0)]);E=new Entangled(2);E.setQubits([new Qubit(3,13,0,2,"halt",0),new Qubit(15,13,0,0,"halt",0)]);r=[h,I,E],s=[[0,5,1,2,"move",1,0,!1],[0,8,3,2,"move",0,0,!1],[18,5,1,-1,"freeze",1,0,!0],[18,8,3,-1,"freeze",0,0,!0],[0,4,1,3,"move",1,0,!1],[0,9,3,1,"move",0,0,!1],[18,4,1,3,"halt",1,0,!0],[18,9,3,1,"halt",0,0,!0],[0,3,1,3,"move",1,0,!1],[0,10,3,1,"move",1,0,!1],[18,3,1,3,"halt",1,0,!0],[18,10,3,1,"halt",1,0,!0],[0,2,1,3,"move",1,0,!1],[0,11,3,1,"move",1,0,!1],[18,2,1,3,"halt",1,0,!0],[18,11,3,1,"halt",1,0,!0],[0,1,1,3,"move",0,0,!1],[0,12,3,1,"move",0,0,!1],[18,1,1,3,"halt",0,0,!0],[18,12,3,1,"halt",0,0,!0],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",0,0,!1],[18,0,1,3,"halt",0,0,!0],[18,13,3,1,"halt",0,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,94,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,57,74,70,2,2,6,-1,-1,-1,-1,-1,-1,-1,3,2,2,68,76,57],
l=[[1,13,"qCreate","free",0,3,0,0,-1],[17,13,"qCreate","free",2,0,0,0,-1],[2,13,"qControl","free",0,0,0,2,-2],[16,13,"qFlip","free",0,1.5707963267948966,0,0,-2],[0,0,"cCreate","free",1,0,0,1,94],[0,13,"cCreate","free",3,1,0,1,94],[9,6,"qCombine","free",0,0,0,2,100],[18,5,"compare","free",0,.7853981633974483,0,2,-1],[18,8,"compare","free",3,.7853981633974483,0,4,-1],[18,0,"cCreate","free",1,0,0,2,94],[18,13,"cCreate","free",3,1,0,2,94]]}else if("teleport"===e){a=!0;h=new Entangled(2);h.setQubits([new Qubit(5,13,0,1,"halt",0),new Qubit(13,13,0,1,"halt",0)]);I=new Entangled(2);I.setQubits([new Qubit(4,13,0,2,"halt",0),new Qubit(14,13,0,0,"halt",0)]);E=new Entangled(2);E.setQubits([new Qubit(3,13,0,2,"halt",0),new Qubit(15,13,0,0,"halt",0)]);r=[h,I,E],o=[[0,5,1,2,"move",1*Math.PI/8,!1],[0,4,1,3,"move",5*Math.PI/8,!1],[18,4,1,3,"halt",5*Math.PI/8,!0],[0,3,1,3,"move",1.1780972450961724,!1],[18,3,1,3,"halt",1.1780972450961724,!0],[0,2,1,3,"move",-1.9634954084936214,!1],[18,2,1,3,"halt",-1.9634954084936214,!0],[0,1,1,3,"move",1.1780972450961724,!1],[18,1,1,3,"halt",1.1780972450961724,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,2,2,2,6,-1,-1,-1,-1,-1,-1,-1,3,2,2,2,2,-1],l=[[9,7,"cCombine","free",0,0,0,1,-2],[9,6,"cCombine","free",0,0,0,1,-2],[0,0,"qCreate","free",1,0,0,1,95],[18,0,"qCreate","free",1,0,0,2,95],[18,5,"qCompare","free",0,1*Math.PI/8,0,2,-2],[1,13,"qCreate","free",0,3,0,0,-1],[17,13,"qCreate","free",2,0,0,0,-1],[2,13,"qControl","free",0,0,0,2,-2],[16,13,"qFlip","free",0,Math.PI/2,0,0,-2]]}else if("distill"===e){a=!0;h=new Entangled(2);h.setQubits([new Qubit(5,13,0,1,"halt",0),new Qubit(13,13,0,1,"halt",0)]);d=new Entangled(2);d.setQubits([new Qubit(4,13,0,2,"halt",0),new Qubit(14,13,0,0,"halt",0)]);u=new Entangled(2);u.setQubits([new Qubit(3,13,0,2,"halt",0),new Qubit(15,13,0,0,"halt",0)]);c=new Entangled(2);c.setQubits([new Qubit(2,13,0,2,"halt",0),new Qubit(16,13,0,0,"halt",0)]);r=[h,d,u,c],o=[[0,5,1,2,"move",1*Math.PI/8,!1],[0,4,1,3,"move",5*Math.PI/8,!1],[18,4,1,3,"halt",5*Math.PI/8,!0],[0,3,1,3,"move",1.1780972450961724,!1],[18,3,1,3,"halt",1.1780972450961724,!0],[0,2,1,3,"move",-1.9634954084936214,!1],[18,2,1,3,"halt",-1.9634954084936214,!0],[0,1,1,3,"move",1.1780972450961724,!1],[18,1,1,3,"halt",1.1780972450961724,!0]],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,85,70,2,2,6,-1,-1,-1,-1,-1,-1,-1,3,2,2,68,76,-1],l=[[0,0,"qCreate","free",1,0,0,1,15],[18,0,"qCreate","free",1,0,0,2,15],[18,5,"qCompare","free",0,.39269908169872414,0,2,-2],[17,13,"qCreate","free",2,0,0,0,-1],[2,13,"qControl","free",0,0,0,2,-2],[16,13,"qFlip","free",0,1.5707963267948966,0,0,-2],[9,6,"cCombine","free",0,0,0,1,-2],[9,7,"cCombine","free",0,0,0,1,-2],[1,13,"upgrade","free",0,.39269908169872414,0,1,-1],[0,13,"cCreate","free",0,0,0,0,-1]]}else if("vaziraniQuantum"===e){a=!0;s=[[18,4,1,-1,"halt",0,0,!0],[18,3,1,-1,"halt",0,0,!0],[18,2,1,-1,"move",0,0,!0]],o=[],n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,64,2,2,2,2,2,2,5,-1,4,64,-1,-1,-1,21,-1,-1,-1,-1,64,2,2,2,5,-1,4,11,2,11,64,-1,-1,-1,21,-1,-1,-1,-1,64,5,-1,4,11,2,11,11,2,11,64,-1,-1,-1,21,-1,-1,-1,-1,-1,3,70,6,3,70,6,3,70,6,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,64,68,2,2,68,2,2,68,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[4,4,"qCombine","free",0,0,0,2,1],[4,3,"qCombine","free",0,0,0,2,1],[4,2,"qCombine","free",0,0,0,2,1],[5,6,"qCombine","free",0,0,0,2,1],[13,6,"qCombine","free",0,0,0,2,1],[14,4,"qCombine","free",0,0,0,2,1],[14,3,"qCombine","free",0,0,0,2,1],[14,2,"qCombine","free",0,0,0,2,1],[6,5,"qControl","free",0,0,0,0,-1],[9,5,"qControl","free",0,0,0,0,-1],[12,5,"qControl","free",0,0,0,0,-1],[6,6,"qFlip","free",0,1.5707963267948966,0,0,-1],[6,6,"qFlip","free",0,1.5707963267948966,1,0,-1],[9,6,"qFlip","free",0,1.5707963267948966,0,0,-1],[9,6,"qFlip","free",0,1.5707963267948966,1,0,-1],[12,6,"qFlip","free",0,1.5707963267948966,0,0,-1],[12,6,"qFlip","free",0,1.5707963267948966,1,0,-1],[18,5,"compare","free",0,.7853981633974483,0,0,-1]]}else if("quantumAdv1"===e){a=!0;s=[[18,5,1,-1,"freeze",0,0,!0]];for(var f=[[0,5],[0,4],[0,3],[0,2],[0,1],[0,0],[1,0],[2,0],[3,0],[4,0]],S=[2,3,3,3,3,3,0,0,0,0],p=[[0,8],[0,9],[0,10],[0,11],[0,12],[0,13],[1,13],[2,13],[3,13],[4,13]],T=[2,1,1,1,1,1,0,0,0,0],R=(r=[],0);R<10;R++){var m=new Entangled(2);m.setQubits([new Qubit(f[R][0],f[R][1],0,S[R],"halt",0),new Qubit(p[R][0],p[R][1],0,T[R],"halt",0)]),r.push(m)}n=[4,2,2,2,2,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,2,2,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[6,3,"cCombine","free",0,0,0,1,-1],[6,10,"cCombine","free",0,0,0,1,-1],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("quantumAdv2"===e){a=!0;for(s=[[18,5,1,-1,"freeze",0,0,!0]],f=[[0,5],[0,4],[0,3],[0,2],[0,1],[0,0],[1,0],[2,0],[3,0],[4,0],[5,0]],S=[2,3,3,3,3,3,0,0,0,0,0],p=[[0,8],[0,9],[0,10],[0,11],[0,12],[0,13],[1,13],[2,13],[3,13],[4,13],[5,13]],T=[2,1,1,1,1,1,0,0,0,0,0],r=[],R=0;R<11;R++){m=new Entangled(2);m.setQubits([new Qubit(f[R][0],f[R][1],0,S[R],"halt",0),new Qubit(p[R][0],p[R][1],0,T[R],"halt",0)]),r.push(m)}n=[4,2,2,2,2,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,2,2,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","free",0,.7853981633974483,0,2,-1],[6,3,"cCombine","free",0,0,0,1,-1],[6,10,"cCombine","free",0,0,0,1,-1],[1,10,"rotate","free",1,.7853981633974483,1,0,-1]]}else if("quantumAdv3"===e){a=!0;for(s=[[18,5,1,-1,"freeze",0,0,!0]],f=[[0,5],[0,4],[0,3],[0,2],[0,1],[0,0],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0]],S=[2,3,3,3,3,3,0,0,0,0,0,0],p=[[0,8],[0,9],[0,10],[0,11],[0,12],[0,13],[1,13],[2,13],[3,13],[4,13],[5,13],[6,13]],T=[2,1,1,1,1,1,0,0,0,0,0,0],r=[],R=0;R<12;R++){m=new Entangled(2);m.setQubits([new Qubit(f[R][0],f[R][1],0,S[R],"halt",0),new Qubit(p[R][0],p[R][1],0,T[R],"halt",0)]),r.push(m)}n=[4,2,2,2,2,2,2,10,-1,20,-1,-1,-1,-1,-1,-1,-1,-1,29,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,5,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,2,2,2,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","free",0,.7853981633974483,0,2,-1],[1,10,"rotate","free",1,.7853981633974483,1,0,-1]]}else if("entChallengeA"===e){a=!0;s=[[18,5,1,-1,"freeze",0,0,!0],[18,4,1,3,"halt",0,0,!0],[18,3,1,3,"halt",0,0,!0],[18,2,1,3,"halt",0,0,!0],[18,1,1,3,"halt",0,0,!0],[18,0,1,3,"halt",0,0,!0]],n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,25,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,64,60,84,23,52,22,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,42,25,24,42,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,40,26,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,64,60,84,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,26,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","free",0,.7853981633974483,0,2,-1],[17,6,"trash","free",0,.7853981633974483,0,0,-1],[16,6,"switch","free",2,1,0,1,-1],[16,5,"cInvert","free",0,1,0,0,-1],[16,5,"cInvert","free",0,0,1,0,-1],[14,5,"trash","free",0,.7853981633974483,0,0,-1],[14,8,"trash","free",0,.7853981633974483,0,0,-1],[13,6,"switch","free",2,0,0,1,-1],[13,7,"switch","free",0,0,0,1,-1],[13,5,"measure","free",0,0,0,0,-1],[13,5,"measure","free",0,1.57079632679,1,0,-1],[13,8,"measure","free",0,0,0,0,-1],[13,8,"measure","free",0,1.57079632679,1,0,-1],[12,6,"trash","free",0,.7853981633974483,0,0,-1],[12,7,"cCreate","free",0,2,0,0,-1],[12,5,"qCombine","free",0,0,0,1,-1],[12,8,"qCombine","free",0,0,0,1,-1],[18,0,"cCreate","free",1,0,0,2,94]]}else if("entChallengeB"===e){a=!0;s=[[18,5,1,-1,"freeze",0,0,!0]],h=new Entangled(4);h.setQubits([new Qubit(2,4,0,2,"halt",0),new Qubit(2,5,0,2,"halt",0),new Qubit(2,8,0,2,"halt",0),new Qubit(2,9,0,2,"halt",0)]);d=new Entangled(4);d.setQubits([new Qubit(1,4,0,2,"halt",0),new Qubit(1,5,0,2,"halt",0),new Qubit(1,8,0,2,"halt",0),new Qubit(1,9,0,2,"halt",0)]);u=new Entangled(4);u.setQubits([new Qubit(1,3,0,3,"halt",0),new Qubit(0,5,0,2,"halt",0),new Qubit(0,8,0,2,"halt",0),new Qubit(1,10,0,1,"halt",0)]);c=new Entangled(4);c.setQubits([new Qubit(1,2,0,3,"halt",0),new Qubit(0,4,0,3,"halt",0),new Qubit(0,9,0,1,"halt",0),new Qubit(1,11,0,1,"halt",0)]);I=new Entangled(4);I.setQubits([new Qubit(1,1,0,3,"halt",0),new Qubit(0,3,0,3,"halt",0),new Qubit(0,10,0,1,"halt",0),new Qubit(1,12,0,1,"halt",0)]);E=new Entangled(4);E.setQubits([new Qubit(2,1,0,0,"halt",0),new Qubit(0,2,0,3,"halt",0),new Qubit(0,11,0,1,"halt",0),new Qubit(2,12,0,0,"halt",0)]);var g=new Entangled(4);g.setQubits([new Qubit(2,2,0,1,"halt",0),new Qubit(0,1,0,3,"halt",0),new Qubit(0,12,0,1,"halt",0),new Qubit(2,11,0,3,"halt",0)]);var A=new Entangled(4);A.setQubits([new Qubit(2,3,0,1,"halt",0),new Qubit(0,0,0,3,"halt",0),new Qubit(0,13,0,1,"halt",0),new Qubit(2,10,0,3,"halt",0)]);r=[h,d,u,c,I,E,g,A],n=[9,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,1,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,1,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,3,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,2,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,4,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[2,8,"qCombine","free",0,0,0,1,-1],[2,5,"qCombine","free",0,0,0,1,-1],[2,9,"qCombine","free",0,0,0,1,-1],[2,4,"qCombine","free",0,0,0,1,-1],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("entChallengeC"===e){a=!0;s=[[18,5,1,-1,"freeze",0,0,!0]],h=new Entangled(4);h.setQubits([new Qubit(2,4,0,2,"halt",0),new Qubit(2,5,0,2,"halt",0),new Qubit(2,8,0,2,"halt",0),new Qubit(2,9,0,2,"halt",0)]);d=new Entangled(4);d.setQubits([new Qubit(1,4,0,2,"halt",0),new Qubit(1,5,0,2,"halt",0),new Qubit(1,8,0,2,"halt",0),new Qubit(1,9,0,2,"halt",0)]);u=new Entangled(4);u.setQubits([new Qubit(1,3,0,3,"halt",0),new Qubit(0,5,0,2,"halt",0),new Qubit(0,8,0,2,"halt",0),new Qubit(1,10,0,1,"halt",0)]);c=new Entangled(4);c.setQubits([new Qubit(1,2,0,3,"halt",0),new Qubit(0,4,0,3,"halt",0),new Qubit(0,9,0,1,"halt",0),new Qubit(1,11,0,1,"halt",0)]);I=new Entangled(4);I.setQubits([new Qubit(1,1,0,3,"halt",0),new Qubit(0,3,0,3,"halt",0),new Qubit(0,10,0,1,"halt",0),new Qubit(1,12,0,1,"halt",0)]);E=new Entangled(4);E.setQubits([new Qubit(2,1,0,0,"halt",0),new Qubit(0,2,0,3,"halt",0),new Qubit(0,11,0,1,"halt",0),new Qubit(2,12,0,0,"halt",0)]);g=new Entangled(4);g.setQubits([new Qubit(2,2,0,1,"halt",0),new Qubit(0,1,0,3,"halt",0),new Qubit(0,12,0,1,"halt",0),new Qubit(2,11,0,3,"halt",0)]);A=new Entangled(4);A.setQubits([new Qubit(2,3,0,1,"halt",0),new Qubit(0,0,0,3,"halt",0),new Qubit(0,13,0,1,"halt",0),new Qubit(2,10,0,3,"halt",0)]);r=[h,d,u,c,I,E,g,A],n=[9,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,1,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,1,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,3,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,2,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,4,64,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[2,8,"qCombine","free",0,0,0,1,-1],[2,5,"qCombine","free",0,0,0,1,-1],[2,9,"qCombine","free",0,0,0,1,-1],[2,4,"qCombine","free",0,0,0,1,-1],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("extraA"===e){a=!0;o=[[0,5,1,2,"move",-1.5707963267948966,!1],[18,4,1,3,"halt",-1.5707963267948966,!0],[18,9,3,1,"halt",-1.5707963267948966,!0],[0,4,1,3,"move",-1.5707963267948966,!1],[18,3,1,3,"halt",-1.5707963267948966,!0],[18,10,3,1,"halt",-1.5707963267948966,!0],[0,3,1,3,"move",-1.5707963267948966,!1],[18,2,1,3,"halt",-1.5707963267948966,!0],[18,11,3,1,"halt",-1.5707963267948966,!0],[0,2,1,3,"move",-1.5707963267948966,!1],[18,1,1,3,"halt",3.141592653589793,!0],[18,12,3,1,"halt",3.141592653589793,!0],[0,1,1,3,"move",3.141592653589793,!1],[18,0,0,3,"halt",3.141592653589793,!0],[18,13,0,1,"halt",3.141592653589793,!0],[0,0,2,3,"move",3.141592653589793,!1],[17,0,0,2,"halt",3.141592653589793,!0],[17,13,0,2,"halt",3.141592653589793,!0],[1,0,2,0,"move",3.141592653589793,!1],[16,0,0,2,"halt",3.141592653589793,!0],[16,13,0,2,"halt",3.141592653589793,!0],[2,0,2,0,"move",3.141592653589793,!1]],s=[],n=[4,2,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,74,2,5,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,79,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,74,2,6],l=[[18,5,"qCompare","free",0,-1.570796326795,0,2,-1],[18,8,"qCompare","free",1,-1.570796326795,0,4,-1],[16,0,"qCreate","free",0,0,0,2,492],[16,13,"qCreate","free",0,0,0,2,492],[2,0,"qCreate","free",2,0,0,1,492]]}else if("extraB"===e){a=!0;h=new Entangled(2);h.setQubits([new Qubit(5,13,0,1,"halt",0),new Qubit(13,13,0,1,"halt",0)]);d=new Entangled(2);d.setQubits([new Qubit(4,13,0,2,"halt",0),new Qubit(14,13,0,0,"halt",0)]);u=new Entangled(2);u.setQubits([new Qubit(3,13,0,2,"halt",0),new Qubit(15,13,0,0,"halt",0)]);c=new Entangled(2);c.setQubits([new Qubit(2,13,0,2,"halt",0),new Qubit(16,13,0,0,"halt",0)]);r=[h,d,u,c],n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,46,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,46,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,46,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,46,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,46,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,46,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,85,70,2,2,6,-1,-1,-1,-1,-1,-1,-1,3,2,2,68,76,-1],l=[[0,5,"qDubCompare","free",0,2,0,1,-1],[18,5,"qDubCompare","free",0,0,0,1,-1],[17,13,"qCreate","free",2,0,0,0,496],[2,13,"qControl","free",0,0,0,2,-2],[16,13,"qFlip","free",0,1.570796326795,0,0,-2],[1,13,"upgrade","free",0,.39269908169,0,1,-1],[0,13,"cCreate","free",0,0,0,0,496],[9,12,"cInvert","free",0,1,0,0,-1],[9,11,"cInvert","free",0,1,0,0,-1],[9,10,"cInvert","free",0,1,0,0,-1],[9,9,"cInvert","free",0,1,0,0,-1],[9,8,"cInvert","free",0,1,0,0,-1],[9,7,"cInvert","free",0,1,0,0,-1],[9,6,"cInvert","free",0,1,0,0,-1],[9,5,"cInvert","free",0,1,0,0,-1],[9,4,"cInvert","free",0,1,0,0,-1],[9,3,"cInvert","free",0,1,0,0,-1],[9,2,"cInvert","free",0,1,0,0,-1],[9,1,"cInvert","free",0,1,0,0,-1]]}else if("extraC"===e){a=!0;o=[],s=[[18,5,1,4,"move",0,0,!0],[0,5,1,2,"move",0,0,!1],[0,8,3,2,"move",1,0,!1],[18,4,1,3,"halt",1,0,!0],[0,4,1,3,"move",1,0,!1],[0,9,3,1,"move",1,0,!1],[18,3,1,3,"halt",0,0,!0],[0,3,1,3,"move",1,0,!1],[0,10,3,1,"move",1,0,!1],[18,2,1,3,"halt",0,0,!0],[0,2,1,3,"move",1,0,!1],[0,11,3,1,"move",0,0,!1],[18,1,1,3,"halt",0,0,!0],[18,0,0,3,"halt",1,0,!0],[17,0,0,2,"halt",1,0,!0],[16,0,0,2,"halt",0,0,!0]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,22,22,22,22,25,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","free",0,.785398163397,0,2,-1],[13,0,"cCreate","free",0,2,0,2,0],[0,0,"cCreate","free",1,0,0,1,0],[0,13,"cCreate","free",3,1,0,1,0]]}else if("binaryencode"===e){a=!0;o=[],s=[[0,5,1,2,"move",0,0,!1],[18,5,1,-1,"freeze",0,0,!0],[0,4,1,3,"halt",0,0,!1],[18,4,1,3,"halt",2,0,!0],[0,3,1,3,"halt",0,0,!1],[18,3,1,3,"halt",1,0,!0],[0,2,1,3,"halt",0,0,!1],[18,2,1,3,"halt",3,0,!0],[0,1,1,3,"halt",0,0,!1],[0,0,1,3,"halt",0,0,!1]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","free",0,.785398163397,0,2,-1],[0,0,"cCreate","free",1,0,0,1,20],[18,0,"cCreate","free",1,1,0,2,-1]]}else if("adder"===e){a=!0;o=[],s=[[18,5,1,4,"move",1,0,!0],[0,5,1,2,"move",1,0,!1],[0,8,3,2,"move",0,0,!1],[18,4,1,3,"halt",1,0,!0],[0,4,1,3,"move",0,0,!1],[0,9,3,1,"move",1,0,!1],[18,3,1,3,"halt",1,0,!0],[0,3,1,3,"move",0,0,!1],[0,10,3,1,"move",1,0,!1],[18,2,1,3,"halt",0,0,!0],[0,2,1,3,"move",1,0,!1],[0,11,3,1,"move",1,0,!1],[18,1,1,3,"halt",1,0,!0],[0,1,1,3,"move",0,0,!1],[0,12,3,1,"move",0,0,!1],[18,0,1,3,"halt",1,0,!0],[0,0,1,3,"move",0,0,!1],[0,13,3,1,"move",1,0,!1]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","transform",0,.785398163397,0,2,-1],[18,0,"cCreate","free",1,2,0,2,58],[0,0,"cCreate","free",1,0,0,1,58],[0,13,"cCreate","free",3,1,0,1,58]]}else if("extraD"===e){a=!0;o=[],s=[[18,5,1,4,"move",1,0,!0],[0,8,3,2,"move",1,0,!1],[0,5,1,2,"move",0,0,!1],[0,9,3,1,"move",1,0,!1],[0,4,1,3,"move",0,0,!1],[0,10,3,1,"move",0,0,!1],[0,3,1,3,"move",0,0,!1],[0,11,3,1,"move",0,0,!1],[0,2,1,3,"move",1,0,!1],[0,12,3,1,"move",1,0,!1],[0,1,1,3,"move",0,0,!1],[0,13,3,1,"move",1,0,!1],[0,0,1,3,"move",1,0,!1]],n=[55,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,55,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,23,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[18,5,"compare","transform",0,.785398163397,0,2,-1],[0,13,"cCreate","free",3,1,0,1,9],[0,0,"cCreate","free",1,0,0,1,100],[18,0,"cCreate","free",1,2,0,2,0]]}else if("chsh"===e){a=!0;h=new Entangled(2);h.setQubits([new Qubit(5,13,0,1,"halt",0),new Qubit(13,13,0,1,"halt",0)]);I=new Entangled(2);I.setQubits([new Qubit(4,13,0,2,"halt",0),new Qubit(14,13,0,0,"halt",0)]);E=new Entangled(2);E.setQubits([new Qubit(3,13,0,2,"halt",0),new Qubit(15,13,0,0,"halt",0)]);r=[h,I,E],n=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,43,53,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,53,41,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,22,22,22,26,21,23,22,22,22,22,25,-1,-1,-1,-1,-1,-1,21,-1,84,-1,-1,-1,53,84,-1,-1,84,-1,21,-1,-1,-1,-1,-1,-1,47,22,61,-1,-1,-1,53,41,-1,-1,61,22,47,-1,-1,-1,-1,-1,-1,21,-1,1,84,-1,24,26,21,-1,84,1,-1,21,-1,-1,-1,-1,-1,84,60,2,67,41,-1,21,-1,21,-1,43,67,2,60,84,-1,-1,-1,-1,-1,-1,-1,1,23,22,51,-1,51,22,26,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,90,-1,90,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,57,-1,57,-1,-1,1,-1,-1,-1,-1,-1,-1,74,70,2,2,6,-1,-1,-1,-1,-1,-1,-1,3,2,2,68,76,-1],l=[[2,13,"qControl","free",0,0,0,2,-2],[16,13,"qFlip","free",0,1.570796326795,0,0,-2],[1,13,"qCreate","free",0,3,0,0,-1],[17,13,"qCreate","free",2,0,0,0,-1],[8,12,"cCreate","free",3,2,0,0,-1],[10,12,"cCreate","free",3,2,0,0,-1],[5,6,"trash","free",0,.785398163397,0,0,-1],[3,7,"cCombine","free",3,0,0,0,-1],[5,7,"measure","free",1,0,0,0,-1],[2,9,"trash","free",0,.785398163397,0,0,-1],[3,9,"measure","free",0,0,0,0,-1],[5,9,"qCombine","free",3,0,0,0,-1],[5,9,"qCombine","free",2,0,1,0,-1],[6,9,"switch","free",1,0,0,1,-1],[13,6,"trash","free",0,.785398163397,0,0,-1],[13,7,"measure","free",1,0,0,0,-1],[15,7,"cCombine","free",3,0,0,0,-1],[12,9,"switch","free",3,0,0,1,-1],[13,9,"qCombine","free",3,0,0,0,-1],[13,9,"qCombine","free",0,0,1,0,-1],[15,9,"measure","free",0,0,0,0,-1],[16,9,"trash","free",0,.785398163397,0,0,-1],[8,11,"delay","free",1,0,0,4,-1],[10,11,"delay","free",1,0,0,4,-1],[8,10,"cSplit","free",3,0,0,0,-1],[10,10,"cSplit","free",3,0,0,0,-1],[12,8,"trash","free",0,.785398163397,0,0,-1],[6,8,"trash","free",0,.785398163397,0,0,-1],[9,7,"cInvert","free",1,0,0,1,-1],[9,7,"cInvert","free",1,1,1,1,-1],[10,7,"switch","free",1,0,0,1,-1],[10,6,"trash","free",0,.785398163397,0,0,-1],[10,4,"switch","free",1,1,0,1,-1],[8,3,"switch","free",3,1,0,1,-1],[10,3,"trash","free",0,.785398163397,0,0,-1],[8,2,"trash","free",0,.785398163397,0,0,-1],[9,4,"cInvert","free",1,1,0,0,-1],[9,4,"cInvert","free",1,0,1,0,-1],[9,3,"cInvert","free",1,1,0,0,-1],[9,3,"cInvert","free",1,0,1,0,-1],[9,6,"cInvert","free",1,0,0,0,-1],[10,1,"cOneCompare","free",0,0,0,0,0]]}else if("freeA"===e){a=!0;o=[],s=[],n=[4,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,76,55,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,91,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],l=[[17,0,"qCreate","free",2,0,0,1,1580],[18,0,"cCreate","free",1,0,0,2,395],[18,5,"compare","free",0,.7853981633974483,0,2,-1]]}else if("freeB"===e){a=!0;h=new Entangled(2);h.setQubits([new Qubit(5,13,0,1,"halt",0),new Qubit(13,13,0,1,"halt",0)]);d=new Entangled(2);d.setQubits([new Qubit(4,13,0,2,"halt",0),new Qubit(14,13,0,0,"halt",0)]);u=new Entangled(2);u.setQubits([new Qubit(3,13,0,2,"halt",0),new Qubit(15,13,0,0,"halt",0)]);c=new Entangled(2);c.setQubits([new Qubit(2,13,0,2,"halt",0),new Qubit(16,13,0,0,"halt",0)]);r=[h,d,u,c],n=[75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,78,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,44,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,2,2,2,6,-1,-1,-1,-1,-1,-1,-1,3,2,2,2,2,-1],l=[[0,5,"qDubCompare","free",0,2,0,1,-1],[18,5,"qDubCompare","free",0,0,0,1,-1],[2,13,"qControl","free",0,0,0,2,-2],[16,13,"qFlip","free",0,Math.PI/2,0,0,-2],[1,13,"qCreate","free",0,3,0,0,-1],[17,13,"qCreate","free",2,0,0,0,-1]]}else if("freeC"===e){a=!0;s=[],o=[],n=new Array(266).fill(-1),l=[]}return!!a&&{tiles:n,allBits:s,allQubits:o,allGates:l,entGroups:r}}function LevelRefresh(e,t){if(["tut1","tut3","tut4"].indexOf(e)>=0){for(var i=0;i<6;i++){var a=Math.round(Math.random());t.getBit(18,8+i).value=1-a,t.getBit(0,5-i).value=1-a}for(i=0;i<5;i++){a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,9+i).setPolarize(a),t.getQubit(18,4-i).setPolarize(a)}a=Math.PI*Math.floor(16*Math.random())/8;return t.getQubit(0,8).setPolarize(a),void(t.getGate(18,5,0).rot=a)}if("tut2"===e){for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(18,8+i).value=a,t.getBit(0,5-i).value=1-a}for(i=0;i<5;i++){a=Math.floor(16*Math.random());t.getQubit(0,9+i).setPolarize(Math.PI*a/8),t.getQubit(18,4-i).setPolarize(Math.PI*(a-4)/8)}a=Math.PI*Math.floor(16*Math.random())/8;return t.getQubit(0,8).setPolarize(Math.PI*a/8),void(t.getGate(18,5,0).rot=Math.PI*(a-4)/8)}if("tut5"===e){for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(0,5-i).value=1-a}for(i=0;i<5;i++){a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,9+i).setPolarize(a)}a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,8).setPolarize(a)}else if("tut6"===e){for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(0,5-i).value=a}for(var r=0;r<6;r++){var s=t.getBit(0,5-r).value;t.getBit(18,5-r).value=s,t.getBit(18,5-r).value=r%4==3?1-s:s,r%2==1&&1===t.getBit(18,5-r).value&&(t.getBit(18,6-r).value=1-t.getBit(18,6-r).value)}}else if("class1"===e)for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(18,5-i).value=1,t.getBit(0,5-i).value=a}else if("class2"===e){for(a=[],i=0;i<6;i++)a.push(Math.round(Math.random())),t.getBit(18,5-i).value=a[i],t.getBit(18,8+i).value=a[i];t.getBit(0,5).value=a[0],t.getBit(0,8).value=a[1],t.getBit(0,1).value=a[2],t.getBit(0,12).value=a[3],t.getBit(1,0).value=a[4],
t.getBit(1,13).value=a[5]}else if("class3"===e){for(a=[],i=0;i<6;i++)a.push(Math.round(Math.random()));var o=[0,1,0,1,0,1].sort((e,t)=>.5-Math.random()),n=0,l=0;for(i=0;i<6;i++)t.getBit(0,5-i).value=o[i],t.getBit(0,8+i).value=a[i],0===o[i]?(t.getBit(18,5-n).value=a[i],n+=1):(t.getBit(18,8+l).value=a[i],l+=1)}else if("class4"===e){for(a=[],i=0;i<6;i++)a.push(Math.round(Math.random())),t.getBit(18,5-i).value=a[i];t.getBit(0,4).value=a[0],t.getBit(0,8).value=a[1],t.getBit(0,2).value=a[2],t.getBit(0,12).value=a[3],t.getBit(0,0).value=a[4],t.getBit(1,13).value=a[5]}else if("class5"===e){for(a=[],o=[],i=0;i<6;i++)a.push(Math.round(Math.random())),o.push(Math.round(Math.random())),t.getBit(18,5-i).value=a[i],t.getBit(0,5-i).value=a[i],t.getBit(0,8+i).value=o[i];for(i=0;i<6;i++)SCENARIO.CINPUTS[2][6+i]=o[i]}else if("class7"===e){for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(18,5-i).value=a,t.getBit(0,5-i).value=a}a=Math.round(Math.random());t.getBit(17,0).value=a,t.getBit(1,0).value=a;a=Math.round(Math.random());t.getBit(16,0).value=a,t.getBit(2,0).value=a;for(i=0;i<6;i++){o=Math.round(Math.random());t.getBit(18,8+i).value=o,t.getBit(3+i,0).value=o}}else if("classPuzzle1"===e)for(i=0;i<6;i++){a=Math.round(Math.random()),o=Math.round(Math.random());t.getBit(18,5-i).value=a,t.getBit(0,5-i).value=a,t.getBit(18,8+i).value=o,t.getBit(0,8+i).value=o}else if("classPuzzle2"===e)for(i=0;i<6;i++){a=Math.round(Math.random()),o=Math.round(Math.random());t.getBit(0,5-i).value=a,t.getBit(0,8+i).value=o,t.getBit(18,5-i).value=(a+o)%2,t.getBit(18,8+i).value=o&&a}else if("classPuzzle3"===e)for(i=0;i<6;i++){a=Math.round(Math.random()),o=Math.round(Math.random());t.getBit(0,5-i).value=a,t.getBit(0,8+i).value=o,t.getBit(18,8+i).value=o&&a}else if("classPuzzle3B"===e)for(i=0;i<6;i++){a=Math.round(Math.random()),o=Math.round(Math.random());t.getBit(0,5-i).value=a,t.getBit(0,8+i).value=o,t.getBit(18,8+i).value=(o+a)%2}else if("classPuzzle4"===e){var h=0;for(i=0;i<5;i++){a=Math.round(Math.random());t.getBit(0,5-i).value=a,t.getBit(18,5-i).value=Math.abs(a-h),h=a}t.getBit(0,0).value=0,t.getBit(18,0).value=a}else if("classPuzzle5"===e){for(a=[],i=0;i<6;i++)a.push(Math.round(Math.random())),t.getBit(0,5-i).value=a[i];t.getBit(18,5).value=a[0],t.getBit(18,4).value=a[1],t.getBit(18,3).value=a[3],t.getBit(18,2).value=a[4],t.getBit(18,8).value=a[2],t.getBit(18,9).value=a[5]}else if("classPuzzle6"===e)for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(0,5-i).value=a,t.getBit(18,5-i).value=a}else if("classPuzzle7"===e)for(i=0;i<6;i++){a=Math.round(Math.random()),o=Math.round(Math.random());t.getBit(0,5-i).value=a,t.getBit(0,8+i).value=o,t.getBit(18,5-i).value=o,t.getBit(18,8+i).value=a}else if("classPuzzle8"===e){for(var d=[],u=0;u<8;u++)d.push(Math.round(Math.random()));var c=[...d],I=Math.round(Math.random());if(0===I){var E=Math.floor(8*Math.random()),f=Math.floor(8*Math.random());Math.round(Math.random())?c[E]=1-c[E]:(c[E]=1-c[E],E!==f&&(c[f]=1-c[f]))}t.getBit(0,5).value=d[0],t.getBit(0,4).value=d[1],t.getBit(0,3).value=d[2],t.getBit(0,2).value=d[3],t.getBit(0,1).value=d[4],t.getBit(0,0).value=d[5],t.getBit(1,0).value=d[6],t.getBit(2,0).value=d[7],t.getBit(0,8).value=c[0],t.getBit(0,9).value=c[1],t.getBit(0,10).value=c[2],t.getBit(0,11).value=c[3],t.getBit(0,12).value=c[4],t.getBit(0,13).value=c[5],t.getBit(1,13).value=c[6],t.getBit(2,13).value=c[7],t.getBit(18,5).value=0+I}else if("classPuzzle9"===e){for(I=Math.round(Math.random()),d=[],u=0;u<10;u++)d.push(Math.round(Math.random()));if(0===I){var S=0;for(r=0;r<10;r++)1===d[r]?S+=1:S=0,4===S&&(d[r]=0,S=0)}else if(1===I){var p=Math.floor(7*Math.random());d[p]=1,d[p+1]=1,d[p+2]=1,d[p+3]=1}t.getBit(0,5).value=d[0],t.getBit(0,4).value=d[1],t.getBit(0,3).value=d[2],t.getBit(0,2).value=d[3],t.getBit(0,1).value=d[4],t.getBit(0,0).value=d[5],t.getBit(1,0).value=d[6],t.getBit(2,0).value=d[7],t.getBit(3,0).value=d[8],t.getBit(4,0).value=d[9],t.getBit(18,5).value=0+I}else if("vaziraniClassic"===e){var T=Math.round(Math.random()),R=Math.round(Math.random()),m=Math.round(Math.random());t.getGate(6,6,1).rot=T,t.getGate(9,6,1).rot=R,t.getGate(12,6,1).rot=m,t.getBit(18,4).value=1-T,t.getBit(18,3).value=1-R,t.getBit(18,2).value=1-m}else if("quant1"===e){for(i=0;i<5;i++){a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,4-i).setPolarize(a),t.getQubit(18,4-i).setPolarize(a);o=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,9+i).setPolarize(o),t.getQubit(18,9+i).setPolarize(o)}a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,5).setPolarize(a),t.getGate(18,5,0).rot=a;o=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,8).setPolarize(o),t.getGate(18,8,0).rot=o}else if("quant2"===e){for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(18,5-i).value=a,t.getBit(0,5-i).value=a}for(i=0;i<5;i++){a=Math.PI*(4+8*Math.round(Math.random()))/8;t.getQubit(0,9+i).setPolarize(a),t.getQubit(18,9+i).setPolarize(a)}a=Math.PI*(4+8*Math.round(Math.random()))/8;t.getQubit(0,8).setPolarize(a),t.getGate(18,8,0).rot=a}else if("quant3A"===e);else if("quant3"===e){for(i=0;i<5;i++){a=Math.PI*(4*Math.round(Math.random()))/8;t.getQubit(0,4-i).setPolarize(a),t.getQubit(18,4-i).setPolarize(a)}a=Math.PI*(4*Math.round(Math.random()))/8;t.getQubit(0,5).setPolarize(a),t.getGate(18,5,0).rot=a}else if("quant4"===e)for(i=0;i<6;i++){a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,5-i).setPolarize(a)}else if("quant5"===e||"quant6"===e){for(a=[],o=[],i=0;i<6;i++)a.push(8*Math.round(Math.random())),t.getQubit(0,5-i).setPolarize(Math.PI*a[i]/8),o.push(4*Math.round(Math.random())),t.getQubit(0,8+i).setPolarize(Math.PI*o[i]/8);for(i=1;i<6;i++)t.getQubit(18,5-i).setPolarize(Math.PI*(a[i]+o[i])/8);t.getGate(18,5,0).rot=Math.PI*(a[0]+o[0])/8}else if("quant6B"===e){SCENARIO.QINPUTS=[[],[],[],[]],SCENARIO.CINPUTS=[[],[],[]];for(r=0;r<96;r++){s=Math.floor(16*Math.random());var g=Math.floor(16*Math.random());SCENARIO.QINPUTS[0].push(s),SCENARIO.QINPUTS[1].push(g),SCENARIO.QINPUTS[2].push(s+5),SCENARIO.QINPUTS[3].push(16-g)}for(i=1;i<6;i++){s=Math.floor(16*Math.random());t.getQubit(0,5-i).setPolarize((s+5)*Math.PI/8),t.getQubit(18,5-i).setPolarize(s*Math.PI/8),t.getQubit(0,5-i).rotateBasis(0),t.getQubit(0,5-i).lockedBasis=!0}s=Math.floor(16*Math.random());t.getGate(18,5).rot=s*Math.PI/8,t.getQubit(0,5).setPolarize((s+5)*Math.PI/8),t.getQubit(0,5).rotateBasis(0),t.getQubit(0,5).lockedBasis=!0;for(i=9;i<14;i++){g=Math.floor(16*Math.random());t.getQubit(18,i).setPolarize(g*Math.PI/8),t.getQubit(0,i).setPolarize((16-g)*Math.PI/8),t.getQubit(0,i).rotateBasis(Math.PI/2),t.getQubit(0,i).lockedBasis=!0}g=Math.floor(16*Math.random());t.getGate(18,8).rot=g*Math.PI/8,t.getQubit(0,8).setPolarize((16-g)*Math.PI/8),t.getQubit(0,8).rotateBasis(Math.PI/2),t.getQubit(0,8).lockedBasis=!0}else if("quant7"===e)for(i=0;i<6;i++)t.getQubit(0,5-i).rotateBasis(0),t.getQubit(0,5-i).lockedBasis=!0;else if("quantChallengeA"===e){for(i=0;i<5;i++){a=4+8*Math.round(Math.random()),o=16-a;t.getQubit(0,4-i).setPolarize(Math.PI*a/8),t.getQubit(18,4-i).setPolarize(Math.PI*o/8)}a=4+8*Math.round(Math.random()),o=16-a;t.getQubit(0,5).setPolarize(Math.PI*a/8),t.getGate(18,5,0).rot=Math.PI*o/8}else if("quantChallengeB"===e){for(i=0;i<5;i++){a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,4-i).setPolarize(a),t.getQubit(0,4-i).lockedBasis=!0,t.getQubit(18,4-i).setPolarize(a);o=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,9+i).setPolarize(o),t.getQubit(0,9+i).lockedBasis=!0,t.getQubit(18,9+i).setPolarize(o)}a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,5).setPolarize(a),t.getQubit(0,5).lockedBasis=!0,t.getGate(18,5,0).rot=a;o=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,8).setPolarize(o),t.getQubit(0,8).lockedBasis=!0,t.getGate(18,8,0).rot=o}else if("quantChallengeC"===e){for(i=0;i<5;i++){a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,4-i).setPolarize(a),t.getQubit(18,4-i).setPolarize(a);o=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,9+i).setPolarize(o)}a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,5).setPolarize(a),t.getGate(18,5,0).rot=a;o=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,8).setPolarize(o),t.getQubit(5,13).setPolarize(Math.PI*Math.floor(16*Math.random())/8),t.getQubit(4,13).setPolarize(Math.PI*Math.floor(16*Math.random())/8),t.getQubit(3,13).setPolarize(Math.PI*Math.floor(16*Math.random())/8),t.getQubit(2,13).setPolarize(Math.PI*Math.floor(16*Math.random())/8),t.getQubit(1,13).setPolarize(Math.PI*Math.floor(16*Math.random())/8)}else if("quantChallengeD"===e)for(i=0;i<4;i++){o=2*Math.round(Math.random())-1,a=1+Math.floor(3*Math.random());var A=t.entList[i];A.ampsComp=[Math.cos(a*Math.PI/16),0,0,o*Math.sin(a*Math.PI/16)],A.computeRotAmps(),A.computeAllEnts();var C=0;if(o<0)C=1;t.getBit(18,5-i).value=C}else if("quantChallengeE"===e){for(i=0;i<5;i++){a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,4-i).setPolarize(a),t.getQubit(18,9+i).setPolarize(a);o=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,9+i).setPolarize(o),t.getQubit(18,4-i).setPolarize(o)}a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,5).setPolarize(a),t.getGate(18,8,0).rot=a;o=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,8).setPolarize(o),t.getGate(18,5,0).rot=o}else if("quantChallengeF"===e);else if("quantChallengeG"===e){for(i=0;i<5;i++){a=Math.round(Math.random());t.getQubit(18,4-i).setPolarize(Math.PI*(4+4*a)/8),t.getBit(0,9+i).value=1-a}a=Math.round(Math.random());t.getBit(0,8).value=1-a,t.getGate(18,5,0).rot=Math.PI*(4+4*a)/8}else if("quantErrorA"===e){for(i=0;i<5;i++){a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,4-i).setPolarize(a),t.getQubit(18,4-i).setPolarize(a)}a=Math.PI*Math.floor(16*Math.random())/8;t.getQubit(0,5).setPolarize(a),t.getGate(18,5,0).rot=a}else if("quantErrorB"===e){for(i=0;i<4;i++)a=Math.floor(16*Math.random()),t.getQubit(0,4-i).setPolarize(Math.PI*a/8),t.getQubit(18,4-i).setPolarize(Math.PI*a/8);a=Math.floor(16*Math.random()),t.getQubit(0,5).setPolarize(Math.PI*a/8),t.getGate(18,5,0).rot=Math.PI*a/8;for(i=0;i<3;i++){A=t.entList[i];A.ampsComp=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)],A.computeRotAmps(),A.computeAllEnts()}}else if("adderB"===e){a=[],o=[];a.push(Math.round(Math.random())),o.push(Math.round(Math.random()));for(i=1;i<5;i++)a.push(Math.round(Math.random())),t.getQubit(0,5-i).setPolarize(Math.PI*a[i]),t.getQubit(18,5-i).setPolarize(Math.PI*a[i]),o.push(Math.round(Math.random())),t.getQubit(0,8+i).setPolarize(Math.PI*o[i]),t.getQubit(18,8+i).setPolarize(Math.PI*o[i]);t.getQubit(0,5).setPolarize(Math.PI*a[0]),t.getGate(18,5,0).rot=Math.PI*a[0],t.getQubit(0,8).setPolarize(Math.PI*o[0]),t.getGate(18,8,0).rot=Math.PI*o[0],t.getGate(13,13,0).rot=Math.PI*((a[0]+o[0])%2),t.getQubit(14,13).setPolarize(Math.PI*((a[1]+o[1])%2)),t.getQubit(15,13).setPolarize(Math.PI*((a[2]+o[2])%2)),t.getQubit(16,13).setPolarize(Math.PI*((a[3]+o[3])%2)),t.getQubit(17,13).setPolarize(Math.PI*((a[4]+o[4])%2))}else if("adderC"===e){a=[],o=[];a.push(Math.round(Math.random())),o.push(Math.round(Math.random()));for(i=1;i<5;i++)a.push(Math.round(Math.random())),t.getQubit(0,5-i).setPolarize(Math.PI*a[i]),t.getQubit(18,5-i).setPolarize(Math.PI*a[i]),o.push(Math.round(Math.random())),t.getQubit(0,8+i).setPolarize(Math.PI*o[i]),t.getQubit(18,8+i).setPolarize(Math.PI*o[i]);t.getQubit(0,5).setPolarize(Math.PI*a[0]),t.getGate(18,5,0).rot=Math.PI*a[0],t.getQubit(0,8).setPolarize(Math.PI*o[0]),t.getGate(18,8,0).rot=Math.PI*o[0],t.getGate(13,13,0).rot=Math.PI*Math.floor(.55*(a[0]+o[0])),t.getQubit(14,13).setPolarize(Math.PI*Math.floor(.55*(a[1]+o[1]))),t.getQubit(15,13).setPolarize(Math.PI*Math.floor(.55*(a[2]+o[2]))),t.getQubit(16,13).setPolarize(Math.PI*Math.floor(.55*(a[3]+o[3]))),t.getQubit(17,13).setPolarize(Math.PI*Math.floor(.55*(a[4]+o[4])))}else if("measure"===e)for(i=0;i<6;i++){a=Math.round(Math.random());t.getQubit(0,5-i).setPolarize(Math.PI*a/2),t.getQubit(0,8+i).setPolarize(Math.PI*a/2),t.getBit(18,5-i).value=a}else if("measureB"===e){a=Math.round(Math.random());t.getQubit(0,5).setPolarize(Math.PI*a/2),t.getQubit(0,4).setPolarize(Math.PI*a/2),t.getQubit(0,3).setPolarize(Math.PI*a/2),t.getQubit(0,2).setPolarize(Math.PI*a/2),t.getBit(18,5).value=a;a=Math.round(Math.random());t.getQubit(0,1).setPolarize(Math.PI*a/2),t.getQubit(0,0).setPolarize(Math.PI*a/2),t.getQubit(1,0).setPolarize(Math.PI*a/2),t.getQubit(2,0).setPolarize(Math.PI*a/2),t.getBit(18,4).value=a;a=Math.round(Math.random());t.getQubit(3,0).setPolarize(Math.PI*a/2),t.getQubit(4,0).setPolarize(Math.PI*a/2),t.getQubit(5,0).setPolarize(Math.PI*a/2),t.getQubit(6,0).setPolarize(Math.PI*a/2),t.getBit(18,3).value=a;a=Math.round(Math.random());t.getQubit(7,0).setPolarize(Math.PI*a/2),t.getQubit(8,0).setPolarize(Math.PI*a/2),t.getQubit(9,0).setPolarize(Math.PI*a/2),t.getQubit(10,0).setPolarize(Math.PI*a/2),t.getBit(18,2).value=a;a=Math.round(Math.random());t.getQubit(11,0).setPolarize(Math.PI*a/2),t.getQubit(12,0).setPolarize(Math.PI*a/2),t.getQubit(13,0).setPolarize(Math.PI*a/2),t.getQubit(14,0).setPolarize(Math.PI*a/2),t.getBit(18,1).value=a}else if("preDenseB"===e)for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(0,5-i).value=a;o=Math.round(Math.random());t.getBit(0,8+i).value=o;var L=Math.round(Math.random());t.getBit(13+i,13).value=L,t.getBit(18,5-i).value=0===L?a:o}else if("simpleDistill"===e){A=t.entList[0];A.setQubits([t.getQubit(4,11),t.getQubit(4,10),t.getQubit(4,9)]),A.ampsComp=[.25,.75,.25,-.25,.25,-.25,-.25,.25],A.computeRotAmps(),A.computeFinalAmps(),A.computeAllEnts(),t.getQubit(4,11).lockedBasis=!0,t.getQubit(4,10).lockedBasis=!0,t.getQubit(4,9).lockedBasis=!0}else if("dense"===e){for(i=0;i<6;i++){a=Math.round(Math.random());t.getBit(18,5-i).value=a,t.getBit(0,5-i).value=a;o=Math.round(Math.random());t.getBit(18,8+i).value=o,t.getBit(0,8+i).value=o}for(i=0;i<3;i++){A=t.entList[i];A.ampsComp=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)],A.computeRotAmps(),A.computeAllEnts()}}else if("teleport"===e){for(i=0;i<4;i++)a=Math.floor(16*Math.random()),t.getQubit(0,4-i).setPolarize(Math.PI*a/8),t.getQubit(18,4-i).setPolarize(Math.PI*a/8);a=Math.floor(16*Math.random()),t.getQubit(0,5).setPolarize(Math.PI*a/8),t.getGate(18,5,0).rot=Math.PI*a/8;for(i=0;i<3;i++){A=t.entList[i];A.ampsComp=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)],A.computeRotAmps(),A.computeAllEnts()}}else if("distill"===e){for(i=0;i<4;i++)a=Math.floor(16*Math.random()),t.getQubit(0,4-i).setPolarize(Math.PI*a/8),t.getQubit(18,4-i).setPolarize(Math.PI*a/8);a=Math.floor(16*Math.random()),t.getQubit(0,5).setPolarize(Math.PI*a/8),t.getGate(18,5,0).rot=Math.PI*a/8;for(i=0;i<4;i++){A=t.entList[i];A.ampsComp=[Math.cos(1*Math.PI/16),0,0,Math.sin(1*Math.PI/16)],A.computeRotAmps(),A.computeAllEnts()}}else if("vaziraniQuantum"===e){T=Math.round(Math.random()),R=Math.round(Math.random()),m=Math.round(Math.random());t.getGate(6,6,0).state=T,t.getGate(9,6,0).state=R,t.getGate(12,6,0).state=m,t.getBit(18,4).value=1-T,t.getBit(18,3).value=1-R,t.getBit(18,2).value=1-m}else if("quantumAdv1"===e){if("constructing"===STATE.mode){a=Math.round(Math.random());var D=Math.floor(16*Math.random())}else if(SCENARIO.currentRep%2==1)a=0,D=0;else a=1,D=SCENARIO.currentRep/2%16;if(t.getBit(18,5).value=a,0===a)var b=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)];else b=[Math.cos(D*Math.PI/16)**2,Math.cos(D*Math.PI/16)*Math.sin(D*Math.PI/16),Math.cos(D*Math.PI/16)*Math.sin(D*Math.PI/16),Math.sin(D*Math.PI/16)**2];for(i=0;i<10;i++){A=t.entList[i];A.ampsComp=[...b],A.computeRotAmps(),A.computeAllEnts()}0===a?t.computizeQubits():t.naturalizeQubits()}else if("quantumAdv2"===e){if("constructing"===STATE.mode)if(Math.round(Math.random())){var O=Math.round(Math.random());a=0,D=Math.floor(8*Math.random())}else a=1,O=Math.round(Math.random()),D=Math.floor(16*Math.random());else if(SCENARIO.currentRep%2==1)a=0,O=(SCENARIO.currentRep+1)/2%2,D=0;else a=1,O=0,D=SCENARIO.currentRep/2%16;if(t.getBit(18,5).value=a,0===a)if(0===O)b=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)];else b=[0,1/Math.sqrt(2),-1/Math.sqrt(2),0];else b=[Math.cos(D*Math.PI/16)**2,Math.cos(D*Math.PI/16)*Math.sin(D*Math.PI/16),Math.cos(D*Math.PI/16)*Math.sin(D*Math.PI/16),Math.sin(D*Math.PI/16)**2];for(i=0;i<11;i++){A=t.entList[i];A.ampsComp=[...b],A.computeRotAmps(),A.computeAllEnts()}0===a?t.computizeQubits():t.naturalizeQubits()}else if("quantumAdv3"===e){if("constructing"===STATE.mode){O=Math.round(Math.random()),a=Math.round(Math.random()),D=4*Math.floor(4*Math.random());var M=1/8*Math.PI*Math.floor(8*Math.random())}else if(SCENARIO.currentRep%2==1)O=0,a=0,D=Math.floor(4*Math.random()),M=1/8*Math.PI*Math.floor(8*Math.random());else a=1,O=Math.round(Math.random()),D=SCENARIO.currentRep/2%4*4,M=2*Math.PI*Math.random();if(t.getBit(18,5).value=a,0===a)b=[Math.cos(M)/Math.sqrt(2),Math.sin(M)/Math.sqrt(2),-Math.sin(M)/Math.sqrt(2),Math.cos(M)/Math.sqrt(2)];else{var v=[Math.cos(Math.PI*D/16),Math.sin(Math.PI*D/16)];b=[v[0]**2,v[0]*v[1],v[0]*v[1],v[1]**2]}for(i=0;i<12;i++){A=t.entList[i];A.ampsComp=[...b],A.computeRotAmps(),A.computeAllEnts()}0===a?t.computizeQubits():t.naturalizeQubits()}else if("entChallengeA"===e);else if("entChallengeB"===e){if(1===SCENARIO.currentRep)var w=Math.floor(7*Math.random());else if(SCENARIO.currentRep%2==0)w=0;else w=1+(SCENARIO.currentRep+1)/2%6;var N=Math.ceil(w/6);if(0===w)b=[1/Math.sqrt(2),0,0,0,0,0,0,0,0,0,0,0,0,0,0,1/Math.sqrt(2)];else if(1===w)b=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];else if(2===w)b=[.5,0,0,.5,0,0,0,0,0,0,0,0,.5,0,0,.5];else if(3===w)b=[.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,.5];else if(4===w)b=[.5,0,0,0,0,0,.5,0,0,.5,0,0,0,0,0,.5];else if(5===w)b=[.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,.5];else if(6===w)b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];for(r=0;r<8;r++){var P=t.entList[r];P.ampsComp=[...b],P.computeRotAmps(),P.computeAllEnts()}t.getBit(18,5).value=N}else if("entChallengeC"===e){if(1===SCENARIO.currentRep)w=Math.floor(7*Math.random());else if(SCENARIO.currentRep%2==0)w=0;else w=1+(SCENARIO.currentRep+1)/2%6;N=Math.ceil(w/6);if(0===w)b=[1/Math.sqrt(2),0,0,0,0,0,0,0,0,0,0,0,0,0,0,1/Math.sqrt(2)];else if(1===w)b=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];else if(2===w)b=[.5,0,0,.5,0,0,0,0,0,0,0,0,.5,0,0,.5];else if(3===w)b=[.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,.5];else if(4===w)b=[.5,0,0,0,0,0,.5,0,0,.5,0,0,0,0,0,.5];else if(5===w)b=[.5,0,0,0,0,.5,0,0,0,0,.5,0,0,0,0,.5];else if(6===w)b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];for(r=0;r<8;r++){P=t.entList[r];P.ampsComp=[...b],P.computeRotAmps(),P.computeAllEnts()}t.getBit(18,5).value=N}else if("extraA"===e);else if("extraB"===e)for(b=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)],r=0;r<4;r++){P=t.entList[r];P.ampsComp=[Math.cos(1*Math.PI/16),0,0,Math.sin(1*Math.PI/16)],P.computeRotAmps(),P.computeAllEnts()}else if("extraC"===e){for(s=[],g=[],r=0;r<4;r++)s.push(Math.round(Math.random())),g.push(Math.round(Math.random()));1===SCENARIO.currentRep||(2===SCENARIO.currentRep?(s=[1,1,1,1],g=[1,1,1,1]):3===SCENARIO.currentRep?s=[0,0,0,0]:4===SCENARIO.currentRep&&(g=[0,0,0,0]));var y=s[0]+2*s[1]+4*s[2]+8*s[3],F=g[0]+2*g[1]+4*g[2]+8*g[3],k=(y*F).toString(2),x=k.length;q=[0,0,0,0,0,0,0,0];for(r=0;r<x;r++)q[r]=parseInt(k[x-r-1]);for(r=0;r<4;r++)t.getBit(0,5-r).value=s[r],t.getBit(0,8+r).value=g[r];for(r=0;r<6;r++)t.getBit(18,5-r).value=q[r];t.getBit(17,0).value=q[6],t.getBit(16,0).value=q[7]}else if("binaryencode"===e){var B=5+Math.floor(11*Math.random());s=[1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<B;r++)s[r]=1;s[B]=0;for(r=0;r<6;r++)t.getBit(0,5-r).value=s[r];if(SCENARIO.CINPUTS=[[],[],[]],B>6)for(r=0;r<B-6;r++)SCENARIO.CINPUTS[0].push(1);B>5&&SCENARIO.CINPUTS[0].push(0);k=B.toString(2),x=k.length;q=[0,0,0,0];for(r=0;r<x;r++)q[r]=parseInt(k[x-r-1]);for(r=0;r<4;r++)t.getBit(18,5-r).value=q[r]}else if("adder"===e){var W=0;for(i=0;i<6;i++){if(5===i){s=0,g=0;var q=(s+g+W)%2}else s=Math.round(Math.random()),g=Math.round(Math.random()),q=(s+g+W)%2;t.getBit(0,5-i).value=s,t.getBit(0,8+i).value=g,t.getBit(18,5-i).value=q,W=Math.floor((s+g+W)/2)}}else if("extraD"===e){var H=15+Math.floor(20*Math.random()),U=Math.round(Math.random()),_=!1;3===SCENARIO.currentRep&&(_=!0,U=1);var G=Helper.genSequenceBits(H,U,_);t.getBit(18,5).value=U;for(i=0;i<6;i++)t.getBit(0,5-i).value=G[0].shift(),t.getBit(0,8+i).value=G[1].shift();SCENARIO.CINPUTS[0]=G[0],SCENARIO.CINPUTS[1]=G[1]}else if("chsh"===e)for(i=0;i<3;i++){A=t.entList[i];A.ampsComp=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)],A.computeRotAmps(),A.computeAllEnts()}else if("freeA"===e);else if("freeB"===e)for(b=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)],r=0;r<4;r++){P=t.entList[r];P.ampsComp=[Math.cos(4*Math.PI/16),0,0,Math.sin(4*Math.PI/16)],P.computeRotAmps(),P.computeAllEnts()}}function LevelSelect(){STATE.mode="levelSelect",FIELD.tileWidth=ResetConsts.resize(),FIELD.tileHeight=FIELD.tileWidth,ResetConsts.levelSelect()}function LevelTitle(){STATE.mode="title",FIELD.tileWidth=2*ResetConsts.resize(),FIELD.tileHeight=FIELD.tileWidth,SCENARIO.channelsCol=[0,0,0,0,0,0],SCENARIO.xCameraLocs=[5,6,7,8,8,9,9,10,10,10,11,12,13,13,13,12,12,11,11,11,12,12,13,13,12,12,11,11,10,9,9,8,8,8,8,8,7,7,7,6,6,5,5,5,5,5,5,5,6],SCENARIO.yCameraLocs=[4,4,4,4,4,4,5,5,5,4,4,4,4,5,6,6,6,6,7,8,8,8,8,9,9,9,9,9,9,9,9,9,9,8,8,7,7,8,9,9,9,9,8,7,6,6,5,4,4],ResetConsts.title(),Timer.initTitle(),IBOARD=new Board(CANV.interface.ctx,FIELD.cols,FIELD.rows);for(var e=[[5,4,3,2,"move",0,!1],[6,3,0,-1,"wait",0,!1],[15,7,1,-1,"wait",1.5707963267948966,!1],[11,3,0,-1,"wait",1.5707963267948966,!1]],t=0;t<e.length;t++){var i=e[t].pop(),a=new Qubit(...e[t]);a.isGhost=i,IBOARD.setQubit(a)}var r=[[6,6,3,-1,"move",0,0,!1],[1,2,1,-1,"wait",0,0,!1],[1,1,1,3,"halt",0,0,!1]];for(t=0;t<r.length;t++){i=r[t].pop();var s=new Bit(...r[t]);s.isGhost=i,IBOARD.setBit(s)}IBOARD._tiles=[4,2,2,2,2,2,60,2,2,5,4,2,62,2,2,2,2,5,84,1,55,-1,84,4,5,21,-1,-1,63,1,24,42,22,22,40,84,1,21,83,81,-1,43,63,1,23,52,22,12,12,26,4,89,68,60,2,6,21,1,23,89,47,1,3,80,2,70,6,3,80,6,24,42,22,40,22,26,3,2,2,60,6,4,82,2,68,5,24,82,22,48,25,4,62,2,5,4,2,2,13,87,33,25,84,25,3,60,84,-1,21,86,1,4,2,6,1,24,22,49,-1,69,41,-1,23,25,21,24,52,26,1,1,3,68,5,3,32,60,13,84,83,81,4,5,53,23,31,42,84,83,81,84,42,61,-1,21,23,31,52,33,26,1,63,41,-1,23,85,5,1,1,-1,-1,1,-1,21,-1,21,-1,3,68,6,3,60,2,89,70,6,73,63,-1,-1,1,-1,23,22,84,40,22,42,40,22,49,4,80,68,62,6,3,68,2,6,-1,-1,4,2,65,2,2,62,5,23,33,82,22,42,25,24,42,52,25,-1,-1,1,-1,1,-1,4,2,6,-1,3,2,62,2,13,13,2,5,21,-1,74,64,2,64,2,6,-1,20,-1,-1,-1,-1,-1,23,26,-1,3,84];var o=[[6,3,"sync","pretransform",0,0,0,0,-2],[6,4,"sync","free",2,0,0,0,-2],[8,3,"qControl","free",0,1.5707963267948966,0,0,-2],[8,4,"qFlip","free",0,1.5707963267948966,0,0,-2],[8,4,"qFlip","free",0,.7853981633974483,1,0,-2],[10,5,"measure","free",0,0,0,0,-2],[13,4,"cSplit","free",0,0,0,0,-2],[11,5,"trash","free",0,0,0,0,-2],[14,5,"upgrade","free",1,.7853981633974483,0,0,-2],[12,7,"switch","free",2,1,0,0,-2],[12,6,"cInvert","free",0,1,0,0,-2],[12,6,"cInvert","free",0,0,1,0,-2],[13,7,"trash","free",0,0,0,0,-2],[12,8,"upgrade","free",0,5.497787143782138,0,0,-2],[12,9,"qControl","free",0,0,0,0,-2],[12,10,"qFlip","free",0,5.497787143782138,0,0,-2],[12,10,"qFlip","free",0,.7853981633974483,1,0,-2],[15,7,"sync","pretransform",1,0,0,0,-2],[14,7,"sync","free",3,0,0,0,-2],[14,9,"qControl","free",3,.7853981633974483,0,0,-2],[15,9,"rotate","free",1,2.356194490192345,0,0,-2],[15,9,"rotate","free",1,.7853981633974483,1,0,-2],[18,7,"measure","free",1,1.5707963267948966,0,0,-2],[17,7,"switch","free",2,1,0,0,-2],[16,7,"trash","free",0,0,0,0,-2],[17,6,"qFlip","free",0,.7853981633974483,0,1,-2],[17,6,"qFlip","free",0,0,1,0,-2],[11,9,"delay","free",0,0,0,1,-2],[13,11,"switch","free",2,0,0,0,-2],[13,10,"rotate","free",0,3.9269908169872414,0,0,-2],[13,10,"rotate","free",0,2.356194490192345,1,0,-2],[16,11,"switch","free",2,1,0,0,-2],[16,10,"qFlip","free",0,.7853981633974483,0,1,-2],[16,10,"qFlip","free",0,.7853981633974483,1,0,-2],[18,13,"trash","free",0,0,0,0,-2],[12,12,"rotate","free",0,2.748893571891069,0,0,-2],[8,9,"rotate","free",1,3.141592653589793,1,0,-2],[11,10,"sync","free",0,0,0,0,-2],[11,11,"sync","free",2,0,0,0,-2],[17,11,"cInvert","free",0,0,0,0,-2],[9,9,"measure","free",0,0,0,0,-2],[9,8,"switch","free",1,1,0,0,-2],[7,5,"trash","free",0,0,0,0,-2],[9,7,"cInvert","free",1,0,0,0,-2],[8,8,"rotate","free",1,0,0,0,-2],[8,8,"rotate","free",1,3.141592653589793,1,0,-2],[9,10,"cSplit","free",1,0,0,0,-2],[6,10,"switch","free",2,1,0,0,-2],[6,9,"qFlip","free",0,.7853981633974483,0,1,-2],[6,9,"qFlip","free",0,0,1,0,-2],[16,3,"switch","free",0,1,0,0,-2],[16,4,"rotate","free",0,0,0,0,-2],[16,4,"rotate","free",0,.7853981633974483,1,0,-2],[18,0,"trash","free",0,0,0,0,-2],[11,3,"sync","pretransform",0,0,0,0,-2],[11,4,"sync","free",2,0,0,0,-2],[14,3,"switch","free",2,1,0,0,-2],[13,2,"delay","free",0,0,0,1,-2],[14,2,"qFlip","free",0,.7853981633974483,0,1,-2],[14,2,"qFlip","free",0,.7853981633974483,1,0,-2],[15,1,"switch","free",0,1,0,0,-2],[15,2,"measure","free",0,.7853981633974483,0,0,-2],[15,2,"measure","free",0,.7853981633974483,1,0,-2],[16,1,"trash","free",0,0,0,0,-2],[2,13,"qCombine","free",0,0,0,0,-2],[1,13,"qCreate","free",0,0,0,0,1],[4,10,"switch","free",0,0,0,0,-2],[4,11,"qCombine","free",1,0,0,0,-2],[4,11,"qCombine","free",2,0,1,0,-2],[4,13,"qCombine","free",0,0,0,0,-2],[7,10,"switch","free",0,1,0,0,-2],[7,11,"rotate","free",0,0,0,0,-2],[7,11,"rotate","free",0,3.9269908169872414,1,0,-2],[6,7,"sync","free",1,0,0,0,-2],[5,7,"sync","free",3,0,0,0,-2],[6,6,"switch","free",1,0,0,0,-2],[5,6,"qFlip","free",1,0,0,0,-2],[5,6,"qFlip","free",1,0,1,0,-2],[3,10,"trash","free",0,0,0,0,-2],[3,4,"measure","free",0,0,0,0,-2],[3,2,"switch","free",3,0,0,0,-2],[4,2,"rotate","free",1,0,0,0,-2],[4,2,"rotate","free",1,3.141592653589793,1,0,-2],[3,1,"trash","free",0,0,0,0,-2],[3,3,"cCombine","free",3,0,0,0,-2],[2,3,"delay","free",0,0,0,7,-2],[6,0,"measure","free",0,.7853981633974483,0,0,-2],[7,2,"cInvert","free",0,0,0,0,-2],[12,1,"switch","free",2,1,0,0,-2],[12,0,"rotate","free",0,0,0,0,-2],[12,0,"rotate","free",0,.7853981633974483,1,0,-2],[9,1,"rotate","free",1,5.105088062083414,0,0,-2],[4,5,"upgrade","free",2,.7853981633974483,0,0,-2],[2,7,"measure","free",0,3.9269908169872414,0,0,-2],[4,7,"trash","free",0,0,0,0,-2],[3,6,"cSplit","free",1,0,0,0,-2],[0,2,"sync","free",3,0,0,0,-2],[1,2,"sync","pretransform",1,0,0,0,-2],[1,1,"cCreate","free",1,0,0,0,-1],[4,8,"cInvert","free",0,0,0,0,-2]];for(t=0;t<o.length;t++){var n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,IBOARD.setGate(l)}RBOARD[0]=IBOARD.copy(),RBOARD[1]=RBOARD[0].copy().updateOneStep()}function TutsOpen(){if(0===TUTORIAL.current){TUTORIAL.title="Handbook 1: Bits, wires and outputs",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" Bits (orange disks) travel along $$b:blue $$b:wires."),TUTORIAL.info.push(String.fromCharCode(8226)+" Qubits (green disks) travel along $$r:red $$r:wires."),TUTORIAL.info.push(String.fromCharCode(8226)+" Only a single bit or qubit can occupy a tile at any time."),TUTORIAL.info.push(" "),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" In most levels, the goal is to output a stream of bits or qubits that matches the desired outputs."),TUTORIAL.info.push(String.fromCharCode(8226)+" Typically you will be given instructions on how the desired output can be achieved."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,5,24,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,11,13,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,24,22,33,26,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,23,25,1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,3,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,89,26,-1,-1,24,25,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,116,21,53,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,50,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,22,22,22,91,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,52,52,22,26,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(var e=[[5,1,0,-1,"halt",0,0,!1],[5,10,1,-1,"freeze",0,0,!0],[0,10,3,-1,"halt",0,0,!1],[4,3,0,-1,"halt",1,0,!1],[5,9,1,3,"halt",0,0,!0],[0,12,2,-1,"halt",0,0,!1],[5,8,1,3,"halt",0,0,!0],[2,12,2,-1,"halt",0,0,!1],[1,3,3,-1,"halt",0,0,!1],[5,7,1,3,"halt",1,0,!0],[3,12,2,-1,"flip",0,0,!1],[2,5,3,-1,"halt",1,0,!1],[5,6,2,-1,"halt",0,0,!0],[4,12,2,-1,"flip",0,0,!1],[6,7,3,-1,"halt",1,0,!0],[6,12,1,-1,"halt",1,0,!1],[1,6,0,-1,"wait",1,0,!1],[6,8,3,-1,"nullflip",1,0,!0],[6,10,1,-1,"halt",1,0,!1],[0,6,0,-1,"move",0,0,!1],[7,9,2,-1,"move",1,0,!1]],t=0;t<e.length;t++){var i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}var r=[[3,5,2,-1,"halt",0,!1],[5,4,1,-1,"halt",1.1780972450961724,!1],[4,2,0,-1,"halt",2.356194490192345,!1],[1,2,0,-1,"halt",0,!1],[0,3,3,-1,"wait",-2.356194490192345,!1],[0,4,3,-1,"move",-2.748893571891069,!1]];for(t=0;t<r.length;t++){i=r[t].pop();var s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}var o=[[0,4,"qCreate","free",3,2,0,0,-1],[0,6,"cCreate","free",0,2,0,0,-1],[1,6,"delay","transform",0,1,0,2,-1],[0,3,"delay","transform",1,1,0,2,-1],[6,1,"trash","free",0,.7853981633974483,0,0,-1],[0,1,"trash","free",0,.7853981633974483,0,0,-1],[6,9,"cSplit","free",2,0,0,0,-1],[7,9,"cCreate","free",2,2,0,0,-1],[5,10,"compare","free",0,.7853981633974483,0,2,-1],[6,8,"cInvert","transform",1,0,0,2,-1],[3,12,"cInvert","transform",0,0,0,0,-1],[4,12,"cInvert","transform",0,0,0,0,-1]];for(t=0;t<o.length;t++){var n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(1===TUTORIAL.current){TUTORIAL.title="Handbook 2: Circuit Construction",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" Wires are placed by $$d:left-click $$d:+ $$d:dragging once selected from the menu."),TUTORIAL.info.push(String.fromCharCode(8226)+" Wires (of matching color) can also be created by $$d:drag-clicking on a gate or existing wire."),TUTORIAL.info.push(String.fromCharCode(8226)+" $$d:Right-click $$d:+ $$d:drag or use the $$d:eraser $$d:tool to destroy gates / wires."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" The orientation of a gate can be adjusted using $$d:mouse-scroll or $$d:arrow $$d:keys BEFORE placement."),TUTORIAL.info.push(String.fromCharCode(8226)+" The properties/settings of a gate are adjusted by selecting the gate $$d:(left- $$d:click) AFTER placement."),TUTORIAL.info.push(String.fromCharCode(8226)+" $$d:Hold $$d:shift $$d:+ $$d:left-click on an existing gate to copy."),TUTORIAL.type="fixed",TUTORIAL.nFrames=7,TUTORIAL.timePerTick=400,TUTORIAL.i0High=-1,TUTORIAL.j0High=-1,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,60,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,60,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,76,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]
;for(o=[[4,3,"measure","free",0,.7853981633974483,0,0,-1],[4,5,"measure","free",0,.7853981633974483,0,0,-1],[2,7,"qCreate","free",2,0,0,0,-1],[4,7,"qCreate","free",1,0,0,0,-1],[1,9,"qCreate","free",1,0,0,0,-1],[3,9,"qCreate","free",1,0,0,0,-1],[5,9,"qCreate","free",1,2,0,0,1],[2,11,"qCreate","free",3,2,0,0,1],[4,11,"qCreate","free",3,2,0,0,1],[5,11,"qCreate","free",3,2,0,0,1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}TUTORIAL.grab={type:"qCreate",i0:3,j0:9,k0:UBOARD[0].getGate(3,9)},UBOARD[1]=UBOARD[0].copy(),UBOARD[2]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[2]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,60,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,60,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,76,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(o=[[4,3,"measure","free",0,.7853981633974483,0,0,-1],[4,5,"measure","free",0,.7853981633974483,0,0,-1],[2,7,"qCreate","free",2,0,0,0,-1],[4,7,"qCreate","free",1,0,0,0,-1],[1,9,"qCreate","free",1,0,0,0,-1],[3,9,"qCreate","free",1,0,0,0,-1],[5,9,"qCreate","free",1,2,0,0,1],[2,11,"qCreate","free",3,2,0,0,1],[4,11,"qCreate","free",3,2,0,0,1],[5,11,"qCreate","free",3,2,0,0,1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[2].setGate(l)}UBOARD[3]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[3]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,60,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,60,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,76,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(o=[[4,3,"measure","free",0,.7853981633974483,0,0,-1],[4,5,"measure","free",0,.7853981633974483,0,0,-1],[2,7,"qCreate","free",2,0,0,0,-1],[4,7,"qCreate","free",1,0,0,0,-1],[1,9,"qCreate","free",1,0,0,0,-1],[3,9,"qCreate","free",1,0,0,0,-1],[5,9,"qCreate","free",1,2,0,0,1],[2,11,"qCreate","free",3,2,0,0,1],[4,11,"qCreate","free",3,2,0,0,1],[5,11,"qCreate","free",3,2,0,0,1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[3].setGate(l)}UBOARD[4]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[4]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,60,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,76,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(o=[[4,3,"measure","free",0,.7853981633974483,0,0,-1],[2,7,"qCreate","free",2,0,0,0,-1],[4,7,"qCreate","free",1,0,0,0,-1],[1,9,"qCreate","free",1,0,0,0,-1],[3,9,"qCreate","free",1,0,0,0,-1],[5,9,"qCreate","free",1,2,0,0,1],[2,11,"qCreate","free",3,2,0,0,1],[4,11,"qCreate","free",3,2,0,0,1],[5,11,"qCreate","free",3,2,0,0,1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[4].setGate(l)}UBOARD[5]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[5]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,60,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,27,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,76,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,116,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,116,75,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(o=[[4,3,"measure","free",0,.7853981633974483,0,0,-1],[2,7,"qCreate","free",2,0,0,0,-1],[4,7,"qCreate","free",1,0,0,0,-1],[1,9,"qCreate","free",1,0,0,0,-1],[3,9,"qCreate","free",1,0,0,0,-1],[5,9,"qCreate","free",1,2,0,0,1],[2,11,"qCreate","free",3,2,0,0,1],[4,11,"qCreate","free",3,2,0,0,1],[5,11,"qCreate","free",3,2,0,0,1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[5].setGate(l)}UBOARD[6]=UBOARD[5].copy()}else if(2===TUTORIAL.current){TUTORIAL.title="Handbook 3: Gates",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" Gates act to alter bits / qubits that move over them."),TUTORIAL.info.push(String.fromCharCode(8226)+" Gates with $$b:blue coloration (generally) act on bits."),TUTORIAL.info.push(String.fromCharCode(8226)+" Gates with $$r:red coloration (generally) act on qubits."),TUTORIAL.info.push(" "),TUTORIAL.info.push(" "),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" Gates with $$b:blue or $$r:red tabs must be connected to wires of the same color."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" Gates with $$g:green tabs can be connected to wires of either color."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,52,22,52,22,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,68,2,62,2,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,75,-1,-1,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,60,2,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,84,22,22,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[[6,2,2,-1,"move",0,0,!1],[6,10,2,-1,"move",0,0,!1],[7,2,2,0,"halt",0,0,!1],[7,10,2,0,"halt",1,0,!1]],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[[6,4,2,-1,"move",0,!1],[0,7,1,-1,"move",3.141592653589793,!1],[0,11,3,-1,"move",3.141592653589793,!1],[7,4,2,0,"halt",0,!1],[0,6,1,3,"halt",0,!1],[0,12,3,1,"halt",3.141592653589793,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[0,2,"trash","free",0,.7853981633974483,0,0,-1],[0,4,"trash","free",0,.7853981633974483,0,0,-1],[6,4,"delay","reset",0,0,0,4,-1],[6,2,"delay","reset",0,0,0,4,-1],[7,2,"cCreate","free",2,0,0,0,-1],[7,4,"qCreate","free",2,0,0,0,-1],[4,2,"cInvert","free",0,0,0,0,-1],[2,2,"cInvert","free",0,0,0,1,-1],[2,4,"qFlip","free",0,.7853981633974483,0,0,-1],[4,4,"rotate","free",0,4.319689898685965,0,0,-1],[3,8,"measure","free",0,0,0,0,-1],[3,6,"trash","free",0,.7853981633974483,0,0,-1],[7,8,"trash","free",0,.7853981633974483,0,0,-1],[3,10,"trash","free",0,.7853981633974483,0,0,-1],[0,7,"delay","reset",1,0,0,4,-1],[0,6,"qCreate","free",1,1,0,0,-1],[0,12,"qCreate","free",3,1,0,0,-1],[0,11,"delay","reset",1,0,0,4,-1],[7,10,"cCreate","free",2,1,0,0,-1],[6,10,"delay","reset",0,0,0,4,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(3===TUTORIAL.current){TUTORIAL.title="Handbook 4: Inversion and Re-zero Gates",TUTORIAL.info=[],TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" $$b:Inversion $$b:gates act on bits to flip their state."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" Inversion gates can be toggled to act as identity (i.e. to leave bits unchanged)."),TUTORIAL.info.push(" "),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" $$b:Re-zero $$b:gates act on bits to set them in the 0-state."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" Re-zero gates can also be toggled to act as identity."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[24,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,52,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,22,52,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,50,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,52,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,22,52,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[[0,4,3,-1,"halt",0,0,!1],[0,2,1,-1,"halt",1,0,!1],[0,10,3,-1,"halt",0,0,!1],[0,8,1,-1,"halt",0,0,!1],[0,5,3,-1,"wait",1,0,!1],[0,1,1,-1,"wait",1,0,!1],[0,11,3,-1,"wait",0,0,!1],[0,7,1,-1,"wait",1,0,!1],[0,6,2,1,"move",0,0,!1],[0,0,2,-1,"halt",1,0,!1],[0,12,2,-1,"halt",1,0,!1],[0,6,2,3,"move",0,1,!1]],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[3,2,"cInvert","free",0,0,0,0,-1],[0,1,"delay","transform",1,0,0,3,-1],[6,2,"trash","free",0,.7853981633974483,0,0,-1],[3,4,"cInvert","free",0,1,0,0,-1],[0,5,"delay","transform",1,0,0,3,-1],[6,4,"trash","free",0,.7853981633974483,0,0,-1],[3,8,"cInvert","free",0,0,0,1,-1],[6,8,"trash","free",0,.7853981633974483,0,0,-1],[3,10,"cInvert","free",0,1,0,1,-1],[6,10,"trash","free",0,.7853981633974483,0,0,-1],[0,6,"cSplit","free",2,0,0,0,-1],[1,6,"cCreate","create",2,1,0,0,-1],[0,7,"delay","transform",1,0,0,3,-1],[0,11,"delay","transform",1,0,0,3,-1],[1,0,"cCreate","create",2,1,0,0,-1],[1,12,"cCreate","create",2,1,0,0,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(4===TUTORIAL.current){TUTORIAL.title="Handbook 5: Combiner and Splitter Gates",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" $$b:Combiners merge up to three wires into a single output wire."),TUTORIAL.info.push(String.fromCharCode(8226)+" If multiple bits/quibts are waiting to enter the same combiner then priority if given clockwise from the output direction."),TUTORIAL.info.push(String.fromCharCode(8226)+" Seperate versions of combiners are available for $$b:bits and for $$r:qubits."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" $$b:Splitters act to duplicate an input bit across multiple outputs."),TUTORIAL.info.push(String.fromCharCode(8226)+" Duplicate bits are only created when splitter outputs are connected to compatible wires or gates."),TUTORIAL.info.push(String.fromCharCode(8226)+" Splitters are not available for qubits (quantum theory forbids it!)."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[24,89,56,-1,-1,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,25,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,22,44,22,26,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,4,2,66,2,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,3,2,2,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,55,84,-1,-1,74,89,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,24,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,48,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,22,48,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,23,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[[0,0,2,-1,"halt",1,0,!1],[0,2,3,-1,"halt",0,0,!1],[0,8,1,-1,"halt",0,0,!1],[0,10,3,-1,"halt",0,0,!1],[1,0,2,-1,"wait",1,0,!1],[0,3,3,-1,"wait",0,0,!1],[0,7,1,-1,"wait",0,0,!1],[0,11,3,-1,"wait",1,0,!1]],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[[6,4,1,-1,"halt",-1.9634954084936214,!1],[6,6,0,-1,"halt",-2.356194490192345,!1],[6,3,1,-1,"wait",2.356194490192345,!1],[5,6,0,-1,"wait",-1.9634954084936214,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[3,4,"qCombine","free",2,0,0,0,-1],[3,2,"cCombine","free",0,0,0,0,-1],[5,0,"trash","free",0,.7853981633974483,0,0,-1],[1,6,"trash","free",0,.7853981633974483,0,0,-1],[6,3,"delay","transform",1,0,0,3,-1],[6,2,"qCreate","create",1,2,0,0,-1],[5,6,"delay","transform",0,0,0,3,-1],[4,6,"qCreate","create",0,2,0,0,-1],[1,0,"delay","transform",0,0,0,3,-1],[2,0,"cCreate","create",2,2,0,0,-1],[0,3,"delay","transform",1,0,0,3,-1],[0,4,"cCreate","create",3,2,0,0,-1],[3,8,"cSplit","free",0,0,0,0,-1],[6,7,"trash","free",0,.7853981633974483,0,0,-1],[6,8,"trash","free",0,.7853981633974483,0,0,-1],[6,9,"trash","free",0,.7853981633974483,0,0,-1],[0,7,"delay","transform",1,0,0,3,-1],[0,6,"cCreate","create",1,2,0,0,-1],[3,10,"cSplit","free",0,0,0,0,-1],[6,11,"trash","free",0,.7853981633974483,0,0,-1],[0,11,"delay","transform",1,0,0,3,-1],[0,12,"cCreate","create",3,2,0,0,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(5===TUTORIAL.current){TUTORIAL.title="Handbook 6: Creation and Incineration",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" Creation gates act to create new $$b:bits or $$r:qubits."),TUTORIAL.info.push(String.fromCharCode(8226)+" Gates can be configured to produce in $$d:fixed, $$d:alternating or $$d:random states."),TUTORIAL.info.push(String.fromCharCode(8226)+" Gates can be configured to produce indefinitely or to produce a finite number of outputs."),TUTORIAL.info.push(" "),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" $$g:Incinerators act to destroy bits and qubits."),TUTORIAL.info.push(String.fromCharCode(8226)+" Incinerators can be toggled to display their destroy count."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,56,-1,74,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,56,-1,74,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,56,-1,74,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,89,25,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,75,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,26,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,6,-1,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,24,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[[3,6,0,-1,"halt",1,0,!1],[3,12,2,-1,"halt",1,0,!1],[2,6,0,-1,"wait",1,0,!1],[4,12,2,-1,"wait",1,0,!1],[1,2,2,-1,"halt",0,0,!1],[1,3,2,-1,"halt",0,0,!1],[1,4,2,-1,"halt",1,0,!1]],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[[0,9,3,-1,"halt",0,!1],[6,9,1,-1,"halt",1.1780972450961724,!1],[0,10,3,-1,"wait",-2.356194490192345,!1],[6,8,1,-1,"wait",-.39269908169872486,!1],[5,2,0,-1,"halt",0,!1],[5,3,0,-1,"halt",0,!1],[5,4,0,-1,"halt",2.748893571891069,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[2,2,"cCreate","create",2,0,0,0,6],[2,3,"cCreate","create",2,1,0,0,8],[2,4,"cCreate","create",2,2,0,0,-1],[4,2,"qCreate","create",0,0,0,0,6],[4,3,"qCreate","create",0,1,0,0,8],[4,4,"qCreate","create",0,2,0,0,-1],[6,4,"trash","free",0,.7853981633974483,0,0,-1],[6,3,"trash","free",0,.7853981633974483,0,0,-1],[6,2,"trash","free",0,.7853981633974483,0,0,-1],[0,2,"trash","free",0,.7853981633974483,0,0,-1],[0,3,"trash","free",0,.7853981633974483,0,0,-1],[0,4,"trash","free",0,.7853981633974483,0,0,-1],[1,6,"cCreate","create",0,2,0,0,-1],[2,6,"delay","transform",0,0,0,3,-1],[0,11,"qCreate","create",3,2,0,0,-1],[0,10,"delay","transform",1,0,0,3,-1],[5,12,"cCreate","create",2,2,0,0,-1],[4,12,"delay","transform",0,0,0,3,-1],[6,8,"delay","transform",1,0,0,3,-1],[6,7,"qCreate","create",1,2,0,0,-1],[2,8,"trash","free",0,.7853981633974483,0,0,-1],[4,10,"trash","free",0,.7853981633974483,0,1,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(6===TUTORIAL.current){TUTORIAL.title="Handbook 7: (Bit) Control Gates",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" $$b:Controls can actively alter the state of gates placed within their $$d:target ring depending on the bits input into the control."),TUTORIAL.info.push(String.fromCharCode(8226)+" During construction the yellow $$d:switch icon can be used to toggle between 0-primed or 1-primed $$b:control states, and the $$d:target $$d:gate can be configured separately for each state."),TUTORIAL.info.push(String.fromCharCode(8226)+" In the example to the left, the target gate directs bits to left after receiving a $$b:`0` $$b:control-bit   and to the top after receiving a     $$b:`1` $$b:control-bit."),TUTORIAL.info.push(String.fromCharCode(8226)+" Each time that the target gate is triggered the control returns to the unprimed state and must be re-primed before the target gate will reaccept bit/qubit entry."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,40,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,40,-1,40,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,52,-1,52,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,54,22,22,25,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,22,25,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,22,46,22,22,26,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,22,42,22,22,25,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(o=[[4,1,"switch","free",0,3,0,1,-1],[2,4,"switch","free",0,1,0,3,-1],[4,4,"switch","free",0,0,0,4,-1],[2,5,"cInvert","free",0,1,0,0,-1],[2,5,"cInvert","free",0,0,1,0,-1],[4,5,"cInvert","free",0,1,0,0,-1],[4,5,"cInvert","free",0,0,1,0,-1],[0,9,"trash","free",0,.785398163397,0,0,-1],[0,8,"trash","free",0,.785398163397,0,0,-1],[3,10,"switch","free",2,2,0,1,-1],[3,9,"cCombine","free",2,0,0,0,-1],[3,9,"cCombine","free",3,0,1,0,-1],[0,10,"trash","free",0,.785398163397,0,0,-1],[6,8,"delay","transform",1,4,0,6,-1],[6,12,"cCreate","free",3,1,0,0,-1],[6,11,"delay","transform",1,1,0,6,-1],[3,6,"cCreate","free",0,2,0,0,-1]],e=[[5,10,2,0,"halt",0,0,!1],[6,8,1,-1,"wait",0,0,!1],[6,11,3,-1,"wait",1,0,!1],[6,7,1,3,"halt",1,0,!1],[6,6,0,3,"halt",0,0,!1],[5,6,0,2,"halt",1,0,!1],[4,6,0,2,"halt",0,0,!1],[6,12,3,1,"move",0,0,!1]],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(7===TUTORIAL.current){TUTORIAL.title="Handbook 8: Delay, Sync and BtQ Gates",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" $$g:Delay $$g:gates act to hold bits or qubits in place for a number of ticks (configurable between 0-7 ticks)."),TUTORIAL.info.push(String.fromCharCode(8226)+" $$g:Sync $$g:gates are always placed in pairs. They will only allow passage when both halves of the pair are simultaneously occupied, otherwise bits / qubits will be held in place."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" $$g:Bit-to-qubit (BtQ) gates transform an incoming bit into an outgoing qubit."),TUTORIAL.info.push(String.fromCharCode(8226)+" If the input bit is $$d:'0' state then the outgoing qubit will be $$d:aligned with the gate arrow, else if the input bit is $$d:'1' state the outgoing qubit will be $$d:anti-aligned."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,22,89,22,22,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,80,2,2,89,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,22,22,82,22,22,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,23,22,22,85,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,22,22,85,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,53,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,57,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[[3,2,2,-1,"wait",0,0,!1],[4,5,2,-1,"halt",1,0,!1],[0,10,3,-1,"halt",1,0,!1],[0,8,1,-1,"halt",0,0,!1],[6,2,2,-1,"wait",1,0,!1],[6,5,2,-1,"wait",0,0,!1],[0,11,3,-1,"wait",1,0,!1],[0,7,1,-1,"wait",0,0,!1],[0,12,3,-1,"flip",0,0,!1],[0,6,2,-1,"halt",0,0,!1],[7,2,2,0,"halt",0,0,!1],[1,6,2,-1,"halt",0,0,!1],[7,5,2,-1,"move",1,0,!1]],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[[6,4,2,-1,"wait",.3926990816987241,!1],[7,4,2,0,"halt",-1.9634954084936211,!1],[8,4,2,0,"halt",1.1780972450961724,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[6,2,"delay","transform",0,2,0,3,-1],[3,2,"delay","transform",0,0,0,2,-1],[7,2,"cCreate","free",2,2,0,0,-1],[0,2,"trash","free",0,.7853981633974483,0,0,-1],[3,4,"sync","free",0,.7853981633974483,0,0,-1],[3,5,"sync","free",2,0,0,0,-2],[0,5,"trash","free",0,.7853981633974483,0,0,-1],[0,4,"trash","free",0,.7853981633974483,0,0,-1],[6,4,"delay","transform",0,3,0,4,-1],[6,5,"delay","transform",0,1,0,4,-1],[7,5,"cCreate","free",2,2,0,0,-1],[8,4,"qCreate","free",2,2,0,0,-1],[7,4,"delay","free",0,0,0,2,-1],[3,8,"upgrade","free",0,.7853981633974483,0,0,-1],[3,10,"upgrade","free",0,.7853981633974483,0,0,-1],[0,7,"delay","transform",1,0,0,3,-1],[0,11,"delay","transform",1,0,0,3,-1],[0,12,"cInvert","transform",1,0,0,0,-1],[0,13,"cCreate","create",3,0,0,0,-1],[6,8,"trash","free",0,.7853981633974483,0,0,-1],[6,10,"trash","free",0,.7853981633974483,0,0,-1],[2,6,"cCreate","create",2,0,0,0,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(8===TUTORIAL.current){TUTORIAL.title="Handbook 9: Intro to Qubits",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" An (unentangled) $$r:qubit is depicted as an arrow pointing to edge of a green disk. The ▲ and ▼ states are analogous to `0` and `1` bits."),TUTORIAL.info.push(String.fromCharCode(8226)+" In general qubits can be at any angle Θ, although the Qubit Factory often only makes use of qubits at discrete angular increments of π/8."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" The outline color of a qubit denotes the sign of its wavefunction, with $$g:green $$g:for $$g:+ve and $$p:purple $$p:for $$p:-ve. Signs only become important when dealing with superpositions."),TUTORIAL.info.push(String.fromCharCode(8226)+" Rotation of a qubit through 2π (or 360°) changes its sign. Although weird, this is expected behavior!"),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,116,-1,116,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,62,2,62,2,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[],r=[[6,10,2,-1,"move",0,!1],[7,10,2,0,"halt",0,!1],[2,1,2,0,"halt",0,!1],[4,1,2,0,"halt",Math.PI,!1],[1,4,2,0,"halt",0*Math.PI/8,!1],[2,4,2,0,"halt",1*Math.PI/8,!1],[3,4,2,0,"halt",2*Math.PI/8,!1],[4,4,2,0,"halt",3*Math.PI/8,!1],[5,4,2,0,"halt",4*Math.PI/8,!1],[1,5,2,0,"halt",5*Math.PI/8,!1],[2,5,2,0,"halt",6*Math.PI/8,!1],[3,5,2,0,"halt",7*Math.PI/8,!1],[4,5,2,0,"halt",8*Math.PI/8,!1],[5,5,2,0,"halt",9*Math.PI/8,!1],[2,8,2,0,"halt",0*Math.PI/8,!1],[4,8,2,0,"halt",0*Math.PI/8,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,15===t&&(s._ampsComp=[-1,0],s._ampsRot=[-1,0],s._ampsFinal=[-1,0]),UBOARD[0].setQubit(s)}for(o=[[7,10,"qCreate","free",2,0,0,0,-1],[0,10,"trash","free",0,.7853981633974483,0,0,-1],[6,10,"delay","reset",0,0,0,5,-1],[2,10,"rotate","free",0,3.141592653589793,0,0,-1],[4,10,"rotate","free",0,3.141592653589793,0,0,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(9===TUTORIAL.current){TUTORIAL.title="Handbook 10: Flip and Rotation Gates",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" $$r:Flip $$r:gates act to reflect qubits about a chosen axis."),TUTORIAL.info.push(String.fromCharCode(8226)+" Flip gates can be toggled to act instead as identity (i.e. qubits are unchanged)."),TUTORIAL.info.push(String.fromCharCode(8226)+" The sign of the output changes depending on if the qubit is aligned or anti-aligned with the flip axis."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" $$r:Rotation $$r:gates act to rotate qubits up to a half-turn in either direction (i.e. within range -π to π)."),TUTORIAL.info.push(" "),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" Rotation gates act as identity if the rotation angle is set to zero."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,68,2,2,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,68,2,2,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,68,2,2,87,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,68,2,2,87,89,56,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,62,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,62,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,4,2,62,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[[6,4,2,-1,"upgrade",0,0,!1],[6,5,2,-1,"upgrade",0,0,!1],[7,4,2,-1,"wait",1,0,!1],[7,5,2,-1,"wait",1,0,!1]],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[[5,1,2,-1,"halt",-1.178097245096172,!1],[5,2,2,-1,"halt",0,!1],[0,6,2,-1,"halt",-1.9634954084936211,!1],[0,9,3,-1,"halt",-.7853981633974484,!1],[1,12,2,-1,"halt",-2.748893571891069,!1],[6,1,2,-1,"wait",-1.5707963267948966,!1],[6,2,2,-1,"wait",-2.356194490192345,!1],[1,6,2,-1,"wait",0,!1],[0,10,3,-1,"wait",-1.9634954084936211,!1],[2,12,2,-1,"wait",-1.178097245096172,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[3,5,"qFlip","free",0,1.5707963267948966,0,0,-1],[3,4,"qFlip","free",0,4.71238898038469,0,0,-1],[0,4,"trash","free",0,.7853981633974483,0,0,-1],[0,5,"trash","free",0,.7853981633974483,0,0,-1],[6,5,"upgrade","transform",2,.7853981633974483,0,0,-1],[6,4,"upgrade","transform",2,.7853981633974483,0,0,-1],[7,4,"delay","transform",0,0,0,3,-1],[7,5,"delay","transform",0,0,0,3,-1],[8,4,"cCreate","create",2,1,0,0,-1],[8,5,"cCreate","create",2,1,0,0,-1],[3,1,"qFlip","free",0,.7853981633974483,0,0,-1],[3,2,"qFlip","free",0,.7853981633974483,0,1,-1],[7,1,"qCreate","create",2,2,0,0,-1],[7,2,"qCreate","create",2,2,0,0,-1],[0,2,"trash","free",0,.7853981633974483,0,0,-1],[0,1,"trash","free",0,.7853981633974483,0,0,-1],[6,2,"delay","transform",0,0,0,3,-1],[6,1,"delay","transform",0,0,0,3,-1],[3,7,"rotate","free",0,2.356194490192345,0,0,-1],[3,9,"rotate","free",0,4.71238898038469,0,0,-1],[1,6,"delay","transform",0,0,0,3,-1],[0,10,"delay","transform",1,0,0,3,-1],[2,6,"qCreate","create",2,2,0,0,-1],[0,11,"qCreate","create",3,2,0,0,-1],[6,7,"trash","free",0,.7853981633974483,0,0,-1],[6,9,"trash","free",0,.7853981633974483,0,0,-1],[3,11,"rotate","free",0,0,0,0,-1],[6,11,"trash","free",0,.7853981633974483,0,0,-1],[2,12,"delay","transform",0,0,0,3,-1],[3,12,"qCreate","create",2,2,0,0,-1]],t=0;t<o.length;t++){
n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(10===TUTORIAL.current){TUTORIAL.title="Handbook 11: Measurements",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" $$r:Measurements produce output qubits either aligned or anti-aligned with the measurment axis."),TUTORIAL.info.push(String.fromCharCode(8226)+" The probability for each outcome depends on the angle Θ between the head of the measurement and the head of the qubit (align prob = cos²(Θ/2), anti-align prob = sin²(Θ/2))."),TUTORIAL.info.push(" "),TUTORIAL.info.push(String.fromCharCode(8226)+" Input qubits that are already aligned / anti-aligned with the measurement remain unchanged."),TUTORIAL.info.push(String.fromCharCode(8226)+" Classical bits corresponding to the measurement outcome (`0` for aligned, `1` for anti-aligned) are output if the $$b:blue tabs are connected to compatible wires or gates."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],SCENARIO.text0={i0:3,j0:1.25,text:"prob: 0.85"},SCENARIO.text1={i0:3,j0:4.75,text:"prob: 0.15"},UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[4,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,0,116,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,60,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,116,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,60,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,24,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,60,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,90,-1,-1,23,22,22,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,77,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[[0,3,1,-1,"halt",0,!1],[2,10,0,-1,"halt",.7853981633974484,!1],[2,7,0,-1,"halt",0,!1],[0,2,1,-1,"wait",0,!1],[0,11,3,-1,"wait",-1.9634954084936211,!1],[0,8,3,-1,"wait",3.141592653589793,!1],[0,1,1,-1,"halt",0,!1],[0,0,2,-1,"halt",0,!1],[0,12,3,1,"halt",1.1780972450961724,!1],[0,9,3,1,"halt",0,!1],[4,2,1,-1,"halt",Math.PI/4,!1],[4,4,1,-1,"halt",5*Math.PI/4,!1],[2,2,1,-1,"halt",0,!1],[2,4,1,-1,"halt",0,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[6,10,"trash","free",0,.7853981633974483,0,0,-1],[6,9,"trash","free",0,.7853981633974483,0,0,-1],[1,0,"qCreate","create",2,0,0,0,-1],[0,12,"qCreate","free",3,2,0,0,-1],[0,11,"delay","transform",1,2,0,3,-1],[3,10,"measure","free",0,.7853981633974483,0,0,-1],[6,11,"trash","free",0,.7853981633974483,0,0,-1],[6,7,"trash","free",0,.7853981633974483,0,0,-1],[3,7,"measure","free",0,0,0,0,-1],[0,9,"qCreate","free",3,1,0,0,-1],[0,8,"delay","transform",1,2,0,3,-1],[3,3,"measure","free",0,.7853981633974483,0,0,-1],[6,3,"trash","free",0,.7853981633974483,0,0,-1],[0,2,"delay","transform",1,0,0,3,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(11===TUTORIAL.current){TUTORIAL.title="Handbook 12: Qubit Control Gates",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" $$r:Qubit $$r:control $$r:gates affect the action of the (flip or rotate) gate placed within their $$d:target $$d:ring based on the state of the control qubit."),TUTORIAL.info.push(String.fromCharCode(8226)+" If the control qubit and gate are aligned then the target gate acts as the identity (i.e. no action), else if they are anti-aligned the target gate acts normally."),TUTORIAL.info.push(""),TUTORIAL.info.push(String.fromCharCode(8226)+" Gates will hold a control/target qubit in place until both are occupied simultaneously."),TUTORIAL.info.push(String.fromCharCode(8226)+" If the control qubit is neither aligned nor anti-aligned with the control gate then an $$d:entangled $$d:state can be produced (see qubit superpositions / entangled states)."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],SCENARIO.text0={i0:3,j0:2.5,text:" aligned"},SCENARIO.text1={i0:3,j0:3.5,text:"anti-aligned"},UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,68,2,62,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,72,2,72,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,70,2,70,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,68,2,62,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,70,2,2,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,68,2,2,89,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,70,2,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,2,68,2,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[[0,1,2,-1,"delete",0,!1],[0,2,2,-1,"delete",0,!1],[0,4,2,-1,"delete",3.141592653589793,!1],[0,5,2,-1,"delete",0,!1],[3,1,2,-1,"halt",0,!1],[3,2,2,-1,"halt",0,!1],[3,4,2,-1,"halt",3.141592653589793,!1],[3,5,2,-1,"halt",3.141592653589793,!1],[6,1,2,-1,"move",0,!1],[6,2,2,-1,"move",0,!1],[6,4,2,-1,"move",3.141592653589793,!1],[6,5,2,-1,"move",0,!1],[7,1,2,0,"halt",0,!1],[7,2,2,0,"halt",0,!1],[7,4,2,0,"halt",3.141592653589793,!1],[7,5,2,0,"halt",0,!1],[3,7,2,-1,"wait",0,!1],[6,8,2,-1,"move",3.141592653589793,!1],[6,10,2,-1,"move",1.5707963267948966,!1],[6,11,2,-1,"move",0,!1],[6,7,2,-1,"move",0,!1],[7,8,2,0,"halt",0,!1],[7,10,2,0,"halt",1.5707963267948966,!1],[7,11,2,0,"halt",0,!1],[8,1,2,0,"halt",0,!1],[8,2,2,0,"halt",0,!1],[8,4,2,0,"halt",0,!1],[8,5,2,0,"halt",0,!1],[8,10,2,0,"halt",0,!1],[8,11,2,0,"halt",0,!1],[7,7,2,0,"halt",0,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[2,2,"qControl","free",2,0,0,0,-1],[4,2,"qControl","free",2,0,0,0,-1],[2,1,"qFlip","free",0,1.5707963267948966,0,0,-1],[2,1,"qFlip","free",0,.7853981633974483,1,0,-1],[4,1,"rotate","free",0,3.141592653589793,0,0,-1],[4,1,"rotate","free",0,.7853981633974483,1,0,-1],[2,4,"qControl","free",0,0,0,0,-1],[4,4,"qControl","free",0,0,0,0,-1],[4,5,"rotate","free",0,3.141592653589793,0,0,-1],[4,5,"rotate","free",0,.7853981633974483,1,0,-1],[2,5,"qFlip","free",0,1.5707963267948966,0,0,-1],[2,5,"qFlip","free",0,.7853981633974483,1,0,-1],[0,5,"trash","transform",0,.7853981633974483,0,0,-1],[0,4,"trash","transform",0,.7853981633974483,0,0,-1],[0,2,"trash","transform",0,.7853981633974483,0,0,-1],[0,1,"trash","transform",0,.7853981633974483,0,0,-1],[6,1,"delay","reset",0,0,0,3,-1],[6,2,"delay","reset",0,0,0,3,-1],[6,4,"delay","reset",0,0,0,3,-1],[6,5,"delay","reset",0,0,0,3,-1],[8,1,"qCreate","free",2,0,0,0,-1],[8,2,"qCreate","free",2,0,0,0,-1],[8,4,"qCreate","free",2,0,0,0,-1],[8,5,"qCreate","free",2,0,0,0,-1],[7,4,"qFlip","free",0,1.5707963267948966,0,0,-1],[7,2,"qFlip","free",0,.7853981633974483,0,1,-1],[7,1,"qFlip","free",0,.7853981633974483,0,1,-1],[7,5,"qFlip","free",0,1.5707963267948966,0,1,-1],[3,7,"qControl","pretransform",0,0,0,0,-1],[6,7,"delay","reset",0,0,0,2,-1],[6,8,"delay","reset",0,0,0,5,-1],[7,7,"qCreate","free",2,1,0,0,-1],[7,8,"qCreate","free",2,1,0,0,-1],[0,7,"trash","free",0,.7853981633974483,0,0,-1],[0,8,"trash","free",0,.7853981633974483,0,0,-1],[3,8,"qFlip","free",0,.7853981633974483,0,0,-1],[3,8,"qFlip","free",0,1.5707963267948966,1,0,-1],[3,10,"qControl","free",0,0,0,0,-1],[8,10,"qCreate","free",2,0,0,0,-1],[6,10,"delay","reset",0,0,0,3,-1],[7,10,"qFlip","free",0,.7853981633974483,0,0,-1],[0,10,"trash","free",0,.7853981633974483,0,0,-1],[0,11,"trash","free",0,.7853981633974483,0,0,-1],[3,11,"qFlip","free",0,1.5707963267948966,0,0,-1],[3,11,"qFlip","free",0,.7853981633974483,1,0,-1],[8,11,"qCreate","free",2,0,0,0,-1],[7,11,"qFlip","free",0,1.5707963267948966,0,1,-1],[6,11,"delay","reset",0,0,0,3,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(12===TUTORIAL.current){TUTORIAL.title="Handbook 13: Qubit Superpositions",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" A single $$r:qubit aligned along an axis can be equivalently represented as a weighted sum (or superposition) of qubits aligned along a different axis. The choice of axis is called the $$d:basis."),TUTORIAL.info.push(String.fromCharCode(8226)+" As an analogy, this is similar to how single color can be represented as a mixture of two other colors."),TUTORIAL.info.push(String.fromCharCode(8226)+" In game, a superposition is shown by a qubit `blinking` through states. The $$d:magnitude of each component is denoted by the dash-length of its border, while the $$d:sign is denoted by color (green +ve / purple -ve)."),TUTORIAL.info.push(String.fromCharCode(8226)+" Although the $$d:global sign of a state is insignificant, the $$d:relative sign between components is significant."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=new Array(FIELD.cols*FIELD.rows).fill(-1);for(e=[],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(o=[],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(13===TUTORIAL.current){TUTORIAL.title="Handbook 14: Entangled States",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" $$d:Entangled $$d:states can only be produced from unentangled qubits through use of $$r:quantum $$r:control gates. Entangled states of many qubits can be formed through use of multiple quantum control gates."),TUTORIAL.info.push(String.fromCharCode(8226)+" Entanglement is indicated via a translucent blob surrounding qubits. Qubits that are entangled together possess the same colored blob!"),TUTORIAL.info.push(String.fromCharCode(8226)+" Entanglement is removed from any qubit that is measured; however the $$d:OTHER qubits that were entangled also change in response to the measurement result (see Wavefunction Collapse). It follows that measurements of entangled states can exhibit $$d:correlations not possible in non-entangled qubits."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,62,2,70,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,70,2,68,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,84,2,68,2,62,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,2,2,2,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,70,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,60,2,68,2,89,68,76,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,2,2,2,2,84,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];for(e=[],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(r=[[6,2,2,-1,"move",1.5707963267948966,!1],[6,4,2,-1,"move",0,!1],[6,3,2,-1,"move",0,!1],[6,8,2,-1,"move",1.5707963267948966,!1],[6,9,2,-1,"move",0,!1],[7,2,2,0,"halt",1.5707963267948966,!1],[7,4,2,0,"halt",0,!1],[7,3,2,0,"halt",0,!1],[7,8,2,0,"halt",1.5707963267948966,!1],[7,9,2,0,"halt",0,!1],[8,2,2,0,"halt",0,!1],[8,4,2,0,"halt",0,!1],[8,3,2,0,"halt",0,!1],[8,8,2,0,"halt",0,!1],[8,9,2,0,"halt",0,!1]],t=0;t<r.length;t++){i=r[t].pop(),s=new Qubit(...r[t]);s.isGhost=i,UBOARD[0].setQubit(s)}for(o=[[0,4,"trash","free",0,.7853981633974483,0,0,-1],[0,2,"trash","free",0,.7853981633974483,0,0,-1],[8,2,"qCreate","free",2,0,0,0,-1],[8,4,"qCreate","free",2,0,0,0,-1],[6,2,"delay","reset",0,0,0,5,-1],[6,4,"delay","reset",0,0,0,5,-1],[8,3,"qCreate","free",2,0,0,0,-1],[0,3,"trash","free",0,.7853981633974483,0,0,-1],[6,3,"delay","reset",0,0,0,5,-1],[4,2,"qControl","free",0,0,0,0,-1],[2,3,"qControl","free",0,0,0,0,-1],[7,2,"qFlip","free",0,.7853981633974483,0,0,-1],[4,3,"qFlip","free",0,1.5707963267948966,0,0,-1],[4,3,"qFlip","free",0,.7853981633974483,1,0,-1],[2,4,"qFlip","free",0,1.5707963267948966,0,0,-1],[2,4,"qFlip","free",0,.7853981633974483,1,0,-1],[4,4,"rotate","free",0,.7853981633974483,0,0,-1],[2,2,"rotate","free",0,.7853981633974483,0,0,-1],[7,3,"qFlip","free",0,.7853981633974483,0,1,-1],[7,4,"qFlip","free",0,.7853981633974483,0,1,-1],[4,8,"qControl","free",0,0,0,0,-1],[8,8,"qCreate","free",2,0,0,0,-1],[7,8,"qFlip","free",0,.7853981633974483,0,0,-1],[6,8,"delay","reset",0,0,0,5,-1],[6,9,"delay","reset",0,0,0,5,-1],[7,9,"qFlip","free",0,.7853981633974483,0,1,-1],[8,9,"qCreate","free",2,0,0,0,-1],[4,9,"qFlip","free",0,1.5707963267948966,0,0,-1],[4,9,"qFlip","free",0,.7853981633974483,1,0,-1],[2,9,"measure","free",0,.7853981633974483,0,0,-1],[7,10,"trash","free",0,.7853981633974483,0,0,-1],[7,7,"trash","free",0,.7853981633974483,0,0,-1]],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}var h=new Entangled(3);h.setQubits([new Qubit(2,11,0,2,"halt",0),new Qubit(3,11,0,2,"halt",0),new Qubit(4,11,0,2,"halt",0)]),h.ampsComp=[.5,0,0,-.5,0,.5,0,.5],h.computeRotAmps(),h.computeAllEnts(),UBOARD[0].setEntGroup(h),UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(14===TUTORIAL.current){SVG.tutorialB.activate(),SVG.tutorialB.svg.style.zIndex="30",TUTORIAL.title="Handbook 15: State Analyzer",TUTORIAL.info=[],TUTORIAL.info.push("The $$d:state $$d:analyzer, which appears when clicking on a qubit while the factory is paused, provides details about a qubit or entangled state including:"),TUTORIAL.info.push(String.fromCharCode(8226)+" the $$d:amplitudes in each of the basis states (together with the ability to alter each qubit basis)."),TUTORIAL.info.push(String.fromCharCode(8226)+" the $$d:entanglement $$d:entropy of each qubit; this is a measure of its entanglement on a scale of 0-1."),TUTORIAL.info.push(String.fromCharCode(8226)+" the $$d:expected $$d:results of a single qubit measurement in a specified basis."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=new Array(FIELD.cols*FIELD.rows).fill(-1);for(e=[],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(o=[],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else if(15===TUTORIAL.current){SVG.tutorialB.activate(),SVG.tutorialB.svg.style.zIndex="30",TUTORIAL.title="Handbook 16: Wavefunction Collapse",TUTORIAL.info=[],TUTORIAL.info.push(String.fromCharCode(8226)+" When a qubit from an entangled state is measured the remaining qubits collapse into a new state (that depends on the measurement outcome of the first qubit). The new state can be predicted using the state analyzer (by clicking on the $$d:orange $$d:buttons below each qubit)."),TUTORIAL.info.push("In the examples on the left:"),TUTORIAL.info.push(String.fromCharCode(8226)+" If qubit-1 is found in state "+String.fromCharCode(9650)+" after measurement then qubit-2 will collapse into an even superposition, ("+String.fromCharCode(9654)+" + "+String.fromCharCode(9664)+")."),TUTORIAL.info.push(String.fromCharCode(8226)+" If qubit-1 is found in state "+String.fromCharCode(9660)+" after measurement then qubit-2 will collapse into an odd superposition, ("+String.fromCharCode(9654)+" - "+String.fromCharCode(9664)+")."),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[0]._tiles=new Array(FIELD.cols*FIELD.rows).fill(-1);for(e=[],t=0;t<e.length;t++){i=e[t].pop(),a=new Bit(...e[t]);a.isGhost=i,UBOARD[0].setBit(a)}for(o=[],t=0;t<o.length;t++){n=o[t].pop(),l=new Gate(...o[t]);l.counterMax=n,UBOARD[0].setGate(l)}UBOARD[1]=UBOARD[0].copy().updateOneStep()}else 16===TUTORIAL.current&&(SVG.tutorialB.activate(),SVG.tutorialB.svg.style.zIndex="30",TUTORIAL.title="Handbook 0: Controls Reference",TUTORIAL.info=[],TUTORIAL.info.push("Game Controls (during construction phase):                   ---------------------------------------------------------------"),TUTORIAL.info.push(" Select, place, interact with objects: $$d:LMB. "),TUTORIAL.info.push(" Erase objects: $$d:RMB $$d:(or $$d:`E` $$d:key $$d:then $$d:LMB). "),TUTORIAL.info.push(" Rotate gate (while placing): $$d:Mouse-scroll $$d:(or $$d:◀/► $$d:keys). "),TUTORIAL.info.push(" Toggle control-gate states: $$d:Double-click $$d:(or $$d:ALT/OPT-click)."),TUTORIAL.info.push(" Copy gate(s): $$d:SHIFT+LMB $$d:(+drag $$d:to $$d:select $$d:larger $$d:region). "),TUTORIAL.info.push(" Cut gate(s): $$d:CTRL/CMD+LMB $$d:(+drag $$d:to $$d:select $$d:larger $$d:region). "),TUTORIAL.info.push(" Undo/redo last action: $$d:`Z` $$d:/ $$d:`X` $$d:keys. "),TUTORIAL.info.push(" Select last/next available gate from menu: $$d:`Q` $$d:/ $$d:`W` $$d:keys. "),TUTORIAL.info.push(" Gate hotkeys (rows 1,2,3): $$d:[1-6], $$d:SHIFT+[1-6], $$d:CTRL+[1-6]."),TUTORIAL.info.push(" Copy factory layout to clipboard: $$d:CTRL+C. "),TUTORIAL.info.push(" Paste factory from clipboard: $$d:CTRL+V $$d:(N/A $$d:for $$d:Firefox). "),TUTORIAL.type="free",TUTORIAL.timePerTick=800,TUTORIAL.grab=0,TUTORIAL.basis=OPTS.basis,OPTS.basis="natural",SCENARIO.channelsCol=[0,0,0,0,0,0],UBOARD[0]=new Board(CANV.tutorialGates.ctx,19,14),UBOARD[1]=UBOARD[0].copy().updateOneStep())}class Achievements{static draw(e,t){for(var i=FIELD.isActiveAward,a=FIELD.tileWidth,r=e.ctx,s=t.ctx,o=1.5*FIELD.tileHeight,n=Paths.greyTile(r),l=Paths.greyTile(r,!0),h=0;h<4;h++){var d=17*FIELD.tileWidth;n.draw(r,d+h*a+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight),n.draw(r,d+h*a+.05*a,o+1.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}t.clear(),"selectAward"===STATE.under.type&&i[STATE.under.k0]&&(s.save(),s.font=2*FIELD.tileWidth/4+"px Courier New",s.fillStyle="antiquewhite",s.shadowBlur=2,s.shadowOffsetX=2,s.shadowOffsetY=2,s.textAlign="center",s.textBaseline="middle",s.fillText(DESCRIPTIONS.allTitles[STATE.under.k0][0],3.5*a,3.7*a),s.fillText(DESCRIPTIONS.allTitles[STATE.under.k0][1],3.5*a,4.4*a),n.draw(s,2.5*a+.1*a,5*a+.1*a,1.8*FIELD.tileWidth,1.8*FIELD.tileHeight),s.strokeStyle="antiquewhite",s.lineWidth=1,s.beginPath(),s.stroke(Helper.roundRect(Math.floor(1.2*a)+.5,Math.floor(3*a)+.5,Math.floor(4.6*a),Math.floor(4.3*a),a/4)),s.restore()),r.save(),r.font=1.2*FIELD.tileWidth/4+"px Verdana",r.fillStyle="black",r.textAlign="left",r.textBaseline="middle",r.fillText("Awards:",16.9*a,1.3*a),r.beginPath(),r.lineWidth=1.5,r.lineStyle="#888",r.stroke(Helper.roundRect(16.8*a,1.1*a,4.35*FIELD.tileWidth,2.5*FIELD.tileWidth,FIELD.tileWidth/8)),r.restore();o=1.5*FIELD.tileHeight,d=17*FIELD.tileWidth;if(i[0]){n=Paths.bit(r,0,0,TIMER.glareRatio);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight);n=Paths.scannersSmall(r,TIMER.trigRatio,0);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}else{n=Paths.greyBit(r,0);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight),l.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}if("selectAward"===STATE.under.type&&i[0]&&0===STATE.under.k0){d=2.5*a,o=5*a,n=Paths.bit(r,0,0,TIMER.glareRatio);n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight);n=Paths.scannersSmall(r,TIMER.trigRatio,0);n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}o=2.5*FIELD.tileHeight,d=17*FIELD.tileWidth;if(i[1]){if(TIMER.trigRatio>.5){n=Paths.bit(r,0,TIMER.trigRatioDub,TIMER.glareRatio);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}n=Paths.wormholesOld(r,TIMER.trigRatio,1);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}else{n=Paths.greyBit(r,0);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight),l.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}if("selectAward"===STATE.under.type&&i[1]&&1===STATE.under.k0){d=2.5*a,o=5*a;if(TIMER.trigRatio>.5){n=Paths.bit(s,0,TIMER.trigRatioDub,TIMER.glareRatio);n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}n=Paths.wormholesOld(r,TIMER.trigRatio,1);n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}o=1.5*FIELD.tileHeight,d=18*FIELD.tileWidth;if(i[2]){n=Paths.newQubit(r,0,0,TIMER.glareRatio);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight);n=Paths.scannersSmall(r,TIMER.trigRatio,0,1);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}else{n=Paths.greyQubit(r,0,0);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight),l.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}if("selectAward"===STATE.under.type&&i[2]&&2===STATE.under.k0){d=2.5*a,o=5*a,n=Paths.newQubit(r,0,0,TIMER.glareRatio);n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight);n=Paths.scannersSmall(r,TIMER.trigRatio,0,1);n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}o=2.5*FIELD.tileHeight,d=18*FIELD.tileWidth;if(i[3]){if(TIMER.trigRatio>.5){n=Paths.newQubit(r,0,TIMER.trigRatioDub,TIMER.glareRatio);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}n=Paths.wormholesOld(r,TIMER.trigRatio);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}else{n=Paths.greyQubit(r,0,0);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight),l.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}if("selectAward"===STATE.under.type&&i[3]&&3===STATE.under.k0){d=2.5*a,o=5*a;if(TIMER.trigRatio>.5){n=Paths.newQubit(s,0,TIMER.trigRatioDub,TIMER.glareRatio);n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}n=Paths.wormholesOld(s,TIMER.trigRatio);n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}o=1.5*FIELD.tileHeight,d=19*FIELD.tileWidth;if(i[4]){var u=Math.PI/4,c=(n=Paths.qFlip(r,0,u,0),-Math.round(TIMER.ratio)*Math.PI/2);if(Math.round(TIMER.tick+TIMER.ratio)%4==0){n=Paths.newQubit(r,c,0,TIMER.glareRatio,{ratio:TIMER.trigRatioDub,rot:3*u});n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}else if(Math.round(TIMER.tick+TIMER.ratio)%4==1){n=Paths.newQubit(r,Math.PI/2+c,0,TIMER.glareRatio,{ratio:TIMER.trigRatioDub,rot:u});n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}else if(Math.round(TIMER.tick+TIMER.ratio)%4==2){n=Paths.newQubit(r,Math.PI+c,0,TIMER.glareRatio,{ratio:TIMER.trigRatioDub,rot:3*u});n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}else if(Math.round(TIMER.tick+TIMER.ratio)%4==3){n=Paths.newQubit(r,3*Math.PI/2+c,0,TIMER.glareRatio,{ratio:TIMER.trigRatioDub,rot:u});n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight)}}else{n=Paths.greyQubit(r,0,0);n.draw(r,d,o,FIELD.tileWidth,FIELD.tileHeight),l.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}if("selectAward"===STATE.under.type&&i[4]&&4===STATE.under.k0){d=2.5*a,o=5*a,u=Math.PI/4,n=Paths.qFlip(s,0,u,0),c=-Math.round(TIMER.ratio)*Math.PI/2;if(Math.round(TIMER.tick+TIMER.ratio)%4==0){n=Paths.newQubit(s,c,0,TIMER.glareRatio,{ratio:TIMER.trigRatioDub,rot:3*u});n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}else if(Math.round(TIMER.tick+TIMER.ratio)%4==1){n=Paths.newQubit(s,Math.PI/2+c,0,TIMER.glareRatio,{ratio:TIMER.trigRatioDub,rot:u});n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}else if(Math.round(TIMER.tick+TIMER.ratio)%4==2){n=Paths.newQubit(s,Math.PI+c,0,TIMER.glareRatio,{ratio:TIMER.trigRatioDub,rot:3*u});n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}else if(Math.round(TIMER.tick+TIMER.ratio)%4==3){n=Paths.newQubit(s,3*Math.PI/2+c,0,TIMER.glareRatio,{ratio:TIMER.trigRatioDub,rot:u});n.draw(s,d,o,2*FIELD.tileWidth,2*FIELD.tileHeight)}}o=2.5*FIELD.tileHeight,d=19*FIELD.tileWidth;if(i[5]){n=Paths.measure(r,0,Math.PI/4,TIMER.trigRatioDub);n.draw(r,d+.1*a,o+.1*a,.8*a,.8*a);n=Paths.scanners(r,TIMER.trigRatio,Math.PI/4);n.draw(r,d+.1*a,o+.1*a,.8*a,.8*a);n=Paths.scanners(r,TIMER.trigRatio,5*Math.PI/4);n.draw(r,d+.1*a,o+.1*a,.8*a,.8*a)}else{n=Paths.measure(r,0,Math.PI/4,TIMER.trigRatioDub,!0);n.draw(r,d+.1*a,o+.1*a,.8*a,.8*a),l.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}if("selectAward"===STATE.under.type&&i[5]&&5===STATE.under.k0){d=2.5*a,o=5*a,n=Paths.measure(s,0,Math.PI/4,TIMER.trigRatioDub);n.draw(s,d+.2*a,o+.2*a,1.6*a,1.6*a);n=Paths.scanners(s,TIMER.trigRatio,Math.PI/4);n.draw(s,d+.2*a,o+.2*a,1.6*a,1.6*a);n=Paths.scanners(s,TIMER.trigRatio,5*Math.PI/4);n.draw(s,d+.2*a,o+.2*a,1.6*a,1.6*a)}o=1.5*FIELD.tileHeight,d=20*FIELD.tileWidth;if(i[6]){var I=TIMER.tick%2;if(TIMER.ratio<.5){n=PathsC.ctrlStart(r,TIMER.trigRatioDub,TIMER.trigRatioDub,0,I,!0);n.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}else{n=PathsC.ctrlStart(r,TIMER.trigRatioDub,TIMER.trigRatioDub,0,1-I,!0);n.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}}else{n=PathsC.ctrlGrey(r);n.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight),l.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}if("selectAward"===STATE.under.type&&i[6]&&6===STATE.under.k0){d=2.5*a,o=5*a,I=TIMER.tick%2;if(TIMER.ratio<.5){n=PathsC.ctrlStart(s,TIMER.trigRatioDub,TIMER.trigRatioDub,0,I,!0);n.draw(s,d+.1*a,o+.1*a,1.8*FIELD.tileWidth,1.8*FIELD.tileHeight)}else{n=PathsC.ctrlStart(s,TIMER.trigRatioDub,TIMER.trigRatioDub,0,1-I,!0);n.draw(s,d+.1*a,o+.1*a,1.8*FIELD.tileWidth,1.8*FIELD.tileHeight)}}o=2.5*FIELD.tileHeight,d=20*FIELD.tileWidth;if(i[7]){I=TIMER.tick%2;if(TIMER.ratio<.5){n=PathsC.ctrlPlay(r,TIMER.trigRatioDub,TIMER.trigRatioDub,-1,I,!0);n.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}else{n=PathsC.ctrlPlay(r,TIMER.trigRatioDub,TIMER.trigRatioDub,-1,1-I,!0);n.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}}else{n=PathsC.ctrlGrey(r);n.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight),l.draw(r,d+.05*a,o+.05*a,.9*FIELD.tileWidth,.9*FIELD.tileHeight)}if("selectAward"===STATE.under.type&&i[7]&&7===STATE.under.k0){d=2.5*a,o=5*a,I=TIMER.tick%2;if(TIMER.ratio<.5){n=PathsC.ctrlPlay(s,TIMER.trigRatioDub,TIMER.trigRatioDub,-1,I,!0);n.draw(s,d+.1*a,o+.1*a,1.8*FIELD.tileWidth,1.8*FIELD.tileHeight)}else{n=PathsC.ctrlPlay(s,TIMER.trigRatioDub,TIMER.trigRatioDub,-1,1-I,!0);n.draw(s,d+.1*a,o+.1*a,1.8*FIELD.tileWidth,1.8*FIELD.tileHeight)}}}}class Analysis{static updateSlide(e){if(ANALYSIS.isOpening?(ANALYSIS.openAmount=Math.min(1,ANALYSIS.openAmount+1*ANALYSIS.openSpeed),ANALYSIS.openTrig=Math.min((.5-.505*Math.cos(Math.PI*ANALYSIS.openAmount))**2,1)):(ANALYSIS.openAmount=Math.max(0,ANALYSIS.openAmount-1*ANALYSIS.openSpeed),ANALYSIS.openTrig=Math.max((.5-.505*Math.cos(Math.PI*ANALYSIS.openAmount))**2,0)),0===ANALYSIS.openTrig&&(ANALYSIS.last=0),"qubit"===STATE.grab.type||"qubitcontrol"===STATE.grab.type){STATE.grab.k0.entGroup?ANALYSIS.bonusTiles=Math.max(0,STATE.grab.k0.entGroup.numQubits-4):ANALYSIS.bonusTiles=0,STATE.grab.k0.entGroup&&STATE.grab.k0.entGroup.numQubits>4?ANALYSIS.bonusOpen<ANALYSIS.bonusTiles?ANALYSIS.bonusOpen=Math.min(ANALYSIS.bonusTiles,ANALYSIS.bonusOpen+4*ANALYSIS.openSpeed):ANALYSIS.bonusOpen=Math.max(ANALYSIS.bonusTiles,ANALYSIS.bonusOpen-4*ANALYSIS.openSpeed):ANALYSIS.bonusOpen=Math.max(0,ANALYSIS.bonusOpen-4*ANALYSIS.openSpeed),ANALYSIS.isOpening=!0,ANALYSIS.last=STATE.grab.k0;var t=ANALYSIS.openTrig*FIELD.menuWidth+FIELD.analysisLeft+ANALYSIS.bonusOpen*FIELD.tileWidth,i=.5*FIELD.tileWidth+t+-FIELD.analysisLeft-FIELD.menuWidth-ANALYSIS.bonusTiles*FIELD.tileWidth;ANALYSIS.openTrig>0&&Analysis.draw(e,STATE.grab.k0,i),SVG.analysis.svg.style.width=t-FIELD.analysisLeft+"px",SVG.analysis.svg.setAttribute("width",t-FIELD.analysisLeft+"px"),CANV.analysisOverlay.canv.style.left=t-FIELD.analysisWidth-(FIELD.maxBonusTiles+.5)*FIELD.tileWidth+"px"}else{ANALYSIS.isOpening=!1,ANALYSIS.bonusOpen=Math.max(0,ANALYSIS.bonusOpen-4*ANALYSIS.openSpeed);t=ANALYSIS.openTrig*FIELD.menuWidth+FIELD.analysisLeft+ANALYSIS.bonusOpen*FIELD.tileWidth,i=.5*FIELD.tileWidth+t+-FIELD.analysisLeft-FIELD.menuWidth-ANALYSIS.bonusTiles*FIELD.tileWidth;ANALYSIS.last?ANALYSIS.openTrig>0&&Analysis.draw(e,ANALYSIS.last,i):CANV.analysis.clear();t=ANALYSIS.openTrig*FIELD.menuWidth+FIELD.analysisLeft+ANALYSIS.bonusOpen*FIELD.tileWidth;SVG.analysis.svg.style.width=t-FIELD.analysisLeft+"px",SVG.analysis.svg.setAttribute("width",t-FIELD.analysisLeft+"px"),CANV.analysisOverlay.canv.style.left=t-FIELD.analysisWidth-(FIELD.maxBonusTiles+.5)*FIELD.tileWidth+"px"}}static draw(e,t,i,a=-1,r=!0,s=0,o=0,n=!0){if(s)var l=[...s];else l=ANALYSIS.highlight;if(a<0)var h=ANALYSIS.prob;else h=a;var d=e.ctx;n&&e.clear();var u=ANALYSIS.xMid,c=ANALYSIS.xPad+i,I=ANALYSIS.yPad+o,E=ANALYSIS.xGap,f=ANALYSIS.basisSpace,S=ANALYSIS.basisSize,p=ANALYSIS.barSize,T=ANALYSIS.barPad;if(t.entGroup)var R=2**Math.min(t.entGroup.numQubits,4),m=t.entGroup.numQubits;else R=2,m=1;FIELD.tileWidth;var g=0,A=0;if("analysisicon"===STATE.pressed.type){var C=TIMER.totalTime-STATE.pressed.i0;C>TIMER.iconMax&&(STATE.pressed={type:"none",i0:0,j0:0,k0:0})}var L=-1;if("analysisicon"===STATE.pressed.type){var D=.5*(1-Math.cos(2*Math.PI*(C/TIMER.iconMax)))*(FIELD.tileWidth/48);g=3*D/4,A=7*D/4;L=STATE.pressed.k0}if(t.entGroup){for(var b=t.entGroup,O=0;O<m;O++){var M=b.qubitList[O],v=M.computeAlfs(TIMER.blinkRatio),w=b.id%ENTBLOBS._colors.length,N=2*b.id%ENTBLOBS.numBlobs,P=(2*b.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(d,N,w,c+E+O*FIELD.tileWidth,I,1,M.ent),ENTBLOBS.draw(d,P,w,c+E+O*FIELD.tileWidth,I,-1,M.ent);var y=c+E+O*FIELD.tileWidth,F=I;if(M.isHovered){var k=1+.2*Math.cos(8*Math.PI*TIMER.qubitGlowRatio),x=(k-1)/2*FIELD.tileWidth,B=(k-1)/2*FIELD.tileWidth,W=Paths.qubitHalo(d,M.basisRot,!0,-1),q=.9*(1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio));W.draw(d,y-(q-1)/2*FIELD.tileWidth,F-(q-1)/2*FIELD.tileHeight,q*FIELD.tileWidth,q*FIELD.tileHeight);W=Paths.newQubit(d,M.basisRot,0,TIMER.glareRatioTrig,0,M.arrow(v),M.ampsFinal,M.offsets,v,M.isGhost);W.draw(d,y-x,F-B,k*FIELD.tileWidth,k*FIELD.tileHeight)}else{W=Paths.newQubit(d,M.basisRot,0,TIMER.glareRatioTrig,0,M.arrow(v),M.ampsFinal,M.offsets,v,M.isGhost);W.draw(d,y,I,FIELD.tileWidth,FIELD.tileHeight)}if("qubitbasis"!==STATE.state){W=PathsI.icon(d,"tagIcon",{counter:M.entInd+1});W.draw(d,c+E+O*FIELD.tileWidth,I,FIELD.tileWidth/3,FIELD.tileHeight/3)}var H=!1;"analysishighlight"===STATE.under.type&&STATE.under.k0===O&&(H=!0);W=PathsI.highlightIcon(d,H,l[O]),y=c+E+O*FIELD.tileWidth+(FIELD.tileWidth-S)/2+FIELD.iconWidth/2,F=I+1.5*f+FIELD.tileHeight+(f-S)/2-FIELD.iconHeight/2;O===L?W.draw(d,y+g,F+A,FIELD.iconWidth,FIELD.iconHeight):W.draw(d,y,F,FIELD.iconWidth,FIELD.iconHeight)}if(m>4){var U=b.ampsFinal.map(e=>Math.abs(e)),_=[...Array(2**m).keys()];_.sort(function(e,t){return U[e]>U[t]?-1:U[e]<U[t]?1:0})}else _=[...Array(2**m).keys()];d.save(),d.beginPath(),d.strokeStyle="#333",d.setLineDash([5,5]),d.lineWidth=1;for(var G=0;G<R+1;G++){F=Math.round(I+(G+2)*f+FIELD.tileHeight)+.5;d.moveTo(c,F),d.lineTo(c+m*FIELD.tileWidth,F)}d.stroke(),d.restore(),d.save(),d.beginPath(),d.strokeStyle="#333",d.setLineDash([4,2,2,2]),d.lineWidth=1;for(G=0;G<R+1;G++){F=Math.round(I+(G+2)*f+FIELD.tileHeight)+.5;d.moveTo(Math.round(c+u+m*FIELD.tileWidth)+.5,F),d.lineTo(Math.round(c+u+m*FIELD.tileWidth+p)+.5,F)}d.stroke(),d.restore(),d.save(),d.beginPath(),d.setLineDash([]);for(G=0;G<R;G++){F=Math.round(I+(G+2)*f+T+FIELD.tileHeight);var V=Math.round(I+(G+3)*f-T+FIELD.tileHeight),Q=(y=Math.round(c+u+m*FIELD.tileWidth)+.5,
t.ampsFinal[G]);d.fillStyle=Q>=0?"darkgreen":"#913191",m>4?d.fillRect(y,F,p*Math.abs(t.ampsFinal[_[G]]),V-F):d.fillRect(y,F,p*Math.abs(t.ampsFinal[G]),V-F)}d.restore(),d.save(),d.textBaseline="bottom",d.textAlign="left",d.font=FIELD.tileWidth/3+"px Courier New",d.fillStyle="black",d.fillText("Amplitudes",Math.round(c+u+m*FIELD.tileWidth),Math.round(I+FIELD.tileHeight+f)),d.restore(),d.save(),d.beginPath(),d.setLineDash([]),d.textBaseline="bottom",d.textAlign="center",d.font=FIELD.tileWidth/3+"px Verdana",d.fillStyle="black";F=Math.round(I+1.5*f+.75*T+FIELD.tileHeight)+.5,y=Math.round(c+u+m*FIELD.tileWidth)+.5;d.fillText("0",y,F),d.fillText("½",y+p/2,F),d.fillText("1",y+p,F),d.restore(),d.save(),d.strokeStyle="#666",d.lineWidth=2;for(y=c+u+m*FIELD.tileWidth,G=0;G<R+1;G++){F=FIELD.tileHeight+I+(G+2)*f;Analysis.drawAmpLines(d,y,F,T,p,f)}d.restore(),d.save();for(G=0;G<2**Math.min(m,4);G++){var $=!1;for(O=0;O<m;O++)if(l[O]&&b.enums[O][_[G]]!==l[O]-1)$=!0;if($){for(O=0;O<m;O++){W=Paths.nakedQubit(d,b.qubitList[O].basisRot,b.enums[O][_[G]],!1);W.draw(d,c+E+O*FIELD.tileWidth+(FIELD.tileWidth-S)/2,I+(G+2)*f+FIELD.tileHeight+(f-S)/2,S,S)}d.beginPath(),d.fillStyle="black",d.globalAlpha=.85,d.fillRect(c+E,I+(G+2)*f+FIELD.tileHeight,m*FIELD.tileWidth+u+p+1,f+1),d.closePath()}else for(O=0;O<m;O++){var z=!1;l[O]>0&&(z=!0);W=Paths.nakedQubit(d,b.qubitList[O].basisRot,b.enums[O][_[G]],z);W.draw(d,c+E+O*FIELD.tileWidth+(FIELD.tileWidth-S)/2,I+(G+2)*f+FIELD.tileHeight+(f-S)/2,S,S)}}if(d.restore(),r){d.save();for(G=0;G<m;G++){var j=b.qubitList[G].ent;W=Paths.entMass(d,j,-Math.PI/4);W.draw(d,c+E+G*FIELD.tileWidth,I+FIELD.tileHeight+(2.5+R)*f,FIELD.tileWidth,FIELD.tileHeight)}d.textBaseline="middle",d.textAlign="left",d.font=FIELD.tileWidth/3+"px Courier New",d.fillStyle="black",d.fillText("Entanglement",Math.round(c+u+m*FIELD.tileWidth),Math.round(I+1.5*FIELD.tileHeight+(2.5+R)*f)),d.textAlign="right",d.fillText("<= ",Math.round(c+u+m*FIELD.tileWidth),Math.round(I+1.5*FIELD.tileHeight+(2.5+R)*f)),d.restore()}if(r){d.save();F=ANALYSIS.yMeasure+(R+2)*f;var Y=-1;"analysisgate"===STATE.under.type&&(Y=STATE.under.k0);for(G=0;G<m;G++){y=c+E+G*FIELD.tileWidth+FIELD.tileWidth/2;if(G===Y)var X=.4,Z=GRADS.glow;else X=0,Z=GRADS.gates;if(G===t.entInd){var J=PathsG.make(d,{type:"measure",orient:-1,rot:t.measureRot,state:0,remaining:-1,counter:0,isControlled:!1,basecol:Z,counterMax:-1});J.draw(d,y-FIELD.tileWidth/2,F-FIELD.tileHeight/2,FIELD.tileWidth,FIELD.tileHeight),Halo.drawReduced(d,y,F,t.measureRot)}else{W=Paths.sphere(d,X);W.draw(d,y-FIELD.tileWidth/2,F-FIELD.tileHeight/2,FIELD.tileWidth,FIELD.tileHeight)}}d.restore()}if(r){d.save(),d.textBaseline="middle",d.textAlign="left",d.font=FIELD.tileWidth/3+"px Courier New",d.fillStyle="black",d.fillText("Meas. Probs.",Math.round(c+u+m*FIELD.tileWidth),Math.round(F-1*f)),d.restore(),d.save(),d.beginPath(),d.setLineDash([]),d.textBaseline="middle",d.textAlign="left",d.font=FIELD.tileWidth/3+"px Verdana",d.fillStyle="black";y=Math.round(c+u+m*FIELD.tileWidth);var K=d.measureText("(0) ↦ ").width;d.fillText("(0) ↦",y-FIELD.tileWidth/12,F+0*f),d.fillText("(1) ↦",y-FIELD.tileWidth/12,F+1*f),d.font=4*FIELD.tileWidth/12+"px Verdana",d.fillText("p="+String(Analysis.normFloat(h)),y-FIELD.tileWidth/12+K,F+0*f),d.fillText("p="+String(Analysis.normFloat(1-h)),y-FIELD.tileWidth/12+K,F+1*f),d.restore()}d.save(),d.beginPath(),d.setLineDash([]);for(O=0;O<m;O++){M=b.qubitList[O];t.id===M.id&&QubitHalo.ring(d,c+E+(O+.5)*FIELD.tileWidth,I+.5*FIELD.tileHeight,M.basisRot)}d.restore()}else{v=t.computeAlfs(TIMER.blinkRatio),W=Paths.newQubit(d,t.basisRot,0,TIMER.glareRatioTrig,0,t.arrow(v),t.ampsFinal,t.offsets,v,t.isGhost);W.draw(d,c+E,I,FIELD.tileWidth,FIELD.tileHeight);H=!1;"analysishighlight"===STATE.under.type&&(H=!0);W=PathsI.highlightIcon(d,H,ANALYSIS.highlight[0]),y=c+E+(FIELD.tileWidth-S)/2+FIELD.iconWidth/2,F=I+1.5*f+FIELD.tileHeight+(f-S)/2-FIELD.iconHeight/2;0===L?W.draw(d,y+g,F+A,FIELD.iconWidth,FIELD.iconHeight):W.draw(d,y,F,FIELD.iconWidth,FIELD.iconHeight);for(G=0;G<2;G++){W=Paths.nakedQubit(d,t.basisRot,G);W.draw(d,c+E+(FIELD.tileWidth-S)/2,I+(G+2)*f+FIELD.tileHeight+(f-S)/2,S,S)}d.save(),d.beginPath(),d.strokeStyle="#333",d.setLineDash([5,5]),d.lineWidth=1;for(G=0;G<3;G++){F=Math.round(I+(G+2)*f+FIELD.tileHeight)+.5;d.moveTo(c,F),d.lineTo(c+FIELD.tileWidth,F),d.stroke()}d.restore(),d.save(),d.beginPath(),d.strokeStyle="#333",d.setLineDash([4,2,2,2]),d.lineWidth=1;for(G=0;G<3;G++){F=Math.round(I+(G+2)*f+FIELD.tileHeight)+.5;d.moveTo(c+u+FIELD.tileWidth,F),d.lineTo(c+u+FIELD.tileWidth+p,F),d.stroke()}d.restore(),d.save(),d.beginPath(),d.setLineDash([]);for(G=0;G<2;G++){F=Math.round(I+(G+2)*f+T+FIELD.tileHeight),V=Math.round(I+(G+3)*f-T+FIELD.tileHeight),y=c+u+FIELD.tileWidth,Q=t.ampsFinal[G];d.fillStyle=Q>=0?"darkgreen":"#913191",d.fillRect(y,F,p*Math.abs(t.ampsFinal[G]),V-F)}d.restore(),d.save(),d.textBaseline="bottom",d.textAlign="left",d.font=FIELD.tileWidth/3+"px Courier New",d.fillStyle="black",d.fillText("Amplitudes",Math.round(c+u+FIELD.tileWidth),Math.round(FIELD.tileHeight+I+f)),d.restore(),d.save(),d.beginPath(),d.setLineDash([]),d.textBaseline="bottom",d.textAlign="center",d.font=FIELD.tileWidth/3+"px Verdana",d.fillStyle="black";F=Math.round(FIELD.tileHeight+I+1.5*f+.75*T)+.5,y=Math.round(c+u+FIELD.tileWidth);d.fillText("0",y,F),d.fillText("½",y+p/2,F),d.fillText("1",y+p,F),d.strokeStyle="#666",d.lineWidth=2;for(G=0;G<3;G++){F=FIELD.tileHeight+I+(G+2)*f,y=Math.round(c+u+FIELD.tileWidth);Analysis.drawAmpLines(d,y,F,T,p,f)}d.restore(),d.save();var ee=[[0,1]];for(G=0;G<2**Math.min(m,4);G++){for($=!1,O=0;O<m;O++)if(ANALYSIS.highlight[O]&&ee[O][G]!==ANALYSIS.highlight[O]-1)$=!0;if($){for(O=0;O<m;O++){W=Paths.nakedQubit(d,t.basisRot,ee[O][G],!1);W.draw(d,c+E+O*FIELD.tileWidth+(FIELD.tileWidth-S)/2,I+(G+2)*f+FIELD.tileHeight+(f-S)/2,S,S)}d.beginPath(),d.fillStyle="black",d.globalAlpha=.85,d.fillRect(c+E,I+(G+2)*f+FIELD.tileHeight,m*FIELD.tileWidth+u+p+1,f+1),d.closePath()}else for(O=0;O<m;O++){z=!1;l[O]>0&&(z=!0);W=Paths.nakedQubit(d,t.basisRot,ee[O][G],z);W.draw(d,c+E+O*FIELD.tileWidth+(FIELD.tileWidth-S)/2,I+(G+2)*f+FIELD.tileHeight+(f-S)/2,S,S)}}d.restore(),d.save();j=t.ent,W=Paths.entMass(d,j,-Math.PI/4);W.draw(d,c+E,I+FIELD.tileHeight+4.5*f,FIELD.tileWidth,FIELD.tileHeight),d.textBaseline="middle",d.textAlign="left",d.font=FIELD.tileWidth/3+"px Courier New",d.fillStyle="black",d.fillText("Entanglement",Math.round(c+u+FIELD.tileWidth),Math.round(I+1.5*FIELD.tileHeight+4.5*f)),d.textAlign="right",d.fillText("<= ",Math.round(c+u+FIELD.tileWidth),Math.round(I+1.5*FIELD.tileHeight+4.5*f)),d.restore(),d.save();F=ANALYSIS.yMeasure+4*f,y=c+E+FIELD.tileWidth/2,J=PathsG.make(d,{type:"measure",orient:-1,rot:t.measureRot,state:0,remaining:-1,counter:0,isControlled:!1,basecol:GRADS.gates,counterMax:-1});J.draw(d,y-FIELD.tileWidth/2,F-FIELD.tileHeight/2,FIELD.tileWidth,FIELD.tileHeight),Halo.drawReduced(d,y,F,STATE.grab.k0.measureRot),d.restore(),d.save(),d.beginPath(),d.setLineDash([]),d.textBaseline="middle",d.textAlign="left",d.font=FIELD.tileWidth/3+"px Courier New",d.fillStyle="black",d.fillText("Meas. Probs.",Math.round(c+u+FIELD.tileWidth),Math.round(F-1*f));y=Math.round(c+u+FIELD.tileWidth);d.font=4*FIELD.tileWidth/12+"px Verdana";K=d.measureText("(0) ↦ ").width;d.fillText("(0) ↦",y-FIELD.tileWidth/12,F+0*f),d.fillText("(1) ↦",y-FIELD.tileWidth/12,F+1*f),d.fillText("p="+String(Analysis.normFloat(h)),y-FIELD.tileWidth/12+K,F+0*f),d.fillText("p="+String(Analysis.normFloat(1-h)),y-FIELD.tileWidth/12+K,F+1*f),d.restore(),d.save(),d.setLineDash([]),QubitHalo.ring(d,c+E+.5*FIELD.tileWidth,I+.5*FIELD.tileHeight,t.basisRot),d.restore()}}static drawAmpLines(e,t,i,a,r,s){e.save(),e.strokeStyle="#333",e.setLineDash([]),e.lineWidth=1,e.beginPath();var o=Math.round(i+.75*a-.5*s)+.5,n=Math.round(i-.75*a+.5*s)+.5,l=Math.round(t);e.moveTo(l,o),e.lineTo(l,n);l=Math.round(t+r/2)+.5;e.moveTo(l,o),e.lineTo(l,n);l=Math.round(t+r)+.5;e.moveTo(l,o),e.lineTo(l,n);o=Math.round(i+.95*a-.5*s)+.5,n=Math.round(i-.95*a+.5*s)+.5,l=Math.round(t+.25*r)+.5;e.moveTo(l,o),e.lineTo(l,n);l=Math.round(t+.75*r)+.5;e.moveTo(l,o),e.lineTo(l,n),e.stroke(),e.restore()}static normFloat(e){if(e=Math.round(1e3*e),e%1e3==0)var t=e/1e3+".000";else if(e%100==0)t=e/1e3+"00";else if(e%10==0)t=e/1e3+"0";else t=e/1e3;return t}static normFloat2(e){if(e=Math.round(100*e),e%100==0)var t=e/100+".00";else if(e%10==0)t=e/100+"0";else t=e/100;return t}}class Bit{constructor(e,t,i,a,r,s,o,n=-1){this._i0=e,this._j0=t,this._last=i,this._next=a,this._action=r,this._value=s,this._layer=o,this._isGhost=!1,n<0?(this._id=GLOBAL_ID,GLOBAL_ID+=1):this._id=n}get i0(){return this._i0}get j0(){return this._j0}get last(){return this._last}get next(){return this._next}get action(){return this._action}get value(){return this._value}get layer(){return this._layer}get id(){return this._id}get isGhost(){return this._isGhost}set i0(e){this._i0=e}set j0(e){this._j0=e}set last(e){this._last=e}set next(e){this._next=e}set action(e){this._action=e}set value(e){this._value=e}set layer(e){this._layer=e}set isGhost(e){this._isGhost=e}pack(){var e=[this._i0,this._j0,this._last,this._next,this._action,this._value,this._layer,this._isGhost];return e}copy(){var e=new Bit(this._i0,this._j0,this._last,this._next,this._action,this._value,this._layer,this._id);return e.isGhost=this.isGhost,e}static moveAdjacentCombine(e,t,i,a){if(44===i)var r=a.getBit(e-1,t+1),s=a.getBit(e-2,t),o=a.getBit(e-1,t-1);else if(45===i)r=a.getBit(e-1,t-1),s=a.getBit(e,t-2),o=a.getBit(e+1,t-1);else if(46===i)r=a.getBit(e+1,t-1),s=a.getBit(e+2,t),o=a.getBit(e+1,t+1);else if(47===i)r=a.getBit(e+1,t+1),s=a.getBit(e,t+2),o=a.getBit(e-1,t+1);r&&"move"===r.action&&r.move(a),s&&"move"===s.action&&s.move(a),o&&"move"===o.action&&o.move(a)}findNextDir(e){if(this._next>=0)return this._next;var t=e.getTile(this._i0,this._j0);return this._next=DIRCLASSIC.fromTo[this._last][t],this._next}move(e){if("halt"===this.action)return!0;var t=this.findNextDir(e),i=e.findAdjacent(this.i0,this.j0,this.findNextDir(t)),a=i.i1,r=i.j1,s=(this.next+2)%4,o=e.getTile(a,r),n=e.getTile(this.i0,this.j0),l=Math.floor(o/20);if(DIRCLASSIC.fromTo[s][o]<0||[54,55,56,57].includes(o))return this.action="halt",!0;var h=e.getGate(a,r);if(h&&"compare"===h.type){if(a>this.i0)var d=1;else if(a<this.i0)d=3;if(r>this.j0)d=2;else if(r<this.j0)d=4;if(0===h.state&&this.isGhost){h.state=d;var u=this.i0+this.j0*e.width,c=a+r*e.width;return this.i0=a,this.j0=r,this.last=s,this.next=-1,this.action="freeze",e.moveBit(this,u,c,this.layer,0),this.layer=0,!0}if(0===h.state&&!this.isGhost){var I=!1;if(1===d||3===d)var E=e.getBit(a,r+1),f=e.getBit(a,r-1);else E=e.getBit(a+1,r),f=e.getBit(a-1,r);return E&&"move"===E.action&&(I=!0),f&&"move"===f.action&&(I=!0),!I&&(this.action="halt",!0)}if(h.state!=d&&h.state<5){h.state=5,h.action="precompare";u=this.i0+this.j0*e.width,c=a+r*e.width;return this.i0=a,this.j0=r,this.last=s,this.next=-1,this.action="freeze",e.moveBit(this,u,c,this.layer,1),this.layer=1,[44,45,46,47].includes(n)&&Bit.moveAdjacentCombine(a,r,n,e),!0}}if(!e.checkIfEmpty(a,r))return!e.checkIfMoving(a,r)&&(this.action="halt",!0);u=this.i0+this.j0*e.width,c=a+r*e.width;if(0===l||1===l||5===l)return this.i0=a,this.j0=r,this.last=s,this.next=-1,this.action="halt",e.moveBit(this,u,c,this.layer),this.layer=0,[44,45,46,47].includes(n)&&Bit.moveAdjacentCombine(a,r,n,e),!0;if(2===l||4===l){h=e.getGate(a,r,e.state[c]);var S="free"===h.action||"reset"===h.action;if("switch"===h.type&&1===h.state)h.rot<2&&(S=!1);else{var p=e.checkWhichControl(a,r,"switch").gate;p&&1===p.state&&p.rot>1&&(S=!1)}if(S){if(this.i0=a,this.j0=r,this.last=s,this.next=-1,this.action="wait",h.action="pretransform",e.moveBit(this,u,c,this.layer),this.layer=0,[44,45,46,47].includes(n)&&Bit.moveAdjacentCombine(a,r,n,e),"cSplit"===h.type){I=[0,0,0,0];var T=e.getTile(this.i0-1,this.j0),R=e.getTile(this.i0,this.j0-1),m=e.getTile(this.i0+1,this.j0),g=e.getTile(this.i0,this.j0+1),A=[54,55,56,57];I[0]=!A.includes(T)&&DIRCLASSIC.enterR.indexOf(T)>=0,I[1]=!A.includes(R)&&DIRCLASSIC.enterB.indexOf(R)>=0,I[2]=!A.includes(m)&&DIRCLASSIC.enterL.indexOf(m)>=0,I[3]=!A.includes(g)&&DIRCLASSIC.enterT.indexOf(g)>=0;for(var C=0,L=0;L<4;L++)if(L!==h.orient&&I[L]){if(0===C)this.next=L;else{var D=new Bit(this._i0,this._j0,this._last,this._next,this._action,this._value,C);D.next=L,e.setBit(D)}C++}}return!0}return this.action="halt",!0}}}class BlueWire{static placeUp(e,t){var i=IBOARD.getTile(e,t),a=IBOARD.getTile(e,t-1),r=CONSTRUCTMAPS.CU0.indexOf(i),s=CONSTRUCTMAPS.CUG.indexOf(i),o=CONSTRUCTMAPS.CD0.indexOf(a),n=CONSTRUCTMAPS.CDG.indexOf(a),l=e+t*FIELD.cols,h=e+(t-1)*FIELD.cols,d=(r>=0||s>=0)&&(o>=0||n>=0),u=Math.abs(SCENARIO.editable[l])>0&&Math.abs(SCENARIO.editable[h])>0;d&&u?(r>=0&&IBOARD.setTile(e,t,CONSTRUCTMAPS.CU1[r]),o>=0&&IBOARD.setTile(e,t-1,CONSTRUCTMAPS.CD1[o]),SFX.wire.play()):a<0&&SCENARIO.editable[h]&&IBOARD.setTile(e,t-1,20)}static placeDown(e,t){var i=IBOARD.getTile(e,t),a=IBOARD.getTile(e,t+1),r=CONSTRUCTMAPS.CD0.indexOf(i),s=CONSTRUCTMAPS.CDG.indexOf(i),o=CONSTRUCTMAPS.CU0.indexOf(a),n=CONSTRUCTMAPS.CUG.indexOf(a),l=e+t*FIELD.cols,h=e+(t+1)*FIELD.cols,d=(r>=0||s>=0)&&(o>=0||n>=0),u=Math.abs(SCENARIO.editable[l])>0&&Math.abs(SCENARIO.editable[h])>0;d&&u?(r>=0&&IBOARD.setTile(e,t,CONSTRUCTMAPS.CD1[r]),o>=0&&IBOARD.setTile(e,t+1,CONSTRUCTMAPS.CU1[o]),SFX.wire.play()):a<0&&SCENARIO.editable[h]&&IBOARD.setTile(e,t+1,20)}static placeLeft(e,t){var i=IBOARD.getTile(e,t),a=IBOARD.getTile(e-1,t),r=CONSTRUCTMAPS.CL0.indexOf(i),s=CONSTRUCTMAPS.CLG.indexOf(i),o=CONSTRUCTMAPS.CR0.indexOf(a),n=CONSTRUCTMAPS.CRG.indexOf(a),l=e+t*FIELD.cols,h=e-1+t*FIELD.cols,d=(r>=0||s>=0)&&(o>=0||n>=0),u=Math.abs(SCENARIO.editable[l])>0&&Math.abs(SCENARIO.editable[h])>0;d&&u?(r>=0&&IBOARD.setTile(e,t,CONSTRUCTMAPS.CL1[r]),o>=0&&IBOARD.setTile(e-1,t,CONSTRUCTMAPS.CR1[o]),SFX.wire.play()):a<0&&SCENARIO.editable[h]&&IBOARD.setTile(e-1,t,20)}static placeRight(e,t){var i=IBOARD.getTile(e,t),a=IBOARD.getTile(e+1,t),r=CONSTRUCTMAPS.CR0.indexOf(i),s=CONSTRUCTMAPS.CRG.indexOf(i),o=CONSTRUCTMAPS.CL0.indexOf(a),n=CONSTRUCTMAPS.CLG.indexOf(a),l=e+t*FIELD.cols,h=e+1+t*FIELD.cols,d=(r>=0||s>=0)&&(o>=0||n>=0),u=Math.abs(SCENARIO.editable[l])>0&&Math.abs(SCENARIO.editable[h])>0;d&&u?(r>=0&&IBOARD.setTile(e,t,CONSTRUCTMAPS.CR1[r]),o>=0&&IBOARD.setTile(e+1,t,CONSTRUCTMAPS.CL1[o]),SFX.wire.play()):a<0&&SCENARIO.editable[h]&&IBOARD.setTile(e+1,t,20)}static place(){var e=STATE.under.i0-STATE.grab.i0,t=STATE.under.j0-STATE.grab.j0,i=Math.sign(e),a=Math.sign(t);if(i>0){for(var r=STATE.grab.j0,s=STATE.grab.i0,o=0;o<Math.abs(e);o++)BlueWire.placeRight(s+o,r);STATE.grab={type:STATE.under.type,i0:s+Math.abs(e),j0:r,k0:s+Math.abs(e)+r*FIELD.cols}}else if(i<0){for(r=STATE.grab.j0,s=STATE.grab.i0,o=0;o<Math.abs(e);o++)BlueWire.placeLeft(s-o,r);STATE.grab={type:STATE.under.type,i0:s-Math.abs(e),j0:r,k0:s-Math.abs(e)+r*FIELD.cols}}else if(a>0){for(r=STATE.grab.j0,s=STATE.grab.i0,o=0;o<Math.abs(t);o++)BlueWire.placeDown(s,r+o);STATE.grab={type:STATE.under.type,i0:s,j0:r+Math.abs(t),k0:s+(r+Math.abs(t))*FIELD.cols}}else if(a<0){for(r=STATE.grab.j0,s=STATE.grab.i0,o=0;o<Math.abs(t);o++)BlueWire.placeUp(s,r-o);STATE.grab={type:STATE.under.type,i0:s,j0:r-Math.abs(t),k0:s+(r-Math.abs(t))*FIELD.cols}}else;}}class Blueprint{static draw(e=!0){CANV.blueprint.clear();var t=-1;e&&"blueprint"===STATE.under.type&&(t=STATE.under.i0);var i=[.75,.75,.75];i[STATE.blueprint]=1;for(var a=[],r=[],s=2;s>=0;s--)if(a=(1-i[s])/2*FIELD.tileWidth+FIELD.tileWidth+.6*(s-2)*FIELD.tileWidth,r=(1-i[s])/2*FIELD.tileWidth,STATE.blueprint!=s){var o=Paths.blueprint(CANV.blueprint.ctx,s,t===s,s);o.draw(CANV.blueprint.ctx,.5*FIELD.tileWidth+a,r,i[s]*FIELD.tileWidth,i[s]*FIELD.tileHeight)}if(STATE.blueprint>=0){a=(1-i[STATE.blueprint])/2*FIELD.tileWidth+FIELD.tileWidth+.6*(STATE.blueprint-2)*FIELD.tileWidth,r=(1-i[STATE.blueprint])/2*FIELD.tileWidth;o=Paths.blueprint(CANV.blueprint.ctx,STATE.blueprint,t===STATE.blueprint,STATE.blueprint);o.draw(CANV.blueprint.ctx,.5*FIELD.tileWidth+a,r,i[STATE.blueprint]*FIELD.tileWidth,i[STATE.blueprint]*FIELD.tileHeight)}}}class Board{constructor(e,t,i){this._ctx=e,this._width=t,this._height=i,this._state=new Array(t*i).fill(0),this._tiles=new Array(t*i).fill(-1),this._gates=[[],[]],this._gates[0]=new Array(t*i).fill(0),this._gates[1]=new Array(t*i).fill(0),this._bits=[[],[],[]],this._bits[0]=new Array(t*i).fill(0),this._bits[1]=new Array(t*i).fill(0),this._bits[2]=new Array(t*i).fill(0),this._qubits=new Array(t*i).fill(0),this._gateList=[],this._bitList=[],this._qubitList=[],this._success=0,this._failure=0,this._entList=[],this._sfx=[!1,!1,!1,!1]}get state(){return this._state}get tiles(){return this._tiles}get gateList(){return this._gateList}get qubitList(){return this._qubitList}get bitList(){return this._bitList}get x0(){return FIELD.leftMargin+FIELD.cameraX}get y0(){return FIELD.topMargin+FIELD.cameraY}get width(){return this._width}get height(){return this._height}get state(){return this._state}get success(){return this._success}get failure(){return this._failure}get totWidth(){return FIELD.tileWidth*this._width}get totHeight(){return FIELD.tileHeight*this._height}get entList(){return this._entList}get sfx(){return this._sfx}set sfx(e){this._sfx=e}set entList(e){this._entList=e}set tiles(e){this._tiles=e}set state(e){this._state=e}set success(e){this._success=e}set failure(e){this._failure=e}serialize(){for(var e=[],t=0;t<this._gateList.length;t++)e.push(this._gateList[t].pack());var i=[];for(t=0;t<this._qubitList.length;t++)i.push(this._qubitList[t].pack());var a=[];for(t=0;t<this._bitList.length;t++)a.push(this._bitList[t].pack());var r=this._tiles;return JSON.stringify({allTiles:r,allGates:e,allBits:a,allQubits:i})}checkWhichControl(e,t,i=["switch","qControl"]){if(SCENARIO.hasEntanglers&&e===FIELD.cols-3&&t===FIELD.rows-1){var a=this.getGate(FIELD.cols-3,FIELD.rows-1);return{dir:5,type:"qControl",action:a.action,gate:a}}if(e>0){a=this.getGate(e-1,t);if(a&&i.indexOf(a.type)>=0&&3===a.orient)return{dir:0,type:a.type,action:a.action,gate:a}}if(t>0){a=this.getGate(e,t-1);if(a&&i.indexOf(a.type)>=0&&0===a.orient)return{dir:1,type:a.type,action:a.action,gate:a}}if(e<this.width-1){a=this.getGate(e+1,t);if(a&&i.indexOf(a.type)>=0&&1===a.orient)return{dir:2,type:a.type,action:a.action,gate:a}}if(t<this.height-1){a=this.getGate(e,t+1);if(a&&i.indexOf(a.type)>=0&&2===a.orient)return{dir:3,type:a.type,action:a.action,gate:a}}return{dir:-1,type:"none",action:"none",gate:0}}checkControl(e,t,i=["switch","qControl"]){if(e>0){var a=this.getGate(e-1,t);if(a&&i.indexOf(a.type)>=0&&3===a.orient)return 0}if(t>0){a=this.getGate(e,t-1);if(a&&i.indexOf(a.type)>=0&&0===a.orient)return 1}if(e<this.width-1){a=this.getGate(e+1,t);if(a&&i.indexOf(a.type)>=0&&1===a.orient)return 2}if(t<this.height-1){a=this.getGate(e,t+1);if(a&&i.indexOf(a.type)>=0&&2===a.orient)return 3}return-1}checkAdjacency(e,t){if(e>0){var i=this.getTile(e-1,t);Math.floor(i/20)}}computizeQubits(){for(var e=0;e<this.qubitList.length;e++){var t=this.qubitList[e];t.rotateBasis(0)}}naturalizeQubits(){for(var e=0;e<this.qubitList.length;e++){var t=this.qubitList[e],i=t.computeNaturalBasis();t.rotateBasis(i)}}findPos(e,t){var i=e*FIELD.tileWidth+this.x0,a=t*FIELD.tileWidth+this.y0;return{x0:i,y0:a}}findTile(e,t){var i=Math.floor((e-this.x0-FIELD.leftPad)/FIELD.tileWidth),a=Math.floor((t-this.y0-FIELD.topPad)/FIELD.tileHeight);return{i0:i,j0:a}}getState(e,t){var i=e+t*this._width;return this.state[i]}setState(e,t,i){var a=e+t*this._width;this.state[a]=i;var r=this._gates[i][a];r&&(this._tiles[a]=MDATA.GATEID[r.type]+r.orient)}clearAdjacent(e,t,i=-1){var a=Helper.getTileEdge(e,t,this);if(a){if(e-1>=0&&(-1===i||0==i)){var r=e-1+t*this._width;if(SCENARIO.editable[r]>0){var s=this._tiles[e-1+t*this._width],o=Math.floor(s/20),n=DESTROYMAPS.R0.indexOf(s);if([0,1,5].indexOf(o)>=0){var l=Helper.getTileEdge(e-1,t,this),h=l[2]>0,d=l[2]===a[0]||3===a[0];h&&!d&&(this._tiles[r]=DESTROYMAPS.R1[n])}}}if(e+1<FIELD.cols&&(-1===i||2==i)){r=e+1+t*this._width;if(SCENARIO.editable[r]>0){s=this._tiles[e+1+t*this._width],o=Math.floor(s/20),n=DESTROYMAPS.L0.indexOf(s);if([0,1,5].indexOf(o)>=0){l=Helper.getTileEdge(e+1,t,this),h=l[0]>0,d=l[0]===a[2]||3===a[2];h&&!d&&(this._tiles[r]=DESTROYMAPS.L1[n])}}}if(t-1>=0&&(-1===i||1==i)){r=e+(t-1)*this._width;if(SCENARIO.editable[r]>0){s=this._tiles[e+(t-1)*this._width],o=Math.floor(s/20),n=DESTROYMAPS.D0.indexOf(s);if([0,1,5].indexOf(o)>=0){l=Helper.getTileEdge(e,t-1,this),h=l[3]>0,d=l[3]===a[1]||3===a[1];h&&!d&&(this._tiles[r]=DESTROYMAPS.D1[n])}}}if(t+1<FIELD.rows&&(-1===i||3==i)){r=e+(t+1)*this._width;if(SCENARIO.editable[r]>0){s=this._tiles[e+(t+1)*this._width],o=Math.floor(s/20),n=DESTROYMAPS.U0.indexOf(s);if([0,1,5].indexOf(o)>=0){l=Helper.getTileEdge(e,t+1,this),h=l[1]>0,d=l[1]===a[3]||3===a[3];h&&!d&&(this._tiles[r]=DESTROYMAPS.U1[n])}}}}}clearTile(e,t,i=!0){var a=e+t*this._width,r=this._tiles[a];if(r>=0&&i){var s=Math.floor(r/20),o=r%20,n=TILE_EDGES[s][o];if(n[0]&&e-1>=0){var l=e-1+t*this._width;if(SCENARIO.editable[l]>0){var h=this._tiles[l],d=DESTROYMAPS.R0.indexOf(h);d>=0&&(this._tiles[l]=DESTROYMAPS.R1[d])}}if(n[1]&&t-1>=0){l=e+(t-1)*this._width;if(SCENARIO.editable[l]>0){h=this._tiles[l],d=DESTROYMAPS.D0.indexOf(h);d>=0&&(this._tiles[l]=DESTROYMAPS.D1[d])}}if(n[2]&&e+1<this._width){l=e+1+t*this._width;if(SCENARIO.editable[l]>0){h=this._tiles[l],d=DESTROYMAPS.L0.indexOf(h);d>=0&&(this._tiles[l]=DESTROYMAPS.L1[d])}}if(n[3]&&t+1<this._height){l=e+(t+1)*this._width;if(SCENARIO.editable[l]>0){h=this._tiles[l],d=DESTROYMAPS.U0.indexOf(h);d>=0&&(this._tiles[l]=DESTROYMAPS.U1[d])}}}if(this._gates[0][a]){var u=this._gates[0][a],c=-1;"sync"!==u.type&&"switch"!==u.type||(c=u.orient);var I=this._gates[0][a].id;delete this._gates[0][a],this._gates[0][a]=0;for(var E=0;E<this._gateList.length;E++)if(this._gateList[E].id===I){this._gateList.splice(E,1);break}if(c>=0){var f=e,S=t;if(0===c?S+=1:1===c?f-=1:2===c?S-=1:3===c&&(f+=1),"sync"===u.type){var p=this.getGate(f,S);p&&"sync"===p.type&&this.clearTile(f,S,!0)}else if("switch"===u.type){p=this.getGate(f,S,1);if(p){l=f+S*this._width,I=this._gates[1][l].id;delete this._gates[1][l],this._gates[1][l]=0;for(E=0;E<this._gateList.length;E++)if(this._gateList[E].id===I){this._gateList.splice(E,1);break}this._state[l]=0}}}}if(this._gates[1][a]){I=this._gates[1][a].id;delete this._gates[1][a],this._gates[1][a]=0;for(E=0;E<this._gateList.length;E++)if(this._gateList[E].id===I){this._gateList.splice(E,1);break}}this._state[a]=0,this._tiles[a]=-1}setTile(e,t,i){var a=e+t*this._width;this._tiles[a]=i}getTile(e,t){if(e<0||e>=this._width)return-1;if(t<0||t>=this._height)return-1;var i=e+t*this._width;return this._tiles[i]}setQubit(e){var t=e.i0+e.j0*this._width;this._qubits[t]=e,this._qubitList.push(e)}setEntGroup(e){this._entList.push(e);for(var t=0;t<e.numQubits;t++)e.qubitList[t]&&this.setQubit(e.qubitList[t])}getQubit(e,t){if(e<0||e>=FIELD.cols)return 0;if(t<0||t>=FIELD.rows)return 0;var i=e+t*this._width;return this._qubits[i]}removeQubit(e){var t=e.i0+e.j0*this._width;this._qubits[t]=0;for(var i=this._qubitList.length-1;i>=0;i--)this._qubitList[i].id===e.id?this._qubitList.splice(i,1):this._qubitList[i].i0===e.i0&&this._qubitList[i].j0===e.j0&&(this._qubits[t]=this._qubitList[i])}moveQubit(e,t,i){this._qubits[t]=0,this._qubits[i]=e}setBit(e){var t=e.i0+e.j0*this._width;this._bits[e.layer][t]=e,this._bitList.push(e)}getBit(e,t,i=0){if(e<0||e>=FIELD.cols)return 0;if(t<0||t>=FIELD.rows)return 0;var a=e+t*this._width;return this._bits[i][a]}removeBit(e){var t=e.i0+e.j0*this._width;this._bits[e.layer][t]=0;for(var i=0;i<this._bitList.length;i++)this._bitList[i].id===e.id&&this._bitList.splice(i,1)}moveBit(e,t,i,a=0,r=0){this._bits[a][t]=0,this._bits[r][i]=e}getAllGates(){for(var e=[],t=0;t<this._gateList.length;t++)e.push(this._gateList[t].pack());return e}setAllGates(e){for(var t=0;t<e.length;t++){var i=e[t].pop(),a=new Gate(...e[t]);a.counterMax=i,this.setGate(a)}}setAllBits(e,t,i){for(var a=0;a<e.length;a++){var r=e[a].pop(),s=new Bit(...e[a]);s.isGhost=r,this.setBit(s)}for(a=0;a<t.length;a++){r=t[a].pop();var o=new Qubit(...t[a]);o.isGhost=r,this.setQubit(o)}for(a=0;a<i.length;a++)this.setEntGroup(i[a])}setGate(e){var t=e.i0+e.j0*this._width;if(this._gates[e.layer][t]=e,this._gateList.push(e),this._state[t]===e.layer&&(this._tiles[t]=MDATA.GATEID[e.type]+e.orient),"switch"===e.type){var i=e.i0,a=e.j0;0===e.orient?a+=1:1==e.orient?i-=1:2==e.orient?a-=1:3==e.orient&&(i+=1);this._width;this.setState(i,a,e.rot%2)}}getGate(e,t,i=0){if(e<0||e>=FIELD.cols)return 0;if(t<0||t>=FIELD.rows)return 0;var a=e+t*this._width;return this._gates[i][a]}checkIfEmpty(e,t){return 0===this.getBit(e,t,0)&&0===this.getBit(e,t,1)&&0===this.getBit(e,t,2)&&0===this.getQubit(e,t)}checkIfMoving(e,t){this._width;return(!this.getBit(e,t,0)||"move"===this.getBit(e,t,0).action)&&((!this.getBit(e,t,1)||"move"===this.getBit(e,t,1).action)&&((!this.getBit(e,t,2)||"move"===this.getBit(e,t,2).action)&&(!this.getQubit(e,t)||"move"===this.getQubit(e,t).action)))}copyNoGates(){for(var e=new Board(this._ctx,this._width,this._height),t=0;t<this._entList.length;t++)this._entList[t].numQubits>0&&e.setEntGroup(this._entList[t].copy());for(t=0;t<this._qubitList.length;t++){var i=this._qubitList[t].copy();if(e.setQubit(i),i.entGroup)for(var a=0;a<e._entList.length;a++)if(i.entID===e._entList[a].id){i.entGroup=e._entList[a],e._entList[a].qubitList[i.entInd]=i;break}}for(t=0;t<this._bitList.length;t++)e.setBit(this._bitList[t].copy());return e.success=this.success,e.failure=this.failure,e}copy(){var e=new Board(this._ctx,this._width,this._height);e._state=JSON.parse(JSON.stringify(this._state)),e._tiles=JSON.parse(JSON.stringify(this._tiles));for(var t=0;t<this._gateList.length;t++)e.setGate(this._gateList[t].copy());for(t=0;t<this._entList.length;t++)this._entList[t].numQubits>0&&e.setEntGroup(this._entList[t].copy());for(t=0;t<this._qubitList.length;t++){var i=this._qubitList[t].copy();if(e.setQubit(i),i.entGroup)for(var a=0;a<e._entList.length;a++)if(i.entID===e._entList[a].id){i.entGroup=e._entList[a],e._entList[a].qubitList[i.entInd]=i;break}}for(t=0;t<this._bitList.length;t++)e.setBit(this._bitList[t].copy());return e.success=this.success,e.failure=this.failure,e}findAdjacent(e,t,i){var a=e,r=t;if(0===i)a=e-1;else if(1==i)r=t-1;else if(2==i)a=e+1;else if(3==i)r=t+1;return{i1:a,j1:r}}updateOneStep(e){RANDS.tick=void 0===e?-1:e,RANDS.count=0;for(var t=this._bitList.length-1;t>=0;t--)"halt"===this._bitList[t].action&&(this._bitList[t].action="move");for(t=this._qubitList.length-1;t>=0;t--)"halt"===this._qubitList[t].action?this._qubitList[t].action="move":"disappear"===this._qubitList[t].action&&this.removeQubit(this._qubitList[t]);for(var i=0;i<this._qubitList.length;i++){var a=this._qubitList[i];a.isGhost&&"move"===a.action&&a.move(this)}for(var r=this._qubitList.length,s=this._bitList.length,o=r+s,n=[...Array(r).keys()],l=[...Array(s).keys()],h=0;h<o;h++){for(t=0;t<l.length;t++){var d=this._bitList[l[t]];if("move"===d.action){var u=d.move(this);u&&(l[t]=-1)}else l[t]=-1}for(t=l.length-1;t>=0;t--)l[t]<0&&l.splice(t,1);for(t=0;t<n.length;t++){a=this._qubitList[n[t]];if("move"===a.action){u=a.move(this);u&&(n[t]=-1)}else n[t]=-1}for(t=n.length-1;t>=0;t--)n[t]<0&&n.splice(t,1);if(0===n.length&&0===l.length)break}for(t=0;t<this._gateList.length;t++){var c=this._gateList[t],I=this.checkWhichControl(c.i0,c.j0);if("qControl"!==I.type&&"switch"!==c.type&&"qControl"!==c.type){var E=this.getTile(c.i0,c.j0),f=Math.floor(E/20);2===f?c.applyClassic(this):3===f?c.applyQuantum(this):4===f&&c.applyUniversal(this)}}for(t=0;t<this._gateList.length;t++){c=this._gateList[t];"switch"===c.type&&c.applySwitch(this),"qControl"===c.type&&c.applyControl(this)}return this}}class BoardData{static makeEditable(e=!0,t=[0,0,0,0,0,0],i=0,a=0,r){var s=new Array(FIELD.cols*FIELD.rows).fill(1);if(e)for(var o=0;o<FIELD.cols;o++)for(var n=0;n<FIELD.rows;n++)if(0===o||o===FIELD.cols-1||0===n||n===FIELD.rows-1){var l=o+n*FIELD.cols;s[l]=0}if(s[0+5*FIELD.cols]=t[0],s[0+8*FIELD.cols]=t[1],s[6*FIELD.cols-1]=t[2],s[9*FIELD.cols-1]=t[3],s[5+(FIELD.rows-1)*FIELD.cols]=t[4],s[FIELD.cols-6+(FIELD.rows-1)*FIELD.cols]=t[5],"key"===a){for(o=12;o<FIELD.cols;o++)for(n=0;n<FIELD.rows;n++){l=o+n*FIELD.cols;s[l]=0}s[127]=2,s[146]=2,s[130]=2,s[107]=-1,s[164]=-1}if("btf"===a){for(n=5,o=0;o<FIELD.cols;o++){l=o+n*FIELD.cols;s[l]=0}s[101]=2,s[107]=2}if("GHZ"===a){for(o=0;o<3;o++)for(n=0;n<FIELD.rows;n++){l=o+n*FIELD.cols;s[l]=0}s[78]=-1,s[97]=-1,s[154]=-1,s[173]=-1}if("inversion"===a){for(var h=[[1,5],[2,5],[3,5],[4,5],[1,8],[2,8],[3,8],[4,8]],d=0;d<h.length;d++){l=h[d][0]+h[d][1]*FIELD.cols;s[l]=0}l=5+5*FIELD.cols;s[l]=-1;l=5+8*FIELD.cols;s[l]=-1}if("inversion2"===a){for(h=[[1,5],[2,5],[3,5],[4,5],[5,5],[6,5],[1,8],[2,8],[3,8],[4,8],[5,8],[6,8]],d=0;d<h.length;d++){l=h[d][0]+h[d][1]*FIELD.cols;s[l]=0}l=7+5*FIELD.cols;s[l]=-1;l=7+8*FIELD.cols;s[l]=-1}if("correctionA"===a){for(o=6;o<10;o++)for(n=0;n<FIELD.rows;n++){l=o+n*FIELD.cols;s[l]=0}l=6+4*FIELD.cols;s[l]=-1;l=6+7*FIELD.cols;s[l]=-1;l=6+10*FIELD.cols;s[l]=-1;l=9+4*FIELD.cols;s[l]=-1;l=9+7*FIELD.cols;s[l]=-1;l=9+10*FIELD.cols;s[l]=-1}if("correctionB"===a)for(o=4,n=0;n<FIELD.rows;n++){l=o+n*FIELD.cols;s[l]=-1}if("correctionC"===a)for(o=6,n=0;n<FIELD.rows;n++){l=o+n*FIELD.cols;s[l]=-1}if("correctionD"===a)for(o=7,n=0;n<FIELD.rows;n++){l=o+n*FIELD.cols;s[l]=-1}if("deviceA"===a){for(o=5;o<14;o++)for(n=2;n<7;n++){l=o+n*FIELD.cols;s[l]=0}var u=[[4,2],[4,3],[4,4],[5,6],[14,2],[14,3],[14,4],[13,6]];for(d=0;d<u.length;d++){l=u[d][0]+u[d][1]*FIELD.cols;s[l]=-1}}if("simpleDistill"===a){var c=[0,0,0,0,0,0,0,0,0,-1,-1,-1,0,0];for(n=0;n<FIELD.rows;n++){l=4+n*FIELD.cols;s[l]=c[n]}for(o=0;o<4;o++)for(n=0;n<FIELD.rows;n++){l=o+n*FIELD.cols;s[l]=0}}if("onetwo"===a){for(o=0;o<4;o++)for(n=6;n<8;n++){l=o+n*FIELD.cols;s[l]=0}l=1+5*FIELD.cols;s[l]=0;l=1+8*FIELD.cols;s[l]=0;l=8+5*FIELD.cols;s[l]=2,s[118]=-1,s[137]=-1}if("canal"===a){s.fill(0);for(o=3;o<16;o++)for(n=6;n<8;n++){l=o+n*FIELD.cols;s[l]=1}s[116]=-1,s[135]=-1,s[130]=-1,s[149]=-1}if("relay"===a){for(o=1;o<16;o++){l=o+4*FIELD.cols;s[l]=0;l=o+9*FIELD.cols;s[l]=0}for(o=15;o<18;o++){l=o+6*FIELD.cols;s[l]=0;l=o+7*FIELD.cols;s[l]=0}s[110]=0,s[167]=0,s[81]=-1,s[86]=-1,s[176]=-1,s[181]=-1}if("fixed"===a)s=new Array(FIELD.cols*FIELD.rows).fill(-1);if("partial"===a)for(var I=0;I<r.length;I++)-1!==r[I]&&(s[I]=-1);if("cross"===a){for(o=0;o<FIELD.cols;o++)for(n=6;n<8;n++){l=o+n*FIELD.cols;s[l]=0}for(o=9,n=1;n<12;n++){l=o+n*FIELD.cols;s[l]=0}l=9+3*FIELD.cols;s[l]=-1;l=9+10*FIELD.cols;s[l]=-1}if("threebox"===a){for(n=0;n<FIELD.rows;n++){l=6+n*FIELD.cols;s[l]=0}for(o=0;o<7;o++){l=o+6*FIELD.cols;s[l]=0;l=o+7*FIELD.cols;s[l]=0}l=6+3*FIELD.cols;s[l]=-1;l=6+10*FIELD.cols;s[l]=-1}if("cornerbox"===a)for(o=0;o<4;o++)for(n=7;n<13;n++){l=o+n*FIELD.cols;s[l]=0}if("halffrozen"===a){for(o=0;o<10;o++)for(n=0;n<FIELD.rows;n++){l=o+n*FIELD.cols;s[l]=0}l=9+6*FIELD.cols;s[l]=-1;l=9+7*FIELD.cols;s[l]=-1;l=9+8*FIELD.cols;s[l]=-1}if("analysis"===a){var E=[4,5,8,9];for(o=0;o<=4;o++)for(n=0;n<4;n++){l=o+E[n]*FIELD.cols;s[l]=0}for(u=[[4,4],[4,5],[4,8],[4,9]],I=0;I<u.length;I++){l=u[I][0]+u[I][1]*FIELD.cols;s[l]=-1}}if(i){var f=(FIELD.cols-1)/2;for(n=0;n<FIELD.rows;n++){l=f+n*FIELD.cols;s[l]=i[n]}}return s}}class Canvs{constructor(e,t){this._name=t,this._canv=document.getElementById(e),this._ctx=document.getElementById(e).getContext("2d"),this._x0=0,this._y0=0,this._h0=0,this._w0=0,this._isActive=!1,document.getElementById(e).width=0,document.getElementById(e).height=0,document.getElementById(e).style.display="none"}get name(){return this._name}get canv(){return this._canv}get ctx(){return this._ctx}get x0(){return this._x0}get y0(){return this._y0}get h0(){return this._h0}get w0(){return this._w0}get isActive(){return this._isActive}set x0(e){this.canv.style.left=e+"px",this._x0=e}set y0(e){
this.canv.style.top=e+"px",this._y0=e}set h0(e){this.canv.height=e,this._h0=e}set w0(e){this.canv.width=e,this._w0=e}set isActive(e){this._isActive=e}resize(){if(this.isActive){var e=this.getDims();this.w0=e.w0,this.h0=e.h0,this.x0=e.x0,this.y0=e.y0,this.setGlobal()}}static translateAll(e){for(var t=Object.entries(e),i=0;i<t.length;i++)t[i][1].translate()}translate(){var e=this.getDims();this.isActive&&(this.x0=e.x0,this.y0=e.y0)}clear(){this.ctx.clearRect(0,0,this.canv.width,this.canv.height)}fill(e=0){e&&(this.ctx.fillStyle=e),this.ctx.fillRect(0,0,this.canv.width,this.canv.height)}activate(){this.ctx.clearRect(0,0,this.canv.width,this.canv.height),this.isActive=!0,this.resize(),this.canv.style.display="block"}deactivate(){this.w0=0,this.h0=0,this.x0=0,this.y0=0,this.isActive=!1,this.canv.style.display="none"}static deactivateAll(e){for(var t=Object.entries(e),i=0;i<t.length;i++)t[i][1].deactivate()}static displayAll(e){for(var t=Object.entries(e),i=0;i<t.length;i++)if(t[i][1].isActive){var a=t[i][1];console.log(a.name,a.x0+a.w0,a.y0+a.h0)}}setGlobal(){"tooltip"===this.name?(this.ctx.fillStyle="antiquewhite",this.ctx.font=1.2/3*FIELD.tileWidth+"px Courier New",this.ctx.textBaseline="middle",this.ctx.shadowBlur=2,this.ctx.shadowOffsetX=2,this.ctx.shadowOffsetY=2,this.ctx.shadowColor="black"):"FPS"===this.name?(this.ctx.fillStyle="white",this.ctx.font="16px verdana",this.ctx.textBaseline="top",this.ctx.textAlign="left"):"base"===this.name&&(this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.lineJoin="round",this.ctx.shadowBlur=0)}getDims(){var e={};if("FPS"===this.name)e.w0=400,e.h0=100,e.x0=0,e.y0=0;else if("interface"===this.name)e.w0=Math.min(window.innerWidth-10,FIELD.totWidth),e.h0=Math.min(window.innerHeight-10,FIELD.totHeight),e.x0=0,e.y0=0;else if("effects"===this.name)"title"===STATE.mode?(e.w0=10*FIELD.tileWidth+35*FIELD.tileWidth/8-FIELD.tileWidth/2,e.h0=15*FIELD.tileHeight/2-FIELD.tileHeight/2,e.x0=FIELD.leftPad+FIELD.tileWidth/4,e.y0=FIELD.topPad+FIELD.tileHeight/4):(e.w0=(1+FIELD.cols)*FIELD.tileWidth,e.h0=(1+FIELD.rows)*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad);else if("base"===this.name)"title"===STATE.mode?(e.w0=10*FIELD.tileWidth+35*FIELD.tileWidth/8-FIELD.tileWidth/2,e.h0=15*FIELD.tileHeight/2-FIELD.tileHeight/2,e.x0=FIELD.leftPad+FIELD.tileWidth/4,e.y0=FIELD.topPad+FIELD.tileHeight/4):(e.w0=(1+FIELD.cols)*FIELD.tileWidth,e.h0=(1+FIELD.rows)*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad);else if("baseWires"===this.name)e.w0=(1+FIELD.cols)*FIELD.tileWidth,e.h0=(1+FIELD.rows)*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad;else if("undos"===this.name)e.w0=8*FIELD.tileWidth,e.h0=3*FIELD.tileHeight/4,e.x0=FIELD.menu2.x0-1.5*FIELD.tileWidth,e.y0=FIELD.menu2.y0+2*FIELD.tileWidth/4;else if("controls"===this.name)e.w0=(1+FIELD.cols)*FIELD.tileWidth,e.h0=(1+FIELD.rows)*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad;else if("menu"===this.name)e.w0=(FIELD.tileWidth+FIELD.menu.pad)*(FIELD.menu.cols+1),e.h0=(FIELD.tileHeight+FIELD.menu.pad)*(FIELD.menu.rows+1)+FIELD.menu.topPad,e.x0=FIELD.menu.x0,e.y0=FIELD.menu.y0;else if("menuBack"===this.name)e.w0=(FIELD.tileWidth+FIELD.menu.pad)*(FIELD.menu.cols+1),e.h0=(FIELD.tileHeight+FIELD.menu.pad)*(FIELD.menu.rows+1)+FIELD.menu.topPad,e.x0=FIELD.menu.x0,e.y0=FIELD.menu.y0;else if("menuOverlay"===this.name)e.w0=(FIELD.tileWidth+FIELD.menu.pad)*(FIELD.menu.cols+1),e.h0=(FIELD.tileHeight+FIELD.menu.pad)*(FIELD.menu.rows+1)+FIELD.menu.topPad,e.x0=FIELD.menu.x0,e.y0=FIELD.menu.y0;else if("menuText"===this.name)e.w0=(FIELD.tileWidth+FIELD.menu.pad)*FIELD.menu.cols+FIELD.menu.pad,e.h0=FIELD.menu.topPad,e.x0=FIELD.menu.x0+FIELD.tileWidth/2,e.y0=FIELD.menu.y0+FIELD.tileHeight/2;else if("menuEraser"===this.name)e.w0=2*FIELD.tileWidth,e.h0=2*FIELD.tileHeight,e.x0=FIELD.menu.x0+FIELD.tileWidth/5,e.y0=FIELD.menu.y0+3*FIELD.tileHeight/8;else if("scoreBase"===this.name)e.w0=FIELD.menuWidth,e.h0=(FIELD.tileHeight+FIELD.menu.pad)*(FIELD.menu.rows+1)+FIELD.menu.topPad-FIELD.tileHeight,e.x0=FIELD.menu.x0,e.y0=FIELD.menu.y0+FIELD.tileHeight/2;else if("score"===this.name)e.w0=FIELD.menuWidth,e.h0=(FIELD.tileHeight+FIELD.menu.pad)*(FIELD.menu.rows+1)+FIELD.menu.topPad-FIELD.tileHeight,e.x0=FIELD.menu.x0,e.y0=FIELD.menu.y0+FIELD.tileHeight/2;else if("scenario"===this.name)e.w0=FIELD.menuWidth,e.h0=FIELD.scoreHeight,e.x0=FIELD.midWidth,e.y0=FIELD.midHeight;else if("archive"===this.name)e.x0=FIELD.midWidth+7.5*FIELD.tileWidth-FIELD.tileWidth,e.y0=FIELD.midHeight+.35*FIELD.tileHeight-FIELD.tileHeight,e.w0=2*FIELD.tileWidth,e.h0=2*FIELD.tileHeight;else if("journal"===this.name)e.x0=FIELD.midWidth-.75*FIELD.tileWidth,e.y0=FIELD.midHeight+.35*FIELD.tileHeight-FIELD.tileHeight,e.w0=2*FIELD.tileWidth,e.h0=2*FIELD.tileHeight;else if("scenarioOverlay"===this.name)e.w0=FIELD.menuWidth,e.h0=FIELD.scoreHeight,e.x0=FIELD.midWidth,e.y0=FIELD.midHeight;else if("scenarioMask"===this.name)e.w0=FIELD.menuWidth,e.h0=FIELD.scoreHeight,e.x0=FIELD.midWidth,e.y0=FIELD.midHeight;else if("analysisOverlay"===this.name)e.w0=FIELD.analysisWidth+FIELD.tileWidth+FIELD.maxBonusTiles*FIELD.tileWidth,e.h0=(1+FIELD.rows)*FIELD.tileHeight,e.x0=FIELD.analysisLeft-FIELD.tileWidth/2-FIELD.maxBonusTiles*FIELD.tileWidth,e.y0=FIELD.topPad;else if("analysis"===this.name)e.w0=FIELD.analysisWidth+FIELD.tileWidth+FIELD.maxBonusTiles*FIELD.tileWidth-FIELD.tileWidth/2,e.h0=(1+FIELD.rows)*FIELD.tileHeight,e.x0=FIELD.analysisLeft,e.y0=FIELD.topPad;else if("victoryBase"===this.name)e.w0=5*FIELD.tileWidth,e.h0=SCENARIO.finishedHeight+FIELD.tileHeight/2,e.x0=FIELD.leftPad+(FIELD.cols/2-2)*FIELD.tileWidth,e.y0=FIELD.topPad+1.5*FIELD.tileHeight;else if("victoryText"===this.name)e.w0=5*FIELD.tileWidth,e.h0=SCENARIO.finishedHeight+FIELD.tileHeight/2,e.x0=FIELD.leftPad+(FIELD.cols/2-2)*FIELD.tileWidth,e.y0=FIELD.topPad+1.5*FIELD.tileHeight;else if("ticker"===this.name)e.w0=3*FIELD.tileWidth,e.h0=FIELD.tileHeight,e.x0=FIELD.leftPad+(FIELD.cols/2-1.5+.5)*FIELD.tileWidth,e.y0=FIELD.topPad+FIELD.tileHeight/3;else if("tooltip"===this.name)e.w0=7*FIELD.tileWidth,e.h0=2*FIELD.tileHeight/3,e.x0=FIELD.leftPad+(3*FIELD.cols-9)/4*FIELD.tileWidth,e.y0=FIELD.topPad+FIELD.tileHeight/2;else if("menu2"===this.name)e.w0=5*FIELD.tileWidth,e.h0=FIELD.tileHeight,e.x0=FIELD.menu2.x0,e.y0=FIELD.menu2.y0;else if("debug"===this.name)e.w0=400,e.h0=200,e.x0=0,e.y0=100;else if("letterButton"===this.name)e.w0=3*FIELD.tileWidth,e.h0=FIELD.tileHeight,e.x0=FIELD.leftPad+16.5*FIELD.tileWidth,e.y0=FIELD.topPad+(FIELD.rows-.5)*FIELD.tileHeight;else if("blueprint"===this.name)e.w0=3*FIELD.tileWidth,e.h0=FIELD.tileHeight,e.x0=FIELD.leftPad+FIELD.tileWidth/2,e.y0=FIELD.topPad+(FIELD.rows-.5+.2)*FIELD.tileHeight;else if("overlay"===this.name)"title"===SCENARIO.whichOne?(e.w0=(.5+FIELD.cols-5.25)*FIELD.tileWidth,e.h0=(.5+FIELD.rows/2)*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad):(e.w0=(1+FIELD.cols)*FIELD.tileWidth,e.h0=(1+FIELD.rows)*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad);else if("overlayLeft"===this.name)e.w0=FIELD.tileWidth,e.h0=(FIELD.rows-1)*FIELD.tileHeight,e.x0=FIELD.leftPad+FIELD.tileWidth/2,e.y0=FIELD.topPad+FIELD.tileHeight;else if("overlayRight"===this.name)e.w0=FIELD.tileWidth,e.h0=(FIELD.rows-1)*FIELD.tileHeight,e.x0=FIELD.leftPad+FIELD.tileWidth*(FIELD.cols-.5),e.y0=FIELD.topPad+FIELD.tileHeight;else if("overlayBottom"===this.name)e.w0=(FIELD.cols-2)*FIELD.tileWidth,e.h0=FIELD.tileHeight,e.x0=FIELD.leftPad+1.5*FIELD.tileWidth,e.y0=FIELD.topPad+(FIELD.rows-.5)*FIELD.tileHeight;else if("title"===this.name)e.w0=10*FIELD.tileWidth+35*FIELD.tileWidth/8-FIELD.tileWidth/2,e.h0=15*FIELD.tileHeight/2-FIELD.tileHeight/2,e.x0=FIELD.leftPad+FIELD.tileWidth/4,e.y0=FIELD.topPad+FIELD.tileHeight/4;else if("titleAbout"===this.name){var t=114*FIELD.tileWidth/16,i=5*FIELD.tileWidth,a=4*FIELD.tileWidth;e.w0=i,e.h0=a,e.x0=FIELD.leftPad+t-i/2,e.y0=FIELD.topPad+27.7*FIELD.tileHeight/4-a}else if("titleText"===this.name){t=114*FIELD.tileWidth/16,i=5*FIELD.tileWidth,a=4*FIELD.tileWidth;e.w0=i,e.h0=a,e.x0=FIELD.leftPad+t-i/2,e.y0=FIELD.topPad+27.7*FIELD.tileHeight/4-a}else"titleLearn"===this.name?(e.w0=1.4*FIELD.tileWidth,e.h0=.95*FIELD.tileHeight,e.x0=13.2*FIELD.tileWidth,e.y0=6.7*FIELD.tileHeight):"underlay"===this.name?(e.w0=10*FIELD.tileWidth+35*FIELD.tileWidth/8-FIELD.tileWidth/2,e.h0=15*FIELD.tileHeight/2-FIELD.tileHeight/2,e.x0=FIELD.leftPad+FIELD.tileWidth/4,e.y0=FIELD.topPad+FIELD.tileHeight/4):"selectOverlay"===this.name?(e.w0=30*FIELD.tileWidth,e.h0=15*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad):"toggles"===this.name?"title"===STATE.mode?(e.w0=1*FIELD.tileWidth,e.h0=1*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad):(e.w0=2*FIELD.tileWidth,e.h0=2*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad):"select"===this.name?(e.w0=30*FIELD.tileWidth,e.h0=15*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad):"selectBase"===this.name?(e.w0=30*FIELD.tileWidth,e.h0=15*FIELD.tileHeight,e.x0=FIELD.leftPad,e.y0=FIELD.topPad):"selectButtons"===this.name?(e.w0=5.5*FIELD.tileWidth,e.h0=2*FIELD.tileHeight,e.x0=FIELD.leftPad+6*FIELD.tileWidth,e.y0=FIELD.topPad+1*FIELD.tileHeight):"selectText"===this.name?(e.w0=FIELD.selBoxW-FIELD.tileWidth,e.h0=FIELD.selBoxH,e.x0=FIELD.leftPad+30.4*FIELD.tileWidth-FIELD.selBoxW,e.y0=FIELD.topPad+1.2*FIELD.tileHeight):"selectAward"===this.name?(e.w0=FIELD.selBoxW-FIELD.tileWidth,e.h0=FIELD.selBoxH,e.x0=FIELD.leftPad+30.4*FIELD.tileWidth-FIELD.selBoxW,e.y0=FIELD.topPad+1.2*FIELD.tileHeight):"confirm"===this.name?"title"===STATE.mode?(e.w0=3*FIELD.tileWidth,e.h0=1.25*FIELD.tileHeight,e.x0=FIELD.leftPad+5.5*FIELD.tileWidth,e.y0=FIELD.topPad+3.5*FIELD.tileHeight):(e.w0=6*FIELD.tileWidth,e.h0=2.5*FIELD.tileHeight,e.x0=FIELD.leftPad+11*FIELD.tileWidth,e.y0=FIELD.topPad+7*FIELD.tileHeight):"tutorialHeader"===this.name?(e.w0=10*FIELD.tileWidth+TUTORIAL.boxWidth,e.h0=2*FIELD.tileHeight,e.x0=TUTORIAL.leftPad,e.y0=TUTORIAL.topPad):"tutorialBase"===this.name?(e.w0=10*FIELD.tileWidth+TUTORIAL.boxWidth,e.h0=14*FIELD.tileHeight,e.x0=TUTORIAL.leftPad,e.y0=TUTORIAL.topPad):"tutorialGates"===this.name?(e.x0=TUTORIAL.leftPad+1.5*FIELD.tileWidth,e.y0=TUTORIAL.topPad+1.5*FIELD.tileHeight,e.w0=6*FIELD.tileWidth,e.h0=12*FIELD.tileHeight):"tutorialEffects"===this.name?(e.x0=TUTORIAL.leftPad+1.5*FIELD.tileWidth,e.y0=TUTORIAL.topPad+1.5*FIELD.tileHeight,e.w0=6*FIELD.tileWidth,e.h0=12*FIELD.tileHeight):"tutorialControls"===this.name?(e.x0=TUTORIAL.leftPad+1.5*FIELD.tileWidth,e.y0=TUTORIAL.topPad+1.5*FIELD.tileHeight,e.w0=6*FIELD.tileWidth,e.h0=12*FIELD.tileHeight):"tutorialExtra"===this.name?(e.x0=TUTORIAL.leftPad+1.2*FIELD.tileWidth,e.y0=TUTORIAL.topPad+1.5*FIELD.tileHeight,e.w0=6*FIELD.tileWidth,e.h0=12*FIELD.tileHeight):"robotBase"===this.name?(e.x0=ROBOT.leftPad,e.y0=ROBOT.topPad,e.w0=ROBOT.width,e.h0=ROBOT.height):"robotScreen"===this.name?(e.x0=ROBOT.leftPad+ROBOT.margin+FIELD.tileWidth/6,e.y0=ROBOT.topPad+ROBOT.margin,e.w0=ROBOT.screenW,e.h0=3*FIELD.tileHeight):"robotScreenBase"===this.name?(e.x0=ROBOT.leftPad+FIELD.tileWidth/6,e.y0=ROBOT.topPad,e.w0=ROBOT.screenW+2*ROBOT.margin,e.h0=ROBOT.screenH+2*ROBOT.margin):"robotText"===this.name?(e.x0=ROBOT.leftPad+ROBOT.margin+ROBOT.screenW+2*ROBOT.lineGap,e.y0=ROBOT.topPad+ROBOT.margin,e.w0=ROBOT.textW,e.h0=ROBOT.screenH):"robotButton"===this.name&&(e.x0=ROBOT.leftPad,e.y0=ROBOT.topPad+ROBOT.height-2*FIELD.tileWidth,e.w0=ROBOT.width,e.h0=1.5*FIELD.tileWidth);return e}}class ConfirmationBox{static openTitle(){document.getElementById("greyoverlay").style.visibility="visible",document.getElementById("greyoverlay").style.opacity=.75,STATE.state="confirming",CANV.confirm.activate()}static open(){STATE.mode="confirming",CANV.confirm.activate()}static close(e,t=0){if(0===t){if(0===e){IBOARD=new Board(CANV.interface.ctx,FIELD.cols,FIELD.rows);var i=!1;2===STATE.blueprint&&FIELD.developerMode&&(i=!0);var a=LevelGates(SCENARIO.name,i);return IBOARD.setAllBits(a.allBits,a.allQubits,a.entGroups),IBOARD.setAllGates(a.allGates),IBOARD._tiles=a.tiles,LevelRefresh(SCENARIO.name,IBOARD),STATE.mode="constructing",TIMER.grey=TIMER.greyMax,CANV.confirm.deactivate(),STATE.state="free",STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},-1!==MENU.selected&&(STATE.state="placing"),UNDOREDO.add(),TIMER.construct=-1,CANV.interface.clear(),void CANV.controls.clear()}return 1===e?(STATE.mode="constructing",TIMER.grey=TIMER.greyMax,CANV.confirm.deactivate(),STATE.state="free",STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},-1!==MENU.selected&&(STATE.state="placing"),TIMER.construct=-1,CANV.interface.clear(),void CANV.controls.clear()):void 0}if(1===t){if(0===e)return STATE.state="options",TIMER.grey=TIMER.greyMax,CANV.confirm.deactivate(),localStorage.clear(),InitScenario.loadAll(),STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.under={type:"none",i0:-1,j0:-1,k0:-1},STATE.underLast={type:"none",i0:-1,j0:-1,k0:-1},void(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1});if(1===e)return STATE.state="options",TIMER.grey=TIMER.greyMax,void CANV.confirm.deactivate()}}static checkUnder(e,t){STATE.pos=ControlState.pos(e);var i=t*FIELD.tileWidth,a=STATE.pos.x-11*i-FIELD.leftPad,r=STATE.pos.y-7*i-FIELD.topPad,s=r>=1.5*i&&r<=2.1*i;return s&&a>1.5*i&&a<2.5*i?0:s&&a>3.5*i&&a<4.5*i?1:-1}static loop(e=1,t=0){var i=ConfirmationBox.checkUnder(INPUTS.mousemove,e);if(INPUTS.keydown&&(27===INPUTS.keydown.keyCode&&ConfirmationBox.close(1,t),INPUTS.keydown=0),INPUTS.mousedown){if(INPUTS.mousedown=0,0===i)return SFX.click.play(),void ConfirmationBox.close(i,t);if(1===i)return SFX.click.play(),void ConfirmationBox.close(i,t)}CANV.confirm.clear();var a=CANV.confirm.ctx,r=e*FIELD.tileWidth,s=r/24,o=r/2,n=[s,s,6*r-s,6*r-s],l=[s,2.5*r-s,2.5*r-s,s],h=[o,o,o,o],d=new Path2D(Helper.makeRoundedPath(n,l,h,1,0,0));a.save(),a.fillStyle="#1b1b1b",a.lineWidth=r/24,a.strokeStyle="#000",a.shadowColor="transparent",a.fill(d),a.stroke(d),a.restore(),a.save(),a.clip(d,"evenodd"),"title"===STATE.mode?Textures.drawFiber(a,0,0,6*r,2.5*r,FIELD.tileWidth/96,.5):Textures.drawFiber(a,0,0,6*r,2.5*r,FIELD.tileWidth/48,.5),a.restore(),a.save(),a.textBaseline="top",a.textAlign="center",a.fillStyle="antiquewhite",a.font=1.2*r/3+"px Courier New",a.shadowBlur=2,a.shadowOffsetX=2,a.shadowOffsetY=2,a.shadowColor="black",0===t?(a.fillText("Clear current board:",3*r,.25*r),a.fillText("are you sure?",3*r,.75*r)):1===t&&(a.fillText("Clear saved data:",3*r,.25*r),a.fillText("are you sure?",3*r,.75*r));n=[1.5*r,1.5*r,2.5*r,2.5*r],l=[1.5*r,2.1*r,2.1*r,1.5*r],h=[r/4,r/4,r/4,r/4],d=new Path2D(Helper.makeRoundedPath(n,l,h,1,0,0));0===i&&(a.fillStyle="grey",a.fill(d)),a.lineWidth=r/24,a.strokeStyle="white",a.stroke(d);d=new Path2D(Helper.makeRoundedPath(n,l,h,1,2*r,0));return 1===i&&(a.fillStyle="grey",a.fill(d)),a.lineWidth=r/24,a.strokeStyle="white",a.stroke(d),a.fillStyle="antiquewhite",a.fillText("YES",2*r,1.6*r),a.fillText("NO",4*r,1.6*r),a.restore(),-1}}class ControlState{constructor(){this._mode="constructing",this._state="free",this._under={type:"none",i0:-1,j0:-1,k0:-1},this._underLast={type:"none",i0:-1,j0:-1,k0:-1},this._selected={type:"none",i0:-1,j0:-1,k0:-1},this._grab={type:"none",i0:-1,j0:-1,k0:-1},this._pressed={type:"none",i0:-1,j0:-1,k0:-1},this._pos={x:0,y:0},this._entLabs=[],this._entGroups=[],this._view=-1,this._tooltip="",this._validPlacement=!1,this._validPlacementLoc=!1,this._validPlacementAdj=!1,this._extraOrient=0,this._blueprint=-1,this._profile=-1,this._lastLetter=0,this._lastBoop=-1,this._heldKey=-1,this._isDestroy=!1,this._isScrollManip=!1,this._newFocus=!1}get newFocus(){return this._newFocus}get extraOrient(){return this._extraOrient}get validPlacement(){return this._validPlacement}get validPlacementLoc(){return this._validPlacementLoc}get validPlacementAdj(){return this._validPlacementAdj}get mode(){return this._mode}get state(){return this._state}get under(){return this._under}get underLast(){return this._underLast}get selected(){return this._selected}get grab(){return this._grab}get pressed(){return this._pressed}get pos(){return this._pos}get entLabs(){return this._entLabs}get entGroups(){return this._entGroups}get view(){return this._view}get tooltip(){return this._tooltip}get blueprint(){return this._blueprint}get profile(){return this._profile}get lastLetter(){return this._lastLetter}get lastBoop(){return this._lastBoop}get heldKey(){return this._heldKey}get isDestroy(){return this._isDestroy}get isScrollManip(){return this._isScrollManip}set newFocus(e){this._newFocus=e}set blueprint(e){this._blueprint=e}set extraOrient(e){this._extraOrient=e}set validPlacement(e){this._validPlacement=e}set validPlacementLoc(e){this._validPlacementLoc=e}set validPlacementAdj(e){this._validPlacementAdj=e}set mode(e){this._mode=e}set state(e){this._state=e}set under(e){this._under=e}set underLast(e){this._underLast=e}set selected(e){this._selected=e}set grab(e){this._grab=e}set pressed(e){this._pressed=e}set pos(e){this._pos=e}set view(e){this._view=e}set tooltip(e){this._tooltip=e}set profile(e){this._profile=e}set lastLetter(e){this._lastLetter=e}set lastBoop(e){this._lastBoop=e}set heldKey(e){this._heldKey=e}set isDestroy(e){this._isDestroy=e}set isScrollManip(e){this._isScrollManip=e}static softReset(){RBOARD.fill(0),LevelRefresh(SCENARIO.whichOne,IBOARD),TIMER.white=0,TIMER.shake=0,SFX.startup.play(),STATE.mode="forwardTrans",STATE.state="free",STATE.grab={type:"none",i0:0,j0:0,k0:0};var e=CTRLMENU.getNamedButton("ctrlPlay"),t=CTRLMENU.getNamedButton("ctrlStep"),i=CTRLMENU.getNamedButton("ctrlBack");e.transition={status:!0,start:1,stop:0},t.transition={status:!0,start:1,stop:0},i.transition={status:!0,start:1,stop:0},RANDS.locs=Array.from(RANDS.locs,()=>Math.floor(1e5*Math.random())),CANV.baseWires.clear(),Render.boardWires(IBOARD,CANV.baseWires.ctx),TIMER.tickEnd=TIMER.tick,TIMER.ratio>.5&&(TIMER.tickEnd=TIMER.tick+1),TIMER.victoryTick=99999,SCENARIO.repSuccess=0}static pos(e){var t=CANV.interface.canv,i=t.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}setEntLab(e){this.entLabs.push(e)}setEntGroup(e){this.entGroups.push(e)}removeEntLab(e){var t=this.entLabs.indexOf(e);t>=0&&this.entLabs.splice(t,1)}checkHover(){if(POPWINDOW.isOpen){if(POPWINDOW.isHover=parseInt(getComputedStyle(POPWINDOW.movableWindow).getPropertyValue("--is-hovered").trim()),POPWINDOW.isHover)return}else POPWINDOW.isHover=0;var e=this._under.i0!==this._underLast.i0||this._under.j0!==this._underLast.j0||this._under.k0!==this._underLast.k0||this._under.type!==this._underLast.type;if(e){var t=!1,i=!1;if("title"===this.mode)i=["titlebutton","optionbut"].includes(this.under.type);else if("finished"===this.mode)i=["nextbutton"].includes(this.under.type);else if("robot"===this.mode)i=["robbutton","archiveButton"].includes(this.under.type);else if("levelSelect"===this.mode)t=["token"].includes(this.under.type),i=["selectPlaque","selectButton","token"].includes(this.under.type);else if("constructing"===this.mode||"paused"===this.mode){var a=["erasing","placing","qwiring","cwiring","destroying"].includes(this.state),r=["qubitbasis","gatedrag","analysisgatecontrolling","premultiplace","multiplace"].includes(this.state);if(a?(t=["eraser"].includes(this.under.type),i=["letterButton","blueprint","undobutton","redobutton"].includes(this.under.type)):(t=["qubit","eraser"].includes(this.under.type),i=["letterButton","blueprint","analysishighlight","analysisgate","undobutton","redobutton","questionicon","archiveButton","journalButton"].includes(this.under.type)),"boardtile"===this.under.type&&"constructing"===this.mode&&!a&&!r){var s=this.under.i0+this.under.j0*FIELD.cols;if(SCENARIO.editable[s]>0){var o=IBOARD.getGate(STATE.under.i0,STATE.under.j0,IBOARD.state[s]);o&&o!=this.grab.k0&&(t=!0)}}if("menubutton"===this.under.type&&"constructing"===this.mode&&("free"===this.state||"placing"===this.state)){var n=MENU.getButton(STATE.under.i0,STATE.under.j0);-1!==n&&(n.isGrey||MENU.selected!==6*n.j0+n.i0&&(t=!0))}}t?SFX.hover.play():i&&SFX.hover2.play()}}checkUnder(){if(this.checkHover(),this._underLast.type=this._under.type,this._underLast.i0=this._under.i0,this._underLast.j0=this._under.j0,this._underLast.k0=this._under.k0,POPWINDOW.isHover)this._under={type:"none",i0:0,j0:0,k0:0};else{if("constructing"===STATE.mode){var e=STATE.pos.y-(FIELD.menu2.y0+3*FIELD.tileWidth/4);if(e>0&&e<FIELD.tileWidth/2){if(UNDOREDO.numAvail>0){var t=STATE.pos.x-(FIELD.menu2.x0-1.5*FIELD.tileWidth)-FIELD.tileWidth/4;if(t>0&&t<FIELD.tileWidth)return void(this._under={type:"undobutton",i0:-1,j0:-1,k0:-1})}if(UNDOREDO.numFwd>0){t=STATE.pos.x-(FIELD.menu2.x0-1.5*FIELD.tileWidth)-6.75*FIELD.tileWidth;if(t>0&&t<FIELD.tileWidth)return void(this._under={type:"redobutton",i0:-1,j0:-1,k0:-1})}}}if("robot"===STATE.mode){var i=STATE.pos.x-ROBOT.leftPad,a=STATE.pos.y-ROBOT.topPad-ROBOT.height+2*FIELD.tileWidth,r=FIELD.tileWidth,s=ROBOT.width/2-1.75*r,o=i>s+.5*r&&i<s+3*r,n=a>r/4&&a<3*r/2;if(o&&n)return void(this._under={type:"robbutton",i0:0,j0:-1,k0:-1});if(SCENARIO.archive&&"finished"===ROBOT.oldMode){o=i>ROBOT.width-5*r&&i<ROBOT.width-r;if(o&&n)return void(this._under={type:"robbutton",i0:1,j0:-1,k0:-1})}if("levelSelect"===ROBOT.oldMode)return void(this._under={type:"none",i0:-1,j0:-1,k0:-1})}if("tutorial"===STATE.mode){i=STATE.pos.x-TUTORIAL.leftPad,a=STATE.pos.y-TUTORIAL.topPad;var l=10*FIELD.tileWidth+TUTORIAL.boxWidth,h=2.75*FIELD.tileWidth,d=(s=3.25*FIELD.tileWidth,.875*FIELD.tileHeight),u=1.375*FIELD.tileHeight,c=l-3.25*FIELD.tileWidth,I=l-2.75*FIELD.tileWidth;n=a>=d&&a<=u,o=i>=h&&i<=s;if(o&&n)return void(this._under={type:"tbutton",i0:1,j0:-1,k0:-1});o=i>=c&&i<=I;if(o&&n)return void(this._under={type:"tbutton",i0:2,j0:-1,k0:-1});var E=l-1.5*FIELD.tileWidth;o=i>=E&&i<=E+FIELD.tileHeight/2,n=a>=.5*FIELD.tileHeight&&a<=FIELD.tileHeight;return o&&n?void(this._under={type:"tbutton",i0:3,j0:-1,k0:-1}):void(this._under={type:"none",i0:-1,j0:-1,k0:-1})}if(["constructing","finished","running","paused","robot"].indexOf(STATE.mode)>=0&&"qubit"!=this._grab.type){a=STATE.pos.y-FIELD.midHeight-.6*FIELD.tileHeight;if(PERSIST0[SCENARIO.name].complete&&SCENARIO.archive){i=STATE.pos.x-FIELD.midWidth-7.75*FIELD.tileWidth,o=i>0&&i<FIELD.tileWidth/2,n=a>0&&a<FIELD.tileHeight/2;if(o&&n)return void(this._under={type:"archiveButton",i0:0,j0:-1,k0:-1})}if(SCENARIO.journal){i=STATE.pos.x-FIELD.midWidth-.5*FIELD.tileWidth,o=i>0&&i<FIELD.tileWidth/2,n=a>0&&a<FIELD.tileHeight/2;if(o&&n)return void(this._under={type:"journalButton",i0:0,j0:-1,k0:-1})}}if("constructing"===STATE.mode){i=STATE.pos.x-FIELD.leftPad,a=STATE.pos.y-FIELD.topPad;var f=FIELD.leftPad+16.25*FIELD.tileWidth,S=FIELD.topPad+(FIELD.rows-.5)*FIELD.tileHeight;o=i>=f&&i<=f+9.5*FIELD.tileWidth/4,n=a>=S&&a<=S+1.2*FIELD.tileHeight/2;if(o&&n)return void(i<f+2.25*FIELD.tileWidth/4?this._under={type:"letterButton",i0:0,j0:-1,k0:-1}:i<f+4.75*FIELD.tileWidth/4?this._under={type:"letterButton",i0:1,j0:-1,k0:-1}:i<f+7.25*FIELD.tileWidth/4?this._under={type:"letterButton",i0:2,j0:-1,k0:-1}:this._under={type:"letterButton",i0:3,j0:-1,k0:-1})}if(["constructing","running","paused","finished","levelSelect","title","robot"].indexOf(STATE.mode)>=0){i=STATE.pos.x-FIELD.leftPad,a=STATE.pos.y-FIELD.topPad;if("title"===STATE.mode)r=FIELD.tileWidth/2;else r=FIELD.tileWidth;o=i>r/3&&i<2*r/3,n=a>r/3&&a<4.4*r/3;if(o&&n)return this._under=a<2.2*r/3?{type:"escbutton",i0:0,j0:-1,k0:-1}:a<3.4*r/3?{type:"escbutton",i0:1,j0:-1,k0:-1}:{type:"escbutton",i0:2,j0:-1,k0:-1},void("title"===STATE.mode&&(this._under.i0+=1,3===this._under.i0&&(this._under={type:"none",i0:-1,j0:-1,k0:-1})))}if("levelSelect"===STATE.mode){SELECTOR.removeHover();i=STATE.pos.x-FIELD.leftPad,a=STATE.pos.y-FIELD.topPad,o=i>17*FIELD.tileWidth&&i<21*FIELD.tileWidth,n=a>1.5*FIELD.tileWidth&&a<3.5*FIELD.tileWidth;if(o&&n){var p=Math.floor((i-17*FIELD.tileWidth)/FIELD.tileWidth),T=Math.floor((a-1.5*FIELD.tileWidth)/FIELD.tileWidth),R=(p=Math.min(Math.max(0,p),3),T=Math.min(Math.max(0,T),1),2*p+T);return this.under={type:"selectAward",i0:p,j0:T,k0:R},"selectButton"!==this._selected.type?(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)):this._selected.k0!==R&&(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)),void(this._selected={type:"selectAward",i0:p,j0:T,k0:R})}o=i>6*FIELD.tileWidth&&i<11*FIELD.tileWidth,n=a>1.5*FIELD.tileWidth&&a<2*FIELD.tileWidth;if(o&&n){for(var m=0;m<7;m++)if((PERSIST0.generic.availableBriefs[m]||FIELD.forceOpen)&&i>6.5*FIELD.tileWidth&&i<6*FIELD.tileWidth+2.5*(m+2)*FIELD.tileWidth/4)return this._under={type:"selectButton",i0:m,j0:-1,k0:-1},"selectButton"!==this._selected.type?(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)):this._selected.i0!==m&&(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)),void(this._selected={type:"selectButton",i0:m,j0:-1,k0:-1});return this._selected={type:"none",i0:-1,j0:-1,k0:-1},void(this._under={type:"none",i0:-1,j0:-1,k0:-1})}var g=SELECTOR.scale,A=SELECTOR.plaqueList.length;for(m=0;m<A;m++){var C=SELECTOR.plaqueList[m];h=C.i0*g*FIELD.tileWidth,d=C.j0*g*FIELD.tileWidth,s=h+C.w0*FIELD.tileWidth,u=d+C.h0*FIELD.tileWidth,o=i>=h&&i<=s,n=a>=d&&a<=u;if(o&&n)return this._under={type:"selectPlaque",i0:C.i0,j0:C.j0,k0:C},"selectPlaque"!==this._selected.type?(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)):this._selected.k0.name!==this._under.k0.name&&(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)),this._selected={type:"selectPlaque",i0:C.i0,j0:C.j0,k0:C},void(C.isHover=!0)}var L=SELECTOR.tokenList.length;for(m=0;m<L;m++){var D=SELECTOR.tokenList[m];if(D.isAvailable){i=STATE.pos.x-FIELD.leftPad,a=STATE.pos.y-FIELD.topPad,h=D.i0*g*FIELD.tileWidth,d=D.j0*g*FIELD.tileWidth,s=h+g*FIELD.tileWidth,u=d+g*FIELD.tileWidth,o=i>=h&&i<=s,n=a>=d&&a<=u;if(o&&n)return this._under={type:"token",i0:D.i0,j0:D.j0,k0:D},"token"!==this._selected.type?(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)):this._selected.k0.name!==this._under.k0.name&&(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)),D.isHover=!0,void(this._selected={type:"token",i0:D.i0,j0:D.j0,k0:D})}}return this._under={type:"none",i0:-1,j0:-1,k0:-1},"none"!==this._selected.type&&(CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)),void(this._selected={type:"none",i0:-1,j0:-1,k0:-1})}h=this.pos.x,d=this.pos.y;if("title"!==STATE.mode){if("finished"===STATE.mode){var b=!RobotSpeech.grab(SCENARIO.name,0,!0)||FIELD.disableBriefs,O=b&&1===SCENARIO.victory;if(O){var M=9*FIELD.tileWidth/4,v=(u=1.6*FIELD.tileWidth,1.5*FIELD.tileHeight/6),w=parseInt(CANV.victoryText.canv.style.left),N=parseInt(CANV.victoryText.canv.style.top),P=CANV.victoryText.canv.width/2-M/2-v+w,y=CANV.victoryText.canv.width/2+M/2+v+w;o=h>P&&h<y,n=d>u-v+N&&d<u+v+N;if(o&&n)return void(this._under={type:"nextbutton",i0:-1,j0:-1,k0:SCENARIO.victory})}}if(!(this.checkGateManip(h,d)||("paused"===this.mode&&-1===TIMER.subTick||"constructing"===this.mode&&"qubiting"===this.state)&&this.checkAnalysis(h,d))){if("constructing"===STATE.mode){i=STATE.pos.x-(FIELD.menu.x0+FIELD.tileWidth/5),a=STATE.pos.y-(FIELD.menu.y0+3*FIELD.tileHeight/8),o=i>0&&i<FIELD.tileWidth,n=a>0&&a<FIELD.tileHeight;if(o&&n)return void(this._under={type:"eraser",i0:-1,j0:-1,k0:-1})}o=h>FIELD.menu.x0&&h<FIELD.menu.x0+MENU.w0,n=d>FIELD.menu.y0&&d<FIELD.menu.y0+MENU.h0-FIELD.tileWidth/2;if(o&&n){var F=MENU.findTile(h-FIELD.menu.x0,d-FIELD.menu.y0);if("constructing"===this.mode){if(MENU.selected>=0){var k=MENU.buttons[MENU.selected],x=MENU.gridPos(k.i0,k.j0);s=x.x0+FIELD.tileWidth+FIELD.menu.x0,u=x.y0+FIELD.tileHeight+FIELD.menu.y0;if(Helper.dist(s-h,u-d)<1.5*SEL_STYLES.iconWidth/2)return MENU.removeHovered(),void(this._under={type:"questionicon",i0:MENU.selected,j0:-1,k0:-1})}F.i0>=0&&F.i0<6&&F.j0>=0?(MENU.setHovered(F.i0,F.j0),this._under={type:"menubutton",i0:F.i0,j0:F.j0,k0:-1}):(MENU.removeHovered(),this._under={type:"none",i0:-1,j0:-1,k0:-1})}}else{if(MENU.removeHovered(),"constructing"===STATE.mode){var B=FIELD.topPad+(FIELD.rows-.3)*FIELD.tileHeight,W=FIELD.leftPad+FIELD.tileWidth;o=h>W&&h<W+2*FIELD.tileWidth,n=d>B&&d<B+FIELD.tileHeight;if(o&&n)return h<W+.6*FIELD.tileWidth?(this._under={type:"blueprint",i0:0,j0:-1,k0:-1},BLUEPRINT.hovered=0):h<W+1.2*FIELD.tileWidth?(this._under={type:"blueprint",i0:1,j0:-1,k0:-1},BLUEPRINT.hovered=1):(this._under={type:"blueprint",i0:2,j0:-1,k0:-1},BLUEPRINT.hovered=2),BLUEPRINT.hovered!==BLUEPRINT.lastHovered&&Blueprint.draw(),void(BLUEPRINT.lastHovered=BLUEPRINT.hovered);BLUEPRINT.hovered=-1,BLUEPRINT.hovered!==BLUEPRINT.lastHovered&&Blueprint.draw(!1),BLUEPRINT.lastHovered=BLUEPRINT.hovered}o=h>FIELD.menu2.x0&&h<FIELD.menu2.x0+CTRLMENU.w0,n=d>FIELD.menu2.y0&&d<FIELD.menu2.y0+CTRLMENU.h0;if(o&&n){F=CTRLMENU.findTile(h-FIELD.menu2.x0,d-FIELD.menu2.y0);return CTRLMENU.setHovered(F.i0,F.j0),void(this._under={type:"ctrlbutton",i0:F.i0,j0:F.j0,k0:CTRLMENU.getButton(F.i0,F.j0)})}if(CTRLMENU.removeHovered(),"constructing"===this.mode&&("free"===this.state||"qubiting"===this.state||"gatemanip"===this.state)&&["tut1","tut2","tut3","tut4","tut5"].indexOf(SCENARIO.name)<0){var q=IBOARD;for(m=0;m<q._qubitList.length;m++)q._qubitList[m].isHovered=!1;if(this.checkQubitManip(h,d))return;o=h>q.x0+FIELD.leftPad&&h<q.x0+FIELD.leftPad+q.width*FIELD.tileWidth,n=d>q.y0+FIELD.topPad&&d<q.y0+FIELD.topPad+q.height*FIELD.tileHeight;if(o&&n){F=q.findTile(h,d);if("free"===this.state||"qubiting"===this.state||"gatemanip"===this.state){var H=F.i0+F.j0*q._width,U=q._qubits[H],_=!0;if("free"===this.state){var G=(h-FIELD.leftPad)/FIELD.tileWidth,V=(d-FIELD.topPad)/FIELD.tileHeight;(Math.abs(G-Math.round(G))>.3||Math.abs(V-Math.round(V))>.3)&&(_=!1)}if(["quantumAdv1","quantumAdv2","quantumAdv3"].indexOf(SCENARIO.name)>=0)var Q=0===F.j0||13===F.j0;else Q=0===F.j0||13===F.j0&&(F.i0<=2||F.i0>=16);if(U&&!Q&&_){if("qubiting"===this.state)var $=q._qubits[H];$=STATE.grab.k0;var z=$.i0===U.i0&&$.j0===U.j0;if(!z&&!U.isGhost)return U.isHovered=!0,void(this._under={type:"qubit",i0:F.i0,j0:F.j0,k0:U})}}}}if("paused"===this.mode&&-1===TIMER.subTick){for(q=RBOARD[TIMER.tick],m=0;m<q._qubitList.length;m++)q._qubitList[m].isHovered=!1;if(this.checkQubitManip(h,d))return;o=h>q.x0+FIELD.leftPad&&h<q.x0+FIELD.leftPad+q.width*FIELD.tileWidth,n=d>q.y0+FIELD.topPad&&d<q.y0+FIELD.topPad+q.height*FIELD.tileHeight;if(o&&n){F=q.findTile(h,d);if("free"===this.state||"qubiting"===this.state){H=F.i0+F.j0*q._width,U=q._qubits[H];if(U){if("qubiting"===this.state)$=q._qubits[H];$=STATE.grab.k0,z=$.i0===U.i0&&$.j0===U.j0;if(!z&&!U.isGhost)return U.isHovered=!0,void(this._under={type:"qubit",i0:F.i0,j0:F.j0,k0:U})}}return void(this._under={type:"boardtile",i0:F.i0,j0:F.j0,k0:-1})}}if("constructing"===this.mode){o=h>IBOARD.x0+FIELD.leftPad&&h<IBOARD.x0+FIELD.leftPad+IBOARD.width*FIELD.tileWidth,n=d>IBOARD.y0+FIELD.topPad&&d<IBOARD.y0+FIELD.topPad+IBOARD.height*FIELD.tileHeight;if(o&&n){F=IBOARD.findTile(h,d);return SCENARIO.editable[F.i0+F.j0*FIELD.cols],void(this._under={type:"boardtile",i0:F.i0,j0:F.j0,k0:-1})}}this._under={type:"none",i0:0,j0:0,k0:0}}}}else{if("free"===STATE.state){var j=this.pos.x-CANV.titleLearn.x0,Y=this.pos.y-CANV.titleLearn.y0,o=j>.1*FIELD.tileWidth&&j<1.1*FIELD.tileWidth,n=Y>.1*FIELD.tileWidth&&Y<.8*FIELD.tileWidth;if(o&&n)return void(this._under={type:"learnbutton",i0:-1,j0:-1,k0:-1});var X=FIELD.tileWidth;if(FIELD.isCleanSlate)var Z=[0,0,0];else Z=[-.15*X,.1*X,.1*X];var J=FIELD.tileWidth*(FIELD.cols-5.25),K=FIELD.tileHeight*(FIELD.rows/2),ee=2*FIELD.tileWidth,te=1.4*FIELD.tileHeight,ie=.4*FIELD.tileWidth,ae=K-te+FIELD.topPad+FIELD.tileHeight/4,re=J/2+FIELD.leftPad+FIELD.leftMargin,o=h>re-ee/2&&h<re+ee/2;if(o)for(var m=0;m<3;m++){var se=ae+m*ie,n=d>se-ie/2+Z[m]&&d<se+ie/2+Z[m];if(n)return void(this._under={type:"titlebutton",i0:m,j0:-1,k0:-1})}}else if("options"===STATE.state){X=FIELD.tileWidth
;var oe=h-(FIELD.leftPad+114*FIELD.tileWidth/16-5*FIELD.tileWidth/2),ne=d-(FIELD.topPad+27.7*FIELD.tileHeight/4-4*FIELD.tileWidth),o=oe>1.4*X&&oe<3.6*X;if(o){var n=ne>8.5*X/3&&ne<9.5*X/3;if(n)return void(STATE.under={type:"optionbut",i0:0,j0:-1,k0:-1});var n=ne>10*X/3&&ne<11*X/3;if(n)return void(STATE.under={type:"optionbut",i0:1,j0:-1,k0:-1})}var o=oe>1.8*X&&oe<4.2*X,le=Math.round(100*(oe-1.8*X)/(2.4*X));if(o){var n=ne>2*X/3+3*X/2-.2*X&&ne<2*X/3+3*X/2+.2*X;if(n)return void(this._under={type:"titleslider",i0:0,j0:le,k0:-1});var n=ne>X+3*X/2-.2*X&&ne<X+3*X/2+.2*X;if(n)return void(this._under={type:"titleslider",i0:1,j0:le,k0:-1})}var o=oe>3.03*X&&oe<3.43*X;if(o)for(var he=[1.5*X/4,1.5*X/4+X/3+X/2,1.5*X/4+X/3+X],m=0;m<3;m++){var n=ne>he[m]-.2*X&&ne<he[m]+.2*X;if(n)return void(this._under={type:"titleoption",i0:0,j0:m,k0:-1})}var o=oe>4.47*X&&oe<4.87*X;if(o)for(he=[1.5*X/4,1.5*X/4+X/3+X/2,1.5*X/4+X/3+X],m=0;m<3;m++){var n=ne>he[m]-.2*X&&ne<he[m]+.2*X;if(n)return void(this._under={type:"titleoption",i0:1,j0:m,k0:-1})}}this._under={type:"none",i0:-1,j0:-1,k0:-1}}}}checkGateManip(e,t){if("gatemanip"===this.state){var i=IBOARD.x0+(STATE.grab.i0+.5)*FIELD.tileWidth+FIELD.leftPad,a=IBOARD.y0+(STATE.grab.j0+.5)*FIELD.tileHeight+FIELD.topPad,r=SEL_STYLES.r0,s=STATE.grab.type,o=STATE.grab.k0;if(["cCreate","qCreate"].indexOf(s)>=0){var n=i-FIELD.tileWidth/3,l=a+FIELD.tileWidth/3+SEL_STYLES.iconWidth/2,h=i+FIELD.tileWidth/3,d=a+FIELD.tileWidth/3+SEL_STYLES.iconWidth/2;if(Helper.dist(n-e,l-t)<SEL_STYLES.iconWidth/2)return this._under={type:"gateicon",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:0},!0;if(Helper.dist(h-e,d-t)<SEL_STYLES.iconWidth/2)return this._under={type:"gateicon",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:1},!0;if("qCreate"===s){var u=a-1.8*FIELD.tileWidth/3+SEL_STYLES.iconWidth/2;if(Helper.dist(n-e,u-t)<SEL_STYLES.iconWidth/2)return this._under={type:"gateicon",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:2},!0}}else if(["trash","cInvert","qFlip"].indexOf(s)>=0){h=i+FIELD.tileWidth/3,d=a+FIELD.tileWidth/3+SEL_STYLES.iconWidth/2;if(Helper.dist(h-e,d-t)<SEL_STYLES.iconWidth/2)return this._under={type:"gateicon",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:1},!0}else if(["switch"].indexOf(s)>=0){var c=3.5*FIELD.tileWidth/12;h=i-FIELD.iconWidth/2-c+SEL_STYLES.iconWidth/2,d=a-c-FIELD.iconWidth/2+SEL_STYLES.iconWidth/2;if(Helper.dist(h-e,d-t)<SEL_STYLES.iconWidth/2)return this._under={type:"gateicon",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:4},!0}if(["cCombine","qCombine","cSplit"].indexOf(s)>=0){var I=[-r,0,r,0],E=[0,-r,0,r],f=(STATE.grab.k0.orient+2)%4;if(Helper.dist(I[f]+i-e,E[f]+a-t)<SEL_STYLES.handleTol*SEL_STYLES.handleRad)return this._under={type:"gatecontrol",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:f},!0}else if(["delay"].indexOf(s)>=0){f=(STATE.grab.k0.orient+2)%2;if(Helper.dist(r*Math.sin((o.rot+.5*o.state)*Math.PI/2)+i-e,-r*Math.cos((o.rot+.5*o.state)*Math.PI/2)+a-t)<SEL_STYLES.handleTol*SEL_STYLES.handleRad)return this._under={type:"gatecontrol",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:f},!0}else if(["measure","rotate","upgrade"].indexOf(s)>=0){f=(STATE.grab.k0.orient+2)%2;if(Helper.dist(-r*Math.cos(o.rot+Math.PI/2)+i-e,-r*Math.sin(o.rot+Math.PI/2)+a-t)<SEL_STYLES.handleTol*SEL_STYLES.handleRad)return this._under={type:"gatecontrol",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:f},!0}else if(["qControl"].indexOf(s)>=0){var S=3*SEL_STYLES.r0/4;f=(STATE.grab.k0.orient+2)%2;if(Helper.dist(-S*Math.cos(o.rot+Math.PI/2)+i-e,-S*Math.sin(o.rot+Math.PI/2)+a-t)<SEL_STYLES.handleTol*SEL_STYLES.handleRad)return this._under={type:"gatecontrol",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:f},!0}else if(["qFlip"].indexOf(s)>=0){if(0===o.state){f=(STATE.grab.k0.orient+2)%2;if(Helper.dist(-r*Math.cos(o.rot+Math.PI/2)+i-e,-r*Math.sin(o.rot+Math.PI/2)+a-t)<SEL_STYLES.handleTol*SEL_STYLES.handleRad)return this._under={type:"gatecontrol",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:f},!0}}else if(["compare"].indexOf(s)>=0){f=(STATE.grab.k0.orient+2)%4;if(Helper.dist(0,-r*Math.cos(o.rot*Math.PI)+a-t)<SEL_STYLES.handleTol*SEL_STYLES.handleRad)return this._under={type:"gatecontrol",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:f},!0}else if(["cCreate"].indexOf(s)>=0){f=(STATE.grab.k0.orient+2)%4;if(Helper.dist(r*Math.sin(2*o.rot*Math.PI/3)+i-e,-r*Math.cos(2*o.rot*Math.PI/3)+a-t)<SEL_STYLES.handleTol*SEL_STYLES.handleRad)return this._under={type:"gatecontrol",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:f},!0}else if(["qCreate"].indexOf(s)>=0){var p=STATE.grab.k0.numPoints;f=(STATE.grab.k0.orient+2)%4;if(Helper.dist(r*Math.sin(2*o.rot*Math.PI/p)+i-e,-r*Math.cos(2*o.rot*Math.PI/p)+a-t)<SEL_STYLES.handleTol*SEL_STYLES.handleRad)return this._under={type:"gatecontrol",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:f},!0}}return!1}checkAnalysis(e,t){if(1===ANALYSIS.openTrig){var i=FIELD.analysisLeft,a=FIELD.topPad,r=FIELD.analysisWidth+FIELD.tileWidth,s=(1+FIELD.rows)*FIELD.tileHeight,o=e>i&&e<i+r,n=t>a&&t<a+s;if(o&&n){var l=this.grab.k0;if(l.entGroup)var h=l.entGroup.numQubits;else h=1;for(var d=FIELD.topPad+ANALYSIS.yPad+1.5*ANALYSIS.basisSpace+FIELD.tileHeight+(ANALYSIS.basisSpace-ANALYSIS.basisSize)/2,u=0;u<h;u++){var c=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+(u+1)*FIELD.tileWidth+(FIELD.tileWidth-ANALYSIS.basisSize)/2-FIELD.iconWidth/2,I=(c-e)**2+(d-t)**2<=(1.2*FIELD.iconWidth/2)**2;if(I)return this._under={type:"analysishighlight",i0:-1,j0:-1,k0:u},!0}if(l.entGroup){var E=l.entGroup,f=Math.min(2**E.numQubits,16),S=(u=l.entInd,FIELD.topPad+ANALYSIS.yMeasure+(f+2)*ANALYSIS.basisSpace);for(u=0;u<E.numQubits;u++){var p=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+(u+1)*FIELD.tileWidth;if(u===l.entInd){var T=E.qubitList[u].measureRot,R=3*SEL_STYLES.r0/4,m=p-R*Math.cos(T+Math.PI/2),g=S-R*Math.sin(T+Math.PI/2);I=(m-e)**2+(g-t)**2<=(1.5*SEL_STYLES.handleRad)**2;if(I)return this._under={type:"analysisgatecontrol",i0:-1,j0:-1,k0:u},!0}if(u===l.entInd)I=(p-e)**2+(S-t)**2<=(FIELD.tileWidth/2)**2;else I=(p-e)**2+(S-t)**2<=(FIELD.tileWidth/6)**2;if(I)return this._under={type:"analysisgate",i0:-1,j0:-1,k0:u},!0}}if(l.entGroup){E=l.entGroup;var A=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+(l.entInd+1)*FIELD.tileWidth,C=FIELD.topPad+ANALYSIS.yPad+FIELD.tileHeight/2,L=(R=3*SEL_STYLES.r0/4,m=R*Math.sin(l.basisRot)+A,g=-R*Math.cos(l.basisRot)+C,R*Math.sin(l.basisRot+Math.PI)+A),D=-R*Math.cos(l.basisRot+Math.PI)+C,b=(m-e)**2+(g-t)**2<=(1.5*SEL_STYLES.handleRad)**2;b&&(this.under.k0=2);var O=(L-e)**2+(D-t)**2<=(1.5*SEL_STYLES.handleRad)**2;if(O&&(this.under.k0=3),b||O)return this.under.type="qubitcontrol",!0;for(var M=0;M<E.numQubits;M++){var v=E.qubitList[M];A=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+(M+1)*FIELD.tileWidth,C=FIELD.topPad+ANALYSIS.yPad+FIELD.tileHeight/2;if(M!=l.entInd){var w=(A-e)**2+(C-t)**2<=(.7*FIELD.tileWidth/2)**2;if(w)return v.isHovered=!0,this._under={type:"qubit",i0:v.i0,j0:v.j0,k0:v},!0;v.isHovered=!1}}}else{p=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+FIELD.tileWidth,S=FIELD.topPad+ANALYSIS.yMeasure+4*ANALYSIS.basisSpace,T=this.grab.k0.measureRot,R=3*SEL_STYLES.r0/4,m=p-R*Math.cos(T+Math.PI/2),g=S-R*Math.sin(T+Math.PI/2),I=(m-e)**2+(g-t)**2<=(1.5*SEL_STYLES.handleRad)**2;if(I)return this._under={type:"analysisgatecontrol",i0:-1,j0:-1,k0:u},!0;A=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+FIELD.tileWidth,C=FIELD.topPad+ANALYSIS.yPad+FIELD.tileHeight/2,R=3*SEL_STYLES.r0/4,m=R*Math.sin(l.basisRot)+A,g=-R*Math.cos(l.basisRot)+C,L=R*Math.sin(l.basisRot+Math.PI)+A,D=-R*Math.cos(l.basisRot+Math.PI)+C,b=(m-e)**2+(g-t)**2<=(1.5*SEL_STYLES.handleRad)**2;b&&(this.under.k0=2);O=(L-e)**2+(D-t)**2<=(1.5*SEL_STYLES.handleRad)**2;if(O&&(this.under.k0=3),b||O)return this.under.type="qubitcontrol",!0}return this._under={type:"analysiswindow",i0:0,j0:0,k0:0},!0}}return!1}checkQubitManip(e,t){if("qubiting"===this.state){var i=this.grab.k0,a=IBOARD.x0+(STATE.grab.i0+.5)*FIELD.tileWidth+FIELD.leftPad,r=IBOARD.y0+(STATE.grab.j0+.5)*FIELD.tileHeight+FIELD.topPad,s=e>=a-SEL_STYLES.r0&&e<=a+SEL_STYLES.r0,o=t>=r-SEL_STYLES.r0&&t<=r+SEL_STYLES.r0;if(s&&o){var n=a+FIELD.tileWidth/3.5,l=r+FIELD.tileWidth/6+SEL_STYLES.iconWidth/2;if(Helper.dist(n-e,l-t)<SEL_STYLES.iconWidth/2)return this._under={type:"qubiticon",i0:STATE.grab.i0,j0:STATE.grab.j0,k0:0},!0;var h=3*SEL_STYLES.r0/4,d=h*Math.sin(i.basisRot)+a,u=-h*Math.cos(i.basisRot)+r,c=h*Math.sin(i.basisRot+Math.PI)+a,I=-h*Math.cos(i.basisRot+Math.PI)+r,E=(d-e)**2+(u-t)**2<=(1.5*SEL_STYLES.handleRad)**2;E&&(this.under.k0=0);var f=(c-e)**2+(I-t)**2<=(1.5*SEL_STYLES.handleRad)**2;if(f&&(this.under.k0=1),E||f)return this.under.type="qubitcontrol",!0}}return!1}}class CopyBuffer{constructor(){this._w0=-1,this._h0=-1,this._center={x:-1,y:-1},this._centerType=0,this._corner={xL:-1,xR:-1,yT:-1,yB:-1},this._tiles=[],this._placeable=[],this._paths=[],this._states=[],this._gates=[]}get w0(){return this._w0}get h0(){return this._h0}get tiles(){return this._tiles}get placeable(){return this._placeable}get paths(){return this._paths}get states(){return this._states}get gates(){return this._gates}get corner(){return this._corner}get center(){return this._center}get centerType(){return this._centerType}set w0(e){this._w0=e}set h0(e){this._h0=e}set tiles(e){this._tiles=e}set paths(e){this._paths=e}set placeable(e){this._placeable=e}set states(e){this._states=e}set gates(e){this._gates=e}set corner(e){this._corner=e}set center(e){this._center=e}set centerType(e){this._centerType=e}reset(){this.tiles=[],this.placeable=[],this.states=[],this.gates=[],this.paths=[],this.corner={xL:-1,xR:-1,yT:-1,yB:-1},this.center={x:-1,y:-1},this.w0=-1,this.h0=-1}place(){if(this.placeable.includes(0))return FIELD.message="Invalid Paste Region",TIMER.message=TIMER.messageMax,SFX.invalid.play(),!1;SFX.destroy.play();for(var e=0;e<this.h0;e++)for(var t=0;t<this.w0;t++){var i=e*this.w0+t,a=this.corner.xL+t,r=this.corner.yT+e;1===this.placeable[i]&&IBOARD.clearTile(a,r)}for(e=0;e<this.h0;e++)for(t=0;t<this.w0;t++){i=e*this.w0+t,a=this.corner.xL+t,r=this.corner.yT+e;var s=r*FIELD.cols+a;-1!==this.tiles[i]&&(IBOARD.tiles[s]=this.tiles[i])}for(var o=0;o<this.gates.length;o++)this.gates[o][0]+=this.corner.xL,this.gates[o][1]+=this.corner.yT;return IBOARD.setAllGates(JSON.parse(JSON.stringify(this.gates))),UNDOREDO.add(),!0}trim(){for(var e=1,t=0,i=0;i<this.h0;i++){var a=this.corner.xL+t,r=this.corner.yT+i,s=IBOARD.getTile(a,r);-1!==s&&(e=0)}var o=1;for(t=this.w0-1,i=0;i<this.h0;i++){a=this.corner.xL+t,r=this.corner.yT+i,s=IBOARD.getTile(a,r);-1!==s&&(o=0)}var n=1;for(i=0,t=0;t<this.w0;t++){a=this.corner.xL+t,r=this.corner.yT+i,s=IBOARD.getTile(a,r);-1!==s&&(n=0)}var l=1;for(i=this.h0-1,t=0;t<this.w0;t++){a=this.corner.xL+t,r=this.corner.yT+i,s=IBOARD.getTile(a,r);-1!==s&&(l=0)}var h=e||o||n||l;return!!h&&(this.w0-=e+o,this.h0-=n+l,this.corner.xL<=this.corner.xR&&(this.corner.xL+=e),this.corner.xR>=this.corner.xL&&(this.corner.xR-=o),this.corner.yT<=this.corner.yB&&(this.corner.yT+=n),this.corner.yB>=this.corner.yT&&(this.corner.yB-=l),!0)}checkPlacement(){this.placeable=new Array(this.w0*this.h0).fill(0);for(var e=0;e<this.h0;e++)for(var t=0;t<this.w0;t++){var i=e*this.w0+t,a=this.corner.xL+t>=0&&this.corner.xL+t<FIELD.cols,r=this.corner.yT+e>=0&&this.corner.yT+e<FIELD.rows,s=this.corner.xL+t,o=this.corner.yT+e,n=o*FIELD.cols+s,l=!1;0===t&&(l=l||this.checkEdgeControl(t-1,e,3)),t===this.w0-1&&(l=l||this.checkEdgeControl(t+1,e,1)),0===e&&(l=l||this.checkEdgeControl(t,e-1,0)),e===this.h0-1&&(l=l||this.checkEdgeControl(t,e+1,2)),-1===this.tiles[i]?this.placeable[i]=2:a&&r?1!==SCENARIO.editable[n]?this.placeable[i]=0:this.placeable[i]=l?0:1:this.placeable[i]=0}}checkEdgeControl(e,t,i){var a=this.corner.xL+e,r=this.corner.yT+t,s=this.corner.xL+e>=0&&this.corner.xL+e<FIELD.cols,o=this.corner.yT+t>=0&&this.corner.yT+t<FIELD.rows;if(s&&o){var n=IBOARD.getGate(a,r);if(n&&("switch"===n.type||"qControl"===n.type)&&n.orient===i)return!0}return!1}checkUnder(){if(this.placeable=new Array(this.w0*this.h0).fill(0),1!==this.h0||1!==this.w0)for(var e=0;e<this.h0;e++)for(var t=0;t<this.w0;t++){o=this.corner.xL+t,n=this.corner.yT+e;var i=e*this.w0+t,a=(l=n*FIELD.cols+o,IBOARD.getGate(o,n,IBOARD.getState(o,n))),r=IBOARD.getTile(o,n,IBOARD.getState(o,n)),s=Math.floor(r/20);1!==SCENARIO.editable[l]?this.placeable[i]=0:0===s||1===s||5===s?this.placeable[i]=1:["switch","sync","qControl"].includes(a.type)&&(0===t&&1===a.orient||t===this.w0-1&&3===a.orient||0===e&&2===a.orient||e===this.h0-1&&0===a.orient)?this.placeable[i]=0:this.placeable[i]=1}else{var o=this.corner.xL+t,n=this.corner.yT+e,l=n*FIELD.cols+o;this.placeable[0]=SCENARIO.editable[l]}}preDraw(){for(var e=.5,t=(this.corner.xL+.5)*FIELD.tileWidth,i=(this.corner.yT+.5)*FIELD.tileWidth,a=0;a<this.h0;a++)for(var r=0;r<this.w0;r++){var s=a*this.w0+r;Paths.place(CANV.base.ctx,this.placeable[s]).draw(CANV.base.ctx,t+r*FIELD.tileWidth,i+a*FIELD.tileWidth,FIELD.tileWidth,FIELD.tileHeight,e)}var o=CANV.base.ctx,n=Math.round((this.corner.xL+.5)*FIELD.tileWidth)+.5,l=Math.round((this.corner.yT+.5)*FIELD.tileWidth)+.5;o.save(),o.lineWidth=1*FIELD.tileWidth/48,o.strokeStyle="seagreen",o.beginPath(),o.stroke(Helper.roundRect(n,l,this.w0*FIELD.tileWidth,this.h0*FIELD.tileWidth,FIELD.tileWidth/4)),o.beginPath();var h=[SEL_STYLES.lineDash,SEL_STYLES.lineGap];o.setLineDash(h),o.lineDashOffset=(SEL_STYLES.lineDash+SEL_STYLES.lineGap)*TIMER.dashRatio,o.lineWidth=1*FIELD.tileWidth/48,o.strokeStyle="#555",o.stroke(Helper.roundRect(n,l,this.w0*FIELD.tileWidth,this.h0*FIELD.tileWidth,FIELD.tileWidth/4)),o.restore()}resize(e,t){this.corner.xL=Math.min(STATE.under.i0,STATE.pressed.i0),this.corner.xR=Math.max(STATE.under.i0,STATE.pressed.i0),this.corner.yT=Math.min(STATE.under.j0,STATE.pressed.j0),this.corner.yB=Math.max(STATE.under.j0,STATE.pressed.j0),this.w0=1+this.corner.xR-this.corner.xL,this.h0=1+this.corner.yB-this.corner.yT,this.checkUnder()}copy(){if(this.placeable.includes(0))return FIELD.message="Invalid Copy Region",TIMER.message=TIMER.messageMax,SFX.invalid.play(),!1;for(var e=!0,t=0;t<FIELD.cols&&(e=this.trim(),e);t++);if(this.corner.xL>this.corner.xR||this.corner.yT>this.corner.yB)return FIELD.message="Empty Copy Region",TIMER.message=TIMER.messageMax,SFX.invalid.play(),!1;var i=new Board(CANV.interface.ctx,FIELD.cols,FIELD.rows);i.tiles=[...IBOARD.tiles];for(var a=0;a<this.h0;a++)for(var r=0;r<this.w0;r++){var s=this.corner.xL+r,o=this.corner.yT+a;0===r&&s>0&&i.clearTile(s-1,o),r===this.w0-1&&s<FIELD.cols-1&&i.clearTile(s+1,o),0===a&&o>0&&i.clearTile(s,o-1),a===this.h0-1&&o<FIELD.rows-1&&i.clearTile(s,o+1)}this.gates=[],this.tiles=new Array(this.w0*this.h0).fill(-1),this.states=new Array(this.w0*this.h0).fill(0);for(a=0;a<this.h0;a++)for(r=0;r<this.w0;r++){s=this.corner.xL+r,o=this.corner.yT+a;var n=a*this.w0+r,l=o*FIELD.cols+s,h=IBOARD.getTile(s,o),d=Math.floor(h/20);if(this.states[n]=IBOARD.state[l],-1===h);else if([0,1,5].includes(d))this.tiles[n]=i.getTile(s,o);else{this.tiles[n]=h;var u=!1;if(0===r){var c=IBOARD.getGate(s-1,o);c&&("switch"!==c.type&&"qControl"!==c.type||3!==c.orient||(u=!0))}else if(r===this.w0-1){c=IBOARD.getGate(s+1,o);c&&("switch"!==c.type&&"qControl"!==c.type||1!==c.orient||(u=!0))}else if(0===a){c=IBOARD.getGate(s,o-1);c&&("switch"!==c.type&&"qControl"!==c.type||0!==c.orient||(u=!0))}else if(a===this.h0-1){c=IBOARD.getGate(s,o+1);c&&("switch"!==c.type&&"qControl"!==c.type||2!==c.orient||(u=!0))}var I=IBOARD.getGate(s,o,0);if(I){var E=I.pack();E[0]=r,E[1]=a,this.gates.push(E)}u&&(this.states[n]=0);var f=IBOARD.getGate(s,o,1);if(f&&!u){var S=f.pack();S[0]=r,S[1]=a,this.gates.push(S)}}}if(COPYBUFFER.initPaths(),"boardtile"===STATE.under.type){r=STATE.under.i0,a=STATE.under.j0;r===this.corner.xL?a===this.corner.yT?this.centerType=0:a===this.corner.yB&&(this.centerType=3):r===this.corner.xR&&(a===this.corner.yT?this.centerType=1:a===this.corner.yB&&(this.centerType=2))}if(STATE.isDestroy){for(a=0;a<this.h0;a++)for(r=0;r<this.w0;r++){s=this.corner.xL+r,o=this.corner.yT+a;IBOARD.clearTile(s,o)}UNDOREDO.add()}return!0}recenter(){var e="justify";"justify"===e?(0===this.centerType||3===this.centerType?(this.center.x=IBOARD.findTile(STATE.pos.x,STATE.pos.y).i0,this.corner.xL=this.center.x,this.corner.xR=this.center.x+this.w0-1):1!==this.centerType&&2!==this.centerType||(this.center.x=IBOARD.findTile(STATE.pos.x,STATE.pos.y).i0,this.corner.xL=this.center.x-this.w0+1,this.corner.xR=this.center.x),0===this.centerType||1===this.centerType?(this.center.y=IBOARD.findTile(STATE.pos.x,STATE.pos.y).j0,this.corner.yT=this.center.y,this.corner.yB=this.center.y+this.h0-1):2!==this.centerType&&3!==this.centerType||(this.center.y=IBOARD.findTile(STATE.pos.x,STATE.pos.y).j0,this.corner.yT=this.center.y-this.h0+1,this.corner.yB=this.center.y)):(this.w0%2?(this.center.x=IBOARD.findTile(STATE.pos.x,STATE.pos.y).i0,this.corner.xL=this.center.x-(this.w0-1)/2,this.corner.xR=this.center.x+(this.w0-1)/2):(this.center.x=IBOARD.findTile(STATE.pos.x+FIELD.tileWidth/2,STATE.pos.y).i0,this.corner.xL=this.center.x-this.w0/2,this.corner.xR=this.center.x+this.w0/2-1),this.h0%2?(this.center.y=IBOARD.findTile(STATE.pos.x,STATE.pos.y).j0,this.corner.yT=this.center.y-(this.h0-1)/2,this.corner.yB=this.center.y+(this.h0-1)/2):(this.center.y=IBOARD.findTile(STATE.pos.x,STATE.pos.y+FIELD.tileWidth/2).j0,this.corner.yT=this.center.y-this.h0/2,this.corner.yB=this.center.y+this.h0/2-1))}demo(){this.w0=2,this.h0=2,this.tiles=[50,50,50,50],this.states=[0,0,0,0],this.gates=[[0,0,"cInvert","free",0,1,0,0,-1],[0,1,"cInvert","free",0,1,0,0,-1],[1,0,"cInvert","free",0,1,0,0,-1],[1,1,"cInvert","free",0,1,0,0,-1]],this.corner={xL:1,xR:2,yT:1,yB:2},this.center={x:1,y:1}}initPaths(){var e=CANV.base.ctx;this.paths=new Array(this.w0*this.h0).fill(0);for(var t=0;t<this.w0*this.h0;t++)if(this.tiles[t]>-1&&(this.tiles[t]<40||this.tiles[t]>=100)){var i=Math.floor(this.tiles[t]/20),a=this.tiles[t]%20;0===i?this.paths[t]=PathsX.qWire(e,a,0):1===i?this.paths[t]=PathsX.cWire(e,a,0):5===i&&(this.paths[t]=PathsX.mWire(e,a,0))}for(var r=0;r<this.gates.length;r++){var s=this.gates[r],o=s[0],n=s[1],l=s[2],h=s[4],d=s[5],u=s[6],c=s[7];t=n*this.w0+o;if(u===this.states[t])if("switch"===l)this.paths[t]=PathsG.simpleSwitch(h);else if("qControl"===l)this.paths[t]=PathsG.simpleControl(d,h);else{var I={type:l,orient:h,rot:d,state:c,remaining:-1,counter:c,undercol:["DarkGoldenRod","GoldenRod"],basecol:GRADS.gates,ctx:e};this.paths[t]=PathsG.make(e,I,!0)}}}draw(){for(var e=CANV.base.ctx,t=.5,i=this.corner.xL,a=this.corner.yT,r=0;r<this.h0;r++)for(var s=0;s<this.w0;s++){var o=r*this.w0+s;if(2!==this.placeable[o]){var n=this.corner.xL+s>=0&&this.corner.xL+s<FIELD.cols,l=this.corner.yT+r>=0&&this.corner.yT+r<FIELD.rows;n&&l&&Paths.place(CANV.base.ctx,this.placeable[o]).draw(CANV.base.ctx,(i+s+.5)*FIELD.tileWidth,(a+r+.5)*FIELD.tileWidth,FIELD.tileWidth,FIELD.tileHeight,t)}}var h=PathsG.targetRing(new PathSet("",32,32),["DarkGoldenRod","GoldenRod"]);h.isFancy=!0;for(var d=0;d<this.gates.length;d++){var u=this.gates[d];if("switch"===u[2]||"qControl"===u[2]){var c=i+u[0],I=a+u[1];0===u[4]&&(I+=1),1===u[4]&&(c-=1),2===u[4]&&(I-=1),3===u[4]&&(c+=1);n=c>=0&&c<FIELD.cols,l=I>=0&&I<FIELD.rows;n&&l&&h.draw(e,(c+.5)*FIELD.tileWidth,(I+.5)*FIELD.tileWidth,FIELD.tileWidth,FIELD.tileHeight,t)}}for(r=0;r<this.h0;r++)for(s=0;s<this.w0;s++){o=r*this.w0+s;var E=this.tiles[o],f=Math.floor(E/20);n=this.corner.xL+s>=0&&this.corner.xL+s<FIELD.cols,l=this.corner.yT+r>=0&&this.corner.yT+r<FIELD.rows;n&&l&&-1!==E&&this.paths[o]&&(0===f||1===f||5===f?RenderLoops.drawWireSingle(e,this.paths[o],(i+s+.5)*FIELD.tileWidth,(a+r+.5)*FIELD.tileWidth,FIELD.tileWidth,FIELD.tileWidth,32,32,t):this.paths[o].draw(e,(i+s+.5)*FIELD.tileWidth,(a+r+.5)*FIELD.tileWidth,FIELD.tileWidth,FIELD.tileHeight,t))}}}class CtrlMenu{constructor(e,t,i,a,r,s){this._label=e,this._x0=t,this._y0=i,this._tileMargin=a,this._numWidth=r,this._numHeight=s,this._hovered=-1,this._selected=-1,this._selRot=0,this._selState=0,this._buttons=[],this._closure=0}get closure(){return this._closure}get label(){return this._label}get x0(){return this._x0}get y0(){return this._y0}get w0(){return(FIELD.tileWidth+this.tileMargin)*this.numWidth}get h0(){return(FIELD.tileHeight+this.tileMargin)*this.numHeight}get tileMargin(){return this._tileMargin}get numWidth(){return this._numWidth}get numHeight(){return this._numHeight}get hovered(){return this._hovered}get selected(){return this._selected}get buttons(){return this._buttons}get selRot(){return this._selRot}get selState(){return this._selState}set closure(e){this._closure=e}set x0(e){this._x0=e}set y0(e){this._y0=e}set tileMargin(e){this._tileMargin=e}set numWidth(e){this._numWidth=e}set numHeight(e){this._numHeight=e}set hovered(e){this._hovered=e}set selected(e){this._selRot=0,this._selected=e}set buttons(e){this._buttons=e}set selRot(e){this._selRot=e}set selState(e){this._selState=e}addButton(e){this.buttons.push(e)}gridPos(e,t){var i=this.x0+e*FIELD.tileWidth+(e+.5)*this.tileMargin,a=this.y0+t*FIELD.tileWidth+(t+.5)*this.tileMargin;return{x0:i,y0:a}}setSelected(e,t){var i=this.buttons.length;this.selected=-1;for(var a=0;a<i;a++)this.buttons[a].i0===e&&this.buttons[a].j0===t?(this.selected=a,this.selState=this.buttons[a].menuState,this.buttons[a].selected=!0):this.buttons[a].selected=!1}checkTransition(){for(var e=this.buttons.length,t=0;t<e;t++)if(!0===this.buttons[t].transition.status||this.buttons[t].animating)return!0;return!1}getButton(e,t){for(var i=this.buttons.length,a=0;a<i;a++)if(this.buttons[a].i0===e&&this.buttons[a].j0===t)return this.buttons[a];return-1}getNamedButton(e){for(var t=this.buttons.length,i=0;i<t;i++)if(this.buttons[i].tileType===e)return this.buttons[i];return-1}setHovered(e,t){var i=this.buttons.length;this.hovered=-1;for(var a=0;a<i;a++)this.buttons[a].i0===e&&this.buttons[a].j0===t?(this.hovered=a,this.buttons[a].hovered=!0):this.buttons[a].hovered=!1}removeHovered(){var e=this.buttons.length;this.hovered=-1;for(var t=0;t<e;t++)this.buttons[t].hovered=!1}findTile(e,t){var i=Math.floor((e-this.x0)/(FIELD.tileWidth+this.tileMargin)),a=Math.floor((t-this.y0)/(FIELD.tileHeight+this.tileMargin));return{i0:i,j0:a}}drawControl(e,t=0,i=0){for(var a=e.ctx,r=0;r<this.buttons.length;r++){var s=this.buttons[r],o=this.gridPos(s.i0,s.j0),n=s.getPath(a);n.draw(a,o.x0+t,o.y0+i,FIELD.tileWidth,FIELD.tileHeight)}}reset(e){var t=this.getNamedButton("ctrlStart"),i=this.getNamedButton("ctrlPlay"),a=this.getNamedButton("ctrlStep"),r=this.getNamedButton("ctrlBack"),s=this.getNamedButton("ctrlNorm");"finished"===STATE.mode||"finished"===ROBOT.oldMode?(t.tileProperties={flash:0,type:1,depth:0,closure:0,hovered:!1},i.tileProperties={flash:0,type:1,depth:0,closure:1,hovered:!1},a.tileProperties={flash:0,type:0,depth:0,closure:1,hovered:!1},r.tileProperties={flash:0,type:1,depth:0,closure:0,hovered:!1},s.tileProperties={flash:0,type:0,depth:0,closure:1,hovered:!1}):"running"===STATE.mode?(t.tileProperties={flash:0,type:1,depth:0,closure:0,hovered:!1},i.tileProperties={flash:0,type:0,depth:0,closure:0,hovered:!1},a.tileProperties={flash:0,type:0,depth:0,closure:0,hovered:!1},r.tileProperties={flash:0,type:0,depth:0,closure:0,hovered:!1},s.tileProperties={flash:0,type:0,depth:0,closure:0,hovered:!1}):"paused"===STATE.mode?(t.tileProperties={flash:0,type:1,depth:0,closure:0,hovered:!1},i.tileProperties={flash:0,type:1,depth:0,closure:0,hovered:!1},a.tileProperties={flash:0,type:1,depth:0,closure:0,hovered:!1},r.tileProperties={flash:0,type:1,depth:0,closure:0,hovered:!1},s.tileProperties={flash:0,type:1,depth:0,closure:0,hovered:!1}):(t.tileProperties={flash:0,type:0,depth:0,closure:0,hovered:!1},i.tileProperties={flash:0,type:0,depth:0,closure:1,hovered:!1},a.tileProperties={flash:0,type:0,depth:0,closure:1,hovered:!1},r.tileProperties={flash:0,type:0,depth:0,closure:1,hovered:!1},s.tileProperties={flash:0,type:0,depth:0,closure:1,hovered:!1}),t.transition={status:!1,start:-1,stop:-1},i.transition={status:!1,start:-1,stop:-1},a.transition={status:!1,start:-1,stop:-1},r.transition={status:!1,start:-1,stop:-1},s.transition={status:!1,start:-1,stop:-1},e.clear(),CTRLMENU.drawControl(e)}static initialize(){var e=new CtrlMenu(0,0,0,0,5,1);return e.addButton(new ControlButton(0,0,0,"ctrlStart",{flash:0,type:0,depth:0,closure:0,hovered:!1},"",0)),e.addButton(new ControlButton(0,2,0,"ctrlPlay",{flash:0,type:0,depth:0,closure:1,hovered:!1},"",0)),e.addButton(new ControlButton(0,3,0,"ctrlStep",{flash:0,type:0,depth:0,closure:1,hovered:!1},"",0)),e.addButton(new ControlButton(0,1,0,"ctrlBack",{flash:0,type:0,depth:0,closure:1,hovered:!1},"",0)),e.addButton(new ControlButton(0,4,0,"ctrlNorm",{flash:0,type:0,depth:0,closure:1,hovered:!1},"",0)),e}}class ControlButton{constructor(e,t,i,a,r,s,o=0){this._label=e,this._i0=t,this._j0=i,this._hovered=!1,this._selected=!1,this._tileType=a,this._tileProperties=r,this._tooltip=s,this._menuState=o,this._animating=!1,this._opening=0,this._transition={status:!1,start:-1,stop:-1},this._startTime=0,this._openTime=0,this._maxTime=400}get label(){return this._label}get i0(){return this._i0}get j0(){return this._j0}get hovered(){return this._hovered}get selected(){return this._selected}get tileType(){return this._tileType}get tileProperties(){return this._tileProperties}get tooltip(){return this._tooltip}get menuState(){return this._menuState}get animating(){return this._animating}get transition(){return this._transition}set label(e){this._label=e}set i0(e){this._i0=e}set j0(e){this._j0=e}set hovered(e){this._hovered=e,this._tileProperties.hovered=e}set selected(e){this._selected=e}set tileType(e){this._tileType=e}set tileProperties(e){this._tileProperties=e}set tooltip(e){this._tooltip=e}set menuState(e){this._menuState=e}set animating(e){this._animating=e}set transition(e){this._transition=e}startAnimation(){this._animating=!0,this._startTime=TIMER.totalTime}open(){this._openTime=TIMER.totalTime,this._opening=1}close(){this._openTime=TIMER.totalTime,this._opening=-1}getPath(e){if(this._opening)if(Math.abs(TIMER.totalTime-this._openTime)>=this._maxTime)-1===this._opening?this._tileProperties.closure=1:this._tileProperties.closure=0,this._opening=0;else{var t=(TIMER.totalTime-this._openTime)/this._maxTime,i=(1-Math.cos(Math.PI*t))/2;-1===this._opening?this._tileProperties.closure=i:this._tileProperties.closure=1-i}if(this._animating)if(Math.abs(TIMER.totalTime-this._startTime)>=this._maxTime)this._animating=!1,this._tileProperties.depth=0;else{var a=(TIMER.totalTime-this._startTime)/this._maxTime,r=(1-Math.cos(2*Math.PI*a))/2;this._tileProperties.depth=r}if(!0===this._transition.status)if(Math.abs(TIMER.totalTime-this._startTime)>=this._maxTime)this._tileProperties.type=this._transition.stop,this._transition={status:!1,start:-1,stop:-1};else{var s=(TIMER.totalTime-this._startTime)/this._maxTime,o=(1-Math.cos(2*Math.PI*s))/2;this._tileProperties.flash=o,this._tileProperties.type=s<=.5?this._transition.start:this._transition.stop}return PathsC.ctrl(e,this.tileType,this.tileProperties)}gridPos(e,t){var i=this.x0+e*this.tileWidth+(e+1)*this.tileMargin,a=this.y0+t*this.tileWidth+(t+1)*this.tileMargin;return{x0:i,y0:a}}}const DESCRIPTIONS={monologue:[],plaque0:"",plaque1:[]};DESCRIPTIONS.plaque1.push("Tutorial"),DESCRIPTIONS.plaque1.push("• Standard onboarding tasks for new employees."),DESCRIPTIONS.plaque1.push("• Instructs on basic factory protocols and user-control mechanisms."),DESCRIPTIONS.plaque2=[],DESCRIPTIONS.plaque2.push("Classic I"),DESCRIPTIONS.plaque2.push("• Introductory tasks for classical computation and the manipulation of bits."),DESCRIPTIONS.plaque2.push("• Designed to familiarize new employees with classical gate functionality."),DESCRIPTIONS.plaque2U=[],DESCRIPTIONS.plaque2U.push("Unlock:"),DESCRIPTIONS.plaque2U.push("Complete `Tutorial` tasks"),DESCRIPTIONS.plaque3=[],DESCRIPTIONS.plaque3.push("Classic II"),DESCRIPTIONS.plaque3.push("• More sophisticated challenges in classical computation."),DESCRIPTIONS.plaque3.push("• Successful completion of tasks indicates an acceptable understanding of circuits and bit logic."),DESCRIPTIONS.plaque3U=[],DESCRIPTIONS.plaque3U.push("Unlock:"),DESCRIPTIONS.plaque3U.push("Complete 5 of `Classic I`"),DESCRIPTIONS.plaque4=[],DESCRIPTIONS.plaque4.push("Classic III"),DESCRIPTIONS.plaque4.push("• Advanced challenges in classical computation."),DESCRIPTIONS.plaque4.push("• Successful completion of tasks will require creative usage of classical gates and mastery of their function."),DESCRIPTIONS.plaque4U=[],DESCRIPTIONS.plaque4U.push("Unlock:"),DESCRIPTIONS.plaque4U.push("Complete 4 of `Classic II`"),DESCRIPTIONS.plaque5=[],DESCRIPTIONS.plaque5.push("Quantum I"),DESCRIPTIONS.plaque5.push("• Introductory tasks for quantum computation and the manipulation of qubits."),DESCRIPTIONS.plaque5.push("• Designed to familiarize new employees with quantum gate functionality."),DESCRIPTIONS.plaque5U=[],DESCRIPTIONS.plaque5U.push("Unlock:"),DESCRIPTIONS.plaque5U.push("Complete 5 of `Classic I`"),DESCRIPTIONS.plaque6=[],DESCRIPTIONS.plaque6.push("Quantum II"),DESCRIPTIONS.plaque6.push("• More sophisticated challenges in quantum computation."),DESCRIPTIONS.plaque6.push("• Employees are introduced to unitary circuits, quantum entanglement and measurement probabilities."),DESCRIPTIONS.plaque6U=[],DESCRIPTIONS.plaque6U.push("Unlock:"),DESCRIPTIONS.plaque6U.push("Complete 6 of `Quantum I`"),DESCRIPTIONS.plaque7=[],DESCRIPTIONS.plaque7.push("Quantum III"),DESCRIPTIONS.plaque7.push("• Advanced challenges in quantum computation."),DESCRIPTIONS.plaque7.push("• Successful completion of tasks will require creative usage of quantum gates and mastery of their function."),DESCRIPTIONS.plaque7U=[],DESCRIPTIONS.plaque7U.push("Unlock:"),DESCRIPTIONS.plaque7U.push("Complete 5 of `Quantum II`"),DESCRIPTIONS.plaque8=[],DESCRIPTIONS.plaque9=[],DESCRIPTIONS.plaque9.push("Hybrid"),DESCRIPTIONS.plaque9.push("• The ultimate challenges."),DESCRIPTIONS.plaque9.push("• Solutions require mastery of both classical and quantum gates, as well as superior command over quantum entanglement."),DESCRIPTIONS.plaque9U=[],DESCRIPTIONS.plaque9U.push("Unlock:"),DESCRIPTIONS.plaque9U.push("Complete 4 of `Classic III`"),DESCRIPTIONS.plaque9U.push("Complete 4 of `Quantum III`"),DESCRIPTIONS.award0=[],DESCRIPTIONS.award0.push("Award"),DESCRIPTIONS.award0.push("• Complete all `classic` computation levels."),DESCRIPTIONS.award1=[],DESCRIPTIONS.award1.push("Award"),DESCRIPTIONS.award1.push("• Bonus star in all `classic` computation levels."),DESCRIPTIONS.award2=[],DESCRIPTIONS.award2.push("Award"),DESCRIPTIONS.award2.push("• Complete all `quantum` computation levels."),DESCRIPTIONS.award3=[],DESCRIPTIONS.award3.push("Award"),DESCRIPTIONS.award3.push("• Bonus star in all `quantum` computation levels."),DESCRIPTIONS.award4=[],DESCRIPTIONS.award4.push("Award"),DESCRIPTIONS.award4.push("• Complete all `hybrid` computation levels."),DESCRIPTIONS.award5=[],DESCRIPTIONS.award5.push("Award"),DESCRIPTIONS.award5.push("• Bonus star in all `hybrid` computation levels."),DESCRIPTIONS.award6=[],DESCRIPTIONS.award6.push("Award"),DESCRIPTIONS.award6.push("• Complete all of the bonus levels."),DESCRIPTIONS.award7=[],DESCRIPTIONS.award7.push("Award"),DESCRIPTIONS.award7.push("• Bonus star in all of the bonus levels."),DESCRIPTIONS.allTitles=[["Boolean","Logistician"],["Boolean","Master"],["Quantum","Adept"],["Quantum","Artificer"],["Entanglement","Maestro"],["Entanglement","Savant"],["Adeptus","Mechanicus"],["The","Omnissiah"]],DESCRIPTIONS.tut1=[],DESCRIPTIONS.tut1.push("Wired"),DESCRIPTIONS.tut1.push("Skill assessment:"),DESCRIPTIONS.tut1.push("• Placement of blue (bit) and red (qubit) wires."),DESCRIPTIONS.tut2=[],DESCRIPTIONS.tut2.push("Gate Keeping"),DESCRIPTIONS.tut2.push("Skill assessment:"),DESCRIPTIONS.tut2.push("• Usage of gates to transform bits and qubits."),DESCRIPTIONS.tut3=[],DESCRIPTIONS.tut3.push("The Manipulator"),DESCRIPTIONS.tut3.push("Skill assessment:"),DESCRIPTIONS.tut3.push("• Ability to set gate properties."),DESCRIPTIONS.tut4=[],
DESCRIPTIONS.tut4.push("CTRL-Z"),DESCRIPTIONS.tut4.push("Skill assessment:"),DESCRIPTIONS.tut4.push("• Gate orientation and placement."),DESCRIPTIONS.tut5=[],DESCRIPTIONS.tut5.push("Wasted Potential"),DESCRIPTIONS.tut5.push("Skill assessment:"),DESCRIPTIONS.tut5.push("• Deletion of wires and gates."),DESCRIPTIONS.tut6=[],DESCRIPTIONS.tut6.push("Making Amends"),DESCRIPTIONS.tut6.push("Skill assessment:"),DESCRIPTIONS.tut6.push("• Usage of blueprints to store/retrieve different designs."),DESCRIPTIONS.tut6.push("• Usage of copy/cut functionality."),DESCRIPTIONS.class1=[],DESCRIPTIONS.class1.push("Straight Shooter"),DESCRIPTIONS.class1.push("Skill assessment:"),DESCRIPTIONS.class1.push("• Usage of the `re-zero` and `inversion` bit gates."),DESCRIPTIONS.class2=[],DESCRIPTIONS.class2.push("Zippidty-split"),DESCRIPTIONS.class2.push("Skill assessment:"),DESCRIPTIONS.class2.push("• Usage of the `combine` and `split` bit gates."),DESCRIPTIONS.class3=[],DESCRIPTIONS.class3.push("The ol'Switch-a-roo"),DESCRIPTIONS.class3.push("Skill assessment:"),DESCRIPTIONS.class3.push("• Usage of the classical `control` gate."),DESCRIPTIONS.class4=[],DESCRIPTIONS.class4.push("nSync"),DESCRIPTIONS.class4.push("Skill assessment:"),DESCRIPTIONS.class4.push("• Usage of the `sync` gate."),DESCRIPTIONS.class5=[],DESCRIPTIONS.class5.push("The Waiting Game"),DESCRIPTIONS.class5.push("Skill assessment:"),DESCRIPTIONS.class5.push("• Usage of the `delay` gate."),DESCRIPTIONS.class6=[],DESCRIPTIONS.class6.push("Genesis"),DESCRIPTIONS.class6.push("Skill assessment:"),DESCRIPTIONS.class6.push("• Basic usage of the `bit creation` gate."),DESCRIPTIONS.class7=[],DESCRIPTIONS.class7.push("The Count"),DESCRIPTIONS.class7.push("Skill assessment:"),DESCRIPTIONS.class7.push("• Usage of the `bit creation` gate to build a counter."),DESCRIPTIONS.classPuzzle1=[],DESCRIPTIONS.classPuzzle1.push("Bandwidth"),DESCRIPTIONS.classPuzzle1.push("Skill assessment:"),DESCRIPTIONS.classPuzzle1.push("• Combining and separating bit streams."),DESCRIPTIONS.classPuzzle2=[],DESCRIPTIONS.classPuzzle2.push("Half Adder"),DESCRIPTIONS.classPuzzle2.push("Skill assessment:"),DESCRIPTIONS.classPuzzle2.push("• Introductory bit logic."),DESCRIPTIONS.classPuzzle4=[],DESCRIPTIONS.classPuzzle4.push("Memory"),DESCRIPTIONS.classPuzzle4.push("Skill assessment:"),DESCRIPTIONS.classPuzzle4.push("• Storage and retrieval of bit values."),DESCRIPTIONS.classPuzzle5=[],DESCRIPTIONS.classPuzzle5.push("Ternary"),DESCRIPTIONS.classPuzzle5.push("Skill assessment:"),DESCRIPTIONS.classPuzzle5.push("• Generation of custom bit sequences."),DESCRIPTIONS.classPuzzle6=[],DESCRIPTIONS.classPuzzle6.push("Repetition"),DESCRIPTIONS.classPuzzle6.push("Skill assessment:"),DESCRIPTIONS.classPuzzle6.push("• Classical error correction."),DESCRIPTIONS.classPuzzle7=[],DESCRIPTIONS.classPuzzle7.push("Swap Meet"),DESCRIPTIONS.classPuzzle7.push("Skill assessment:"),DESCRIPTIONS.classPuzzle7.push("• Creative usage of classical control gates."),DESCRIPTIONS.classPuzzle8=[],DESCRIPTIONS.classPuzzle8.push("Strict Equality"),DESCRIPTIONS.classPuzzle8.push("Skill assessment:"),DESCRIPTIONS.classPuzzle8.push("• Advanced classical circuit design and bit logic."),DESCRIPTIONS.classPuzzle3=[],DESCRIPTIONS.classPuzzle3.push("AND Frugality"),DESCRIPTIONS.classPuzzle3.push("Skill assessment:"),DESCRIPTIONS.classPuzzle3.push("• Advanced classical circuit design and bit logic."),DESCRIPTIONS.classPuzzle3B=[],DESCRIPTIONS.classPuzzle3B.push("XOR Frugality"),DESCRIPTIONS.classPuzzle3B.push("Skill assessment:"),DESCRIPTIONS.classPuzzle3B.push("• Advanced classical circuit design and bit logic."),DESCRIPTIONS.classPuzzle9=[],DESCRIPTIONS.classPuzzle9.push("Haystack"),DESCRIPTIONS.classPuzzle9.push("Skill assessment:"),DESCRIPTIONS.classPuzzle9.push("• Usage of classical memories."),DESCRIPTIONS.classPuzzle9.push("• Advanced classical circuit design and bit logic."),DESCRIPTIONS.vaziraniClassic=[],DESCRIPTIONS.vaziraniClassic.push("Quality Control"),DESCRIPTIONS.vaziraniClassic.push("Skill assessment:"),DESCRIPTIONS.vaziraniClassic.push("• Device testing protocols."),DESCRIPTIONS.binaryencode=[],DESCRIPTIONS.binaryencode.push("Unary <<< Binary"),DESCRIPTIONS.binaryencode.push("Skill assessment:"),DESCRIPTIONS.binaryencode.push("• Advanced classical circuit design and bit logic."),DESCRIPTIONS.binaryencode.push("• Understanding of binary encoding."),DESCRIPTIONS.adder=[],DESCRIPTIONS.adder.push("Calculon"),DESCRIPTIONS.adder.push("Skill assessment:"),DESCRIPTIONS.adder.push("• Advanced classical circuit design and bit logic."),DESCRIPTIONS.adder.push("• Understanding of binary addition."),DESCRIPTIONS.quant1=[],DESCRIPTIONS.quant1.push("Inversion"),DESCRIPTIONS.quant1.push("Skill assessment:"),DESCRIPTIONS.quant1.push("• Usage of `rotation` and `flip` qubit gates."),DESCRIPTIONS.quant1.push("• Understanding of reversibility in quantum circuits."),DESCRIPTIONS.quant2=[],DESCRIPTIONS.quant2.push("Wires Crossed"),DESCRIPTIONS.quant2.push("Skill assessment:"),DESCRIPTIONS.quant2.push("• Usage of `measure` and `bit-to-qubit` gates."),DESCRIPTIONS.quant2.push("• Ability to interchange between bits and qubits."),DESCRIPTIONS.quant3A=[],DESCRIPTIONS.quant3A.push("Dice Roll"),DESCRIPTIONS.quant3A.push("Skill assessment:"),DESCRIPTIONS.quant3A.push("• Understanding of qubit measurement outcome probabilities."),DESCRIPTIONS.quant3=[],DESCRIPTIONS.quant3.push("Lossy"),DESCRIPTIONS.quant3.push("Skill assessment:"),DESCRIPTIONS.quant3.push("• Optimal determination of unknown qubit states."),DESCRIPTIONS.quant4=[],DESCRIPTIONS.quant4.push("Straight Shooter II"),DESCRIPTIONS.quant4.push("Skill assessment:"),DESCRIPTIONS.quant4.push("• Usage of `measure` gates to transform qubit states."),DESCRIPTIONS.quant5=[],DESCRIPTIONS.quant5.push("Quantum Control"),DESCRIPTIONS.quant5.push("Skill assessment:"),DESCRIPTIONS.quant5.push("• Usage of quantum `control` gates in conjunction with qubit rotations."),DESCRIPTIONS.quant6=[],DESCRIPTIONS.quant6.push("Quantum Control II"),DESCRIPTIONS.quant6.push("Skill assessment:"),DESCRIPTIONS.quant6.push("• Usage of quantum `control` gates in conjunction with qubit flips."),DESCRIPTIONS.quant6B=[],DESCRIPTIONS.quant6B.push("Superposition"),DESCRIPTIONS.quant6B.push("Skill assessment:"),DESCRIPTIONS.quant6B.push("• Understanding of qubit basis states and super- positions."),DESCRIPTIONS.quant7=[],DESCRIPTIONS.quant7.push("Measure x1, Cut x2"),DESCRIPTIONS.quant7.push("Skill assessment:"),DESCRIPTIONS.quant7.push("• Basic understanding of measurement outcomes with entangled states."),DESCRIPTIONS.measure=[],DESCRIPTIONS.measure.push("Discernment"),DESCRIPTIONS.measure.push("Skill assessment:"),DESCRIPTIONS.measure.push("• Applied understanding of measure outcome probs."),DESCRIPTIONS.measure.push("• Introductory quantum state tomography."),DESCRIPTIONS.adderB=[],DESCRIPTIONS.adderB.push("Drive-by XOR"),DESCRIPTIONS.adderB.push("Skill assessment:"),DESCRIPTIONS.adderB.push("• Usage of quantum control gates to implement qubit logic."),DESCRIPTIONS.adderC=[],DESCRIPTIONS.adderC.push("Drive-by AND"),DESCRIPTIONS.adderC.push("Skill assessment:"),DESCRIPTIONS.adderC.push("• Usage of quantum control gates to implement qubit logic."),DESCRIPTIONS.entChallengeA=[],DESCRIPTIONS.entChallengeA.push("Lock and Key"),DESCRIPTIONS.entChallengeA.push("Skill assessment:"),DESCRIPTIONS.entChallengeA.push("• Applied understanding of correlation in measurements of entangled qubits."),DESCRIPTIONS.quantChallengeB=[],DESCRIPTIONS.quantChallengeB.push("Analysis"),DESCRIPTIONS.quantChallengeB.push("Skill assessment:"),DESCRIPTIONS.quantChallengeB.push("• Understanding of unitary transformations on entangled states."),DESCRIPTIONS.quantChallengeB.push("• Usage of the state analyzer tool."),DESCRIPTIONS.quantChallengeC=[],DESCRIPTIONS.quantChallengeC.push("Magic Mirror"),DESCRIPTIONS.quantChallengeC.push("Skill assessment:"),DESCRIPTIONS.quantChallengeC.push("• Applied understanding of reversibility in quantum circuits."),DESCRIPTIONS.quantChallengeD=[],DESCRIPTIONS.quantChallengeD.push("Even Odds"),DESCRIPTIONS.quantChallengeD.push("Skill assessment:"),DESCRIPTIONS.quantChallengeD.push("• Applied understanding of correlation in measurements of entangled qubits."),DESCRIPTIONS.quantChallengeA=[],DESCRIPTIONS.quantChallengeA.push("Try, Try, Try Again"),DESCRIPTIONS.quantChallengeA.push("Skill assessment:"),DESCRIPTIONS.quantChallengeA.push("• Creative usage of measurement gates."),DESCRIPTIONS.quantChallengeE=[],DESCRIPTIONS.quantChallengeE.push("Swap Meet II"),DESCRIPTIONS.quantChallengeE.push("Skill assessment:"),DESCRIPTIONS.quantChallengeE.push("• Creative usage of quantum control gates."),DESCRIPTIONS.quantChallengeF=[],DESCRIPTIONS.quantChallengeF.push("Relay"),DESCRIPTIONS.quantChallengeF.push("Skill assessment:"),DESCRIPTIONS.quantChallengeF.push("• Introductory entanglement swapping."),DESCRIPTIONS.simpleDistill=[],DESCRIPTIONS.simpleDistill.push("Distillary"),DESCRIPTIONS.simpleDistill.push("Skill assessment:"),DESCRIPTIONS.simpleDistill.push("• Introductory entanglement distillation."),DESCRIPTIONS.measureB=[],DESCRIPTIONS.measureB.push("Cascade"),DESCRIPTIONS.measureB.push("Skill assessment:"),DESCRIPTIONS.measureB.push("• Sequential measurements and state tomography."),DESCRIPTIONS.chsh=[],DESCRIPTIONS.chsh.push("Jolly Cooperation"),DESCRIPTIONS.chsh.push("Skill assessment:"),DESCRIPTIONS.chsh.push("• Quantum entanglement and correlation."),DESCRIPTIONS.chsh.push("• Quantum game theory."),DESCRIPTIONS.quantumAdv3=[],DESCRIPTIONS.quantumAdv3.push("Statistics"),DESCRIPTIONS.quantumAdv3.push("Skill assessment:"),DESCRIPTIONS.quantumAdv3.push("• Measurement probabilities and tomography of entangled states."),DESCRIPTIONS.preDenseB=[],DESCRIPTIONS.preDenseB.push("Superdense?"),DESCRIPTIONS.preDenseB.push("Skill assessment:"),DESCRIPTIONS.preDenseB.push("• Encoding/decoding classical data to/from qubits."),DESCRIPTIONS.teleport=[],DESCRIPTIONS.teleport.push("Beam me up"),DESCRIPTIONS.teleport.push("Skill assessment:"),DESCRIPTIONS.teleport.push("• Utilization of entanglement as a resource in a quantum protocol."),DESCRIPTIONS.quantErrorA=[],DESCRIPTIONS.quantErrorA.push("Correction"),DESCRIPTIONS.quantErrorA.push("Skill assessment:"),DESCRIPTIONS.quantErrorA.push("• Introductory quantum error correction."),DESCRIPTIONS.quantChallengeG=[],DESCRIPTIONS.quantChallengeG.push("Back-to-front"),DESCRIPTIONS.quantChallengeG.push("Skill assessment:"),DESCRIPTIONS.quantChallengeG.push("• Advanced usage of quantum control gates."),DESCRIPTIONS.quantumAdv1=[],DESCRIPTIONS.quantumAdv1.push("Correlation"),DESCRIPTIONS.quantumAdv1.push("Skill assessment:"),DESCRIPTIONS.quantumAdv1.push("• Advanced tomography of entangled quantum states."),DESCRIPTIONS.entChallengeB=[],DESCRIPTIONS.entChallengeB.push("GHZ"),DESCRIPTIONS.entChallengeB.push("Skill assessment:"),DESCRIPTIONS.entChallengeB.push("• Manipulation and evaluation of multi-qubit entangled states."),DESCRIPTIONS.dense=[],DESCRIPTIONS.dense.push("Super-dense!"),DESCRIPTIONS.dense.push("Skill assessment:"),DESCRIPTIONS.dense.push("• Utilization of entanglement as a resource in a quantum protocol."),DESCRIPTIONS.distill=[],DESCRIPTIONS.distill.push("Beam me up II"),DESCRIPTIONS.distill.push("Skill assessment:"),DESCRIPTIONS.distill.push("• Practical application of entanglement distillation as part of a quantum protocol."),DESCRIPTIONS.quantErrorB=[],DESCRIPTIONS.quantErrorB.push("Correction II"),DESCRIPTIONS.quantErrorB.push("Skill assessment:"),DESCRIPTIONS.quantErrorB.push("• More sophisticated quantum error correction."),DESCRIPTIONS.vaziraniQuantum=[],DESCRIPTIONS.vaziraniQuantum.push("Quality Control II"),DESCRIPTIONS.vaziraniQuantum.push("Skill assessment:"),DESCRIPTIONS.vaziraniQuantum.push("• Creative use of quantum components in order to achieve a computational advantage."),DESCRIPTIONS.quantumAdv2=[],DESCRIPTIONS.quantumAdv2.push("Correlation II"),DESCRIPTIONS.quantumAdv2.push("Skill assessment:"),DESCRIPTIONS.quantumAdv2.push("• Advanced tomography of entangled quantum states."),DESCRIPTIONS.entChallengeC=[],DESCRIPTIONS.entChallengeC.push("GHZ II"),DESCRIPTIONS.entChallengeC.push("Skill assessment:"),DESCRIPTIONS.entChallengeC.push("• Advanced tomography of multi-qubit entangled states."),DESCRIPTIONS.extraA=[],DESCRIPTIONS.extraA.push("Bonus Level"),DESCRIPTIONS.extraA.push("???"),DESCRIPTIONS.extraB=[],DESCRIPTIONS.extraB.push("Bonus Level"),DESCRIPTIONS.extraB.push("???"),DESCRIPTIONS.extraC=[],DESCRIPTIONS.extraC.push("Bonus Level"),DESCRIPTIONS.extraC.push("???"),DESCRIPTIONS.extraD=[],DESCRIPTIONS.extraD.push("Bonus Level"),DESCRIPTIONS.extraD.push("???"),DESCRIPTIONS.freeA=[],DESCRIPTIONS.freeA.push("Template A"),DESCRIPTIONS.freeA.push("Blank template used for level design"),DESCRIPTIONS.freeB=[],DESCRIPTIONS.freeB.push("Template B"),DESCRIPTIONS.freeB.push("Blank template used for level design. Includes entanglers"),DESCRIPTIONS.freeC=[],DESCRIPTIONS.freeC.push("Free-form"),DESCRIPTIONS.freeC.push("Empty factory for testing and experimentation.");class EntBlob{constructor(){this._entWeights=[],this._numSeg=50,this._amp=.05,this._colors=["rebeccapurple","darkcyan","firebrick","darkgreen","darkgoldenrod","dodgerblue","fuchsia","saddlebrown"],this._radius=1,this._numBlobs=10}get numBlobs(){return this._numBlobs}makeBlobs(){for(var e=[],t=0;t<this._numBlobs;t++){for(var i=[],a=0;a<5;a++)i.push(2*(Math.random()-.5));var r=[];for(a=0;a<this._numSeg;a++){var s=2*a*Math.PI/this._numSeg,o=i[0]*Math.cos(1*s+1)+i[1]*Math.cos(2*s+2)+i[2]*Math.cos(3*s+3)+i[3]*Math.cos(4*s+4)+i[4]*Math.cos(5*s+5);r.push(this._radius*(1+this._amp*o))}e.push(r)}this._entWeights=e}getWeights(e){return this._entWeights[e]}draw(e,t,i,a,r,s,o=1){if(!(o<.001)){e.save(),e.beginPath(),e.translate(a+FIELD.tileWidth/2,r+FIELD.tileHeight/2),e.scale(1+.1*s*Math.cos(2*Math.PI*TIMER.blinkRatio),1-.1*s*Math.cos(1+2.1*Math.PI*TIMER.blinkRatio)),e.rotate(2*s*TIMER.blob*Math.PI),e.globalAlpha=.2,e.lineWidth=1*o*2*FIELD.tileWidth/4,e.lineCap="round",e.strokeStyle=this._colors[i];var n=FIELD.tileWidth/3,l=this._entWeights[t];e.moveTo(n*l[0],0);for(var h=0;h<this._numSeg;h++){var d=2*Math.PI*h/this._numSeg;e.lineTo(n*l[h]*Math.cos(d),n*l[h]*Math.sin(d))}e.lineTo(n*l[0],0),e.stroke(),e.restore()}}}class Entangled{constructor(e,t=-1){this._numQubits=e,this._ampsComp=new Array(2**e).fill(0),this._ampsRot=new Array(2**e).fill(0),this._ampsFinal=new Array(2**e).fill(0),this._qubitList=new Array(e).fill(0),this._qubitID=new Array(e).fill(-1),this._offsets=new Array(2**e).fill(0),this._enums=Entangled.findEnums(e),this._allOrders=Entangled.findAllOrders(e),this._ents=new Array(e).fill(0),t<0?(this._id=GLOBAL_IDE,GLOBAL_IDE+=1):this._id=t}get numQubits(){return this._numQubits}get ampsComp(){return this._ampsComp}get ampsRot(){return this._ampsRot}get ampsFinal(){return this._ampsFinal}get qubitList(){return this._qubitList}get qubitID(){return this._qubitID}get offsets(){return this._offsets}get enums(){return this._enums}get allOrders(){return this._allOrders}get id(){return this._id}get ents(){return this._ents}set numQubits(e){this._numQubits=e}set ampsComp(e){this._ampsComp=e}set ampsRot(e){this._ampsRot=e}set ampsFinal(e){this._ampsFinal=e}set qubitList(e){this._qubitList=e}set qubitID(e){this._qubitID=e}set offsets(e){this._offsets=e}set enums(e){this._enums=e}set allOrders(e){this._allOrders=e}set id(e){this._id=e}set ents(e){this._ents=e}copy(){var e=new Entangled(this.numQubits,this.id);return e.ampsComp=[...this.ampsComp],e.ampsRot=[...this.ampsRot],e.ampsFinal=[...this.ampsFinal],e.offsets=[...this.offsets],e.enums=[...this.enums],e.qubitID=[...this.qubitID],e.allOrders=Entangled.findAllOrders(this.numQubits),e}reorder(e){for(var t=new Array(2**this.numQubits).fill(0),i=0;i<this.numQubits;i++)t=t.map((t,a)=>t+2**e[i]*this.enums[i][a]);this.ampsComp=Entangled.reorderMid(this.ampsComp,t),this.ampsRot=Entangled.reorderMid(this.ampsRot,t),this.ampsFinal=Entangled.reorderMid(this.ampsFinal,t),this.offsets=Entangled.reorderMid(this.offsets,t);for(i=0;i<this.numQubits;i++)this.qubitList[i].entInd=e[i];this.qubitList=Entangled.reorderMid(this.qubitList,e),this.qubitID=Entangled.reorderMid(this.qubitID,e),this.ents=Entangled.reorderMid(this.ents,e),this.computeOffsets()}static reorderMid(e,t){return e.map((i,a)=>e[t[a]])}static joinStatesQQ(e,t){for(var i=2,a=2,r=new Array(i*a).fill(0),s=0;s<i;s++)for(var o=0;o<i;o++)r[o+s*i]=e.ampsComp[o]*t.ampsComp[s];var n=new Entangled(2);return n.setQubits([e,t]),n.ampsComp=r,n.computeRotAmps(),n}static joinStatesQE(e,t){var i=1,a=t.numQubits,r=2,s=2**a;if(!(i+a>4+FIELD.maxBonusTiles)){for(var o=new Array(r*s).fill(0),n=0;n<s;n++)for(var l=0;l<r;l++)o[l+n*r]=e.ampsComp[l]*t.ampsComp[n];t.ampsComp=o,t.numQubits=i+a,t.qubitList.unshift(e),t.qubitID.unshift(e.id),t.enums=Entangled.findEnums(i+a),t.allOrders=Entangled.findAllOrders(i+a),t.computeRotAmps(),t.computeAllEnts();for(var h=0;h<t.numQubits;h++){var d=t.qubitList[h];d.entGroup=t,d.entInd=h,d.entID=t.id}return t}console.log("above max entangled threshold")}static joinStatesEQ(e,t){var i=e.numQubits,a=1,r=2**i,s=2;if(!(i+a>4+FIELD.maxBonusTiles)){for(var o=new Array(r*s).fill(0),n=0;n<s;n++)for(var l=0;l<r;l++)o[l+n*r]=e.ampsComp[l]*t.ampsComp[n];e.ampsComp=o,e.numQubits=i+a,e.qubitList.push(t),e.qubitID.push(t.id),e.enums=Entangled.findEnums(i+a),e.allOrders=Entangled.findAllOrders(i+a),e.computeRotAmps(),e.computeAllEnts();for(var h=0;h<e.numQubits;h++){var d=e.qubitList[h];d.entGroup=e,d.entInd=h,d.entID=e.id}return e}console.log("above max entangled threshold")}static joinStatesEE(e,t){var i=e.numQubits,a=t.numQubits,r=2**i,s=2**a;if(i+a>4+FIELD.maxBonusTiles)return console.log("above max entangled threshold"),void console.log(i+a,4+FIELD.maxBonusTiles);for(var o=new Array(r*s).fill(0),n=0;n<s;n++)for(var l=0;l<r;l++)o[l+n*r]=e.ampsComp[l]*t.ampsComp[n];e.ampsComp=o,e.numQubits=i+a;for(var h=0;h<a;h++){var d=t.qubitList.shift();e.qubitList.push(d),e.qubitID.push(d.id),d.entInd=i+h,d.entID=e.id,d.entGroup=e}return e.enums=Entangled.findEnums(i+a),e.allOrders=Entangled.findAllOrders(i+a),e.computeRotAmps(),e.computeAllEnts(),t.numQubits=0,e}static findEnums(e){for(var t=[...Array(2**e).keys()],i=[],a=0;a<e;a++)i.push(t.map(e=>Math.floor(e/2**a)%2));return i}static findAllOrders(e){for(var t=new Array(e),i=0;i<e;i++){var a=[...Array(e).keys()].map(e=>2**e);a.splice(i,1),t[i]=Entangled.findOrder(a)}return t}static findOrder(e){for(var t=e.length,i=[0,e[0]],a=1;a<t;a++)i=i.concat(i.map(t=>t+e[a]));return i}applyControl(e,t,i,a){var r=this.qubitList[t];if("qFlip"===a.type)if(0===a.state)var s=Gate.getFlipMatrix(a.rot);else s=[1,0,0,1];else if("rotate"===a.type)if(0===r.last||1===r.last)s=Gate.getRotMatrix(a.rot);else if(2===r.last||3===r.last)s=Gate.getRotMatrix(a.rot);var o=Math.cos(i/2)**2,n=Math.sin(i/2)**2,l=Math.cos(i/2)*Math.sin(i/2),h=new Array(2**this.numQubits).fill(0),d=new Array(2**this.numQubits).fill(0);for(const t of this.allOrders[e]){var u=t+2**e;h[t]=this.ampsComp[t]*o+this.ampsComp[u]*l,h[u]=this.ampsComp[t]*l+this.ampsComp[u]*n,d[t]=this.ampsComp[t]*n-this.ampsComp[u]*l,d[u]=-this.ampsComp[t]*l+this.ampsComp[u]*o}var c=new Array(2**this.numQubits).fill(0);for(const e of this.allOrders[t]){u=e+2**t;c[e]=s[0]*d[e]+s[2]*d[u],c[u]=s[1]*d[e]+s[3]*d[u]}for(var I=new Array(2**this.numQubits).fill(0),E=0;E<2**this.numQubits;E++)I[E]=h[E]+c[E];if(!this.qubitList[t].lockedBasis)if("rotate"===a.type){var f=this.qubitList[t].basisVecs,S=[0,0,0,0];S[0]=Math.cos(a.rot/2)*f[0]-Math.sin(a.rot/2)*f[1],S[1]=Math.sin(a.rot/2)*f[0]+Math.cos(a.rot/2)*f[1],S[2]=Math.cos(a.rot/2)*f[2]-Math.sin(a.rot/2)*f[3],S[3]=Math.sin(a.rot/2)*f[2]+Math.cos(a.rot/2)*f[3],this.qubitList[t].basisVecs=S}else if("qFlip"===a.type){f=this.qubitList[t].basisVecs,S=[0,0,0,0];S[0]=Math.cos(a.rot)*f[0]+Math.sin(a.rot)*f[1],S[1]=Math.sin(a.rot)*f[0]-Math.cos(a.rot)*f[1],S[2]=Math.cos(a.rot)*f[2]+Math.sin(a.rot)*f[3],S[3]=Math.sin(a.rot)*f[2]-Math.cos(a.rot)*f[3],this.qubitList[t].basisVecs=S}this.ampsComp=I,this.computeRotAmps(),this.computeAllEnts(),this.removeUnentangled()}removeUnentangled(){for(var e=.01,t=this.numQubits-1;t>=0;t--)if(this.ents[t]<e&&this.numQubits>1){var i=this.computeNaturalBasis(t);this.applyMeasure(t,i)}}setQubits(e){for(var t=0;t<e.length;t++){var i=e[t];this._qubitList[t]=i,i.setEntGroup(this,t)}}computeAllEnts(){for(var e=0;e<this.numQubits;e++)this.computeEnt(e)}computeEnt(e){for(var t=[...this.ampsComp],i=this.allOrders[e],a=2**(this.numQubits-1),r=new Array(a).fill(0),s=new Array(a).fill(0),o=0;o<a;o++)r[o]=t[i[o]],s[o]=t[i[o]+2**e];var n=Helper.inner(r,r),l=1-n,h=Helper.inner(r,s),d=Math.sqrt(4*h**2+(n-l)**2),u=(n+l-d)/2,c=(n+l+d)/2,I=0;return u>.001&&(I+=-u*Math.log2(u)),c>.001&&(I+=-c*Math.log2(c)),I=Math.max(Math.min(I,1),0),this.ents[e]=I,this.qubitList[e].ent=I,I}computeNaturalBasis(e){for(var t=[...this.ampsComp],i=this.allOrders[e],a=2**(this.numQubits-1),r=new Array(a).fill(0),s=new Array(a).fill(0),o=0;o<a;o++)r[o]=t[i[o]],s[o]=t[i[o]+2**e];var n=Helper.inner(r,r),l=Helper.inner(r,s),h=Math.sqrt(4*l**2+4*n**2-4*n+1),d=(1+h)/2,u=.001;if(d<.5+u)var c=0;else if(Math.abs(l)>=u)c=2*Math.atan((d-n)/l);else if(n>=.5)c=0;else if(n<.5)c=Math.PI;return c}computeOffsets(){for(var e=new Array(2**this.numQubits).fill(0),t=this.ampsRot,i=1;i<2**this.numQubits;i++)e[i]=e[i-1]+t[i-1]**2;this.offsets=e}rotateBasis(e,t){e<=-Math.PI&&(e+=2*Math.PI),e>Math.PI&&(e-=2*Math.PI),this.qubitList[t].basisRot=e,this.qubitList[t].basisVecs=[Math.cos(e/2),Math.sin(e/2),-Math.sin(e/2),Math.cos(e/2)],this.computeRotAmps()}applyFlip(e,t){var i=this.qubitList[e],a=1e-5;t>Math.PI+a&&(t-=2*Math.PI),t<-Math.PI+a&&(t+=2*Math.PI);var r=new Array(2**this.numQubits).fill(0);for(const i of this.allOrders[e]){var s=i+2**e;r[i]=Math.cos(t)*this.ampsComp[i]+Math.sin(t)*this.ampsComp[s],r[s]=Math.sin(t)*this.ampsComp[i]-Math.cos(t)*this.ampsComp[s]}if(this._ampsComp=r,!i.lockedBasis){var o=[0,0,0,0];o[0]=Math.cos(t)*i.basisVecs[0]+Math.sin(t)*i.basisVecs[1],o[1]=Math.sin(t)*i.basisVecs[0]-Math.cos(t)*i.basisVecs[1],o[2]=Math.cos(t)*i.basisVecs[2]+Math.sin(t)*i.basisVecs[3],o[3]=Math.sin(t)*i.basisVecs[2]-Math.cos(t)*i.basisVecs[3],i.basisVecs=o}this.computeRotAmps()}applyRot(e,t){var i=this.qubitList[e],a=1e-5;t>Math.PI+a&&(t-=2*Math.PI),t<-Math.PI+a&&(t+=2*Math.PI);var r=new Array(2**this.numQubits).fill(0);for(const i of this.allOrders[e]){var s=i+2**e;r[i]=Math.cos(t/2)*this.ampsComp[i]-Math.sin(t/2)*this.ampsComp[s],r[s]=Math.sin(t/2)*this.ampsComp[i]+Math.cos(t/2)*this.ampsComp[s]}if(this._ampsComp=r,!i.lockedBasis){var o=[0,0,0,0];o[0]=Math.cos(t/2)*i.basisVecs[0]-Math.sin(t/2)*i.basisVecs[1],o[1]=Math.sin(t/2)*i.basisVecs[0]+Math.cos(t/2)*i.basisVecs[1],o[2]=Math.cos(t/2)*i.basisVecs[2]-Math.sin(t/2)*i.basisVecs[3],o[3]=Math.sin(t/2)*i.basisVecs[2]+Math.cos(t/2)*i.basisVecs[3],i.basisVecs=o}this.computeRotAmps()}projectMeasure(e,t){this.qubitList[e];var i=1e-5;t>Math.PI+i&&(t-=2*Math.PI),t<-Math.PI+i&&(t+=2*Math.PI);var a=this.ampsComp,r=this.allOrders[e],s=0;for(const i of r){var o=i+2**e;s+=(Math.cos(t/2)*a[i]+Math.sin(t/2)*a[o])**2}return s}applyMeasure(e,t){var i=this.qubitList[e],a=1e-5;t>Math.PI+a&&(t-=2*Math.PI),t<-Math.PI+a&&(t+=2*Math.PI),Math.abs(t)<a&&(t=0);var r=this.ampsComp,s=this.allOrders[e],o=0;for(const i of s){var n=i+2**e;o+=(Math.cos(t/2)*r[i]+Math.sin(t/2)*r[n])**2}var l=[Math.cos(t/2),Math.sin(t/2)];Math.sin(t/2),Math.cos(t/2);if(o>Helper.random()){i.ampsComp=[...l],i.lockedBasis||(i.basisVecs=[Math.cos(t/2),Math.sin(t/2),-Math.sin(t/2),Math.cos(t/2)]);var h=0,d=0,u=new Array(2**(this.numQubits-1)).fill(0);for(const i of s){var c=i+2**e;u[d]+=(Math.cos(t/2)*r[i]+Math.sin(t/2)*r[c])/Math.sqrt(o),d+=1}}else{if(t<=0){i.ampsComp=[-Math.sin(t/2),Math.cos(t/2)];var I=1}else{i.ampsComp=[Math.sin(t/2),-Math.cos(t/2)];I=-1}i.lockedBasis||(i.basisVecs=[Math.cos(t/2),Math.sin(t/2),-Math.sin(t/2),Math.cos(t/2)]);h=1,d=0,u=new Array(2**(this.numQubits-1)).fill(0);for(const i of s){c=i+2**e;u[d]+=I*(-Math.sin(t/2)*r[i]+Math.cos(t/2)*r[c])/Math.sqrt(1-o),d+=1}}if(this.numQubits=this.numQubits-1,this.qubitList.splice(i.entInd,1),this.qubitID.splice(i.entInd,1),this.ampsComp=u,this.enums=Entangled.findEnums(this.numQubits),this.allOrders=Entangled.findAllOrders(this.numQubits),this.computeRotAmps(),this.computeAllEnts(),i.entGroup=0,i.entInd=-1,i.entID=-1,i.ent=0,i.computeRotAmps(),1===this.numQubits){this.numQubits=0;var E=this.qubitList.splice(0,1)[0];this.qubitID.splice(0,1),E.entGroup=0,E.entInd=-1,E.entID=-1,E.ent=0,E.ampsComp=u;a=1e-5;if(Math.abs(u[0])<a)var f=Math.PI;else f=2*Math.atan(u[1]/u[0]);E.basisVecs=[Math.cos(f/2),Math.sin(f/2),-Math.sin(f/2),Math.cos(f/2)],E.computeRotAmps()}else for(var S=0;S<this.numQubits;S++)this.qubitList[S].entInd=S;return h}computeRotAmps(){for(var e=[...this.ampsComp],t=0;t<this.numQubits;t++){var i=this.qubitList[t].basisVecs,a=[...e];for(const s of this.allOrders[t]){var r=s+2**t;a[s]=i[0]*e[s]+i[1]*e[r],a[r]=i[2]*e[s]+i[3]*e[r]}e=[...a]}this.ampsRot=e,this.computeFinalAmps(),this.computeOffsets()}computeFinalAmps(){for(var e=1e-5,t=[],i=0;i<this.numQubits;i++){t.push([0,0]);var a=this.qubitList[i];Math.abs(a.basisVecs[0])<e?(a.basisRot=Math.PI,t[i][0]=Math.sign(a.basisVecs[1])):(a.basisRot=2*Math.atan(a.basisVecs[1]/a.basisVecs[0]),t[i][0]=Math.sign(a.basisVecs[0])),Math.abs(a.basisVecs[2])<e?t[i][1]=Math.sign(a.basisVecs[3]):t[i][1]=Math.sign(a.basisVecs[2])}for(var r=[...this.ampsRot],s=0;s<2**this.numQubits;s++){var o=1;for(i=0;i<this.numQubits;i++){var n=this.enums[i];o*=t[i][n[s]]}r[s]=o*r[s]}this.ampsFinal=r}setQubit(e,t){this.qubitsList[t]=e}computeArrow(e,t){for(var i=0,a=this._enums[t],r=0;r<e.length;r++)i+=a[r]*e[r];return i}computeAlfs(e){for(var t=.1,i=2**this.numQubits,a=new Array(2**this.numQubits).fill(0),r=1;r<i;r++)a[r]=a[r-1]+this.ampsRot[r-1]**2;var s=a.concat(a.map(e=>e+1));e<.5&&(e+=1);var o=e-t/2,n=e+t/2;for(r=2*i-1;r>=0;r--)if(n>s[r]){var l=r;break}for(r=l;r>=0;r--)if(o>s[r]){var h=r;break}var d=l-h+1,u=new Array(i).fill(0);if(1===d)h>=i?u[h-i]=1:u[h]=1;else{var c=(s[h+1]-o)/t,I=(n-s[l])/t;if(h>=i?u[h-i]+=c:u[h]+=c,l>=i?u[l-i]+=I:u[l]+=I,d>2)for(r=h+1;r<l;r++){var E=(s[r+1]-s[r])/t;r>=i?u[r-i]+=E:u[r]+=E}}return u}}class Finished{static startCelebration(){if(STATE.grab={type:"none",i0:0,j0:0,k0:0},CTRLMENU.getNamedButton("ctrlPlay").close(),CTRLMENU.getNamedButton("ctrlStep").close(),CTRLMENU.getNamedButton("ctrlPlay").transition={status:!0,start:0,stop:1},CTRLMENU.getNamedButton("ctrlStep").transition={status:!0,start:0,stop:1},CTRLMENU.getNamedButton("ctrlBack").transition={status:!0,start:0,stop:1},CTRLMENU.getNamedButton("ctrlNorm").close(),STATE.mode="finishtrans",TIMER.shake=0,FIELD.channelsDir=[1,1,1,1,1,1],CTRLMENU.getNamedButton("ctrlPlay").startAnimation(),SCENARIO.repetitions>1)SCENARIO.correctReps>=SCENARIO.successRep?(SCENARIO.victory=1,SCENARIO.starred=SCENARIO.starCond()):(SCENARIO.victory=0,SCENARIO.starred=!1);else if(0===SCENARIO.victoryCond||4===SCENARIO.victoryCond){var e=RBOARD[TIMER.tick].success;e>=SCENARIO.numCorrect?(SCENARIO.victory=1,SCENARIO.starred=SCENARIO.starCond(e)):(SCENARIO.victory=0,SCENARIO.starred=!1)}else if(1===SCENARIO.victoryCond){e=RBOARD[TIMER.tick].qubitList.length+RBOARD[TIMER.tick].bitList.length;0===e?(SCENARIO.victory=1,SCENARIO.starred=SCENARIO.starCond()):(SCENARIO.victory=0,SCENARIO.starred=!1)}else if(2===SCENARIO.victoryCond){if("chsh"===SCENARIO.name)var t=RBOARD[TIMER.tick].getGate(10,1),i=Math.round(t.counter/t.counterMax*100),a=i>=SCENARIO.outputC[0]&&i<=SCENARIO.outputC[1],r=!0;else{t=RBOARD[TIMER.tick].getGate(18,5);var s=RBOARD[TIMER.tick].getGate(18,8),o=(i=Math.round(t.counter/t.counterMax*100),Math.round(s.counter/s.counterMax*100));a=i>=SCENARIO.outputC[0]&&i<=SCENARIO.outputC[1],r=o>=SCENARIO.outputD[0]&&o<=SCENARIO.outputD[1]}a&&r?(SCENARIO.victory=1,SCENARIO.starred=SCENARIO.starCond()):(SCENARIO.victory=0,SCENARIO.starred=!1)}else if(3===SCENARIO.victoryCond){e=RBOARD[TIMER.tick].success;e>=SCENARIO.numCorrect?(SCENARIO.victory=1,SCENARIO.starred=SCENARIO.starCond(e)):(SCENARIO.victory=0,SCENARIO.starred=!1)}SCENARIO.victory?(PERSIST0[SCENARIO.name].complete=!0,STATE.lastLetter=1,SFX.success.play()):(STATE.lastLetter=1,SFX.loser.play()),SCENARIO.starred&&(PERSIST0[SCENARIO.name].star=!0),Storage.save(PERSIST0[SCENARIO.name],SCENARIO.name,0)}static draw(e,t){var i=e.ctx,a=t.ctx,r=RobotSpeech.grab(SCENARIO.name,0,!0);FIELD.disableBriefs&&(r=!1);var s=!r&&1===SCENARIO.victory,o=FIELD.tileWidth/6;s&&(o=0);var n=["finishtrans","finished","backwardTrans"].indexOf(STATE.mode)>=0||"finished"===ROBOT.oldMode;if(!n||SCENARIO.victory<0)e.clear();else{var l=Math.min(1,TIMER.finishTime/TIMER.finishMid);if("finishtrans"===STATE.mode)var h=(l-1)*SCENARIO.finishedHeight,d=l*SCENARIO.finishedHeight;else if("finished"===STATE.mode||"finished"===ROBOT.oldMode)h=0,d=SCENARIO.finishedHeight;else if("backwardTrans"===STATE.mode)h=(l-1)*SCENARIO.finishedHeight,d=l*SCENARIO.finishedHeight;e.clear(),t.clear();var u=FIELD.tileHeight/4,c=FIELD.tileHeight/4,I=new Path2D(Helper.makeRoundedPath([u,u,e.w0-u,e.w0-u],[h-0*FIELD.tileHeight,d,d,h-0*FIELD.tileHeight],[0,c,c,0],1,0,0)),E=i.createLinearGradient(0,0,e.w0,0);if(E.addColorStop(1,"#444"),E.addColorStop(.45,"#4e7566"),E.addColorStop(.55,"#4e7566"),E.addColorStop(0,"#444"),i.save(),i.fillStyle=E,i.shadowBlur=4,i.shadowOffsetX=4,i.shadowOffsetY=4,i.shadowColor="#555",i.lineStyle="black",i.lineWidth=1,i.fill(I),i.stroke(I),i.restore(),"finished"!==STATE.mode&&"backwardTrans"!==STATE.mode&&"finished"!==ROBOT.oldMode){if("finishtrans"===STATE.mode){var f=(TIMER.finishTime-TIMER.finishMid)/(TIMER.finishMax-TIMER.finishMid);if(f>0&&1===STATE.lastLetter&&(SFX.finlaser.play(),STATE.lastLetter=0),f>=0){var S=.5*(1-Math.cos(Math.PI*Math.min(Math.max(0,1.25*(f-.1)),1))),p=FIELD.tileWidth/4;if(f<=.1)var T=10*f,R=2*u,m=e.w0-2*u,g=10*p*f;else if(f>=.9)T=10*(1-f),R=e.w0-2*u,m=2*u,g=10*p*(1-f);else T=1,R=2*u+S*(e.w0-4*u),m=e.w0-2*u-S*(e.w0-4*u),g=p;v=Paths.scannersFinish(i,T);v.draw(i,R-p/2,d,p,p);v=Paths.scannersFinish(i,T);if(v.draw(i,m-p/2,d,p,p),s){a.save();L=9*FIELD.tileWidth/4,h=1.6*FIELD.tileWidth,u=1.5*FIELD.tileHeight/6,c=FIELD.tileHeight/6,I=new Path2D(Helper.makeRoundedPath([e.w0/2-L/2-u,e.w0/2-L/2-u,e.w0/2+L/2+u,e.w0/2+L/2+u],[h-u,h+u,h+u,h-u],[c,c,c,c],1,0,0));a.fillStyle="#333",a.strokeStyle="black",a.lineWidth=2,a.fill(I),a.stroke(I),a.restore()}if(a.save(),a.textBaseline="top",a.textAlign="center",a.font=2*FIELD.tileWidth/4+"px Courier New",a.fillStyle="antiquewhite",a.shadowBlur=2,a.shadowOffsetX=2,a.shadowOffsetY=2,a.shadowColor="black",a.font=1*FIELD.tileWidth/2+"px Courier New",1===SCENARIO.victory?(a.fillText("Factory",e.w0/2,FIELD.tileWidth/6+o),a.fillText("Successful!",e.w0/2,4.5*FIELD.tileWidth/6+o),s&&(a.font=1*FIELD.tileWidth/3+"px Courier New",a.textBaseline="middle",a.fillText("Level select",e.w0/2,1.6*FIELD.tileWidth))):0===SCENARIO.victory&&(a.fillText("Factory",e.w0/2,2*FIELD.tileWidth/6),a.fillText("Malfunction",e.w0/2,4*FIELD.tileWidth/4)),a.restore(),a.save(),1===SCENARIO.victory)if(SCENARIO.starred){D=.9*(1+.2*Math.cos(12*Math.PI*TIMER.qubitGlowRatio)),b=1.4*FIELD.tileWidth/2,O=e.w0-2.4*FIELD.tileWidth/2,h=.8*FIELD.tileWidth/4+o,M=.4*Math.sin(2*Math.PI*TIMER.blinkRatio),v=Paths.starBonus(a,0,M);v.draw(a,b-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2),v.draw(a,O-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2)}else{D=.9*(1+.2*Math.cos(12*Math.PI*TIMER.qubitGlowRatio)),b=1.4*FIELD.tileWidth/2,O=e.w0-2.4*FIELD.tileWidth/2,h=.8*FIELD.tileWidth/4+o,v=Paths.starBonus(a,1,0);v.draw(a,b-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2),
v.draw(a,O-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2)}else{D=.9*(1+.2*Math.cos(12*Math.PI*TIMER.qubitGlowRatio)),b=1.4*FIELD.tileWidth/2,O=e.w0-2.4*FIELD.tileWidth/2,h=.8*FIELD.tileWidth/4+FIELD.tileWidth/6,M=.4*Math.sin(2*Math.PI*TIMER.blinkRatio),v=Paths.sparkBonus(a,0,M-Math.PI/8);v.draw(a,b-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2);v=Paths.sparkBonus(a,1,-M+Math.PI/8);v.draw(a,O-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2)}a.restore(),a.save(),a.globalCompositeOperation="destination-out",a.fillRect(R,0,e.w0,3*FIELD.tileWidth/4+o),a.fillRect(0,3*FIELD.tileWidth/4+o,m,t.h0),a.restore(),a.save();E=i.createLinearGradient(R-g,0,R+g,0);E.addColorStop(0,"rgba(255,255,255,0.0)"),E.addColorStop(.2,"rgba(0,0,255,0.2)"),E.addColorStop(.5,"cyan"),E.addColorStop(.8,"rgba(0,0,255,0.2)"),E.addColorStop(1,"rgba(255,255,255,0.0)"),a.fillStyle=E,a.fillRect(R-g,0,R+g,d);var A=i.createLinearGradient(m-g,0,m+g,0);A.addColorStop(0,"rgba(255,255,255,0.0)"),A.addColorStop(.2,"rgba(0,0,255,0.2)"),A.addColorStop(.5,"cyan"),A.addColorStop(.8,"rgba(0,0,255,0.2)"),A.addColorStop(1,"rgba(255,255,255,0.0)"),a.fillStyle=A,a.fillRect(m-g,0,m+g,d),a.restore()}}}else{var C=0;if("backwardTrans"===STATE.mode&&(C=(l-1)*SCENARIO.finishedHeight),s){a.save();var L=9*FIELD.tileWidth/4,h=1.6*FIELD.tileWidth+C,u=1.5*FIELD.tileHeight/6,c=FIELD.tileHeight/6,I=new Path2D(Helper.makeRoundedPath([e.w0/2-L/2-u,e.w0/2-L/2-u,e.w0/2+L/2+u,e.w0/2+L/2+u],[h-u,h+u,h+u,h-u],[c,c,c,c],1,0,0));a.strokeStyle="black","nextbutton"===STATE.under.type?a.fillStyle="#666":a.fillStyle="#333",a.lineWidth=2,a.fill(I),a.stroke(I),a.restore()}if(a.save(),a.textBaseline="top",a.textAlign="center",a.shadowBlur=2,a.shadowOffsetX=2,a.shadowOffsetY=2,a.shadowColor="black",a.font=1*FIELD.tileWidth/2+"px Courier New",1===SCENARIO.victory?(a.fillStyle="antiquewhite",a.fillText("Factory",e.w0/2,o+FIELD.tileWidth/6+C),a.fillText("Successful!",e.w0/2,o+4.5*FIELD.tileWidth/6+C),s&&(a.font=1*FIELD.tileWidth/3+"px Courier New",a.fillStyle="antiquewhite",a.textBaseline="middle",a.fillText("Level select",e.w0/2,1.6*FIELD.tileWidth+C))):0===SCENARIO.victory&&(a.fillStyle="antiquewhite",a.fillText("Factory",e.w0/2,2*FIELD.tileWidth/6+C),a.fillText("Malfunction",e.w0/2,4*FIELD.tileWidth/4+C)),a.restore(),a.save(),1===SCENARIO.victory)if(SCENARIO.starred){var D=.9*(1+.2*Math.cos(12*Math.PI*TIMER.qubitGlowRatio)),b=1.4*FIELD.tileWidth/2,O=e.w0-2.4*FIELD.tileWidth/2,h=.8*FIELD.tileWidth/4+C+o,M=.4*Math.sin(2*Math.PI*TIMER.blinkRatio),v=Paths.starBonus(a,0,M);v.draw(a,b-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2),v.draw(a,O-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2)}else{var D=.9*(1+.2*Math.cos(12*Math.PI*TIMER.qubitGlowRatio)),b=1.4*FIELD.tileWidth/2,O=e.w0-2.4*FIELD.tileWidth/2,h=.8*FIELD.tileWidth/4+C+o,M=0,v=Paths.starBonus(a,1,M);v.draw(a,b-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2),v.draw(a,O-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2)}else{var D=.9*(1+.2*Math.cos(12*Math.PI*TIMER.qubitGlowRatio)),b=1.4*FIELD.tileWidth/2,O=e.w0-2.4*FIELD.tileWidth/2,h=.8*FIELD.tileWidth/4+C+FIELD.tileWidth/6,M=.4*Math.sin(2*Math.PI*TIMER.blinkRatio),v=Paths.sparkBonus(a,0,M-Math.PI/8);v.draw(a,b-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2);var v=Paths.sparkBonus(a,1,-M+Math.PI/8);v.draw(a,O-(D-1)/2*FIELD.tileWidth/2,h-(D-1)/2*FIELD.tileHeight/2,D*FIELD.tileWidth/2,D*FIELD.tileWidth/2)}a.restore()}}}}class Gate{constructor(e,t,i,a,r,s,o,n=0,l=-1){this._i0=e,this._j0=t,this._orient=r,this._action=a,this._type=i,this._rot=s,this._layer=o,this._state=n,this._counter=0,this._counterMax=-2,this._qubitStore=0,["compare"].indexOf(i)>=0?this._numPoints=2:["measure","rotate","qFlip","upgrade","qControl"].indexOf(i)>=0?this._numPoints=16:["delay"].indexOf(i)>=0?this._numPoints=8:["cCombine","qCombine","cSplit"].indexOf(i)>=0?this._numPoints=4:["cCreate","qCreate"].indexOf(i)>=0?this._numPoints=3:this._numPoints=0,l<0?(this._id=GLOBAL_IDG,GLOBAL_IDG+=1):this._id=l}get i0(){return this._i0}get j0(){return this._j0}get orient(){return this._orient}get action(){return this._action}get type(){return this._type}get rot(){return Math.round(1e13*this._rot)/1e13}get layer(){return this._layer}get state(){return this._state}get id(){return this._id}get counter(){return this._counter}get counterMax(){return this._counterMax}get qubitStore(){return this._qubitStore}get numPoints(){return this._numPoints}set i0(e){this._i0=e}set j0(e){this._j0=e}set action(e){this._action=e}set orient(e){this._orient=e}set rot(e){this._rot=e}set layer(e){this._layer=e}set state(e){this._state=e}set counter(e){this._counter=e}set counterMax(e){this._counterMax=e}set qubitStore(e){this._qubitStore=e}static getFlipMatrix(e){var t=1e-5;return e>Math.PI+t&&(e-=2*Math.PI),e<-Math.PI+t&&(e+=2*Math.PI),[Math.cos(e),Math.sin(e),Math.sin(e),-Math.cos(e)]}static getRotMatrix(e){var t=1e-5;return e>Math.PI+t&&(e-=2*Math.PI),e<-Math.PI+t&&(e+=2*Math.PI),[Math.cos(e/2),Math.sin(e/2),-Math.sin(e/2),Math.cos(e/2)]}setProperties(e){this._orient=e.orient,this._rot=e.rot,this._state=e.state,this._counter=e.counter,this._counterMax=e.counterMax}getProperties(){var e={type:this._type,orient:this._orient,rot:this._rot,state:this._state,counter:this._counter,counterMax:this._counterMax,remaining:this._counterMax};return e}getRotDeg(){var e=(16+Math.round(this.rot/Math.PI*8))%16;e>8&&(e-=16);var t=String(22.5*e);return e%2==0&&(t+=".0"),t+"°"}getRotRad(e=!0){var t=(16+Math.round(this.rot/Math.PI*8))%16,i=["0","1","2","3","4","5","6","7","8","-7","-6","-5","-4","-3","-2","-1"],a=i[t]+"π/8";return e&&t<=8&&(a=" "+a),a}pack(){return[this._i0,this._j0,this._type,this._action,this._orient,Math.round(1e12*this._rot)/1e12,this._layer,this._state,this._counterMax]}copy(){var e=new Gate(this._i0,this._j0,this._type,this._action,this._orient,this._rot,this._layer,this._state);return e.counter=this.counter,e.counterMax=this.counterMax,e.qubitStore=this.qubitStore,e}applyQuantum(e){var t=this.i0+this.j0*e.width;if(e.state[t]===this.layer){var i=e.getQubit(this.i0,this.j0);if("pretransform"!==this.action)if("transform"===this.action){g=e.checkWhichControl(this.i0,this.j0,"switch").gate;if(g&&1===g.state&&(g.rot+=2),"rotate"===this.type){if(this.action="free",i.action="move",0===this.state)i.applyRot(this.rot);else if(1===this.state){var a=Helper.random();if(a>.75){var r=Math.floor(3*Helper.random());0===r&&(r=-1);var s=r*(Math.PI/2);i.applyRot(s)}else i.applyRot(0)}else if(2===this.state){r=Math.floor(16*Helper.random())-7,s=r*(Math.PI/8);i.applyRot(s)}return}if("qFlip"===this.type)return this.action="free",i.action="move",void(0===this.state?i.applyFlip(this.rot):1===this.state||(2===this.state?(i.rotateBasis(0),i.lockedBasis=!0):3===this.state&&(i.rotateBasis(this.rot),i.lockedBasis=!0)));if("measure"===this.type){this.action="free",i.action="move";var o=i.applyMeasure(this.rot),n=[54,55,56,57];if(0===this.orient)var l=e.getTile(this.i0,this.j0-1),h=e.getTile(this.i0,this.j0+1),d=!n.includes(l)&&DIRCLASSIC.enterB.indexOf(l)>=0,u=!n.includes(h)&&DIRCLASSIC.enterT.indexOf(h)>=0;else if(1===this.orient){l=e.getTile(this.i0-1,this.j0),h=e.getTile(this.i0+1,this.j0);var c=!n.includes(l)&&DIRCLASSIC.enterR.indexOf(l)>=0,I=!n.includes(h)&&DIRCLASSIC.enterL.indexOf(h)>=0}if(d){var E=new Bit(this.i0,this.j0,0,1,"move",o,0);e.setBit(E)}if(u){E=new Bit(this.i0,this.j0,0,3,"move",o,1);e.setBit(E)}if(c){E=new Bit(this.i0,this.j0,0,0,"move",o,0);e.setBit(E)}if(I){E=new Bit(this.i0,this.j0,0,2,"move",o,1);e.setBit(E)}return}}else if("nullswitch"===this.action){if(e.checkIfEmpty(this.i0,this.j0))return void(this.action="free")}else if("switch"===this.action){if(e.checkIfEmpty(this.i0,this.j0))return this.action="free",e.state[t]=!e.state[t]+0,void e.setState(this.i0,this.j0,e.state[t])}else{if("free"!==this.action){if("create"===this.action){if(0===this.state||5===this.state){if(0===this.rot)var f=0;else if(1===this.rot)f=8*Math.floor(2*Helper.random());else if(2===this.rot)f=Math.floor(16*Helper.random());else if(3===this.rot)f=4;var S=new Qubit(this.i0,this.j0,this.orient,-1,"move",f*Math.PI/8);3===this.rot&&S.rotateBasis(0),5===this.state&&(S.rotateBasis(0),S.lockedBasis=!0),e.setQubit(S),this.counter=this.counter+1}else if(SCENARIO.QINPUTS[this.rot].length>this.counter){s=Math.PI*SCENARIO.QINPUTS[this.rot][this.counter]/8;this.counter=this.counter+1;S=new Qubit(this.i0,this.j0,this.orient,-1,"move",s);2===this.state&&(S.isGhost=!0),3===this.state&&(S.rotateBasis(0),S.lockedBasis=!0),4===this.state&&(S.lockedBasis=!0),e.setQubit(S)}return void(this.action="free")}if("precompare"===this.action)return void(this.action="compare");if("compare"===this.action){var p=0;if(0===p){var T=.001,R=i.projectMeasure(this.rot);1-R<T?(e.success+=1,this.rot=1,this.counter=1):(e.failure+=1,this.rot=0,this.counter=2),i.applyMeasure(this.rot)}else if(1===p){i.applyMeasure(this.rot);var m=Math.abs(i.ampsComp[0]*Math.cos(this.rot/2)+i.ampsComp[1]*Math.sin(this.rot/2));T=1e-5;1-m**2<T?(e.success+=1,this.rot=1,this.counter=1):(e.failure+=1,this.rot=0,this.counter=2)}return e.removeQubit(i),this.action="free",void(this.state=0)}return this.action="free",void(i&&(i.action="move"))}if("qCreate"===this.type)return void(e.checkIfEmpty(this.i0,this.j0)&&(0===this.state||5===this.state?(this.counter<this.counterMax||this.counterMax<0)&&(this.action="create",this.j0>0&&this.j0<13&&(e.sfx[0]=!0)):SCENARIO.QINPUTS[this.rot].length>this.counter&&(this.counter<this.counterMax||this.counterMax<0)&&(this.action="create")))}else{if("rotate"===this.type)return this.action="transform",i.action="rotate",void(e.sfx[2]=!0);if("qFlip"===this.type)return void(0===this.state?(this.action="transform",i.action="flip",e.sfx[2]=!0):(i.action="wait",this.action="transform"));if("measure"===this.type)return this.action="transform",i.action="measure",void(e.sfx[1]=!0);if("qCombine"===this.type){var g=e.checkWhichControl(this.i0,this.j0,"switch").gate;return g&&1===g.state&&(g.rot+=2),2===this.state&&(this.counterMax-=1),this.action="free",void(i.action="move")}this.action="transform"}}}applyClassic(e){var t=this.i0+this.j0*e.width;if(e.state[t]===this.layer){var i=e.getBit(this.i0,this.j0,0),a=e.getBit(this.i0,this.j0,1),r=e.getBit(this.i0,this.j0,2);if("pretransform"===this.action){if("cCombine"===this.type){var s=e.checkWhichControl(this.i0,this.j0,"switch").gate;return s&&1===s.state&&(s.rot+=2),this.action="free",void(i.action="move")}if("cInvert"===this.type){if(this.action="transform",0===this.state)0===this.rot?i.action="flip":1===this.rot&&(i.action="nullflip"),e.sfx[2]=!0;else if(1===this.state)0===this.rot?0===i.value?i.action="nullflip":1===i.value&&(i.action="flip"):1===this.rot&&(i.action="nullflip"),e.sfx[2]=!0;else if(2===this.state)i.action="nullflip",i.isGhost=!0;else if(3===this.state){var o=Math.floor(5*Helper.random());i.action=0===o?"flip":"nullflip",e.sfx[2]=!0}return}return"cSplit"===this.type?(this.action="free",i&&(i.action="move"),a&&(a.action="move"),void(r&&(r.action="move"))):"cTrash"===this.type?(this.action="transform",void(i.action="delete")):void(this.action="transform")}if("transform"===this.action){s=e.checkWhichControl(this.i0,this.j0,"switch").gate;return s&&1===s.state&&(s.rot+=2),"cTrash"===this.type?(e.removeBit(i),void(this.action="free")):"cInvert"===this.type?(0===this.state?0===this.rot&&(i.value=!i.value+0):1===this.state?0===this.rot&&(i.value=0):"flip"===i.action&&(i.value=!i.value+0),i.action="move",void(this.action="free")):void(i.action="move")}if("nullswitch"===this.action){if(e.checkIfEmpty(this.i0,this.j0))return void(this.action="free")}else if("switch"===this.action){if(e.checkIfEmpty(this.i0,this.j0))return this.action="free",e.state[t]=!e.state[t]+0,void e.setState(this.i0,this.j0,e.state[t])}else{if("create"===this.action){if(this.action="free",0===this.state){if(0===this.rot)o=0;else if(1===this.rot)o=this.counter%2;else if(2===this.rot)o=Math.floor(2*Helper.random());var n=new Bit(this.i0,this.j0,this.orient,-1,"move",o,0);e.setBit(n),this.counter=this.counter+1}else if(SCENARIO.CINPUTS[this.rot].length>this.counter){o=SCENARIO.CINPUTS[this.rot][this.counter];this.counter=this.counter+1;n=new Bit(this.i0,this.j0,this.orient,-1,"move",o,0);2===this.state&&(n.isGhost=!0),e.setBit(n)}return}if("free"===this.action&&"cCreate"===this.type&&e.checkIfEmpty(this.i0,this.j0))return void(0===this.state?(this.counter<this.counterMax||this.counterMax<0)&&(this.action="create",e.sfx[0]=!0):SCENARIO.CINPUTS[this.rot].length>this.counter&&(this.counter<this.counterMax||this.counterMax<0)&&(this.action="create"))}}}applyUniversal(e){if("free"!==this.action){var t=this.i0+this.j0*e.width;if(e.state[t]===this.layer){var i=e.getQubit(this.i0,this.j0,0);if(i)var a=!0;else for(var r=0;r<3;r++){var s=e.getBit(this.i0,this.j0,r);if(s){var o=s;a=!1;break}}if("precompare"===this.action){var n=e.getBit(this.i0,this.j0,0),l=e.getBit(this.i0,this.j0,1);return n.action="ghost",l.action="ghost",void(this.action="compare")}if("compare"===this.action){if(a);else{n=e.getBit(this.i0,this.j0,0),l=e.getBit(this.i0,this.j0,1);n.value===l.value?(e.success+=1,this.rot=1,this.counter=1):(e.failure+=1,this.rot=0,this.counter=2),e.removeBit(n),e.removeBit(l)}return this.action="free",void(this.state=0)}if("pretransform"===this.action){if("cOneCompare"===this.type)return o.action="delete",this.action="transform",void(this.state=5);if("qDubCompare"===this.type){if(0===this.state)var h=e.getQubit(18,5),d=e.getQubit(18,8);else if(1===this.state)h=e.getQubit(0,5),d=e.getQubit(18,5);return void(h&&d&&(this.action="transform",h.action="qDubCompare",d.action="qDubCompare"))}if("trash"===this.type)return this.action="transform",this.counter>=0&&(this.counter+=1),a?i.action="delete":o.action="delete",void(e.sfx[0]=!0);if("sync"===this.type){var u=this.i0,c=this.j0;0===this.orient?c+=1:1===this.orient?u-=1:2===this.orient?c-=1:3===this.orient&&(u+=1);var I=e.getGate(u,c);if("pretransform"===I.action){this.action="reset",I.action="prereset",a?i.action="move":o.action="move";var E=e.getQubit(u,c);if(E)E.action="move";else{var f=e.getBit(u,c,0);f.action="move"}return}return}return"upgrade"===this.type?(o.action="upgrade",this.action="transform",void(e.sfx[2]=!0)):"delay"===this.type?void(a?0===this.state?(i.action="move",this.action="free"):(i.action="wait",this.action="transform",e.sfx[2]=!0):0===this.state?(o.action="move",this.action="free"):(o.action="wait",this.action="transform",this.j0>0&&this.j0<13&&(e.sfx[2]=!0))):void(this.action="transform")}if("transform"===this.action){var S=e.checkWhichControl(this.i0,this.j0,"switch").gate;if(S&&(S.rot+=2),"cOneCompare"!==this.type){if("qDubCompare"===this.type){if(0===this.state){var p=18,T=8;u=18,c=5}else if(1===this.state)p=0,T=5,u=18,c=5;var R=e.getGate(p,T),m=e.getGate(u,c),g=e.getQubit(p,T),A=e.getQubit(u,c),C=!1,L=g.entGroup;if(L){var D=1e-5;if(2===L.numQubits){var b=L.qubitList[0].i0===u||L.qubitList[0].i0===p,O=L.qubitList[0].j0===c||L.qubitList[0].j0===T,M=L.qubitList[1].i0===u||L.qubitList[1].i0===p,v=L.qubitList[1].j0===c||L.qubitList[1].j0===T;if(0===this.state)var w=.5-L.ampsComp[0]**2<D,N=.5-L.ampsComp[3]**2<D;else if(1===this.state)w=L.computeEnt(0)>=.85,N=L.computeEnt(1)>=.85;w&&N&&b&&O&&M&&v&&(C=!0)}var P=g.computeNaturalBasis();g.applyMeasure(P);var y=A.computeNaturalBasis();A.applyMeasure(y)}return C?(e.success+=1,R.counter=1,m.counter=1):(e.failure+=1,R.counter=0,m.counter=0),e.removeQubit(g),e.removeQubit(A),R.action="free",void(m.action="free")}if("trash"===this.type){if(a){if(i.entGroup){var F=i.computeNaturalBasis();i.applyMeasure(F)}e.removeQubit(i)}else e.removeBit(o);return void(this.action="free")}if("upgrade"===this.type){if(e.removeBit(o),2===this.state)var k=1+Math.floor(7*Helper.random()),x=k*(Math.PI/8)+Math.PI*o.value;else x=this.rot-Math.PI*o.value;i=new Qubit(o.i0,o.j0,o.last,(this.orient+2)%4,"move",x,o.id);return 1!==this.state&&2!==this.state||i.rotateBasis(0),e.setQubit(i),void(this.action="free")}return"delay"===this.type?(this.j0>0&&this.j0<13&&(e.sfx[2]=!0),this.rot+=1,void(this.rot===this.state&&(this.rot=0,this.action="reset",a?i.action="move":o.action="move"))):void(a?i.action="move":o.action="move")}this.counter+=o.value,this.counterMax+=1,e.success+=1,e.removeBit(o),this.action="free",this.state=0}else if("nullswitch"===this.action){if(e.checkIfEmpty(this.i0,this.j0))return void(this.action="free")}else{if("reset"===this.action)return void(this.action="free");if("prereset"===this.action)return void(this.action="reset");if("switch"===this.action&&e.checkIfEmpty(this.i0,this.j0))return this.action="free",e.state[t]=!e.state[t]+0,void e.setState(this.i0,this.j0,e.state[t])}}}}applySwitch(e){this.i0,this.j0,e.width;var t=e.getBit(this.i0,this.j0,0);if("transform"===this.action)return this.action="free",this.rot=t.value,void(t.action="move");if("pretransform"===this.action){var i=this.i0,a=this.j0;0===this.orient?a+=1:1==this.orient?i-=1:2==this.orient?a-=1:3==this.orient&&(i+=1);var r=i+a*e.width,s=e.state[r],o=e.getGate(i,a,0),n=e.getGate(i,a,1);if(0===o||0===n)return this.action="free",void(t.action="move");if("free"===o.action&&"free"===n.action)e.checkIfEmpty(i,a)?(this.action="transform",t.action="transform",s===t.value?0===s?(o.action="nullswitch",e.sfx[1]=!0):(n.action="nullswitch",e.sfx[1]=!0):0===s?(o.action="switch",e.sfx[1]=!0):(n.action="switch",e.sfx[1]=!0)):0===s?o.action="hold":n.action="hold";else if("hold"===o.action||"hold"===n.action)return void(e.checkIfEmpty(i,a)&&(t.action="transform",this.action="transform",s===t.value?0===s?o.action="nullswitch":n.action="nullswitch":0===s?o.action="switch":n.action="switch"))}}applyControl(e){this.i0,this.j0,e.width;var t=e.getQubit(this.i0,this.j0);if(2===this.state)var i=FIELD.cols-3,a=FIELD.rows-1;else{i=this.i0,a=this.j0;0===this.orient?a+=1:1===this.orient?i-=1:2===this.orient?a-=1:3===this.orient&&(i+=1)}var r=e.getQubit(i,a),s=e.getGate(i,a,0),o=e.getGate(i,a,1);if(t&&r){if("entangle"===this.action){var n=!1;if(t.entGroup&&r.entGroup&&t.entGroup.id===r.entGroup.id&&(n=!0),n)var l=t.entGroup.numQubits;else{var h=1;t.entGroup&&(h=t.entGroup.numQubits);var d=1;r.entGroup&&(d=r.entGroup.numQubits);l=h+d}if(l>4+FIELD.maxBonusTiles){var u=l-(4+FIELD.maxBonusTiles);if(t.entGroup){t.entGroup.computeAllEnts();var c=t.entGroup.ents,I=t.entInd}else c=[0],I=0;if(r.entGroup){r.entGroup.computeAllEnts();var E=r.entGroup.ents,f=h+r.entInd}else E=[0],f=h;var S=c.concat(E),p=[...Array(l).keys()];p.sort(function(e,t){return S[e]<S[t]?-1:S[e]>S[t]?1:0});for(var T=[],R=0;R<l&&(p[R]!==I&&p[R]!==f&&T.push(p[R]),!(T.length>=u));R++);var m=[],g=[];for(R=0;R<u;R++)T[R]<h?m.push(T[R]):g.push(T[R]-h);m=m.sort(function(e,t){return e-t}),g=g.sort(function(e,t){return e-t});for(R=m.length-1;R>=0;R--){var A=t.entGroup.computeNaturalBasis(m[R]);t.entGroup.applyMeasure(m[R],A)}for(R=g.length-1;R>=0;R--){A=r.entGroup.computeNaturalBasis(g[R]);r.entGroup.applyMeasure(g[R],A)}}var C=!0;if("qFlip"===s.type&&1===s.state&&(C=!1),"rotate"===s.type&&0===s.rot&&(C=!1),n)return t.entGroup.applyControl(t.entInd,r.entInd,this.rot,s,o),t.action="halt",r.action="halt",this.action="free",void(s.action="free");if(t.entGroup){if(r.entGroup){if(C){var L=Entangled.joinStatesEE(t.entGroup,r.entGroup);L.applyControl(t.entInd,r.entInd,this.rot,s,o)}return t.action="halt",r.action="halt",this.action="free",void(s.action="free")}if(C){L=Entangled.joinStatesEQ(t.entGroup,r);L.applyControl(t.entInd,r.entInd,this.rot,s,o)}return t.action="halt",r.action="halt",this.action="free",void(s.action="free")}if(r.entGroup){if(C){L=Entangled.joinStatesQE(t,r.entGroup);L.applyControl(t.entInd,r.entInd,this.rot,s,o)}return t.action="halt",r.action="halt",this.action="free",void(s.action="free")}if(C){L=Entangled.joinStatesQQ(t,r);L.applyControl(0,1,this.rot,s,o),e.entList.push(L)}return t.action="halt",r.action="halt",this.action="free",void(s.action="free")}"wait"===t.action&&"wait"===r.action&&"pretransform"===this.action&&"pretransform"===s.action&&(t.action="controlled","qFlip"===s.type?r.action="flip":"rotate"===s.type?r.action="rotate":r.action="halt",this.action="entangle",this.j0>0&&this.j0<13&&(e.sfx[1]=!0))}else t?"pretransform"===this.action?t.action="wait":t.action="halt":r&&("pretransform"===s.action?r.action="wait":r.action="halt")}}class Gears{static drawOptionsMenu(e){var t=FIELD.tileWidth;FIELD.tileHeight;e.save(),e.fillStyle="antiquewhite",e.textBaseline="middle",e.textAlign="center",e.font=.4*FIELD.tileWidth+"px Courier New",OPTS.autoResize?e.fillText("•",3.23*t,1.5*t/4):e.fillText("•",4.67*t,1.5*t/4),OPTS.fancyGraphics?e.fillText("•",3.23*t,1.5*t/4+t/3+t/2):e.fillText("•",4.67*t,1.5*t/4+t/3+t/2),FIELD.disableBriefs?e.fillText("•",4.67*t,1.5*t/4+t/3+t):e.fillText("•",3.23*t,1.5*t/4+t/3+t),e.restore(),e.save(),e.lineWidth=FIELD.tileWidth/24,e.strokeStyle="antiquewhite",e.moveTo(1.8*t,2*t/3+3*t/2),e.lineTo(4.2*t,2*t/3+3*t/2),e.moveTo(1.8*t,3*t/3+3*t/2),e.lineTo(4.2*t,3*t/3+3*t/2),e.stroke(),e.font="normal "+.2*FIELD.tileWidth+"px Courier New",e.fillStyle="antiquewhite",e.textAlign="right",e.textBaseline="middle",e.fillText("0  ",1.8*t,2*t/3+3*t/2),e.fillText("0  ",1.8*t,3*t/3+3*t/2),e.textAlign="left",e.fillText(" 100",4.2*t,2*t/3+3*t/2),e.fillText(" 100",4.2*t,3*t/3+3*t/2);var i=1.8;if(OPTS.musicOn)i=1.8+(4.2-1.8)*OPTS.music;var a=1.8;if(OPTS.sfxOn)a=1.8+(4.2-1.8)*OPTS.sfx;e.textBaseline="middle",e.textAlign="center",e.font="normal "+.8*FIELD.tileWidth+"px Courier New",e.fillText("•",i*t,2.1*t/3+3*t/2),e.fillText("•",a*t,3.1*t/3+3*t/2),e.restore(),e.save();var r=!1;if("optionbut"===STATE.under.type&&0===STATE.under.i0)r=!0;e.lineWidth=t/48,e.strokeStyle="antiquewhite";var s=[1.4*t,1.4*t,3.6*t,3.6*t],o=[8.5*t/3,9.5*t/3,9.5*t/3,8.5*t/3],n=[t/8,t/8,t/8,t/8],l=new Path2D(Helper.makeRoundedPath(s,o,n,1,0,0));r&&(e.fillStyle="#555",e.fill(l)),e.stroke(l),e.restore(),e.save();r=!1;if("optionbut"===STATE.under.type&&1===STATE.under.i0)r=!0;e.lineWidth=t/48,e.strokeStyle="antiquewhite";s=[1.4*t,1.4*t,3.6*t,3.6*t],o=[10*t/3,11*t/3,11*t/3,10*t/3],n=[t/8,t/8,t/8,t/8],l=new Path2D(Helper.makeRoundedPath(s,o,n,1,0,0));r&&(e.fillStyle="#555",e.fill(l)),e.stroke(l),e.restore(),e.save(),e.textBaseline="top",e.fillStyle="antiquewhite",e.font=.2*FIELD.tileWidth+"px Courier New";var h=[0,t/3,t/3+t/2,t/3+2*t/2,t/3+3*t/2,2*t/3+3*t/2,2*t/3+4*t/2,2*t/3+5*t/2],d=["Window Resizing:","[manual resizing via `<` and `>` keys]","Graphics:","Level Briefings:","Music:","Effects:","Reset Saved Data","Done"];e.font="normal "+.2*FIELD.tileWidth+"px Courier New";for(var u=0;u<d.length;u++)e.fillStyle=1===u||6===u||7===u?"antiquewhite":"cornflowerblue",u>=6?(e.textAlign="center",e.fillText(d[u],2.5*t,h[u]+t/4)):(e.textAlign="left",e.fillText(d[u],t/4,h[u]+t/4));e.fillStyle="antiquewhite",e.font="normal "+.2*FIELD.tileWidth+"px Courier New";d=["auto [ ]  manual [ ]","","std. [ ]  simple [ ]","on   [ ]  off    [ ]"];e.textAlign="left";for(u=0;u<d.length;u++)e.fillText(d[u],2.2*t+t/4,h[u]+t/4);e.restore()}static drawOptions(e){var t=FIELD.tileWidth,i=FIELD.tileHeight,a=t*(FIELD.cols-5.25),r=i*(FIELD.rows/2),s=(FIELD.tileWidth,FIELD.tileHeight,FIELD.tileWidth,1.4*FIELD.tileHeight),o=.4*FIELD.tileWidth,n=r-s;if(FIELD.isCleanSlate){h=["start","options","about"];e.setTransform(1,0,0,1,0,0),e.textBaseline="middle",e.textAlign="center",e.fillStyle="antiquewhite";for(d=0;d<3;d++){if("titlebutton"===STATE.under.type&&STATE.under.i0===d){u=.3+.05*Math.cos(4*TIMER.blinkRatio*Math.PI);e.font=u*FIELD.tileWidth+"px Courier New"}else e.font=.3*FIELD.tileWidth+"px Courier New";e.fillText(h[d],a/2,n+d*o-.1*FIELD.tileWidth)}}else{var l=[-.15*t,.1*t,.1*t],h=["continue","options","about"];e.setTransform(1,0,0,1,0,0),e.textBaseline="middle",e.textAlign="center",e.fillStyle="antiquewhite";for(var d=0;d<3;d++){if("titlebutton"===STATE.under.type&&STATE.under.i0===d){var u=.3+.03*Math.cos(4*TIMER.blinkRatio*Math.PI);e.font=u*FIELD.tileWidth+"px Courier New"}else e.font=.3*FIELD.tileWidth+"px Courier New";e.fillText(h[d],a/2,n+d*o+l[d])}e.fillStyle="#ff4551",e.font=Math.round(.18*FIELD.tileWidth)+"px Courier New",e.fillText("employee#"+PERSIST0.generic.nameTag,a/2,n+.13*t)}}static drawPath(e,t,i,a,r,s,o=32,n=32){e.setTransform(1,0,0,1,0,0),e.scale(r/o,s/n),e.translate(o*i/r,n*a/s);for(var l=0;l<t.length;l++)t[l].fill&&(e.fillStyle=t[l].fill,e.fill(t[l].path)),t[l].stroke&&(e.lineCap=t[l].lineCap,e.lineWidth=t[l].lineWidth,e.strokeStyle=t[l].stroke,e.stroke(t[l].path))}static findPath(e){var t=6,i=FIELD.tileWidth,a=2*i;if(OPTS.fancyGears)var r=GRADS.gears;else r="#222";var s=PathsX.gear(e,2*Math.PI*TIMER.popRatio/t,t,r);Gears.drawPath(e,s,-.7*i,.5*i,a,a),Gears.drawPath(e,s,-.7*i,6.5*i,a,-a),Gears.drawPath(e,s,14.5*i,.5*i,-a,a),Gears.drawPath(e,s,14.5*i,6.5*i,-a,-a);s=PathsX.gear(e,-Math.PI/2-2*Math.PI*TIMER.popRatio/t,t,r);Gears.drawPath(e,s,.5*i,-.7*i,a,a),Gears.drawPath(e,s,.5*i,7.7*i,a,-a),Gears.drawPath(e,s,13.3*i,-.7*i,-a,a),Gears.drawPath(e,s,13.3*i,7.7*i,-a,-a)}}class Graphics{static initFlares(){FLARES.max=200,FLARES.amount=75,FLARES.start=[],FLARES.travel=[],FLARES.lifetimes=[],FLARES.dotsizes=[],FLARES.x0=[],FLARES.y0=[];for(var e=0;e<FLARES.max;e++){var t=2*Math.PI*Math.random();FLARES.x0.push(Math.cos(t)),FLARES.y0.push(Math.sin(t)),FLARES.start.push(0+.5*Math.random()),FLARES.travel.push(.25+1*Math.random()),FLARES.lifetimes.push(.5+.5*Math.random()),FLARES.dotsizes.push(.5+.5*Math.random())}FLARES.colors0=["#3cd73c","limegreen","#007d00","lime","#0aff0a","#00af00"],FLARES.colors1=["#8c0000","crimson","#e61e46","darkred","#950a0a","#8c1700"]}static init(){OPTS.useShads=OPTS.fancyGraphics,OPTS.useGrads=OPTS.fancyGraphics,OPTS.useSnappers=OPTS.fancyGraphics,OPTS.useGrads?(GRADS.gears=CANV.title.ctx.createRadialGradient(24,24,1,16,16,16),GRADS.gears.addColorStop(0,"#666"),GRADS.gears.addColorStop(.2,"#444"),GRADS.gears.addColorStop(1,"black"),GRADS.gates=CANV.base.ctx.createRadialGradient(8,8,1,16,16,16),GRADS.gates.addColorStop(0,"#666"),GRADS.gates.addColorStop(.2,"#444"),GRADS.gates.addColorStop(1,"black"),GRADS.glow=CANV.base.ctx.createRadialGradient(8,8,1,16,16,16),GRADS.glow.addColorStop(0,flashColor("#666",.2)),GRADS.glow.addColorStop(.2,flashColor("#444",.2)),GRADS.glow.addColorStop(1,flashColor("black",.2)),GRADS.flame=CANV.base.ctx.createLinearGradient(0,0,32,32),GRADS.flame.addColorStop(0,"CornflowerBlue"),GRADS.flame.addColorStop(.4,"CornflowerBlue"),GRADS.flame.addColorStop(.6,"#d92b2b"),GRADS.flame.addColorStop(1,"#d92b2b")):(GRADS.gears="#222",GRADS.gates="#222",GRADS.glow="#444",GRADS.flame="darkmagenta")}}class Halo{static drawReduced(e,t,i,a){e.save();var r=3*SEL_STYLES.r0/4;Halo.drawRing(e,t,i,r),Halo.drawRingDivs(e,t,i,r,16),"analysisgatecontrol"===STATE.under.type||"analysisgatecontrolling"===STATE.state?e.fillStyle=SEL_STYLES.color2:e.fillStyle=SEL_STYLES.color,e.beginPath(),e.strokeStyle="black",e.lineWidth=1,e.arc(-r*Math.cos(a+Math.PI/2)+t,-r*Math.sin(a+Math.PI/2)+i,SEL_STYLES.handleRad,0,2*Math.PI),e.fill(),e.stroke(),e.restore()}static drawRing(e,t,i,a){e.save(),e.beginPath(),e.lineWidth=1*FIELD.tileWidth/48,e.strokeStyle="seagreen",e.arc(t,i,a,0,2*Math.PI),e.stroke(),e.beginPath();var r=[SEL_STYLES.lineDash,SEL_STYLES.lineGap];e.setLineDash(r),e.lineDashOffset=(SEL_STYLES.lineDash+SEL_STYLES.lineGap)*TIMER.dashRatio,e.lineWidth=1*FIELD.tileWidth/48,e.strokeStyle="#333",e.arc(t,i,a,0,2*Math.PI),e.stroke(),e.restore()}static drawRingDivs(e,t,i,a,r){e.save(),e.strokeStyle=SEL_STYLES.color1,e.lineCap="round",e.lineWidth=FIELD.tileWidth/8,e.beginPath();for(var s=0;s<r;s++){var o=2*s*Math.PI/r;e.moveTo(-a*Math.sin(o)+t,-a*Math.cos(o)+i),e.lineTo(-(a-.5)*Math.sin(o)+t,-(a-.5)*Math.cos(o)+i)}e.stroke(),e.restore()}static drawRingControl(e,t,i,a,r,s){var o=1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio);e.save(),e.beginPath(),e.fillStyle=s,e.strokeStyle="black",e.lineWidth=FIELD.tileWidth/48,e.arc(t+a*Math.sin(r),i-a*Math.cos(r),o*SEL_STYLES.handleRad,0,2*Math.PI),e.fill(),e.stroke(),e.restore()}static drawSwitchIconSimple(e,t,i){var a=1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio),r=-(a-1)/2*FIELD.iconWidth,s=-(a-1)/2*FIELD.iconHeight,o=3.5*FIELD.tileWidth/12,n=PathsI.icon(e,"switchIcon",{hover:!1});n.draw(e,t-FIELD.iconWidth/2-o+r,i-o-FIELD.iconWidth/2+s,a*FIELD.iconWidth,a*FIELD.iconHeight)}static drawIcons(e,t,i,a=0){var r=0,s=0,o=0,n=0,l=0,h=0,d=0,u=0;if("gateicon"===STATE.pressed.type){var c=TIMER.totalTime-STATE.pressed.i0;c>TIMER.iconMax&&(STATE.pressed={type:"none",i0:0,j0:0,k0:0})}if("gateicon"===STATE.pressed.type){var I=.5*(1-Math.cos(2*Math.PI*(c/TIMER.iconMax)))*(FIELD.tileWidth/48);0===STATE.pressed.k0?(r=3*I/4,l=7*I/4):1===STATE.pressed.k0?(s=3*I/4,h=7*I/4):2===STATE.pressed.k0?(o=3*I/4,d=7*I/4):4===STATE.pressed.k0?(n=3*I/4,u=7*I/4):5===STATE.pressed.k0&&(3*I/4,7*I/4)}if(a)var E=a;else E=STATE.grab;var f=1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio),S=-(f-1)/2*FIELD.iconWidth,p=-(f-1)/2*FIELD.iconHeight;if("cCreate"===E.type||"qCreate"===E.type){var T=!1,R=!1,m=!1;"gateicon"===STATE.under.type&&(0===STATE.under.k0?T=!0:1===STATE.under.k0?R=!0:2===STATE.under.k0&&(m=!0));var g=PathsI.icon(e,"minusIcon",{hover:T});g.draw(e,r+t-FIELD.iconWidth/2-FIELD.tileWidth/3+S,l+i+FIELD.tileWidth/3+p,f*FIELD.iconWidth,f*FIELD.iconHeight);g=PathsI.icon(e,"plusIcon",{hover:R});if(g.draw(e,s+t-FIELD.iconWidth/2+FIELD.tileWidth/3+S,h+i+FIELD.tileWidth/3+p,f*FIELD.iconWidth,f*FIELD.iconHeight),"qCreate"===E.type){var A=5===E.k0.state;g=PathsI.icon(e,"lockIcon",{hover:m,state:A});g.draw(e,o+t-FIELD.iconWidth/2-FIELD.tileWidth/3+S,d+i-1.8*FIELD.tileWidth/3+p,f*FIELD.tileWidth/3,f*FIELD.tileHeight/3)}}else if(["cInvert","trash","qFlip"].indexOf(E.type)>=0){var C=!1;"gateicon"===STATE.under.type&&1===STATE.under.k0&&(C=!0);g=PathsI.icon(e,"switchIcon",{hover:C});g.draw(e,s+t-FIELD.iconWidth/2+FIELD.tileWidth/3+S,h+i+FIELD.tileWidth/3+p,f*FIELD.iconWidth,f*FIELD.iconHeight)}else if("qControl"===E.type);else if("switch"===E.type){C=!1;"gateicon"===STATE.under.type&&4===STATE.under.k0&&(C=!0);var L=3.5*FIELD.tileWidth/12;g=PathsI.icon(e,"switchIcon",{hover:C});g.draw(e,n+t-FIELD.iconWidth/2-L+S,u+i-L-FIELD.iconWidth/2+p,f*FIELD.iconWidth,f*FIELD.iconHeight)}}static draw(e,t=0){var i="gatemanip"===STATE.state||"gatedrag"===STATE.state;if(i||0!==t){if(t)var a=t;else a=STATE.grab;if("switch"===a.type)var r=3*SEL_STYLES.r0/4;else if("qControl"===a.type)r=3*SEL_STYLES.r0/4;else r=SEL_STYLES.r0;var s=IBOARD.x0+(a.i0+.5)*FIELD.tileWidth,o=IBOARD.y0+(a.j0+.5)*FIELD.tileHeight;Halo.drawRing(e,s,o,r),Halo.drawIcons(e,s,o,t);var n=a.k0,l=n.numPoints;Halo.drawRingDivs(e,s,o,r,l);var h=!0;if(["cInvert","switch","trash"].indexOf(a.type)>=0&&(h=!1),"qFlip"===a.type&&1===n.state&&(h=!1),h)if("gatedrag"===STATE.state){if(["cCombine","qCombine","cSplit"].indexOf(a.type)>=0)var d=n.rot+Math.PI/2;else if(["cCreate","qCreate"].indexOf(a.type)>=0)d=2*n.rot*Math.PI/3;else if(["delay"].indexOf(a.type)>=0)d=(.5*n.rot+.5*n.state)*Math.PI/2;else d=n.rot;Halo.drawRingControl(e,s,o,r,d,SEL_STYLES.color2)}else{if(["cCombine","qCombine","cSplit"].indexOf(a.type)>=0){var u=(n.orient+2)%4;d=(u-1)*Math.PI/2}else if(["cCreate","qCreate"].indexOf(a.type)>=0)d=2*n.rot*Math.PI/3;else if(["delay"].indexOf(a.type)>=0)d=n.state*Math.PI/4;else d=n.rot;"gatecontrol"===STATE.under.type?Halo.drawRingControl(e,s,o,r,d,SEL_STYLES.color2):Halo.drawRingControl(e,s,o,r,d,SEL_STYLES.color)}}}}class Helper{static random(){if(RANDS.tick>=0){var e=RANDS.all[RANDS.locs[RANDS.tick]+RANDS.count];return RANDS.count+=1,void 0===e&&(e=Math.random(),console.log("RNG OVERFLOW!!!!!")),e}return Math.random()}
static sideIntroLaser(e,t){var i=e.ctx,a=t.ctx,r=e.x0,s=e.y0,o=FIELD.tileWidth/6,n=TIMER.construct/TIMER.constructMax,l=.5-.5*Math.cos(Math.PI*n),h=e.w0,d=e.h0,u=.05*d+.9*d*(1-l),c=.6*FIELD.tileWidth;if((n<.2||n>.8)&&(c=5*c*Math.min(1-n,n)),i.globalCompositeOperation="destination-out",i.beginPath(),i.rect(0,0,h,u),i.fill(),i.globalCompositeOperation="source-over","constructing"===STATE.mode){a.globalAlpha=1,a.globalCompositeOperation="source-over";var I=o;n<.4&&(I*=n/.4),a.fillStyle="black",a.beginPath(),a.moveTo(r+o,s+u-c/2),a.quadraticCurveTo(r+o-I,s+u,r+o,s+u+c/2),a.closePath(),a.fill(),a.beginPath(),a.moveTo(r+h-o,s+u-c/2),a.quadraticCurveTo(r+h-o+I,s+u,r+h-o,s+u+c/2),a.closePath(),a.fill();var E=a.createLinearGradient(r,s+u-c/2,r,s+u+c/2);E.addColorStop(0,"rgba(255,255,255,0.0)"),E.addColorStop(.2,"rgba(0,0,255,0.4)"),E.addColorStop(.5,"rgba(0,255,255,0.7)"),E.addColorStop(.8,"rgba(0,0,255,0.4)"),E.addColorStop(1,"rgba(255,255,255,0.0)"),(n<.2||n>.8)&&(a.globalAlpha=Math.min(1,Math.abs(5*Math.min(1-n,n)))),a.fillStyle=E,a.beginPath(),a.rect(r+o,s+u-c/2,h-2*o,c),a.fill()}}static introLaser(e,t){var i=e.ctx,a=t.ctx,r=TIMER.construct/TIMER.constructMax,s=.5-.5*Math.cos(Math.PI*r),o=2*OVERLAY.margin+FIELD.tileWidth*FIELD.cols,n=.7*o*s,l=FIELD.topMargin-OVERLAY.margin,h=2*OVERLAY.margin+FIELD.tileHeight*FIELD.rows,d=.6*FIELD.tileWidth,u=.3*FIELD.tileWidth;(r<.2||r>.8)&&(d=5*d*Math.min(1-r,r)),r<.4&&(u=2.5*u*Math.min(1-r,r));var c=FIELD.leftMargin-OVERLAY.margin+FIELD.leftPad+n,I=FIELD.leftMargin-OVERLAY.margin+FIELD.leftPad+o-n;if(c<I&&(i.globalCompositeOperation="destination-out",i.beginPath(),i.rect(c-FIELD.leftPad,l,Math.abs(I-c),h),i.fill(),i.globalCompositeOperation="source-over"),"constructing"===STATE.mode){a.globalAlpha=1,a.globalCompositeOperation="source-over",a.fillStyle="black",a.beginPath(),a.moveTo(c-d/2,FIELD.topPad+l),a.quadraticCurveTo(c,FIELD.topPad+l-u,c+d/2,FIELD.topPad+l),a.closePath(),a.moveTo(c-d/2,FIELD.topPad+l+h),a.quadraticCurveTo(c,FIELD.topPad+l+u+h,c+d/2,FIELD.topPad+l+h),a.closePath(),a.moveTo(I-d/2,FIELD.topPad+l),a.quadraticCurveTo(I,FIELD.topPad+l-u,I+d/2,FIELD.topPad+l),a.closePath(),a.moveTo(I-d/2,FIELD.topPad+l+h),a.quadraticCurveTo(I,FIELD.topPad+l+u+h,I+d/2,FIELD.topPad+l+h),a.closePath(),a.fill();var E=a.createLinearGradient(c-d/2,FIELD.topPad+l,c+d/2,FIELD.topPad+l);E.addColorStop(0,"rgba(255,255,255,0.0)"),E.addColorStop(.2,"rgba(0,0,255,0.4)"),E.addColorStop(.5,"rgba(0,255,255,0.7)"),E.addColorStop(.8,"rgba(0,0,255,0.4)"),E.addColorStop(1,"rgba(255,255,255,0.0)");var f=a.createLinearGradient(I-d/2,FIELD.topPad+l,I+d/2,FIELD.topPad+l);f.addColorStop(0,"rgba(255,255,255,0.0)"),f.addColorStop(.2,"rgba(0,0,255,0.4)"),f.addColorStop(.5,"rgba(0,255,255,0.7)"),f.addColorStop(.8,"rgba(0,0,255,0.4)"),f.addColorStop(1,"rgba(255,255,255,0.0)"),(r<.2||r>.8)&&(a.globalAlpha=Math.min(1,Math.abs(5*Math.min(1-r,r)))),a.fillStyle=E,a.beginPath(),a.rect(c-d/2,FIELD.topPad+l,d,h),a.fill(),a.fillStyle=f,a.beginPath(),a.rect(I-d/2,FIELD.topPad+l,d,h),a.fill()}}static openExternalLink(e){["constructing","running","paused","robot"].includes(STATE.mode)&&65===e.keyCode&&PERSIST0[SCENARIO.name].complete&&SCENARIO.archive&&window.open(SCENARIO.archive,"_blank")}static pasteCurrentBoard(e){"constructing"===STATE.mode?(86===e.keyCode&&(e.ctrlKey||e.metaKey)&&("function"==typeof navigator.clipboard.readText?navigator.clipboard.readText().then(e=>Helper.tryImportLayout(e)):(console.log("Browser does not support import from clipboard."),FIELD.message="Unsupported in Current Browser!",TIMER.message=TIMER.messageMax,SFX.invalid.play())),220===e.keyCode&&e.shiftKey&&(e.ctrlKey||e.metaKey)&&navigator.clipboard.readText().then(e=>Helper.importFactory(JSON.parse(e),!0))):"levelSelect"===STATE.mode&&86===e.keyCode&&(e.ctrlKey||e.metaKey)&&("function"==typeof navigator.clipboard.readText?navigator.clipboard.readText().then(e=>Helper.importSave(JSON.parse(e))):(console.log("Browser does not support import from clipboard."),FIELD.message="Unsupported in Current Browser!",TIMER.message=TIMER.messageMax,SFX.invalid.play()))}static copyCurrentBoard(e){if("constructing"===STATE.mode){if(67===e.keyCode&&(e.ctrlKey||e.metaKey)){for(var t=[],i=0;i<IBOARD._gateList.length;i++)t.push(IBOARD._gateList[i].pack());var a=[];for(i=0;i<IBOARD._qubitList.length;i++)a.push(IBOARD._qubitList[i].pack());var r=[];for(i=0;i<IBOARD._bitList.length;i++)r.push(IBOARD._bitList[i].pack());var s=IBOARD._tiles;FIELD.developerMode&&(console.log(JSON.stringify(s)),console.log(JSON.stringify(t)),console.log(JSON.stringify(a)),console.log(JSON.stringify(r)));const e=JSON.stringify({name:SCENARIO.title,tag:SCENARIO.whichOne,version:FIELD.version,tiles:s,gates:t});return console.log(e),FIELD.message="Factory Copied!",TIMER.message=TIMER.messageMax,e}}else if("levelSelect"===STATE.mode&&67===e.keyCode&&(e.ctrlKey||e.metaKey)){var o=LEVELS.names.length,n={},l={};n.generic=localStorage.getItem("generic"),l.generic=Helper.makeCheckFancy(JSON.stringify(localStorage.getItem("generic")));for(var h=0;h<o;h++){var d=localStorage.getItem(LEVELS.names[h]+"0");d&&(l[LEVELS.names[h]]=Helper.makeCheckFancy(JSON.stringify(d)),n[LEVELS.names[h]]=d)}return n.generic1=l,FIELD.message="Profile Copied!",TIMER.message=TIMER.messageMax,JSON.stringify(n)}return 0}static checkSubsequence(e,t){for(var i=e.length,a=t.length,r=0;r<i-a;r++){for(var s=!0,o=0;o<a;o++)t[o]!==e[r+o]&&(s=!1);if(s)return!0}return!1}static genSequenceBits(e,t=!0,i=!1){for(var a=0,r=[],s=0;s<e-5;s++){var o=Math.round(Math.random());0===o?a=0:a++,4===a&&(o=0,a=0),r.push(o)}r.push(0),r.push(1),r.push(1),r.push(1),r.push(1);var n=[];if(t){if(i)var l=e-9;else l=Math.floor((e-9)*Math.random());for(s=0;s<9;s++)n.push(r[l+s])}else{for(s=0;s<9;s++)n.push(Math.round(Math.random()));for(var h=Helper.checkSubsequence(r,n),d=0;h&&d<100;){var u=Math.floor(9*Math.random());n[u]=1-n[u],h=Helper.checkSubsequence(r,n),d++}}return[r,n]}static countCleanTiles(e){for(var t=0,i=1;i<FIELD.cols-1;i++)for(var a=1;a<FIELD.rows-1;a++){var r=i+a*FIELD.cols;-1===e[r]&&(t+=1)}return t}static tryImportLayout(e){try{var t=JSON.parse(e);t&&"object"==typeof t&&Helper.importFactory(t)}catch(e){console.log("Invalid JSON import"),FIELD.message="Invalid Import!",TIMER.message=TIMER.messageMax,SFX.invalid.play()}}static makeCheckHash(e){for(var t=0,i=0;i<e.length;i++)i%2==0?t+=e.charCodeAt(i):t-=e.charCodeAt(i);return t}static makeCheckFancy(e){for(var t=0,i=0,a=0,r=0;r<e.length;r++)r%2==0?(t+=e.charCodeAt(r),i+=2*e.charCodeAt(r),a+=7*e.charCodeAt(r)):(t-=e.charCodeAt(r),i-=3*e.charCodeAt(r),i-=5*e.charCodeAt(r));return[t,i,a]}static makeCheckDigit(e=SCENARIO.whichOne){var t=LevelGates(e,!1,0);if(!t)return[-9,-9];for(var i=0,a=0;a<FIELD.cols;a++)i+=t.tiles[a],i+=t.tiles[a+(FIELD.rows-1)*FIELD.cols];for(var r=0;r<FIELD.rows;r++)i+=t.tiles[0+r*FIELD.cols],i+=t.tiles[FIELD.cols-1+r*FIELD.cols];for(var s=0,o=0;o<t.allGates.length;o++){var n=t.allGates[o];s+=n[0]+n[1]-Helper.makeCheckHash(n[2])+Math.floor(10*n[4])+Math.floor(10*n[5])+n[6]+n[7]}return[i,s]}static checkImportFactory(e){if("freeA"===e)return!0;if(e!==SCENARIO.whichOne)return!1;var t=LEVELS.names.indexOf(e);if(t<0)return!1;var i=Helper.makeCheckDigit(SCENARIO.whichOne);return console.log(i),console.log(LEVELS.tileHash[t]),console.log(LEVELS.gateHash[t]),i[0]===LEVELS.tileHash[t]&&i[1]===LEVELS.gateHash[t]}static importFactory(e,t=!1){if(!t){var i=Helper.checkImportFactory(e.tag);if(!i)return FIELD.message="Invalid Import!",TIMER.message=TIMER.messageMax,void SFX.invalid.play()}IBOARD=new Board(CANV.interface.ctx,FIELD.cols,FIELD.rows);var a=LevelGates(e.tag);IBOARD.setAllBits(a.allBits,a.allQubits,a.entGroups),IBOARD.setAllGates(e.gates),IBOARD._tiles=e.tiles,LevelRefresh(SCENARIO.name,IBOARD),FIELD.message="Factory Imported!",TIMER.message=TIMER.messageMax,UNDOREDO.add(),SFX.click2.play()}static checkImport(e){for(var t=e.generic1,i=Object.getOwnPropertyNames(t),a=0;a<i.length;a++){var r=i[a],s=e[r];if(!s)return!1;var o=Helper.makeCheckFancy(JSON.stringify(s)),n=t[r],l=o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2];if(!l)return!1}return!0}static importSave(e){var t=Helper.checkImport(e);if(!t)return FIELD.message="Invalid Import!",void(TIMER.message=TIMER.messageMax);for(var i=e.generic1,a=Object.getOwnPropertyNames(i),r=0;r<a.length;r++){var s=a[r],o=e[s];"generic"===s?o&&localStorage.setItem(s,o):o&&localStorage.setItem(s+"0",o)}InitScenario.loadAll(),SCENARIO.whichOne="levelSelect",SCENARIO.solution=!1,InitScenario.load(SCENARIO.whichOne,SCENARIO.solution),FIELD.message="Profile Imported!",TIMER.message=TIMER.messageMax}static findStringDifference(e,t){for(var i="",a=[],r=0;r<Math.min(e.length,t.length);r++)e[r]!==t[r]&&(i+=e[r],a.push(r));return{diffs:i,locs:a}}static findStorageSize(){var e,t=0;for(e in localStorage)localStorage.hasOwnProperty(e)&&(t+=2*(localStorage[e].length+e.length));console.log("Total Storage = "+(t/1024).toFixed(2)+" KB")}static drawToggles(){CANV.toggles.clear();var e=CANV.toggles.ctx;if("title"===STATE.mode)var t=FIELD.tileWidth/2;else t=FIELD.tileWidth;var i=[!1,!1,!1];"escbutton"===STATE.under.type&&(i[STATE.under.i0]=!0),"title"===STATE.mode?(PathsI.musicIcon(e,OPTS.musicOn,i[1]).draw(e,t/3,1*t/3,.3*t,.3*t),PathsI.sfxIcon(e,OPTS.sfxOn,i[2]).draw(e,t/3,2.25*t/3,.3*t,.3*t)):(PathsI.escIcon(e,i[0]).draw(e,t/3,t/3,.3*t,.3*t),PathsI.musicIcon(e,OPTS.musicOn,i[1]).draw(e,t/3,2.25*t/3,.3*t,.3*t),PathsI.sfxIcon(e,OPTS.sfxOn,i[2]).draw(e,t/3,3.5*t/3,.3*t,.3*t))}static generateName(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ9",t="0123456789",i="",a=0;a<4;a++)i+=e.charAt(Math.floor(Math.random()*e.length));for(a=0;a<2;a++)i+=t.charAt(Math.floor(Math.random()*t.length));return i}static fiberBoxPath(e,t,i,a,r,s){e.save(),e.fillStyle="#2b2b2b",e.strokeStyle="#000",e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fill(t),e.stroke(t),e.restore(),e.save(),e.clip(t,"evenodd"),Textures.drawFiber(e,i,a,r,s,FIELD.tileWidth/48,.5),e.restore()}static fiberBox(e,t,i,a,r,s,o=!0,n=48){var l=[t,t,t+a,t+a],h=[i,i+r,i+r,i],d=[s,s,s,s],u=new Path2D(Helper.makeRoundedPath(l,h,d,1,0,0));e.save(),e.fillStyle="#2b2b2b",e.strokeStyle="#000",o?(e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f"):e.shadowColor="transparent",e.fill(u),e.stroke(u),e.restore(),e.save(),e.clip(u,"evenodd"),Textures.drawFiber(e,t,i,a,r,FIELD.tileWidth/n,.5),e.restore()}static renderOverlay(e,t){var i=new Path2D(makeOverlayPattern());e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="#304347",e.fill(t,"evenodd"),e.lineWidth=1,e.strokeStyle="black",e.stroke(t),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(t,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(i),e.translate(4040,0),e.fill(i),e.translate(0,4040),e.fill(i),e.translate(-4040,0),e.fill(i),e.translate(8080,-4040),e.fill(i),e.translate(0,4040),e.fill(i),e.restore()}static esc(){if("title"!==STATE.mode)if("tutorial"===STATE.mode)SFX.click.play(),TutControl.close();else if("robot"===STATE.mode)SFX.click.play(),STATE.mode=ROBOT.oldMode,ROBOT.oldMode="none",STATE.state="free",STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},"constructing"===STATE.mode&&-1!==MENU.selected&&(STATE.state="placing"),CANV.robotBase.deactivate(),CANV.robotScreen.deactivate(),CANV.robotScreenBase.deactivate(),CANV.robotText.deactivate(),CANV.robotButton.deactivate();else if("levelSelect"===STATE.mode){SFX.select2.play(),ROBOT.oldMode="none";var e=2*ResetConsts.resize();SCENARIO.whichOne="title",InitScenario.load("title"),FIELD.tileWidth=e,FIELD.tileHeight=e,ResetConsts.title(),TIMER.resize=-1}else SFX.select2.play(),ROBOT.oldMode="none",PERSIST0[SCENARIO.name].tiles[STATE.blueprint]=[...IBOARD._tiles],PERSIST0[SCENARIO.name].gates[STATE.blueprint]=IBOARD.getAllGates(),Storage.save(PERSIST0[SCENARIO.name],SCENARIO.name,0),InitScenario.load("levelSelect",!1),SCENARIO.whichOne="levelSelect",STATE.state="free",STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1};else"options"===STATE.state?STATE.state="free":"confirming"===STATE.state&&(STATE.state="options",document.getElementById("greyoverlay").style.visibility="hidden",CANV.confirm.deactivate())}static arrowHead(e,t,i,a,r){var s=[t+a*Math.cos(r),t+a*Math.cos(r+2*Math.PI/3),t+a*Math.cos(r+4*Math.PI/3)],o=[i+a*Math.sin(r),i+a*Math.sin(r+2*Math.PI/3),i+a*Math.sin(r+4*Math.PI/3)];e.moveTo(s[0],o[0]),e.lineTo(s[1],o[1]),e.lineTo(s[2],o[2]),e.lineTo(s[0],o[0])}static squareBracket(e,t,i){var a=FIELD.tileWidth,r=FIELD.tileHeight;e.moveTo((t+.1)*a,(i-1.2)*r),e.lineTo((t-.1)*a,(i-1.2)*r),e.lineTo((t-.1)*a,(i+1.2)*r),e.lineTo((t+.1)*a,(i+1.2)*r),e.moveTo((t+.7)*a,(i-1.2)*r),e.lineTo((t+.9)*a,(i-1.2)*r),e.lineTo((t+.9)*a,(i+1.2)*r),e.lineTo((t+.7)*a,(i+1.2)*r)}static checkFlipAlign(){for(var e=IBOARD.gateList,t=!0,i=0;i<e.length;i++)if("qFlip"===e[i].type&&0===e[i].layer){var a=Math.round(e[i].rot/Math.PI*8);a<0&&(a+=16),a>15&&(a-=16),console.log(a),0!==a&&4!==a&&8!==a&&12!==a||(t=!1)}return t}static countGates(e=0){for(var t=IBOARD.gateList,i=0,a=0;a<t.length;a++){var r=!0;"cCreate"===t[a].type&&0!==t[a].state?r=!1:"qCreate"===t[a].type?r=!1:"compare"===t[a].type||"qCompare"===t[a].type?r=!1:0!==t[a].layer&&(r=!1),e&&e.indexOf(t[a].type)<0&&(r=!1),r&&(i+=1)}return i}static boundAngle(e){var t=1e-4;return e<=-Math.PI+t&&(e+=2*Math.PI),e>Math.PI+t&&(e-=2*Math.PI),e}static resetBackground(){document.getElementById("overback").style.display="block"}static coordFromDir(e,t){var i=e.i0,a=e.j0;if(0===t)i-=1;else if(1===t)a-=1;else if(2===t)i+=1;else{if(3!==t)return 0;a+=1}return{i1:i,j1:a}}static getTileEdge(e,t,i){var a=e+t*i._width,r=i._tiles[a];if(r<0)return 0;var s=Math.floor(r/20),o=r%20;if(s<6)var n=TILE_EDGES[s][o];else n=0;return n}static pathFromCoord(e,t,i=!0){for(var a="M "+e[0]+" "+t[0],r=1;r<e.length;r++)a+=" L "+e[r]+" "+t[r];return a+=i?" Z":" ",a}static roundRect(e,t,i,a,r){var s=[e,e,e+i,e+i],o=[t,t+a,t+a,t],n=[r,r,r,r];return new Path2D(Helper.makeRoundedPath(s,o,n))}static makeCurve(e,t,i,a,r){var s=i-e,o=a-t,n=e+s/2,l=t+o/2,h=Math.atan2(o,s),d=n-Math.sin(h)*r,u=l-Math.cos(h)*r,c=" ";return c+="Q "+d+" "+u+" "+i+" "+a,c}static makeRoundedPath(e,t,i,a=1,r=0,s=0){var o="",n=e.length,l=0,h=0,d=0,u=0,c=0,I=0,E=0,f=0,S=0,p=0,T=0,R=0,m=0;if(r*=a,s*=a,0===i[0]){o=o+"M "+(a*e[0]+r)+" "+(a*t[0]+s);var g=a*e[0]+r,A=a*t[0]+s}else{l=e[0]-e[n-1],h=t[0]-t[n-1],d=Math.sqrt(l**2+h**2),u=e[0]-e[1],c=t[0]-t[1],I=Math.sqrt(u**2+c**2),E=i[0],E>d&&(E=d),E>I&&(E=I),f=e[n-1]+(d-E)/d*l,S=t[n-1]+(d-E)/d*h,p=e[1]+(I-E)/I*u,T=t[1]+(I-E)/I*c,m=Math.atan2(c,u)-Math.atan2(h,l),m<0&&(m+=2*Math.PI),R=m>Math.PI?1:0,o=o+" M "+(a*f+r)+" "+(a*S+s),o=o+" a "+a*E*Math.tan(m/2)+" "+a*E*Math.tan(m/2)+" 0 0 "+R+" "+a*(p-f)+" "+a*(T-S);g=a*f+r,A=a*S+s}for(var C=1;C<n-1;C++)0===i[C]?o=o+" L "+(a*e[C]+r)+" "+(a*t[C]+s):(l=e[C]-e[C-1],h=t[C]-t[C-1],d=Math.sqrt(l**2+h**2),u=e[C]-e[C+1],c=t[C]-t[C+1],I=Math.sqrt(u**2+c**2),E=i[C],E>d&&(E=d),E>I&&(E=I),f=e[C-1]+(d-E)/d*l,S=t[C-1]+(d-E)/d*h,p=e[C+1]+(I-E)/I*u,T=t[C+1]+(I-E)/I*c,m=Math.atan2(c,u)-Math.atan2(h,l),m<0&&(m+=2*Math.PI),R=m>Math.PI?1:0,o=o+" L "+(a*f+r)+" "+(a*S+s),o=o+" a "+a*E*Math.tan(m/2)+" "+a*E*Math.tan(m/2)+" 0 0 "+R+" "+a*(p-f)+" "+a*(T-S));return 0===i[n-1]?o=o+" L "+(a*e[n-1]+r)+" "+(a*t[n-1]+s):(l=e[n-1]-e[n-2],h=t[n-1]-t[n-2],d=Math.sqrt(l**2+h**2),u=e[n-1]-e[0],c=t[n-1]-t[0],I=Math.sqrt(u**2+c**2),E=i[n-1],E>d&&(E=d),E>I&&(E=I),f=e[n-2]+(d-E)/d*l,S=t[n-2]+(d-E)/d*h,p=e[0]+(I-E)/I*u,T=t[0]+(I-E)/I*c,m=Math.atan2(c,u)-Math.atan2(h,l),m<0&&(m+=2*Math.PI),R=m>Math.PI?1:0,o=o+" L "+(a*f+r)+" "+(a*S+s),o=o+" a "+a*E*Math.tan(m/2)+" "+a*E*Math.tan(m/2)+" 0 0 "+R+" "+a*(p-f)+" "+a*(T-S)),o=o+" L "+g+" "+A+" ",o}static parseTextColored(e,t,i){var a=t.split(" "),r=[],s=[],o=[],n=[],l=[],h=[],d="",u="",c="",I="",E="",f="",S=a[0],p="w";if("$"===S[0]&&"$"===S[1]){p=S[2],S=S.slice(4);var T=" ".repeat(S.length)}else T=" ".repeat(S.length);var R=T,m=T,g=T,A=T,C=T,L=T;"w"===p?R=S:"r"===p?m=S:"g"===p?g=S:"b"===p?A=S:"d"===p?C=S:"p"===p&&(L=S),d+=R,u+=m,c+=g,I+=A,E+=C,f+=L;for(var D=1;D<a.length;D++){S=a[D],p="w";if("$"===S[0]&&"$"===S[1]){p=S[2],S=S.slice(4);T=" ".repeat(S.length)}else T=" ".repeat(S.length);R=T,m=T,g=T,A=T,C=T,L=T;"w"===p?R=S:"r"===p?m=S:"g"===p?g=S:"b"===p?A=S:"d"===p?C=S:"p"===p&&(L=S);var b=e.measureText(d+" "+S).width;b<i?(d=d+" "+R,u=u+" "+m,c=c+" "+g,I=I+" "+A,E=E+" "+C,f=f+" "+L):(r.push(d),s.push(u),o.push(c),n.push(I),l.push(E),h.push(f),d=R,u=m,c=g,I=A,E=C,f=L)}return r.push(d),s.push(u),o.push(c),n.push(I),l.push(E),h.push(f),[r,s,o,n,l,h]}static parseText(e,t,i){for(var a=t.split(" "),r=[],s=a[0],o=1;o<a.length;o++){var n=a[o],l=e.measureText(s+" "+n).width;l<i?s=s+" "+n:(r.push(s),s=n)}return r.push(s),r}static dist(e,t){return Math.sqrt(e**2+t**2)}static distsqd(e,t){return e**2+t**2}static inner(e,t){for(var i=e.length,a=0,r=0;r<i;r++)a+=e[r]*t[r];return a}static clearCanvas(e){var t=e.width,i=e.height;e.getContext("2d").clearRect(0,0,t,i),e.getContext("2d").save()}}class InitScenario{static load(e,t=!1){STATE.mode="constructing",STATE.state="free",STATE.under={type:"none",i0:-1,j0:-1,k0:-1},FIELD.cols=19,FIELD.rows=14,FIELD.topEntry=FIELD.rows/2-2,FIELD.bottomEntry=FIELD.rows/2,FIELD.entryPoints=[5*FIELD.cols,8*FIELD.cols,6*FIELD.cols-1],FIELD.maxBonusTiles=2,FIELD.lastLoc="none",FIELD.cameraX=0,FIELD.cameraY=0,FIELD.channels=[0,0,0,0,0,0],FIELD.channelsTrig=[0,0,0,0,0,0],SCENARIO.name=e,SCENARIO.success=0,SCENARIO.failure=0,SCENARIO.victory=-1,SCENARIO.successful=0,SCENARIO.victoryCond=0,SCENARIO.text0=0,SCENARIO.text1=0,SCENARIO.repetitions=1,SCENARIO.device=0,SCENARIO.repSuccess=0,SCENARIO.disableOverlay=!1,SCENARIO.archive=0,SCENARIO.lastWasSuccess=!1,PERF.otherTot=0,PERF.loopTot=0,PERF.renderTot=0,PERF.otherMid=0,PERF.loopMid=0,PERF.renderMid=0,PERF.other=0,PERF.loop=0,PERF.render=0,ANALYSIS.last=0,ANALYSIS.openAmount=0,ANALYSIS.isOpening=!1,ANALYSIS.openSpeed=.05,ANALYSIS.openTrig=1,ANALYSIS.gateProbs=[0,0,0,0],ANALYSIS.probs=0,ANALYSIS.bonusTiles=0,ANALYSIS.bonusOpen=0,ANALYSIS.highlight=new Array(4+FIELD.maxBonusTiles).fill(0),SEL_STYLES.color="#7ab97a",SEL_STYLES.color1="forestgreen",SEL_STYLES.color2="lemonchiffon",SEL_STYLES.color4="#7ab4b9",SEL_STYLES.color5="#b9827a",SEL_STYLES.lineGap=FIELD.tileWidth/12,SEL_STYLES.lineDash=FIELD.tileWidth/12,SEL_STYLES.handleTol=1.2,TUTORIAL.leftPad=4*FIELD.tileWidth,TUTORIAL.topPad=4*FIELD.tileHeight,TUTORIAL.boxHeight=6*FIELD.tileHeight,TUTORIAL.margin=FIELD.tileWidth/3,TUTORIAL.show=!1,OPTS.basis="natural",OPTS.displayBoard=!0,DEBUG.show=!1,LEVELS.names.indexOf(e)>=0&&0===STATE.profile&&(STATE.blueprint=PERSIST0[e].currblue,BLUEPRINT.selected=STATE.blueprint,BLUEPRINT.lastSelected=STATE.blueprint);var i=InitScenario.router(e,t,!1);if(!i){IBOARD=new Board(CANV.interface.ctx,FIELD.cols,FIELD.rows),LevelConsts(e);var a=LevelGates(e,t);IBOARD.setAllBits(a.allBits,a.allQubits,a.entGroups),IBOARD._tiles=[...PERSIST0[e].tiles[STATE.blueprint]],IBOARD.setAllGates(JSON.parse(JSON.stringify(PERSIST0[e].gates[STATE.blueprint]))),LevelRefresh(e,IBOARD),UNDOREDO.reset()}if(!(LEVELS.names.indexOf(e)<0)){FIELD.channelsDir=[...SCENARIO.channelsDir];for(var r=0;r<6;r++)FIELD.channels[r]=Math.round((SCENARIO.channelsDir[r]+1)/2),FIELD.channelsTrig[r]=Math.round((SCENARIO.channelsDir[r]+1)/2);if(CANV.overlayLeft.clear(),Overlay.createLeftGrill(CANV.overlayLeft.ctx),CANV.overlayRight.clear(),Overlay.createRightGrill(CANV.overlayRight.ctx),CANV.overlayBottom.clear(),Overlay.createBottomGrill(CANV.overlayBottom.ctx),Blueprint.draw(),!PERSIST0[SCENARIO.name].briefed){var s=LEVELS.names.indexOf(SCENARIO.name);TUTORIAL.default=LEVELS.briefs[s]}}}static router(e,t,i){return"levelSelect"===e?(LevelSelect(),!0):"title"===e&&(LevelTitle(),!0)}static loadAll(){for(var e=0;e<LEVELS.num;e++){var t=Storage.load(PERSIST0,LEVELS.names[e],0);t||(PERSIST0[LEVELS.names[e]]={},PERSIST0[LEVELS.names[e]].star=!1,PERSIST0[LEVELS.names[e]].complete=!1,PERSIST0[LEVELS.names[e]].available=!0,LEVELS.briefs[e]>=0?PERSIST0[LEVELS.names[e]].briefed=!1:PERSIST0[LEVELS.names[e]].briefed=!0,PERSIST0[LEVELS.names[e]].hasRobot=!1,PERSIST0[LEVELS.names[e]].currblue=1,PERSIST0[LEVELS.names[e]].tiles=[[],[],[]],PERSIST0[LEVELS.names[e]].gates=[[],[],[]])}t=Storage.loadGeneric();t?FIELD.isCleanSlate=!1:(FIELD.isCleanSlate=!0,PERSIST0.generic={},PERSIST0.generic.music=OPTS.music,PERSIST0.generic.sfx=OPTS.sfx,PERSIST0.generic.musicOn=OPTS.musicOn,PERSIST0.generic.sfxOn=OPTS.sfxOn,PERSIST0.generic.nameTag=Helper.generateName(),PERSIST0.generic.disableBriefs=FIELD.disableBriefs,PERSIST0.generic.fancyGraphics=OPTS.fancyGraphics,PERSIST0.generic.autoResize=OPTS.autoResize,PERSIST0.generic.availableBriefs=[0,0,0,0,0,0,0],localStorage.setItem("generic",JSON.stringify(PERSIST0.generic))),FIELD.availableBriefs=PERSIST0.generic.availableBriefs;for(e=0;e<LEVELS.num;e++){var i=LEVELS.names[e];STATE.blueprint=0;var a=LevelGates(LEVELS.names[e],!1);PERSIST0[i].tiles[0].length<1&&(PERSIST0[i].tiles[0]=a.tiles,PERSIST0[i].gates[0]=a.allGates),STATE.blueprint=1;a=LevelGates(LEVELS.names[e],!1);PERSIST0[i].tiles[1].length<1&&(PERSIST0[i].tiles[1]=a.tiles,PERSIST0[i].gates[1]=a.allGates),STATE.blueprint=2;a=LevelGates(LEVELS.names[e],!1);PERSIST0[i].tiles[2].length<1&&(PERSIST0[i].tiles[2]=a.tiles,PERSIST0[i].gates[2]=a.allGates)}}}class Inputs{static resolve(){INPUTS.mousemove&&(MouseMove.main(INPUTS.mousemove),INPUTS.mousemove=0),INPUTS.mousedown&&(MouseDown.main(INPUTS.mousedown),INPUTS.mousedown=0),INPUTS.mouseup&&(MouseUp.main(INPUTS.mouseup),INPUTS.mouseup=0),INPUTS.wheel&&(Inputs.onWheel(INPUTS.wheel),INPUTS.wheel=0),INPUTS.keydown&&(Inputs.onKeyDown(INPUTS.keydown),INPUTS.keydown=0),INPUTS.resize&&(TIMER.resize=TIMER.resizeMax,INPUTS.resize=0),INPUTS.dblclick&&(INPUTS.dblclick.altKey||"constructing"!==STATE.mode||"boardtile"!==STATE.under.type||"free"!==STATE.state&&"gatemanip"!==STATE.state||MouseDown.quickToggleSwitch(INPUTS.dblclick),INPUTS.dblclick=0)}static onKeyDown(e){if(("constructing"===STATE.mode||"paused"===STATE.mode)&&"qubit"===STATE.grab.type){var t=STATE.grab.k0;if(t.entGroup){if(37===e.keyCode){var i=t.entGroup.numQubits,a=t.entInd;if(a>0){var r=[...Array(i).keys()];r[a-1]=a,r[a]=a-1,t.entGroup.reorder(r)}return SFX.click2.play(),void e.preventDefault()}if(39===e.keyCode){i=t.entGroup.numQubits,a=t.entInd;if(a<i-1){r=[...Array(i).keys()];r[a+1]=a,r[a]=a+1,t.entGroup.reorder(r)}return SFX.click2.play(),void e.preventDefault()}}}if(FIELD.developerMode){if("constructing"===STATE.mode&&(220===e.keyCode&&(console.log(Helper.makeCheckDigit()),console.log(Helper.countCleanTiles(IBOARD._tiles))),49===e.keyCode&&console.log(UNDOREDO.boardStorage[UNDOREDO.numCurr].serialize()),192===e.keyCode)){for(var s=[],o=0;o<IBOARD._gateList.length;o++)s.push(IBOARD._gateList[o].pack());var n=[];for(o=0;o<IBOARD._qubitList.length;o++)n.push(IBOARD._qubitList[o].pack());var l=[];for(o=0;o<IBOARD._bitList.length;o++)l.push(IBOARD._bitList[o].pack());var h=IBOARD._tiles;console.log(JSON.stringify(h)),console.log(JSON.stringify(s)),console.log(JSON.stringify(n)),console.log(JSON.stringify(l))}if("title"===STATE.mode&&72===e.keyCode&&Storage.loadFromAll(),71===e.keyCode&&console.log(JSON.stringify(PERSIST0)),76===e.keyCode){console.log(PERSIST0),console.log(PERSIST0.generic.availableBriefs);var d=localStorage.getItem("generic");null!=d&&console.log(JSON.parse(d).availableBriefs)}187===e.keyCode&&e.shiftKey&&(DEBUG.show=!DEBUG.show),67===e.keyCode&&Canvs.displayAll(CANV)}if(70===e.keyCode&&(OPTS.showFPS=!OPTS.showFPS,OPTS.showFPS||CANV.FPS.clear()),190===e.keyCode&&(FIELD.defaultWidth=Math.round(1.25*FIELD.defaultWidth),TIMER.resize=1),188===e.keyCode&&(FIELD.defaultWidth=Math.round(.8*FIELD.defaultWidth),TIMER.resize=1),27===e.keyCode&&Helper.esc(),"levelSelect"===STATE.mode){85===e.keyCode&&e.shiftKey&&FIELD.developerMode&&(e.ctrlKey||e.metaKey)&&(FIELD.forceOpen=!FIELD.forceOpen,SELECTOR.unlockCheck(),SELECTOR.initialize(),SELECTOR.drawBase(CANV.selectBase),SELECTOR.draw(CANV.select,CANV.selectText),SELECTOR.drawText(CANV.selectText));var u=[49,50,51,52,53,54,55,56,57];if(u.includes(e.keyCode)&&e.shiftKey&&e.altKey){var c=e.keyCode-48;FIELD.forceOpenRing[c]=!FIELD.forceOpenRing[c],SELECTOR.unlockCheck(),SELECTOR.initialize(),SELECTOR.drawBase(CANV.selectBase),SELECTOR.draw(CANV.select,CANV.selectText),SELECTOR.drawText(CANV.selectText)}}if("constructing"===STATE.mode){219===e.keyCode||81===e.keyCode?MENU.selectNext(-1):221!==e.keyCode&&87!==e.keyCode||MENU.selectNext(1);u=[49,50,51,52,53,54];if(u.includes(e.keyCode)&&(e.shiftKey?MENU.selectHot(e.keyCode-49,1):e.ctrlKey||e.metaKey?MENU.selectHot(e.keyCode-49,2):MENU.selectHot(e.keyCode-49,0)),37===e.keyCode&&(SFX.click2.play(),e.preventDefault(),MENU.selProperties.orient=(MENU.selProperties.orient+3)%4),39===e.keyCode&&(SFX.click2.play(),e.preventDefault(),MENU.selProperties.orient=(MENU.selProperties.orient+1)%4),72===e.keyCode&&(SFX.click.play(),TUTORIAL.current=TUTORIAL.default,TUTORIAL.oldMode=STATE.mode,TUTORIAL.channelsCol=[...SCENARIO.channelsCol],STATE.mode="tutorial",ResetConsts.tutorial(),TUTORIAL.show=!0),112===e.keyCode&&(SFX.click.play(),TUTORIAL.current=16,TUTORIAL.oldMode=STATE.mode,TUTORIAL.channelsCol=[...SCENARIO.channelsCol],STATE.mode="tutorial",ResetConsts.tutorial(),TUTORIAL.show=!0),66===e.keyCode){ROBOT.oldMode=STATE.mode,STATE.mode="robot",FIELD.forced=!0;var I=ResetConsts.robot();I?(SFX.click.play(),TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible"):SFX.invalid.play()}82===e.keyCode&&(SFX.click.play(),UNDOREDO.add(),LevelRefresh(SCENARIO.name,IBOARD)),69===e.keyCode&&(SFX.click2.play(),"destroying"!==STATE.state&&(STATE.state="erasing",STATE.grab={type:"free",i0:-1,j0:-1,k0:-1},MENU.setSelected(-1,-1))),SCENARIO.journal&&74===e.keyCode&&(SFX.click.play(),PopWindow.setText(),POPWINDOW.movableWindow.style.display="block",POPWINDOW.isOpen=!0,POPWINDOW.text.scrollTop=0),90===e.keyCode&&UNDOREDO.retreat(),89!==e.keyCode&&88!==e.keyCode||UNDOREDO.advance()}if("robot"===STATE.mode&&32===INPUTS.keydown.keyCode&&RobotSpeech.advanceText(),"running"!==STATE.mode&&"paused"!==STATE.mode||(219===e.keyCode?TIMER.timePerTick=Math.min(2*TIMER.timePerTick,4*TIMER.defaultTimePerTick):221===e.keyCode&&(TIMER.timePerTick=Math.max(TIMER.timePerTick/2,1))),"paused"===STATE.mode&&FIELD.developerMode&&192===e.keyCode){console.log(RBOARD[TIMER.tick]);for(s=[],o=0;o<RBOARD[TIMER.tick]._gateList.length;o++)s.push(RBOARD[TIMER.tick]._gateList[o].pack());for(n=[],o=0;o<RBOARD[TIMER.tick]._qubitList.length;o++)n.push(RBOARD[TIMER.tick]._qubitList[o].pack());for(l=[],o=0;o<RBOARD[TIMER.tick]._bitList.length;o++)l.push(RBOARD[TIMER.tick]._bitList[o].pack());h=RBOARD[TIMER.tick]._tiles;console.log(JSON.stringify(h)),console.log(JSON.stringify(s)),console.log(JSON.stringify(n)),console.log(JSON.stringify(l)),console.log(RBOARD[TIMER.tick-1].entList)}FIELD.developerMode&&console.log(e.keyCode)}static onWheel(e){if(MENU.selected>=0&&"placing"===STATE.state)TIMER.totalWheel+=e.deltaY,TIMER.allowWheel&&Math.abs(TIMER.totalWheel)>=4&&(SFX.click2.play(),"trash"===MENU.selProperties.type?MENU.selProperties.orient=0:e.deltaY>0?(MENU.selProperties.orient+=1,MENU.selProperties.orient>3&&(MENU.selProperties.orient=0)):e.deltaY<0&&(MENU.selProperties.orient-=1,MENU.selProperties.orient<0&&(MENU.selProperties.orient=3)),TIMER.allowWheel=!1,TIMER.totalWheel=0,setTimeout(function(){TIMER.allowWheel=!0},100));else if("gatemanip"===STATE.state&&(TIMER.totalWheel+=e.deltaY,TIMER.allowWheel&&Math.abs(TIMER.totalWheel)>=4)){SFX.click2.play();var t=STATE.grab.k0;if(t){if(["cCombine","qCombine","cSplit"].includes(STATE.grab.type)){var i=t.orient;e.deltaY>0?(i+=1,i>=4&&(i-=4)):e.deltaY<0&&(i-=1,i<0&&(i+=4)),t.orient=i;var a=t.i0+t.j0*FIELD.cols;IBOARD.tiles[a]=MDATA.GATEID[STATE.grab.type]+t.orient}else if(["switch"].includes(STATE.grab.type)){t.rot=1-t.rot;i=t.orient;var r=STATE.grab.i0,s=STATE.grab.j0;0==i?s+=1:1==i?r-=1:2==i?s-=1:3==i&&(r+=1),IBOARD.setState(r,s,t.rot)}else if(["trash"].includes(STATE.grab.type))t.state=1-t.state;else if(["cInvert"].includes(STATE.grab.type))t.rot=1-t.rot;else if(["measure","rotate","qFlip","upgrade"].includes(STATE.grab.type)){i=Math.round(t.rot/(Math.PI/8))%16;e.deltaY>0?(i+=1,i>=16&&(i-=16)):e.deltaY<0&&(i-=1,i<0&&(i+=16)),t.rot=i*Math.PI/8}else if(["delay"].includes(STATE.grab.type)){i=t.state;e.deltaY>0?(i+=1,i>=7.5&&(i-=8)):e.deltaY<0&&(i-=1,i<0&&(i+=8)),t.state=Math.round(i)}else if(["qControl"].includes(STATE.grab.type)){var o=Math.round(8*t.rot/Math.PI);e.deltaY>0?(o+=1,o>8&&(o-=16)):e.deltaY<0&&(o-=1,o<=-8&&(o+=16)),t.rot=Math.PI*o/8}else if(["cCreate","qCreate"].includes(STATE.grab.type)){o=Math.round(Math.abs(t.rot));e.deltaY>0?(o+=1,o>2&&(o=0)):e.deltaY<0&&(o-=1,o<0&&(o=2)),t.rot=o}var n=["trash","cInvert","cCombine","qCombine","cSplit","cCreate","qCreate","qControl","delay","measure","rotate","qFlip","upgrade"];n.includes(STATE.grab.type)&&(STATE.isScrollManip?UNDOREDO.replace():UNDOREDO.add(),STATE.isScrollManip=!0)}TIMER.allowWheel=!1,TIMER.totalWheel=0,setTimeout(function(){TIMER.allowWheel=!0},100)}}}class Loop{static main(){if(OPTS.useGrads&&(GRADS.flame=CANV.base.ctx.createLinearGradient(0,0,32,32),GRADS.flame.addColorStop(0,"CornflowerBlue"),GRADS.flame.addColorStop(.4+.05*TIMER.blinkRatioDub,"CornflowerBlue"),GRADS.flame.addColorStop(.6+.05*TIMER.glareRatioTrig*TIMER.blinkRatioDub,"#d92b2b"),GRADS.flame.addColorStop(1,"#d92b2b")),"robot"!==STATE.mode&&TIMER.grey>0&&(document.getElementById("greyoverlay").style.opacity=TIMER.grey/TIMER.greyMax*.75),0===STATE.heldKey&&"free"===STATE.state&&"constructing"===STATE.mode&&(STATE.state="erasing"),CANV.menuEraser.clear(),"constructing"===STATE.mode){if("erasing"===STATE.state||"destroying"===STATE.state)var e=.7+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio);else e=.75;if(PathsI.eraserIcon(CANV.menuEraser.ctx).draw(CANV.menuEraser.ctx,(1-e)*FIELD.tileWidth/2,(1-e)*FIELD.tileHeight/2,e*FIELD.tileWidth,e*FIELD.tileHeight),"constructing"===STATE.mode&&"eraser"===STATE.under.type&&"erasing"!==STATE.state){e=.8+.07*Math.cos(8*Math.PI*TIMER.qubitGlowRatio);Paths.qubitHalo(CANV.menuEraser.ctx).draw(CANV.menuEraser.ctx,(1-e)*FIELD.tileWidth/2,(1-e)*FIELD.tileHeight/2,e*FIELD.tileWidth,e*FIELD.tileHeight)}}else{e=.75;PathsI.eraserIcon(CANV.menuEraser.ctx).draw(CANV.menuEraser.ctx,(1-e)*FIELD.tileWidth/2,(1-e)*FIELD.tileHeight/2,e*FIELD.tileWidth,e*FIELD.tileHeight)}if("escbutton"!==STATE.under.type&&"escbutton"!==STATE.underLast.type||Helper.drawToggles(),"constructing"===STATE.mode){var t=0===UNDOREDO.numAvail&&0===UNDOREDO.numFwd,i=UNDOREDO.leftExtend>0||UNDOREDO.rightExtend>0;if(!t||i){CANV.undos.clear(),0===UNDOREDO.numAvail?UNDOREDO.leftExtend=Math.max(0,UNDOREDO.leftExtend-TIMER.dt/200):UNDOREDO.leftExtend=Math.min(1,UNDOREDO.leftExtend+TIMER.dt/200),0===UNDOREDO.numFwd?UNDOREDO.rightExtend=Math.max(0,UNDOREDO.rightExtend-TIMER.dt/200):UNDOREDO.rightExtend=Math.min(1,UNDOREDO.rightExtend+TIMER.dt/200);var a=FIELD.tileWidth;Paths.undoButton(CANV.undos.ctx,UNDOREDO.numAvail,"undobutton"===STATE.under.type).draw(CANV.undos.ctx,a/4,3*a/4-UNDOREDO.leftExtend*a/2,a,a),Paths.redoButton(CANV.undos.ctx,UNDOREDO.numFwd,"redobutton"===STATE.under.type).draw(CANV.undos.ctx,6.75*a,3*a/4-UNDOREDO.rightExtend*a/2,a,a)}}if(OPTS.sfxOn&&("gatedrag"===STATE.state?SFX.manip.play():"qubitbasis"===STATE.state?SFX.manip2.play():"analysisgatecontrolling"===STATE.state&&SFX.manip.play()),"confirming"!==STATE.mode){if(PERSIST0[SCENARIO.name]&&PERSIST0[SCENARIO.name].complete&&SCENARIO.archive){CANV.archive.clear();var r=!1;"archiveButton"===STATE.under.type&&(r=!0);var s=Paths.archiveButton(CANV.archive.ctx,r)
;s.draw(CANV.archive.ctx,1.25*FIELD.tileWidth,1.25*FIELD.tileHeight,FIELD.tileWidth/2,FIELD.tileHeight/2)}if(SCENARIO.journal){CANV.journal.clear();r=!1;"journalButton"===STATE.under.type&&(r=!0);s=Paths.journalButton(CANV.journal.ctx,r);s.draw(CANV.journal.ctx,1.25*FIELD.tileWidth,1.25*FIELD.tileHeight,FIELD.tileWidth/2,FIELD.tileHeight/2)}CANV.letterButton.clear();var o=[0,0,0,0];if("letterButton"===STATE.under.type&&(o[STATE.under.i0]=1),"robot"===STATE.mode&&(Timer.robotStep(performance.now()),Robot.drawButton(),CANV.robotScreen.ctx.fillStyle="black",CANV.robotScreen.clear(),CANV.robotScreen.fill(),Robot.draw(CANV.robotScreen.ctx,ROBOT.screenW/16,RTIMER.theta,RTIMER.stretch,RTIMER.extend),ROBOT.isDone||(CANV.robotText.clear(),TextParser.draw(CANV.robotText.ctx,0,0,ROBOT.lineGap,RTIMER.pageTime/RTIMER.charTime,ROBOT.lines,ROBOT.lineTime,ROBOT.wordTime,ROBOT.paraGaps))),PERSIST0[SCENARIO.name]){if(PERSIST0[SCENARIO.name].briefed)var n=1,l=0,h=0;else n=1.1+.2*Math.cos(8*Math.PI*TIMER.qubitGlowRatio),l=(1-n)/2*FIELD.tileWidth/2,h=(1-n)/2*FIELD.tileWidth/2;s=Paths.letterButton(CANV.letterButton.ctx,0,o[0]);s.draw(CANV.letterButton.ctx,l+FIELD.tileWidth/4,h+FIELD.tileHeight/4,n*FIELD.tileWidth/2,n*FIELD.tileHeight/2);s=Paths.letterButton(CANV.letterButton.ctx,1,o[1]);s.draw(CANV.letterButton.ctx,3.5*FIELD.tileWidth/4,FIELD.tileHeight/4,FIELD.tileWidth/2,FIELD.tileHeight/2);s=Paths.letterButton(CANV.letterButton.ctx,2,o[2]);s.draw(CANV.letterButton.ctx,6*FIELD.tileWidth/4,FIELD.tileHeight/4,FIELD.tileWidth/2,FIELD.tileHeight/2);s=Paths.letterButton(CANV.letterButton.ctx,3,o[3]);s.draw(CANV.letterButton.ctx,8.5*FIELD.tileWidth/4,FIELD.tileHeight/4,FIELD.tileWidth/2,FIELD.tileHeight/2)}if(TIMER.shake>=0){var d=TIMER.shake/TIMER.shakeMax;e=FIELD.tileWidth/48;FIELD.leftPad=FIELD.leftPad0+4*e*Math.sin(Math.PI*d)*Math.cos(Math.PI*(5*d+Math.random())),FIELD.topPad=FIELD.topPad0+4*e*Math.sin(Math.PI*d)*Math.sin(Math.PI*(6*d+Math.random())),ResetConsts.translate()}TIMER.construct<0&&(CANV.controls.clear(),CANV.scenarioMask.clear()),TIMER.message>0?(CANV.FPS.clear(),CANV.FPS.ctx.globalAlpha=Math.min(1,Math.max(0,TIMER.message/TIMER.messageMax)),CANV.FPS.ctx.fillText(FIELD.message,0,0)):OPTS.showFPS&&(CANV.FPS.clear(),CANV.FPS.ctx.globalAlpha=1,CANV.FPS.ctx.fillText("FPS: "+TIMER.FPS+" "+Math.round(PERF.otherTot)+" "+Math.round(PERF.loopTot)+" "+Math.round(PERF.renderTot),0,0)),Placement.check(),Tooltip.draw(),["running","paused","backwardTrans","forwardTrans","finishtrans","finished"].indexOf(STATE.mode)>=0||"finished"===ROBOT.oldMode?(Score.drawBase(CANV.scoreBase),Score.draw(CANV.score,CANV.menuText)):(CANV.scoreBase.clear(),CANV.score.clear()),"running"===STATE.mode||"paused"===STATE.mode||"finishtrans"===STATE.mode?Ticker.draw(CANV.ticker,FIELD.tileWidth/6,-FIELD.tileWidth/6,2*FIELD.tileWidth/3,4*FIELD.tileWidth/3):"backwardTrans"===STATE.mode&&Ticker.reset(CANV.ticker,FIELD.tileWidth/6,-FIELD.tileWidth/6,2*FIELD.tileWidth/3,4*FIELD.tileWidth/3,1-TIMER.transRatio);var u=performance.now();"running"===STATE.mode||"paused"===STATE.mode?Render.boardDynamic(RBOARD[TIMER.tick],RBOARD[TIMER.tick+1],0,[0,1,1]):"finishtrans"===STATE.mode||"finished"===STATE.mode||"finished"===ROBOT.oldMode?Render.boardDynamic(RBOARD[TIMER.tick],RBOARD[TIMER.tick],0,[0,1,1]):"constructing"===STATE.mode?("boardtile"===STATE.under.type?Render.boardSingle(IBOARD,STATE.under.i0,STATE.under.j0):Render.boardSingle(IBOARD),CANV.menu.clear(),CANV.menuText.clear(),TIMER.construct<0&&(MENU.closure=0,MENU.draw(CANV.menu,CANV.menuText))):"backwardTrans"===STATE.mode?(TIMER.transRatio>.5?RBOARD[TIMER.tick]&&RBOARD[TIMER.tick+1]?Render.boardDynamic(RBOARD[TIMER.tick],RBOARD[TIMER.tick+1]):Render.boardSingle(IBOARD):(TIMER.tick=0,CANV.baseWires.clear(),Render.boardSingle(IBOARD)),CANV.effects.ctx.save(),CANV.effects.ctx.globalAlpha=.7*TIMER.transRatioDub,CANV.effects.ctx.fillStyle="aliceblue",CANV.effects.ctx.fillRect(IBOARD.x0,IBOARD.y0,IBOARD.width*FIELD.tileWidth,IBOARD.height*FIELD.tileHeight),CANV.effects.ctx.restore(),CANV.menu.clear(),CANV.menuText.clear(),MENU.closure=TIMER.transRatioTrig,MENU.draw(CANV.menu,CANV.menuText)):"forwardTrans"===STATE.mode&&(CANV.menu.clear(),CANV.menuText.clear(),MENU.setSelected(-1,-1),MENU.closure=TIMER.transRatioTrig,MENU.draw(CANV.menu,CANV.menuText),Render.boardSingle(IBOARD)),PERF.render=performance.now()-u,CANV.debug.clear(),DEBUG.show&&(CANV.debug.ctx.fillStyle="white",CANV.debug.fill(),CANV.debug.ctx.fillStyle="black",CANV.debug.ctx.font="14px Verdana",CANV.debug.ctx.fillText(String(STATE.mode),10,20),CANV.debug.ctx.fillText(String(STATE.state),10,40),CANV.debug.ctx.fillText("grab: "+String(STATE.grab.type)+", i0: "+String(STATE.grab.i0)+", j0: "+String(STATE.grab.j0)+", k0: "+String(STATE.grab.k0),10,60),CANV.debug.ctx.fillText("under: "+String(STATE.under.type)+", i0: "+String(STATE.under.i0)+", j0: "+String(STATE.under.j0)+", k0: "+String(STATE.under.i0+STATE.under.j0*FIELD.cols),10,80),CANV.debug.ctx.fillText("underLast: "+String(STATE.underLast.type)+", i0: "+String(STATE.underLast.i0)+", j0: "+String(STATE.underLast.j0)+", k0: "+String(STATE.underLast.k0),10,100),CANV.debug.ctx.fillText("selected: "+String(MENU.selected)+", i0: "+String(STATE.selected.i0)+", j0: "+String(STATE.selected.j0)+", k0: "+String(STATE.selected.i0+STATE.selected.j0*FIELD.cols),10,120),"running"===STATE.mode?CANV.debug.ctx.fillText("success: "+RBOARD[TIMER.tick].success+", failure: "+RBOARD[TIMER.tick].failure,10,140):CANV.debug.ctx.fillText("success: "+IBOARD.success+", failure: "+IBOARD.failure,10,140),CANV.debug.ctx.fillText("sel state: "+MENU.selProperties.state,10,160),CANV.debug.ctx.fillText("State X: "+STATE.pos.x+", State Y: "+STATE.pos.y,10,180),CANV.debug.ctx.fillText("Wheel: "+TIMER.allowWheel,10,200)),"ctrlbutton"===STATE.under.type||CTRLMENU.checkTransition()?(CANV.menu2.clear(),CTRLMENU.drawControl(CANV.menu2),FIELD.lastLoc="ctrlbutton"):"backwardTrans"===STATE.mode?(CANV.menu2.clear(),CTRLMENU.drawControl(CANV.menu2)):("ctrlbutton"!==STATE.under.type&&"ctrlbutton"===FIELD.lastLoc&&(CTRLMENU.removeHovered(),CANV.menu2.clear(),CTRLMENU.drawControl(CANV.menu2)),FIELD.lastLoc="none"),Placement.draw(),"multiplace"===STATE.state&&"boardtile"===STATE.under.type?COPYBUFFER.draw():"premultiplace"===STATE.state&&COPYBUFFER.preDraw(),TIMER.construct<0&&(CANV.controls.ctx.globalCompositeOperation="source-over",Halo.draw(CANV.controls.ctx),QubitHalo.draw(CANV.controls.ctx)),Analysis.updateSlide(CANV.analysis),0===FIELD.channelsDir[0]&&0===FIELD.channelsDir[1]||(CANV.overlayLeft.clear(),Overlay.createLeftGrill(CANV.overlayLeft.ctx)),0===FIELD.channelsDir[2]&&0===FIELD.channelsDir[3]||(CANV.overlayRight.clear(),Overlay.createRightGrill(CANV.overlayRight.ctx)),0===FIELD.channelsDir[4]&&0===FIELD.channelsDir[5]||(CANV.overlayBottom.clear(),Overlay.createBottomGrill(CANV.overlayBottom.ctx)),TIMER.construct>=0&&(CANV.interface.clear(),Helper.introLaser(CANV.controls,CANV.interface),Helper.sideIntroLaser(CANV.scenarioMask,CANV.interface),CANV.menu.clear(),CANV.menuText.clear(),MENU.closure=Math.max(0,Math.min(1,(TIMER.construct-.2*TIMER.constructMax)/(.8*TIMER.constructMax)))**2,MENU.draw(CANV.menu,CANV.menuText)),Inputs.resolve(),Finished.draw(CANV.victoryBase,CANV.victoryText),TIMER.white>=0&&(CANV.effects.ctx.save(),CANV.effects.ctx.globalAlpha=.6*TIMER.whiteRatio,SCENARIO.lastWasSuccess?CANV.effects.ctx.fillStyle="lightgreen":CANV.effects.ctx.fillStyle="lightcoral",CANV.effects.ctx.fillRect(IBOARD.x0,IBOARD.y0,IBOARD.width*FIELD.tileWidth,IBOARD.height*FIELD.tileHeight),CANV.effects.ctx.restore())}else ConfirmationBox.loop()}static title(){if("confirming"!==STATE.state){if("escbutton"!==STATE.under.type&&"escbutton"!==STATE.underLast.type||Helper.drawToggles(),TIMER.tick<SCENARIO.xCameraLocs.length-1){var e=-1*FIELD.tileWidth*SCENARIO.xCameraLocs[TIMER.tick]+6*FIELD.tileWidth+FIELD.leftMargin,t=-1*FIELD.tileHeight*SCENARIO.yCameraLocs[TIMER.tick]+2.5*FIELD.tileHeight,i=-1*FIELD.tileWidth*SCENARIO.xCameraLocs[TIMER.tick+1]+6*FIELD.tileWidth+FIELD.leftMargin,a=-1*FIELD.tileHeight*SCENARIO.yCameraLocs[TIMER.tick+1]+2.5*FIELD.tileHeight,r=(1-TIMER.popRatio)*e+TIMER.popRatio*i,s=(1-TIMER.popRatio)*t+TIMER.popRatio*a;FIELD.cameraX=r,FIELD.cameraY=s;var o=4e3/(13.875*FIELD.tileWidth),n=2e3/(7.25*FIELD.tileHeight),l=150-o*Math.round(Math.abs(r+1500)%(150/o)),h=130-n*Math.round(Math.abs(s+1300)%(130/n));SVG.title.svg.setAttribute("viewBox",l-75+" "+(h-65)+" 4000 2000")}OPTS.showFPS&&(CANV.FPS.clear(),CANV.FPS.ctx.fillText("FPS: "+TIMER.FPS+" "+FIELD.tileWidth,0,0)),2===TIMER.tick&&(OPTS.fancyGears=TIMER.FPS>20),3===TIMER.tick&&OPTS.attemptDowngrade&&(OPTS.attemptDowngrade=!1,OPTS.fancyGraphics=TIMER.FPS>20,Graphics.init());var d=SCENARIO.xCameraLocs[TIMER.tick],u=SCENARIO.xCameraLocs[TIMER.tick+1],c=SCENARIO.yCameraLocs[TIMER.tick],I=SCENARIO.yCameraLocs[TIMER.tick+1],E=Math.max(Math.min(d,u)-7,0),f=Math.min(Math.max(d,u)+7,FIELD.cols),S=Math.max(Math.min(c,I)-4,0),p=Math.min(Math.max(c,I)+4,FIELD.rows);if(Render.boardDynamic(RBOARD[TIMER.tick],RBOARD[TIMER.tick+1],[E,S,f,p],[1,1,1]),CANV.title.clear(),Gears.findPath(CANV.title.ctx),FIELD.showTitleMenu&&("free"===STATE.state?(CANV.titleAbout.clear(),CANV.titleText.clear(),Gears.drawOptions(CANV.title.ctx)):"options"===STATE.state&&(CANV.titleText.clear(),Gears.drawOptionsMenu(CANV.titleText.ctx))),FIELD.showTitleMenu){CANV.titleLearn.clear();var T=CANV.titleLearn.ctx;T.save(),T.translate(.05*FIELD.tileWidth,.45*FIELD.tileHeight),T.rotate(-23*Math.PI/180);var R=1+.05*Math.cos(4*TIMER.blinkRatio*Math.PI);T.scale(R,R),"learnbutton"===STATE.under.type?T.fillStyle="rgba(60,60,100,0.7)":T.fillStyle="rgba(0,0,40,0.7)",T.strokeStyle="black",T.lineWidth=2,T.beginPath();var m=FIELD.tileWidth,g=[.2*m,.95*m,1.15*m,1.15*m,0,0],A=[0,0,.25*m,.5*m,.5*m,.25*m],C=[.1*m,.1*m,.1*m,.1*m,.1*m,.1*m],L=new Path2D(Helper.makeRoundedPath(g,A,C));T.fill(L),T.stroke(L),T.textBaseline="top",T.textAlign="left",T.font=.7*FIELD.tileWidth/6+"px Verdana",T.shadowBlur=2,T.shadowOffsetX=2,T.shadowOffsetY=2,T.shadowColor="black",T.fillStyle="antiquewhite",T.fillText("Walkthrough",.2*FIELD.tileWidth,.2*FIELD.tileHeight/2),T.fillText("Available Here!",.15*FIELD.tileWidth,.6*FIELD.tileHeight/2),T.restore()}DEBUG.show&&(CANV.debug.clear(),CANV.debug.ctx.fillStyle="white",CANV.debug.fill(),CANV.debug.ctx.fillStyle="black",CANV.debug.ctx.font="14px Verdana",CANV.debug.ctx.fillText(String(STATE.mode),10,20),CANV.debug.ctx.fillText(String(STATE.state),10,40),CANV.debug.ctx.fillText("grab: "+String(STATE.grab.type)+", i0: "+String(STATE.grab.i0)+", j0: "+String(STATE.grab.j0)+", k0: "+String(STATE.grab.k0),10,60),CANV.debug.ctx.fillText("under: "+String(STATE.under.type)+", i0: "+String(STATE.under.i0)+", j0: "+String(STATE.under.j0)+", k0: "+String(STATE.under.k0),10,80),CANV.debug.ctx.fillText("underLast: "+String(STATE.underLast.type)+", i0: "+String(STATE.underLast.i0)+", j0: "+String(STATE.underLast.j0)+", k0: "+String(STATE.underLast.k0),10,100),CANV.debug.ctx.fillText("State X: "+STATE.pos.x+", State Y: "+STATE.pos.y,10,140)),TIMER.grey>0&&(document.getElementById("greyoverlay").style.opacity=TIMER.grey/TIMER.greyMax*.75),Inputs.resolve()}else ConfirmationBox.loop(.5,1)}static select(){"escbutton"!==STATE.under.type&&"escbutton"!==STATE.underLast.type||Helper.drawToggles(),TIMER.message>0?(CANV.FPS.clear(),CANV.FPS.ctx.globalAlpha=Math.min(1,Math.max(0,TIMER.message/TIMER.messageMax)),CANV.FPS.ctx.fillText(FIELD.message,0,0)):OPTS.showFPS&&(CANV.FPS.clear(),CANV.FPS.ctx.fillText("FPS: "+TIMER.FPS+" "+FIELD.tileWidth,0,0)),CANV.selectButtons.clear();var e=[0,0,0,0,0,0];"selectButton"===STATE.under.type&&(e[STATE.under.i0]=1),CANV.selectButtons.ctx.save(),CANV.selectButtons.ctx.font=1.2*FIELD.tileWidth/4+"px Verdana",CANV.selectButtons.ctx.fillStyle="black",CANV.selectButtons.ctx.textAlign="left",CANV.selectButtons.ctx.textBaseline="middle",CANV.selectButtons.ctx.fillText("Inbox:",2*FIELD.tileWidth/4,FIELD.tileHeight/4),CANV.selectButtons.ctx.beginPath(),CANV.selectButtons.ctx.lineWidth=1.5,CANV.selectButtons.ctx.lineStyle="#888",CANV.selectButtons.ctx.stroke(Helper.roundRect(1.7*FIELD.tileWidth/4,.2*FIELD.tileHeight/4,4.6*FIELD.tileWidth,1.1*FIELD.tileWidth,FIELD.tileWidth/8)),CANV.selectButtons.ctx.restore();for(var t=0;t<7;t++)if(PERSIST0.generic.availableBriefs[t]||FIELD.forceOpen){var i=Paths.selectButtons(CANV.selectButtons.ctx,(t+1).toString(),e[t]);i.draw(CANV.selectButtons.ctx,2.5*(t+1)*FIELD.tileWidth/4,2*FIELD.tileHeight/4,FIELD.tileWidth/2,FIELD.tileHeight/2)}if("robot"===STATE.mode&&(Timer.robotStep(performance.now()),Robot.drawButton(),CANV.robotScreen.ctx.fillStyle="black",CANV.robotScreen.clear(),CANV.robotScreen.fill(),Robot.draw(CANV.robotScreen.ctx,ROBOT.screenW/16,RTIMER.theta,RTIMER.stretch,RTIMER.extend),ROBOT.isDone||(CANV.robotText.clear(),TextParser.draw(CANV.robotText.ctx,0,0,ROBOT.lineGap,RTIMER.pageTime/RTIMER.charTime,ROBOT.lines,ROBOT.lineTime,ROBOT.wordTime,ROBOT.paraGaps))),CANV.select.clear(),SELECTOR.draw(CANV.select),Achievements.draw(CANV.select,CANV.selectAward),CANV.debug.clear(),DEBUG.show){CANV.debug.ctx.fillStyle="white",CANV.debug.fill(),CANV.debug.ctx.fillStyle="black",CANV.debug.ctx.font="14px Verdana",CANV.debug.ctx.fillText(String(STATE.mode),10,20),CANV.debug.ctx.fillText(String(STATE.state),10,40),CANV.debug.ctx.fillText("grab: "+String(STATE.grab.type)+", i0: "+String(STATE.grab.i0)+", j0: "+String(STATE.grab.j0)+", k0: "+String(STATE.grab.k0),10,60),CANV.debug.ctx.fillText("under: "+String(STATE.under.type)+", i0: "+String(STATE.under.i0)+", j0: "+String(STATE.under.j0)+", k0: "+String(STATE.under.k0),10,80),"running"===STATE.mode?CANV.debug.ctx.fillText("success: "+RBOARD[TIMER.tick].success+", failure: "+RBOARD[TIMER.tick].failure,10,100):CANV.debug.ctx.fillText("success: "+IBOARD.success+", failure: "+IBOARD.failure,10,100),CANV.debug.ctx.fillText("sel state: "+MENU.selProperties.state,10,120);var a=Math.round(10*STATE.pos.x/FIELD.tileWidth-3)/10,r=Math.round(10*STATE.pos.y/FIELD.tileHeight-3)/10;if(CANV.debug.ctx.fillText("State X: "+a+", State Y: "+r,10,140),CANV.debug.ctx.fillText("Wheel: "+TIMER.allowWheel,10,160),"qubiting"===STATE.state||"qubitbasis"===STATE.state){var s=STATE.grab.k0;CANV.debug.ctx.fillText("compAmps: "+Math.round(100*s.ampsComp[0])/100+", "+Math.round(100*s.ampsComp[1])/100+" rot: "+Math.round(8*s.rot/Math.PI)+", basis: "+Math.round(8*s.basisRot/Math.PI),10,180)}}Inputs.resolve()}static tutorial(){if(OPTS.showFPS&&(CANV.FPS.clear(),CANV.FPS.ctx.fillText("FPS: "+TIMER.FPS+" "+FIELD.tileWidth,0,0),CANV.FPS.ctx.fillText(STATE.pos.x+", "+STATE.pos.y,0,20)),"free"===TUTORIAL.type?Render.boardDynamicTutorial(UBOARD[0],UBOARD[1]):"fixed"===TUTORIAL.type&&Render.boardSingleTutorial(UBOARD[UTIMER.tick%TUTORIAL.nFrames]),Inputs.resolve(),TUTORIAL.grab&&(CANV.tutorialControls.clear(),Halo.draw(CANV.tutorialControls.ctx,TUTORIAL.grab)),TutControl.draw(),12===TUTORIAL.current)TutControl.drawSuperposition();else if(14===TUTORIAL.current)CANV.tutorialExtra.clear(),Analysis.draw(CANV.tutorialExtra,TUTORIAL.entStateQ0,-.2*FIELD.tileWidth,.5);else if(15===TUTORIAL.current)CANV.tutorialExtra.clear(),Analysis.draw(CANV.tutorialExtra,TUTORIAL.entStateQ0,-.2*FIELD.tileWidth,.5,!1,[1,0,0,0,0,0]),Analysis.draw(CANV.tutorialExtra,TUTORIAL.entStateQ0,-.2*FIELD.tileWidth,.5,!1,[2,0,0,0,0,0],5.6*FIELD.tileHeight,!1);else if(1===TUTORIAL.current){CANV.tutorialExtra.clear();var e=.8*FIELD.tileWidth,t=8.5*FIELD.tileHeight,i=Paths.qubitHalo(CANV.tutorialExtra.ctx),a=1*(1.1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio));i.draw(CANV.tutorialExtra.ctx,e-(a-1)/2*FIELD.tileWidth,t-(a-1)/2*FIELD.tileHeight,a*FIELD.tileWidth,a*FIELD.tileHeight)}else if(6===TUTORIAL.current){CANV.tutorialExtra.clear();e=2.3*FIELD.tileWidth,t=4*FIELD.tileHeight;var r=3*SEL_STYLES.r0/4;Halo.drawRing(CANV.tutorialExtra.ctx,e,t,r),Halo.drawRing(CANV.tutorialExtra.ctx,e+2*FIELD.tileHeight,t,r),Halo.drawSwitchIconSimple(CANV.tutorialExtra.ctx,e,t),Halo.drawSwitchIconSimple(CANV.tutorialExtra.ctx,e+2*FIELD.tileHeight,t)}}}class Menu{constructor(e,t,i,a,r,s,o){this._label=e,this._x0=t,this._y0=i,this._w0=(a+FIELD.tileWidth)*(s+1),this._h0=(a+FIELD.tileHeight)*(o+1)+r,this._topPad=r,this._tileMargin=a,this._numWidth=s,this._numHeight=o,this._hovered=-1,this._selected=-1,this._buttons=[],this._background=0,this._closure=0,this._selProperties={}}get closure(){return this._closure}get label(){return this._label}get x0(){return this._x0}get y0(){return this._y0}get w0(){return this._w0}get h0(){return this._h0}get tileMargin(){return this._tileMargin}get topPad(){return this._topPad}get numWidth(){return this._numWidth}get numHeight(){return this._numHeight}get hovered(){return this._hovered}get selected(){return this._selected}get buttons(){return this._buttons}get selRot(){return this._selRot}get selState(){return this._selState}get selProperties(){return this._selProperties}set selProperties(e){this._selProperties=e}set closure(e){this._closure=e}set x0(e){this._x0=e}set y0(e){this._y0=e}set w0(e){this._w0=e}set h0(e){this._h0=e}set topPad(e){this._topPad=e}set tileMargin(e){this._tileMargin=e}set numWidth(e){this._numWidth=e}set numHeight(e){this._numHeight=e}set hovered(e){this._hovered=e}set selected(e){this._selected=e}set buttons(e){this._buttons=e}set selRot(e){this._selRot=e}set selState(e){this._selState=e}selectNext(e=1){var t=this.buttons.length;if(this.selected<0){if("free"===STATE.state||"erasing"===STATE.state)for(var i=0,a=0;a<t;a++){var r=i%this.numWidth,s=Math.floor(i/this.numWidth),o=this.getButton(r,s);if(-1!==o&&!o.isGrey)return SFX.click2.play(),this.selProperties=JSON.parse(JSON.stringify(this.getButton(r,s).defaultProperties)),this.setSelected(r,s),void(STATE.state="placing");i+=1}}else if("placing"===STATE.state)for(i=this.selected+e,a=0;a<t;a++){i<0&&(i+=t),i>=t&&(i=0);r=i%this.numWidth,s=Math.floor(i/this.numWidth),o=this.getButton(r,s);if(-1!==o&&!o.isGrey)return SFX.click2.play(),this.selProperties=JSON.parse(JSON.stringify(this.getButton(r,s).defaultProperties)),void this.setSelected(r,s);i+=e}}selectHot(e,t){this.buttons.length;if(this.selected<0){if("free"===STATE.state||"erasing"===STATE.state){var i=this.getButton(e,t);if(-1!==i&&!i.isGrey)return SFX.click2.play(),this.selProperties=JSON.parse(JSON.stringify(this.getButton(e,t).defaultProperties)),this.setSelected(e,t),void(STATE.state="placing")}}else if("placing"===STATE.state){i=this.getButton(e,t);if(-1!==i&&!i.isGrey)return SFX.click2.play(),this.selProperties=JSON.parse(JSON.stringify(this.getButton(e,t).defaultProperties)),void this.setSelected(e,t)}}addButton(e){this.buttons.push(e)}reset(){this._hovered=-1,this._selected=-1,this._background=0,this._closure=0,this._selProperties={};for(var e=0;e<this.buttons.length;e++)this.buttons[e].clear();this.buttons=[]}gridPos(e,t){var i=this.x0+(e+.5)*FIELD.tileWidth+(e+1)*this.tileMargin,a=this.y0+(t+.5)*FIELD.tileHeight+(t+1)*this.tileMargin+this.topPad;return{x0:i,y0:a}}setSelected(e,t,i=0){var a=this.buttons.length;this.selected=-1;for(var r=0;r<a;r++)this.buttons[r].i0===e&&this.buttons[r].j0===t?(this.selected=r,this.buttons[r].selected=!0,this.selProperties=JSON.parse(JSON.stringify(this.buttons[r].defaultProperties))):this.buttons[r].selected=!1}getButton(e,t){for(var i=this.buttons.length,a=0;a<i;a++)if(this.buttons[a].i0===e&&this.buttons[a].j0===t)return this.buttons[a];return-1}getNamedButton(e,t=0){var i=this.buttons.length;if("cInvert"===e)return 0===t?this.buttons[4]:this.buttons[5];for(var a=0;a<i;a++)if(this.buttons[a].tile.name===e)return this.buttons[a];return-1}setHovered(e,t){var i=this.buttons.length;this.hovered=-1;for(var a=0;a<i;a++)this.buttons[a].i0===e&&this.buttons[a].j0===t?(this.hovered=a,this.buttons[a].hovered=!0):this.buttons[a].hovered=!1}removeHovered(){var e=this.buttons.length;this.hovered=-1;for(var t=0;t<e;t++)this.buttons[t].hovered=!1}findTile(e,t){var i=Math.floor((e-this.x0-FIELD.tileWidth/2-this.tileMargin/2)/(FIELD.tileWidth+this.tileMargin)),a=Math.floor((t-this.y0-FIELD.tileHeight/2-this.topPad-this.tileMargin/2)/(FIELD.tileHeight+this.tileMargin));return{i0:i,j0:a}}draw(e,t){var i=e.ctx,a=t.ctx,r=(FIELD.tileWidth+FIELD.menu.pad)*FIELD.menu.cols+FIELD.menu.pad;a.fillStyle="antiquewhite",a.font=1.2/3*FIELD.tileWidth+"px Courier New",a.textBaseline="middle",a.shadowBlur=2,a.shadowOffsetX=2,a.shadowOffsetY=2,a.shadowColor="black";TIMER.time;for(var s=-1,o=-1,n=0;n<this.buttons.length;n++){var l=this.buttons[n],h=this.gridPos(l.i0,l.j0);l.hovered&&(o=n),l.selected&&(s=n),!l.hovered&&l.selected}if(s>=0){l=this.buttons[s],h=this.gridPos(l.i0,l.j0);var d=.1,u=h.x0+FIELD.tileWidth/2,c=h.y0+FIELD.tileHeight/2,I=(1+2*d)*(FIELD.tileWidth/2);const e=i.createRadialGradient(u,c,.5*I,u,c,I);e.addColorStop(0,"white"),e.addColorStop(.95,"black"),e.addColorStop(1,SEL_STYLES.color1),i.save(),i.beginPath(),i.arc(u,c,I,0,2*Math.PI),i.lineWidth=1*FIELD.tileWidth/48,i.strokeStyle="seagreen",i.stroke(),i.setLineDash([SEL_STYLES.lineDash,SEL_STYLES.lineGap]),i.lineDashOffset=(SEL_STYLES.lineDash+SEL_STYLES.lineGap)*TIMER.dashRatio,i.strokeStyle="#333",i.stroke(),i.fillStyle="seagreen",i.globalAlpha=.4,i.fill(),i.restore();var E=!1;if("questionicon"===STATE.under.type)E=!0;i.save();var f=1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio),S=(u=h.x0+FIELD.tileWidth-.5*FIELD.iconWidth,c=h.y0+FIELD.tileHeight-.5*FIELD.iconHeight,PathsI.icon(i,"questionIcon",{hover:E}));S.draw(i,u,c,f*FIELD.iconWidth,f*FIELD.iconHeight),i.restore()}if(o>=0&&o!=s){l=this.buttons[o],h=this.gridPos(l.i0,l.j0),d=.05;if(!l.isGrey){S=Paths.qubitHalo(i,0,!0,-1),f=1.3*(1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio));S.draw(i,h.x0-(f-1)/2*FIELD.tileWidth,h.y0-(f-1)/2*FIELD.tileHeight,f*FIELD.tileWidth,f*FIELD.tileHeight)}}if(o>=0&&o===s){l=this.buttons[s];l.isGrey||a.fillText(l.tooltip,r/2-a.measureText(l.tooltip).width/2,FIELD.menu.topPad/3)}else if(o>=0){l=this.buttons[o];l.isGrey||a.fillText(l.tooltip,r/2-a.measureText(l.tooltip).width/2,FIELD.menu.topPad/3)}else if(s>=0&&!l.isGrey){l=this.buttons[s];a.fillText(l.tooltip,r/2-a.measureText(l.tooltip).width/2,FIELD.menu.topPad/3)}if(this._closure>0){i.save();var p=Math.sqrt(.5-.5*Math.cos(Math.PI*this._closure)),T=this.x0+FIELD.tileWidth/2+p*((this.w0-FIELD.tileWidth)/2),R=i.createLinearGradient(T-this.w0/2,this.y0+this.h0/2,T,this.y0+this.h0/2);R.addColorStop(0,"#444"),R.addColorStop(1,"#4e7566"),i.fillStyle=R,i.fillRect(this.x0+FIELD.tileWidth/2,this.y0+FIELD.tileHeight/2,p*((this.w0-FIELD.tileWidth)/2),this.h0-FIELD.tileHeight);var m=this.x0+this.w0-FIELD.tileWidth/2-p*((this.w0-FIELD.tileWidth)/2),g=i.createLinearGradient(m,this.y0+this.h0/2,m+this.w0/2,this.y0+this.h0/2);g.addColorStop(1,"#444"),g.addColorStop(0,"#4e7566"),i.fillStyle=g,i.fillRect(this.x0+this.w0-FIELD.tileWidth/2,this.y0+FIELD.tileHeight/2,-p*((this.w0-FIELD.tileWidth)/2),this.h0-FIELD.tileHeight),i.beginPath(),i.moveTo(T,this.y0+FIELD.tileHeight/2),i.lineTo(T,this.y0-FIELD.tileHeight/2+this.h0),i.moveTo(m,this.y0+FIELD.tileHeight/2),i.lineTo(m,this.y0-FIELD.tileHeight/2+this.h0),i.strokeStyle="#222",i.lineWidth=FIELD.tileWidth/12,i.setLineDash([]),i.stroke(),i.lineWidth=FIELD.tileWidth/24,i.strokeStyle="#324d42",i.setLineDash([5,3]),i.stroke(),i.restore()}}static resize(){var e=FIELD.menu.pad,t=FIELD.menu.topPad,i=FIELD.menu.cols,a=FIELD.menu.rows;MENU.w0=(e+FIELD.tileWidth)*(i+1),MENU.h0=(e+FIELD.tileHeight)*(a+1)+t,MENU.topPad=t,MENU.tileMargin=e,MENU.numWidth=i,MENU.numHeight=a}static initialize(){var e=0;if(SCENARIO.menuGrey&&SCENARIO.menuGrey.length>3)e=1;var t=FIELD.menu.pad,i=FIELD.menu.topPad,a=FIELD.menu.cols,r=FIELD.menu.rows;MENU.reset(),MENU.w0=(t+FIELD.tileWidth)*(a+1),MENU.h0=(t+FIELD.tileHeight)*(r+1)+i,MENU.topPad=i,MENU.tileMargin=t,MENU.numWidth=a,MENU.numHeight=r;var s=["DarkGoldenRod","GoldenRod"],o=["cWire","switch","cCombine","cSplit","cInvert","cInvert","qWire","qControl","qCombine","measure","qFlip","rotate","cCreate","qCreate","delay","sync","upgrade","trash","compare","qCompare","cCreate","qCreate"],n=["Bit wire","Bit control","Bit wire combiner","Bit wire splitter","Bit inversion / identity","Bit re-zero / identity","Qubit wire","Qubit control","Qubit wire combiner","Qubit measure","Qubit flip / identity","Qubit rotation","Bit creation","Qubit creation","Delay","Sync","Bit-to-qubit","Incinerator","Bit / qubit comparison","Qubit comparison","Bit creation (preset)","Qubit creation (preset)"];if(0===e)var l=18;else l=o.length;for(var h=0;h<l;h++){var d=h%6,u=Math.floor(h/6),c={type:o[h],orient:0,rot:Math.PI/4,state:0,remaining:-1,counter:0,undercol:s,isControlled:!1,basecol:GRADS.gates,counterMax:-1};if("cWire"===c.type){var I=new PathSet("cWire",32,32),E=new Path2D("M 1 16 L 31 16");I.add({path:E,stroke:"MidnightBlue",lineWidth:2,lineCap:"round",shadowStroke:"dodgerblue"});var f=new Button(0,d,u,I,n[h],0,JSON.parse(JSON.stringify(c)));MENU.addButton(f,n[h],0,c,SCENARIO.menuGrey[u][d])}else if("qWire"===c.type){I=new PathSet("qWire",32,32),E=new Path2D("M 1 16 L 31 16");I.add({path:E,stroke:"Darkred",lineWidth:2,lineCap:"round",shadowStroke:"#DD0000"});f=new Button(0,d,u,I,n[h],0,JSON.parse(JSON.stringify(c)));MENU.addButton(f,n[h],0,c,SCENARIO.menuGrey[u][d])}else if("switch"===c.type){c.rot=1,c.state=1;f=new Button(0,d,u,PathsG.simpleSwitch(0),n[h],0,JSON.parse(JSON.stringify(c)));MENU.addButton(f,n[h],0,c,SCENARIO.menuGrey[u][d])}else if("qControl"===c.type){c.rot=0;f=new Button(0,d,u,PathsG.simpleControl(c.rot,0),n[h],0,JSON.parse(JSON.stringify(c)));MENU.addButton(f,n[h],0,c,SCENARIO.menuGrey[u][d])}else{["cCombine","cSplit","cInvert","cCreate","qCreate","qCombine","measure","upgrade","delay"].indexOf(c.type)>=0?c.rot=0:["rotate","qFlip"].includes(c.type)?c.rot=Math.PI/2:c.rot=Math.PI/4,"cCreate"===c.type&&(c.remaining=-2),"qCreate"===c.type&&(c.remaining=-2),5===h&&"cInvert"===c.type?c.state=1:"delay"===c.type?c.state=2:c.state=0,["cCreate","qCreate"].indexOf(c.type)>=0&&3===u&&(c.state=2);f=new Button(0,d,u,PathsG.make(CANV.ctxMB,c),n[h],0,JSON.parse(JSON.stringify(c)));MENU.addButton(f,n[h],0,c,SCENARIO.menuGrey[u][d])}}return MENU}}class Button{constructor(e,t,i,a,r,s=0,o={},n=!1){this._label=e,this._i0=t,this._j0=i,this._hovered=!1,this._selected=!1,this._isGrey=n,this._tile=a,this._tooltip=r,this._menuState=s,this._defaultProperties=o}get isGrey(){return this._isGrey}get label(){return this._label}get i0(){return this._i0}get j0(){return this._j0}get hovered(){return this._hovered}get selected(){return this._selected}get tile(){return this._tile}get tooltip(){return this._tooltip}get menuState(){return this._menuState}get defaultProperties(){return this._defaultProperties}set isGrey(e){this._isGrey=e}set label(e){this._label=e}set i0(e){this._i0=e}set j0(e){this._j0=e}set hovered(e){this._hovered=e}set selected(e){this._selected=e}set tile(e){this._tile=e}set tooltip(e){this._tooltip=e}set menuState(e){this._menuState=e}gridPos(e,t){var i=this.x0+e*this.tileWidth+(e+1)*this.tileMargin,a=this.y0+t*this.tileWidth+(t+1)*this.tileMargin;return{x0:i,y0:a}}clear(){this._defaultProperties={}}}class MouseDown{static main(e){FIELD.isBlur=!1,STATE.isScrollManip=!1,STATE.pos=ControlState.pos(e),STATE.checkUnder(),0!==e.button?2!==e.button||MouseDown.right(e):MouseDown.left(e)}static right(e){if("ctrlbutton"!==STATE.under.type)if(MENU.selected>=0)MENU.setSelected(-1,-1),STATE.state="free";else if("erasing"===STATE.state)STATE.state="free";else if("gatemanip"===STATE.state)STATE.state="free",STATE.grab={type:"free",i0:-1,j0:-1,k0:-1};else{if("gatedrag"===STATE.state)return;if("constructing"===STATE.mode)return STATE.underLast.type="none",void MouseDown.beginDestroy()}else MouseDown.clickCtrl(e,!0)}static beginDestroy(){STATE.state="destroying",STATE.grab={type:"none",i0:0,j0:0,k0:0};var e=STATE.under.i0+STATE.under.j0*FIELD.cols;if("boardtile"===STATE.under.type&&SCENARIO.editable[e]>0&&2!==SCENARIO.editable[e]){var t=IBOARD.getTile(STATE.under.i0,STATE.under.j0);t>-1&&SFX.destroy.play(),IBOARD.clearTile(STATE.under.i0,STATE.under.j0)}}static left(e){STATE.pos.x,STATE.pos.y;if("constructing"===STATE.mode&&"none"===STATE.under.type)return STATE.state="free",STATE.grab={type:"none",i0:0,j0:0,k0:0},void MENU.setSelected(-1,-1);if("escbutton"===STATE.under.type)return 0===STATE.under.i0?Helper.esc():1===STATE.under.i0||2===STATE.under.i0&&(OPTS.sfxOn=!OPTS.sfxOn),void Helper.drawToggles();if("robbutton"!==STATE.under.type){if("journalButton"===STATE.under.type)return SFX.click.play(),PopWindow.setText(),POPWINDOW.movableWindow.style.display="block",POPWINDOW.isOpen=!0,void(POPWINDOW.text.scrollTop=0);if("constructing"===STATE.mode&&"eraser"===STATE.under.type&&(SFX.click2.play(),STATE.state="erasing",STATE.grab={type:"free",i0:-1,j0:-1,k0:-1},MENU.setSelected(-1,-1)),"constructing"===STATE.mode&&"erasing"===STATE.state&&"boardtile"===STATE.under.type)return STATE.underLast.type="none",void MouseDown.beginDestroy();if("constructing"!==STATE.mode||"letterButton"!==STATE.under.type){if("levelSelect"===STATE.mode){if("selectButton"===STATE.under.type)return FIELD.neededBrief=STATE.under.i0,void(FIELD.forced=!0);if("token"===STATE.under.type){Storage.saveGeneric(),SFX.select2.play(),TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible";var t=STATE.under.k0;SCENARIO.whichOne=t.link,t.isHover=!1,InitScenario.load(t.link,!1);var i=!0;return RobotSpeech.grab(SCENARIO.whichOne,0)||(i=!1),PERSIST0[SCENARIO.whichOne].hasRobot&&(i=!1),FIELD.disableBriefs&&(i=!1),void(i&&(PERSIST0[SCENARIO.whichOne].hasRobot=!0,Render.boardSingle(IBOARD),ROBOT.oldMode="constructing",STATE.mode="robot",ResetConsts.robot()))}}if("tutorial"!==STATE.mode)if("title"!==STATE.mode){if("finished"===STATE.mode){if("nextbutton"===STATE.under.type&&0===STATE.under.k0)return void MouseDown.resetFromFinished(e);if("nextbutton"===STATE.under.type&&1===STATE.under.k0)return SFX.select2.play(),void Helper.esc()}if("forwardTrans"!==STATE.mode&&"backwardTrans"!==STATE.mode){if("constructing"===STATE.mode&&"blueprint"===STATE.under.type)return STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},void(STATE.blueprint!==STATE.under.i0&&(SFX.click.play(),PERSIST0[SCENARIO.name].tiles[STATE.blueprint]=[...IBOARD._tiles],PERSIST0[SCENARIO.name].gates[STATE.blueprint]=IBOARD.getAllGates(),STATE.blueprint=STATE.under.i0,PERSIST0[SCENARIO.name].currblue=STATE.under.i0,IBOARD=IBOARD.copyNoGates(),IBOARD.setAllGates(JSON.parse(JSON.stringify(PERSIST0[SCENARIO.name].gates[STATE.blueprint]))),IBOARD._tiles=[...PERSIST0[SCENARIO.name].tiles[STATE.blueprint]],LevelRefresh(SCENARIO.name,IBOARD),UNDOREDO.reset(!0),Blueprint.draw()));if("constructing"===STATE.mode){if("undobutton"===STATE.under.type)return void UNDOREDO.retreat();if("redobutton"===STATE.under.type)return void UNDOREDO.advance()}if("ctrlbutton"!==STATE.under.type){if("constructing"===STATE.mode&&"questionicon"===STATE.under.type){SFX.click.play();for(var a=MENU.buttons[MENU.selected],r=a.tile.name,s=0;s<MDATA.tutsLink.length;s++)if(MDATA.tutsLink[s].indexOf(r)>=0)return TUTORIAL.current=s,TUTORIAL.oldMode=STATE.mode,TUTORIAL.channelsCol=[...SCENARIO.channelsCol],STATE.mode="tutorial",ResetConsts.tutorial(),void(TUTORIAL.show=!0)}if("constructing"!==STATE.mode||"menubutton"!==STATE.under.type){if("constructing"===STATE.mode){if("qubiting"===STATE.state){if(MouseDown.clickAnalysis(e))return;"boardtile"===STATE.under.type&&MouseDown.clickFreeBoard(e)}else{if("destroying"===STATE.state)return void(STATE.state="free");if("gatemanip"===STATE.state)return"qubit"===STATE.under.type?void MouseDown.clickQubit(e):void MouseDown.clickGateManip(e);if("free"===STATE.state&&"qubit"===STATE.under.type)return void MouseDown.clickQubit(e)
;if("free"===STATE.state&&"boardtile"===STATE.under.type&&e.altKey)return SFX.click2.play(),void MouseDown.quickToggleSwitch(e);if("free"===STATE.state&&"boardtile"===STATE.under.type)return void MouseDown.clickFreeBoard(e);if("placing"===STATE.state){if("boardtile"===STATE.under.type)return void MouseDown.clickPlace(e)}else if("multiplace"===STATE.state)return COPYBUFFER.place(),COPYBUFFER.reset(),void(STATE.state="free")}if(MouseDown.clickQubit(e))return}if(["running","paused"].indexOf(STATE.mode)>=0){if("qubiting"===STATE.state&&MouseDown.clickAnalysis(e))return;if(MouseDown.clickQubit(e))return;return STATE.state="free",void(STATE.grab={type:"none",i0:0,j0:0,k0:0})}}else{a=MENU.getButton(STATE.under.i0,STATE.under.j0);-1!==a&&(a.isGrey||(SFX.click2.play(),STATE.state="placing",MENU.selProperties=JSON.parse(JSON.stringify(MENU.getButton(STATE.under.i0,STATE.under.j0).defaultProperties)),MENU.setSelected(STATE.under.i0,STATE.under.j0)))}}else MouseDown.clickCtrl(e,!1)}}else"optionbut"===STATE.under.type?0===STATE.under.i0?ConfirmationBox.openTitle():1===STATE.under.i0&&Helper.esc():"titlebutton"===STATE.under.type?0===STATE.under.i0?(TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible",SFX.select2.play(),SCENARIO.whichOne=SCENARIO.default,SCENARIO.solution=!1,InitScenario.load(SCENARIO.whichOne,SCENARIO.solution),Storage.saveGeneric()):1===STATE.under.i0&&(SFX.select2.play(),STATE.state="options",Overlay.createTitleOptions(CANV.titleAbout.ctx),STATE.grab={type:"none",i0:-1,j0:-1,k0:-1}):"titleslider"===STATE.under.type?(0===STATE.under.i0?(OPTS.music=Math.min(Math.max(0,STATE.under.j0/100),1),SFX.background.volume=OPTS.music,STATE.grab.type="titleslider",STATE.grab.i0=0,PERSIST0.generic.music=OPTS.music):1===STATE.under.i0&&(OPTS.sfx=Math.min(Math.max(0,STATE.under.j0/100),1),STATE.grab.type="titleslider",STATE.grab.i0=1,PERSIST0.generic.sfx=OPTS.sfx),Storage.saveGeneric()):"titleoption"===STATE.under.type&&(0===STATE.under.j0?0===STATE.under.i0?(OPTS.autoResize=!0,PERSIST0.generic.autoResize=OPTS.autoResize,TIMER.resize=1):1===STATE.under.i0&&(OPTS.autoResize=!1,PERSIST0.generic.autoResize=OPTS.autoResize):1===STATE.under.j0?0===STATE.under.i0?(OPTS.fancyGraphics=!0,PERSIST0.generic.fancyGraphics=OPTS.fancyGraphics,Graphics.init()):1===STATE.under.i0&&(OPTS.fancyGraphics=!1,PERSIST0.generic.fancyGraphics=OPTS.fancyGraphics,Graphics.init()):2===STATE.under.j0&&(0===STATE.under.i0?(FIELD.disableBriefs=!1,PERSIST0.generic.disableBriefs=FIELD.disableBriefs):1===STATE.under.i0&&(FIELD.disableBriefs=!0,PERSIST0.generic.disableBriefs=FIELD.disableBriefs)),Storage.saveGeneric());else TutControl.click()}else{if(0===STATE.under.i0)return SFX.click.play(),TUTORIAL.current=TUTORIAL.default,TUTORIAL.oldMode=STATE.mode,TUTORIAL.channelsCol=[...SCENARIO.channelsCol],STATE.mode="tutorial",ResetConsts.tutorial(),void(TUTORIAL.show=!0);if(1===STATE.under.i0){ROBOT.oldMode=STATE.mode,STATE.mode="robot",FIELD.forced=!0;var o=ResetConsts.robot();o?(SFX.click.play(),TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible"):SFX.invalid.play()}else 2===STATE.under.i0?(SFX.click.play(),UNDOREDO.add(),LevelRefresh(SCENARIO.name,IBOARD)):3===STATE.under.i0&&(SFX.click.play(),document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible",ConfirmationBox.open())}}else 0===STATE.under.i0&&(SFX.click.play(),RobotSpeech.advanceText())}static clickCtrl(e,t){var i=STATE.under.k0;if("ctrlStart"===i.tileType){if(STATE.state="free",STATE.grab={type:"none",i0:0,j0:0,k0:0},"constructing"===STATE.mode){if(TIMER.construct>=0)return!0;RANDS.locs=Array.from(RANDS.locs,()=>Math.floor(1e5*Math.random())),PERSIST0[SCENARIO.name].tiles[STATE.blueprint]=[...IBOARD._tiles],PERSIST0[SCENARIO.name].gates[STATE.blueprint]=IBOARD.getAllGates(),Storage.save(PERSIST0[SCENARIO.name],SCENARIO.name,0),TIMER.finishTime=0,TIMER.shake=0,STATE.mode="forwardTrans",STATE.grab={type:"none",i0:0,j0:0,k0:0},i.transition={status:!0,start:0,stop:1},i.startAnimation(),TIMER.victoryTick=99999,SCENARIO.currentRep=1,SCENARIO.correctReps=0,SCENARIO.repSuccess=0,CANV.baseWires.clear(),Render.boardWires(IBOARD,CANV.baseWires.ctx);var a=CTRLMENU.getNamedButton("ctrlPlay"),r=CTRLMENU.getNamedButton("ctrlStep"),s=CTRLMENU.getNamedButton("ctrlBack"),o=CTRLMENU.getNamedButton("ctrlNorm");a.tileProperties.type=0,r.tileProperties.type=0,s.tileProperties.type=0,o.tileProperties.type=0,a.open(),r.open(),s.open(),o.open(),FIELD.cleanTiles=Helper.countCleanTiles(IBOARD.tiles),SFX.startup.play(),SFX.rightBeeped=!0,SFX.wrongBeeped=!0,SFX.tickBeeped=!1,t&&(TIMER.timePerTick=1)}else"running"===STATE.mode||"paused"===STATE.mode?(STATE.grab={type:"none",i0:0,j0:0,k0:0},TIMER.timePerTick=TIMER.defaultTimePerTick,TIMER.shake=0,SCENARIO.currentRep=1,STATE.mode="backwardTrans",STATE.state="free",i.transition={status:!0,start:1,stop:0},i.startAnimation(),TIMER.tickEnd=TIMER.tick,TIMER.ratio>.5&&(TIMER.tickEnd=TIMER.tick+1),CTRLMENU.getNamedButton("ctrlPlay").close(),CTRLMENU.getNamedButton("ctrlStep").close(),CTRLMENU.getNamedButton("ctrlBack").close(),CTRLMENU.getNamedButton("ctrlNorm").close(),SFX.stopdown.play()):"finished"!==STATE.mode&&"finished"!==ROBOT.oldMode||(i.transition={status:!0,start:1,stop:0},i.startAnimation(),"robot"===STATE.mode&&Helper.esc(),MouseDown.resetFromFinished(e),SFX.stopdown.play());return!0}if("ctrlNorm"===i.tileType)return i.startAnimation(),TIMER.timePerTick=TIMER.defaultTimePerTick,!0;if("ctrlBack"===i.tileType){if("finished"===STATE.mode||"finished"===ROBOT.oldMode)return"robot"===STATE.mode&&Helper.esc(),SFX.stopdown.play(),void MouseDown.backFromFinished(e);if(i.startAnimation(),"running"===STATE.mode)TIMER.timePerTick=Math.min(2*TIMER.timePerTick,4*TIMER.defaultTimePerTick);else if("paused"===STATE.mode&&TIMER.boardTime%1<1e-5){var n=Math.max(1,Math.round(TIMER.defaultTimePerTick/(16*TIMER.timePerTick)));if(0===RBOARD[Math.max(0,TIMER.tick-n)])return;if(TIMER.tick=Math.max(0,TIMER.tick-n),TIMER.boardTime=Math.max(0,TIMER.boardTime-n),"qubit"===STATE.grab.type){for(var l=STATE.grab.k0.id,h=RBOARD[TIMER.tick].qubitList,d=!1,u=0;u<h.length;u++)if(h[u].id===l){STATE.grab.i0=h[u].i0,STATE.grab.j0=h[u].j0,STATE.grab.k0=h[u],d=!0;break}d||(STATE.grab={type:"none",i0:0,j0:0,k0:0})}}return!0}if("ctrlStep"===i.tileType)return i.startAnimation(),"running"===STATE.mode?TIMER.timePerTick=Math.max(TIMER.timePerTick/2,1):"paused"===STATE.mode&&(TIMER.boardTime+=1e-4,RBOARD[TIMER.tick+1]=RBOARD[TIMER.tick].copy().updateOneStep(TIMER.tick)),!0;if("ctrlPlay"===i.tileType){i.startAnimation();r=CTRLMENU.getNamedButton("ctrlStep"),s=CTRLMENU.getNamedButton("ctrlBack");return"paused"===STATE.mode?(SCENARIO.isPaused=!1,RBOARD[TIMER.tick+1]=RBOARD[TIMER.tick].copy().updateOneStep(TIMER.tick),i.transition={status:!0,start:1,stop:0},r.transition={status:!0,start:1,stop:0},s.transition={status:!0,start:1,stop:0},STATE.mode="running"):"running"===STATE.mode&&(SCENARIO.isPaused=!0,i.transition={status:!0,start:0,stop:1},r.transition={status:!0,start:0,stop:1},s.transition={status:!0,start:0,stop:1},STATE.mode="paused"),!0}}static clickAnalysis(e){if("qubiting"===STATE.state){if("analysiswindow"===STATE.under.type)return!0;if("analysishighlight"===STATE.under.type)return SFX.click2.play(),ANALYSIS.highlight[STATE.under.k0]=(ANALYSIS.highlight[STATE.under.k0]+1)%3,STATE.pressed={type:"analysisicon",i0:TIMER.totalTime,j0:0,k0:STATE.under.k0},!0;if("analysisgatecontrol"===STATE.under.type)return STATE.state="analysisgatecontrolling",!0;if("analysisgate"===STATE.under.type){var t=STATE.grab.k0;if(t.entGroup){var i=t.entGroup.qubitList[STATE.under.k0];return STATE.grab={type:"qubit",i0:i.i0,j0:i.j0,k0:i},i.computeMeasureProb(),!0}return!0}}return!1}static clickQubit(e){if("qubiticon"===STATE.under.type){var t=STATE.grab.k0;return t&&(SFX.click2.play(),STATE.pressed={type:"qubiticon",i0:TIMER.totalTime,j0:0,k0:0},t.lockedBasis=!t.lockedBasis),!0}if("qubitcontrol"===STATE.under.type)return STATE.state="qubitbasis",STATE.grab.type="qubitcontrol",STATE.grab.l0=STATE.under.k0,!0;if("qubit"===STATE.under.type){t=STATE.under.k0;if(!t.isGhost){SFX.click2.play();var i=!1,a=!1;if("qubiting"===STATE.state){var r=STATE.grab.k0;t.id===r.id?(i=!0,a=!0):t.entGroup&&r.entGroup&&t.entGroup.id===r.entGroup.id&&(a=!0)}return i||t.computeMeasureProb(),a||(ANALYSIS.highlight=ANALYSIS.highlight.fill(0)),STATE.state="qubiting",STATE.under.k0.isHovered=!1,STATE.grab={type:STATE.under.type,i0:STATE.under.i0,j0:STATE.under.j0,k0:STATE.under.k0},!0}}return!1}static clickGateIcon(e){var t=STATE.grab.type;if(STATE.pressed={type:"gateicon",i0:TIMER.totalTime,j0:0,k0:STATE.under.k0},4===STATE.under.k0||5===STATE.under.k0){if("switch"===t){var i=STATE.grab.k0;if(1===i.state?i.rot=1-i.rot:i.rot=STATE.under.k0-4,i.rot<2){var a=i.orient,r=STATE.grab.i0,s=STATE.grab.j0;0==a?s+=1:1==a?r-=1:2==a?s-=1:3==a&&(r+=1),IBOARD.setState(r,s,i.rot)}return}var o=STATE.under.k0-4,n=IBOARD.checkWhichControl(STATE.grab.i0,STATE.grab.j0),l=(STATE.grab.k0,STATE.grab.i0),h=STATE.grab.j0;r=STATE.grab.i0,s=STATE.grab.j0;0===n.dir?r-=1:1===n.dir?s-=1:2===n.dir?r+=1:3===n.dir&&(s+=1);var d=IBOARD.getGate(r,s);return d.rot=o,IBOARD.setState(l,h,o),void(STATE.grab={type:STATE.grab.type,i0:l,j0:h,k0:IBOARD.getGate(l,h,o)})}if(["qCreate","cCreate"].indexOf(t)>=0){i=STATE.grab.k0;0===STATE.under.k0?-1===i.counterMax?i.counterMax=9:i.counterMax-=1:1===STATE.under.k0?9===i.counterMax?i.counterMax=-1:i.counterMax+=1:"qCreate"===t&&2===STATE.under.k0&&(5===i.state?i.state=0:i.state=5)}else if(["trash"].indexOf(t)>=0){i=STATE.grab.k0;i.state=1-i.state}else if(["qFlip"].indexOf(t)>=0){i=STATE.grab.k0;i.state=1-i.state}else if(["cInvert"].indexOf(t)>=0){i=STATE.grab.k0;i.rot=1-i.rot}else if(["qControl"].indexOf(t)>=0){i=STATE.grab.k0;i.state=1-i.state;r=STATE.grab.i0,s=STATE.grab.j0;0==i.orient?s+=1:1==i.orient?r-=1:2==i.orient?s-=1:3==i.orient&&(r+=1),IBOARD.setState(r,s,i.state)}else if(["switch"].indexOf(t)>=0){i=STATE.grab.k0;i.rot=1-i.rot;a=i.orient,r=STATE.grab.i0,s=STATE.grab.j0;0==a?s+=1:1==a?r-=1:2==a?s-=1:3==a&&(r+=1),IBOARD.setState(r,s,i.rot)}return t}static resetFromFinished(e){ROBOT.oldMode="none",STATE.grab={type:"none",i0:0,j0:0,k0:0},TIMER.timePerTick=TIMER.defaultTimePerTick,TIMER.victoryTick=9999,TIMER.tickEnd=TIMER.tick,TIMER.shake=0,TIMER.tick=0,TIMER.boardTime=0,FIELD.channelsDir=[...SCENARIO.channelsDir],STATE.mode="backwardTrans",STATE.state="free",TIMER.finishTime=TIMER.finishMid;var t=CTRLMENU.getNamedButton("ctrlBack");t.close();var i=CTRLMENU.getNamedButton("ctrlStart");i.transition={status:!0,start:1,stop:0}}static backFromFinished(e){return ROBOT.oldMode="none",STATE.grab={type:"none",i0:0,j0:0,k0:0},FIELD.channelsDir=[...SCENARIO.channelsDir],TIMER.shake=0,STATE.under.k0.startAnimation(),STATE.mode="paused",TIMER.tick-=2,TIMER.boardTime=TIMER.tick,TIMER.finishTime=0,TIMER.timePerTick=TIMER.defaultTimePerTick,TIMER.victoryTick=9999,STATE.grab={type:"none",i0:0,j0:0,k0:0},SCENARIO.victory=-1,CTRLMENU.getNamedButton("ctrlPlay").open(),CTRLMENU.getNamedButton("ctrlStep").open(),CTRLMENU.getNamedButton("ctrlNorm").open(),CANV.victoryBase.clear(),CANV.victoryText.clear(),Ticker.draw(CANV.ticker,FIELD.tileWidth/6,-FIELD.tileWidth/6,2*FIELD.tileWidth/3,4*FIELD.tileWidth/3),SCENARIO.currentRep-=1,SCENARIO.correctReps-=SCENARIO.repSuccess,!0}static quickToggleSwitch(e){var t=STATE.under.i0,i=STATE.under.j0,a=t+i*FIELD.cols,r=IBOARD.getGate(t,i,IBOARD.getState(t,i)),s=IBOARD.checkControl(t,i,["switch"]);if("switch"===r.type){if(SCENARIO.editable[a]>=1&&STATE.under.k0<4){r.rot=1-r.rot;var o=r.orient,n=t,l=i;return 0==o?l+=1:1==o?n-=1:2==o?l-=1:3==o&&(n+=1),IBOARD.setState(n,l,r.rot),STATE.state="free",void(STATE.grab={type:"free",i0:-1,j0:-1,k0:-1})}}else if(s>=0&&SCENARIO.editable[a]>=1){n=t,l=i;0==s?n-=1:1==s?l-=1:2==s?n+=1:3==s&&(l+=1);r=IBOARD.getGate(n,l,IBOARD.getState(n,l));return r.rot=1-r.rot,IBOARD.setState(t,i,r.rot),STATE.state="free",void(STATE.grab={type:"free",i0:-1,j0:-1,k0:-1})}}static clickFreeBoard(e){var t=STATE.under.i0,i=STATE.under.j0,a=t+i*FIELD.cols,r=IBOARD.getGate(t,i,IBOARD.getState(t,i)),s=IBOARD.getTile(t,i,IBOARD.getState(t,i)),o=Math.floor(s/20);if(!r)return e.shiftKey||e.ctrlKey||e.metaKey?(e.shiftKey?STATE.isDestroy=!1:STATE.isDestroy=!0,SFX.click2.play(),void(SCENARIO.editable[a]>=1&&(STATE.state="premultiplace",STATE.pressed={type:"board",i0:t,j0:i,k0:0},COPYBUFFER.reset(),COPYBUFFER.w0=1,COPYBUFFER.h0=1,COPYBUFFER.center={x:t,y:i},COPYBUFFER.corner={xL:t,xR:t,yT:i,yB:i},COPYBUFFER.checkUnder()))):5===o||[12,13,32,33].includes(s)?SCENARIO.menuGrey&&SCENARIO.menuGrey[0][0]?void(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1}):(STATE.state="prewiring",void(STATE.grab={type:o,i0:STATE.under.i0,j0:STATE.under.j0,k0:s})):0===o?SCENARIO.menuGrey&&SCENARIO.menuGrey[1][0]?void(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1}):(STATE.state="preqwiring",void(STATE.grab={type:o,i0:STATE.under.i0,j0:STATE.under.j0,k0:s})):1===o?SCENARIO.menuGrey&&SCENARIO.menuGrey[0][0]?void(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1}):(STATE.state="precwiring",void(STATE.grab={type:o,i0:STATE.under.i0,j0:STATE.under.j0,k0:s})):void(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1});SFX.click2.play(),STATE.pressed={type:"none",i0:0,j0:0,k0:0};var n=!0;return SCENARIO.editable[a]<1&&!1,["sync"].indexOf(r.type)>=0&&(n=!1),e.shiftKey||e.ctrlKey||e.metaKey?(e.shiftKey?STATE.isDestroy=!1:STATE.isDestroy=!0,void(SCENARIO.editable[a]>=1&&(STATE.state="premultiplace",STATE.pressed={type:"board",i0:t,j0:i,k0:0},COPYBUFFER.reset(),COPYBUFFER.w0=1,COPYBUFFER.h0=1,COPYBUFFER.center={x:t,y:i},COPYBUFFER.corner={xL:t,xR:t,yT:i,yB:i},COPYBUFFER.checkUnder()))):n?(STATE.state="pregatemanip",void(STATE.grab={type:r.type,i0:STATE.under.i0,j0:STATE.under.j0,k0:r})):void 0}static clickPlace(e){var t=MENU.buttons[MENU.selected],i="cWire"===t.tile.name||"qWire"===t.tile.name;t.defaultProperties;if(!i){if(!STATE.validPlacement)return void SFX.invalid.play();if("sync"===t.tile.name){var a=IBOARD.getGate(STATE.under.i0,STATE.under.j0);if("sync"===a.type&&a.orient===MENU.selProperties.orient)return}var r=JSON.parse(JSON.stringify(MENU.selProperties));["cCombine","qCombine","cSplit","cCreate","qCreate","switch","compare","sync","qControl","upgrade"].indexOf(t.tile.name)>=0?r.orient=(MENU.selProperties.orient+STATE.extraOrient)%4:["cInvert","cCompare","cCompare","delay","measure","qFlip","rotate"].indexOf(t.tile.name)>=0&&(r.orient=(MENU.selProperties.orient+STATE.extraOrient)%2),IBOARD.clearTile(STATE.under.i0,STATE.under.j0,!1);var s=new Gate(STATE.under.i0,STATE.under.j0,t.tile.name,"free",0,0,0,0);s.setProperties(r),IBOARD.setGate(s),SFX.wire.play();var o=0,n=IBOARD.checkWhichControl(STATE.under.i0,STATE.under.j0);if(n.dir>=0){o=new Gate(STATE.under.i0,STATE.under.j0,t.tile.name,"free",0,0,1,0);if(o.setProperties(JSON.parse(JSON.stringify(r))),IBOARD.setGate(o),"switch"===n.type){var l=Helper.coordFromDir({i0:STATE.under.i0,j0:STATE.under.j0},n.dir),h=IBOARD.getGate(l.i1,l.j1);IBOARD.setState(STATE.under.i0,STATE.under.j0,h.rot),0===h.rot?"rotate"===o.type?o.rot=0:"qFlip"===o.type?o.state=1:"cInvert"===o.type&&(o.rot=1):"rotate"===s.type?s.rot=0:"qFlip"===s.type?s.state=1:"cInvert"===s.type&&(s.rot=1)}}IBOARD.clearAdjacent(STATE.under.i0,STATE.under.j0)}if(["cCreate","qCreate"].indexOf(t.tile.name)>=0)1===s.state&&("cCreate"===s.type?s.counterMax=SCENARIO.CINPUTS[s.rot].length:"qCreate"===s.type&&(s.counterMax=SCENARIO.QINPUTS[s.rot].length));else if(["switch","qControl"].indexOf(t.tile.name)>=0){var d=MENU.selProperties.orient,u=STATE.under.i0,c=STATE.under.j0;0==d?c+=1:1==d?u-=1:2==d?c-=1:3==d&&(u+=1);var I=IBOARD.getGate(u,c);if(I){var E=I.copy();if(E.layer=1,IBOARD.setGate(E),"switch"===t.tile.name){var f=s.rot;IBOARD.setState(u,c,f),1===f?"rotate"===I.type?I.rot=0:"qFlip"===I.type?I.state=1:"cInvert"===I.type&&(I.rot=1-I.rot):0===f&&("rotate"===E.type?E.rot=0:"qFlip"===E.type?E.state=1:"cInvert"===E.type&&(E.rot=1-E.rot))}}}else if(["sync"].indexOf(t.tile.name)>=0){d=MENU.selProperties.orient,u=STATE.under.i0,c=STATE.under.j0;0==d?c+=1:1==d?u-=1:2==d?c-=1:3==d&&(u+=1),IBOARD.clearTile(u,c,!1),IBOARD.setGate(new Gate(u,c,"sync","free",(d+2)%4,0,0)),IBOARD.clearAdjacent(u,c)}if(UNDOREDO.add(),"cWire"===t.tile.name){if(IBOARD.getTile(STATE.under.i0,STATE.under.j0)<0){var S=STATE.under.i0+STATE.under.j0*FIELD.cols;1===SCENARIO.editable[S]&&(SFX.wire.play(),IBOARD.setTile(STATE.under.i0,STATE.under.j0,20))}STATE.state="cwiring",STATE.grab={type:STATE.under.type,i0:STATE.under.i0,j0:STATE.under.j0,k0:STATE.under.k0}}else if("qWire"===t.tile.name){if(IBOARD.getTile(STATE.under.i0,STATE.under.j0)<0){S=STATE.under.i0+STATE.under.j0*FIELD.cols;1===SCENARIO.editable[S]&&(SFX.wire.play(),IBOARD.setTile(STATE.under.i0,STATE.under.j0,0))}STATE.state="qwiring",STATE.grab={type:STATE.under.type,i0:STATE.under.i0,j0:STATE.under.j0,k0:STATE.under.k0}}}static clickGateManip(e){if("gateicon"===STATE.under.type){var t=MouseDown.clickGateIcon(e);return SFX.click2.play(),void("qCreate"!==t&&"cCreate"!==t&&UNDOREDO.add())}if("gatecontrol"===STATE.under.type){STATE.state="gatedrag";var i=STATE.grab.k0,a=STATE.grab.type;return["cCombine","qCombine","cSplit"].indexOf(a)>=0&&(i.rot=i.orient*Math.PI/2,i.orient=0),void SFX.manip.play()}if(STATE.state="free",STATE.grab={type:"none",i0:0,j0:0,k0:0},"boardtile"===STATE.under.type){var r=STATE.under.i0,s=STATE.under.j0,o=IBOARD.getGate(r,s,IBOARD.getState(r,s));if(o&&(SFX.click2.play(),["sync"].indexOf(o.type)<0)){var n=r+s*FIELD.cols;if(SCENARIO.editable[n]>0)return STATE.state="gatemanip",void(STATE.grab={type:o.type,i0:STATE.under.i0,j0:STATE.under.j0,k0:o})}}}}class MouseMove{static main(e){if(STATE.pos=ControlState.pos(e),STATE.checkUnder(),"tutorial"!==STATE.mode)if("title"!==STATE.mode){if("constructing"===STATE.mode){if("free"===STATE.state)return;if("destroying"===STATE.state){var t=STATE.under.i0+STATE.under.j0*FIELD.cols;if("boardtile"===STATE.under.type&&SCENARIO.editable[t]>0&&2!==SCENARIO.editable[t]){var i=IBOARD.getTile(STATE.under.i0,STATE.under.j0);i>=0&&(SFX.destroy.play(),IBOARD.clearTile(STATE.under.i0,STATE.under.j0))}return}if("premultiplace"===STATE.state){if("boardtile"===STATE.under.type){var a=!1;COPYBUFFER.corner.xL!==Math.min(STATE.under.i0,STATE.pressed.i0)&&(a=!0),COPYBUFFER.corner.xR!==Math.max(STATE.under.i0,STATE.pressed.i0)&&(a=!0),COPYBUFFER.corner.yT!==Math.min(STATE.under.j0,STATE.pressed.j0)&&(a=!0),COPYBUFFER.corner.yB!==Math.max(STATE.under.j0,STATE.pressed.j0)&&(a=!0),a&&COPYBUFFER.resize(STATE.under.i0,STATE.under.j0)}else STATE.state="free";return}if("multiplace"===STATE.state){if("boardtile"===STATE.under.type){var r=COPYBUFFER.corner.xL,s=COPYBUFFER.corner.yT;COPYBUFFER.recenter(),r===COPYBUFFER.corner.xL&&s===COPYBUFFER.corner.yT||COPYBUFFER.checkPlacement()}return}if("gatemanip"===STATE.state)return;if("gatedrag"===STATE.state){var o=IBOARD.x0+(STATE.grab.i0+.5)*FIELD.tileWidth+FIELD.leftPad,n=IBOARD.y0+(STATE.grab.j0+.5)*FIELD.tileHeight+FIELD.topPad,l=Math.atan2(STATE.pos.y-n,STATE.pos.x-o),h=STATE.grab.k0,d=STATE.grab.type;if(["cCreate"].indexOf(d)>=0)l+=Math.PI/2,l<0&&(l+=2*Math.PI),h.rot=l/(2*Math.PI/3);else if(["qCreate"].indexOf(d)>=0){l+=Math.PI/2;var u=STATE.grab.k0.numPoints;l<0&&(l+=2*Math.PI),h.rot=l/(2*Math.PI/u)}else["switch","compare"].indexOf(d)>=0?(l+=Math.PI/2,l>Math.PI&&(l-=2*Math.PI),h.rot=l/Math.PI):["qControl"].indexOf(d)>=0?(l+=Math.PI/2,l>Math.PI&&(l-=2*Math.PI),h.rot=l):["cCombine","qCombine","cSplit"].indexOf(d)>=0?(h.rot=l,h.orient=0):["delay"].indexOf(d)>=0?(l+=Math.PI/2,h.rot=4*l/Math.PI,h.state=0):["measure","rotate","qFlip","upgrade"].indexOf(d)>=0&&(h.rot=l+Math.PI/2);return}if("placing"===STATE.state)return;if("preqwiring"===STATE.state||"precwiring"===STATE.state||"prewiring"===STATE.state){if("boardtile"===STATE.under.type){var c=STATE.under.i0,I=STATE.under.j0,E=STATE.grab.k0,f=-1;if(I===STATE.grab.j0&&(c===STATE.grab.i0-1?f=0:c===STATE.grab.i0+1&&(f=2)),c===STATE.grab.i0&&(I===STATE.grab.j0-1?f=1:I===STATE.grab.j0+1&&(f=3)),f>=0)return"prewiring"===STATE.state?0===f?[13,32,100,102,105,107,108,110,113,115].includes(E)?(STATE.state="qwiring",MENU.setSelected(0,1),void RedWire.place()):(STATE.state="cwiring",MENU.setSelected(0,0),void BlueWire.place()):1===f?[12,33,101,103,104,106,109,111,112,114].includes(E)?(STATE.state="qwiring",MENU.setSelected(0,1),void RedWire.place()):(STATE.state="cwiring",MENU.setSelected(0,0),void BlueWire.place()):2===f?[13,32,100,102,105,107,108,110,113,115].includes(E)?(STATE.state="qwiring",MENU.setSelected(0,1),void RedWire.place()):(STATE.state="cwiring",MENU.setSelected(0,0),void BlueWire.place()):3===f?[12,33,101,103,104,106,109,111,112,114].includes(E)?(STATE.state="qwiring",MENU.setSelected(0,1),void RedWire.place()):(STATE.state="cwiring",MENU.setSelected(0,0),void BlueWire.place()):void 0:"preqwiring"===STATE.state?(STATE.state="qwiring",MENU.setSelected(0,1),void RedWire.place()):"precwiring"===STATE.state?(STATE.state="cwiring",MENU.setSelected(0,0),void BlueWire.place()):void 0}return}if("pregatemanip"===STATE.state){if("boardtile"===STATE.under.type){c=STATE.under.i0,I=STATE.under.j0,f=-1;if(I===STATE.grab.j0&&(c===STATE.grab.i0-1?f=0:c===STATE.grab.i0+1&&(f=2)),c===STATE.grab.i0&&(I===STATE.grab.j0-1?f=1:I===STATE.grab.j0+1&&(f=3)),f>=0){t=STATE.grab.j0*IBOARD._width+STATE.grab.i0;var S=Math.floor(IBOARD._tiles[t]/20),p=IBOARD._tiles[t]%20;if(2===S)var T=TILE_EDGES[2][p][f];else if(3===S)T=TILE_EDGES[3][p][f];else if(4===S)T=TILE_EDGES[4][p][f];else T=0;if(1===T){if(SCENARIO.menuGrey&&SCENARIO.menuGrey[1][0])return;return STATE.state="qwiring",MENU.setSelected(0,1),void RedWire.place()}if(2===T){if(SCENARIO.menuGrey&&SCENARIO.menuGrey[0][0])return;return STATE.state="cwiring",MENU.setSelected(0,0),void BlueWire.place()}return}}return}if("cwiring"===STATE.state)return"boardtile"===STATE.under.type?void BlueWire.place():void STATE.state;if("qwiring"===STATE.state)return"boardtile"===STATE.under.type?void RedWire.place():void STATE.state;if("analysisgatecontrolling"===STATE.state)return void MouseMove.analysisGateControl();if("qubitbasis"===STATE.state)return void MouseMove.qubitBasisControl()}else if("paused"===STATE.mode){if("free"===STATE.state)return;if("analysisgatecontrolling"===STATE.state)return void MouseMove.analysisGateControl();if("qubitbasis"===STATE.state)return void MouseMove.qubitBasisControl()}}else if("options"===STATE.state&&"titleslider"===STATE.grab.type){var R=STATE.pos.x-(FIELD.leftPad+114*FIELD.tileWidth/16-5*FIELD.tileWidth/2),m=Math.round(100*(R-1.8*FIELD.tileWidth)/(2.4*FIELD.tileWidth));0===STATE.grab.i0?(OPTS.music!==Math.min(Math.max(0,m/100),1)&&SoundData.setMusic(),OPTS.music=Math.min(Math.max(0,m/100),1),OPTS.musicOn=!0,SFX.background.volume=OPTS.music,Helper.drawToggles()):1===STATE.grab.i0&&(OPTS.sfx!==Math.min(Math.max(0,m/100),1)&&SoundData.setSFX(),OPTS.sfx=Math.min(Math.max(0,m/100),1),OPTS.sfxOn=!0,Helper.drawToggles())}}static analysisGateControl(){var e=STATE.grab.k0;if(e.entGroup){var t=e.entInd,i=e.entGroup.numQubits;e.computeMeasureProb()}else{t=0,i=1;e.computeMeasureProb()}var a=Math.min(2**i,16),r=FIELD.topPad+ANALYSIS.yMeasure+(a+2)*ANALYSIS.basisSpace,s=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+(t+1)*FIELD.tileWidth,o=Math.atan2(STATE.pos.y-r,STATE.pos.x-s);e.measureRot=o+Math.PI/2}static qubitBasisControl(){var e=STATE.pos.x,t=STATE.pos.y,i=STATE.grab.k0;if(STATE.grab.l0<2){var a=STATE.grab.i0,r=STATE.grab.j0,s=IBOARD.x0+(a+.5)*FIELD.tileWidth+FIELD.leftPad,o=IBOARD.y0+(r+.5)*FIELD.tileHeight+FIELD.topPad,n=e-s,l=o-t,h=Math.atan2(n,l);if(0===STATE.grab.l0)i.rotateBasis(h),i.lockedBasis=!1;else if(1===STATE.grab.l0){var d=h+Math.PI;d>Math.PI&&(d-=2*Math.PI),i.rotateBasis(d),i.lockedBasis=!1}}else if(STATE.grab.l0<4){if(i.entGroup){i.entGroup;var u=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+(i.entInd+1)*FIELD.tileWidth,c=FIELD.topPad+ANALYSIS.yPad+FIELD.tileHeight/2}else u=FIELD.analysisLeft+ANALYSIS.xPad+ANALYSIS.xGap+FIELD.tileWidth,c=FIELD.topPad+ANALYSIS.yPad+FIELD.tileHeight/2;n=e-u,l=c-t,h=Math.atan2(n,l);if(2===STATE.grab.l0)i.rotateBasis(h),i.lockedBasis=!1;else if(3===STATE.grab.l0){d=h+Math.PI;d>Math.PI&&(d-=2*Math.PI),i.rotateBasis(d),i.lockedBasis=!1}}}}class MouseUp{static main(e){(e.ctrlKey||e.metaKey)&&e.button;if("destroying"===STATE.state)return UNDOREDO.add(),"eraser"===STATE.underLast.type?STATE.state="erasing":STATE.state="free",void(STATE.underLast={type:"free",i0:-1,j0:-1,k0:-1});if(0===e.button){if("title"===STATE.mode)return void("options"===STATE.state&&(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1}));if("analysisgatecontrolling"===STATE.state){var t=STATE.grab.k0;if(t.entGroup)t.entInd;else;var i=t.measureRot,a=Math.round(i/(Math.PI/8))%16;return a<0&&(a+=16),t.measureRot=a*Math.PI/8,t.computeMeasureProb(),void(STATE.state="qubiting")}if("qubitbasis"===STATE.state){t=STATE.grab.k0;var r=Math.round(8*t.basisRot/Math.PI);return t.rotateBasis(Math.PI*r/8),STATE.state="qubiting",void(STATE.grab.type="qubit")}if("preqwiring"===STATE.state||"precwiring"===STATE.state||"prewiring"===STATE.state)return STATE.state="free",void(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1});if("premultiplace"===STATE.state){if(1===COPYBUFFER.w0&&1===COPYBUFFER.h0){var s=COPYBUFFER.corner.xL,o=COPYBUFFER.corner.yT,n=s+o*FIELD.cols,l=IBOARD.getGate(s,o,IBOARD.getState(s,o));if(l&&SCENARIO.editable[n]>=1){var h=MENU.getNamedButton(l.type,l.state);return SCENARIO.menuGrey&&SCENARIO.menuGrey[h.j0][h.i0]?void(STATE.state="free"):(MENU.setSelected(h.i0,h.j0),MENU.selProperties=JSON.parse(JSON.stringify(l.getProperties())),MENU.selProperties.isControlled=!1,MENU.selProperties.basecol=GRADS.gates,MENU.selProperties.undercol=["DarkGoldenRod","GoldenRod"],STATE.state="placing",STATE.isDestroy&&IBOARD.clearTile(STATE.pressed.i0,STATE.pressed.j0),UNDOREDO.add(),STATE.grab={type:"none",i0:0,j0:0,k0:0},STATE.pressed={type:"none",i0:-1,j0:-1,k0:-1},void COPYBUFFER.reset())}return STATE.state="free",STATE.pressed={type:"none",i0:-1,j0:-1,k0:-1},void COPYBUFFER.reset()}var d=COPYBUFFER.copy();return d?(FIELD.message="Region Copied",TIMER.message=TIMER.messageMax,STATE.state="multiplace",COPYBUFFER.recenter(),COPYBUFFER.checkPlacement(),SFX.click2.play()):(COPYBUFFER.reset(),STATE.state="free"),void(STATE.pressed={type:"none",i0:-1,j0:-1,k0:-1})}if("pregatemanip"===STATE.state){if(STATE.checkUnder(),"boardtile"===STATE.under.type){s=STATE.under.i0,o=STATE.under.j0;if(s===STATE.grab.i0&&o===STATE.grab.j0){n=s+o*FIELD.cols;return SCENARIO.editable[n]>0?void(STATE.state="gatemanip"):(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},void(STATE.state="free"))}return STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},void(STATE.state="free")}return STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},void(STATE.state="free")}if("gatedrag"===STATE.state){var u=STATE.grab.k0;if(["cCreate","qCreate"].indexOf(STATE.grab.type)>=0){var c=Math.round(Math.abs(u.rot)),I=STATE.grab.k0.numPoints;c===I&&(c-=I),u.rot=c}else if(["qControl"].indexOf(STATE.grab.type)>=0){c=Math.round(8*u.rot/Math.PI);u.rot=Math.PI*c/8}else if(["switch"].indexOf(STATE.grab.type)>=0){u.rot=Math.round(Math.abs(u.rot));a=u.orient;var E=STATE.grab.i0,f=STATE.grab.j0;0==a?f+=1:1==a?E-=1:2==a?f-=1:3==a&&(E+=1),IBOARD.setState(E,f,u.rot)}else if(["delay"].indexOf(STATE.grab.type)>=0)u.rot<0&&(u.rot+=8),u.state+=Math.round(u.rot),u.state>7.5&&(u.state=0),u.rot=0;else if(["cCombine","qCombine","cSplit"].indexOf(STATE.grab.type)>=0){var S=u.rot+u.orient*Math.PI/2;a=Math.round(S/(Math.PI/2))%4;a<0&&(a+=4),u.orient=a,u.rot=0;n=u.i0+u.j0*FIELD.cols;IBOARD.tiles[n]=MDATA.GATEID[STATE.grab.type]+u.orient}else if(["measure","rotate","qFlip","upgrade"].indexOf(STATE.grab.type)>=0){a=Math.round(u.rot/(Math.PI/8))%16;a<0&&(a+=16),u.rot=a*Math.PI/8}return UNDOREDO.add(),void(STATE.state="gatemanip")}if("cwiring"===STATE.state||"qwiring"===STATE.state)return UNDOREDO.add(),void(STATE.state="placing");if("rotating"===STATE.state){STATE.state="free";s=STATE.grab.i0,o=STATE.grab.j0,n=STATE.grab.k0;for(var p=0;p<STATE.entGroups.length;p++)if(STATE.entGroups[p].label===s){var T=STATE.entGroups[p];break}var R=T.rots;R[o]=2*Math.PI*(T.degs[o]/16),T.rots=R}}}}const MDATA={GATEID:{qCombine:64,cCombine:44,cSplit:48,rotate:62,trash:84,switch:40,measure:60,cInvert:52,upgrade:85,sync:80,delay:89,cCreate:54,qFlip:68,qCreate:74,compare:91,cCompare:58,qCompare:78,qControl:70,qDubCompare:95,cOneCompare:96}};MDATA.tutsLink=new Array(16).fill(0),MDATA.tutsLink[0]=["cWire","qWire"],MDATA.tutsLink[1]=[],MDATA.tutsLink[2]=[],MDATA.tutsLink[3]=["cInvert"],MDATA.tutsLink[4]=["cCombine","qCombine","cSplit"],MDATA.tutsLink[5]=["cCreate","qCreate","trash"],MDATA.tutsLink[6]=["switch"],MDATA.tutsLink[7]=["delay","sync","upgrade"],MDATA.tutsLink[8]=[],MDATA.tutsLink[9]=["qFlip","rotate"],MDATA.tutsLink[10]=["measure"],MDATA.tutsLink[11]=["qControl"],MDATA.tutsLink[12]=[],MDATA.tutsLink[13]=[],MDATA.tutsLink[14]=[],MDATA.tutsLink[15]=[];const TILE_EDGES=[];TILE_EDGES.push([[0,0,0,0],[0,1,0,1],[1,0,1,0],[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0],[1,1,1,1],[2,1,2,1],[1,2,1,2],[1,1,1,0],[0,1,1,1],[1,0,1,1],[1,1,0,1]]),TILE_EDGES.push([[0,0,0,0],[0,2,0,2],[2,0,2,0],[0,2,2,0],[0,0,2,2],[2,0,0,2],[2,2,0,0],[0,2,0,0],[0,0,2,0],[0,0,0,2],[2,0,0,0],[2,2,2,2],[1,2,1,2],[2,1,2,1],[2,2,2,0],[0,2,2,2],[2,0,2,2],[2,2,0,2]]),TILE_EDGES.push([[2,0,2,0],[0,2,0,2],[2,0,2,0],[0,2,0,2],[2,2,2,2],[2,2,2,2],[2,2,2,2],[2,2,2,2],[2,2,2,2],[2,2,2,2],[2,2,2,2],[2,2,2,2],[2,0,2,0],[0,2,0,2],[0,0,2,0],[0,0,0,2],[2,0,0,0],[0,2,0,0],[2,2,0,0],[2,0,0,2]]),TILE_EDGES.push([[1,2,1,2],[2,1,2,1],[1,0,1,0],[0,1,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,0,1,0],[0,1,0,1],[1,0,1,0],[0,1,0,1],[1,0,1,0],[0,1,0,1],[0,0,1,0],[0,0,0,1],[1,0,0,0],[0,1,0,0],[1,1,0,0],[1,0,0,1]]),TILE_EDGES.push([[3,0,3,0],[0,3,0,3],[3,0,3,0],[0,3,0,3],[3,3,3,3],[2,0,1,0],[0,2,0,1],[1,0,2,0],[0,1,0,2],[3,0,3,0],[0,3,0,3],[2,2,0,0],[0,2,2,0],[0,0,2,2],[2,0,0,2],[1,0,0,0],[2,0,0,0]]),TILE_EDGES.push([[1,2,1,0],[0,1,2,1],[1,0,1,2],[2,1,0,1],[2,1,2,0],[0,2,1,2],[2,0,2,1],[1,2,0,2],[1,2,0,0],[0,1,2,0],[0,0,1,2],[2,0,0,1],[2,1,0,0],[0,2,1,0],[0,0,2,1],[1,0,0,2],[0,0,0,0]]);const CONSTRUCTMAPS={QR0:[-1,0,1,2,3,4,7,8,9,10,11,13,14,15,16,17,20,21,27,29,32,100,102,105,107,108,110,113,115],QR1:[8,8,15,2,3,4,3,8,4,2,11,13,14,15,16,11,8,105,113,110,32,100,102,105,13,100,110,113,102],QRG:[60,62,64,65,66,67,68,70,72,74,78,79,80,82,84,85,89,95],QL0:[-1,0,1,2,5,6,7,8,9,10,11,13,14,15,16,17,20,21,27,29,32,100,102,105,107,108,110,113,115],QL1:[10,10,17,2,5,6,6,2,5,10,11,13,14,11,16,17,10,107,108,115,32,100,102,13,107,108,102,100,115],QLG:[60,62,64,65,66,67,68,70,72,76,78,79,80,82,84,87,89,95],QD0:[-1,0,1,2,4,5,7,8,9,10,11,12,14,15,16,17,20,22,28,30,33,101,103,104,106,109,111,112,114],QD1:[9,9,1,16,4,5,1,4,9,5,11,12,11,15,16,17,9,106,114,111,33,101,103,12,106,101,111,103,114],QDG:[61,63,64,65,66,67,69,71,73,75,79,81,83,84,86,90,95],QU0:[-1,0,1,2,3,6,7,8,9,10,11,12,14,15,16,17,20,22,28,30,33,101,103,104,106,109,111,112,114],QU1:[7,7,1,14,3,6,7,3,1,6,11,12,14,15,11,17,7,104,109,112,33,101,103,104,12,109,103,112,101],QUG:[61,63,64,65,66,67,69,71,73,77,78,81,83,84,88,90,95],CR0:[-1,0,1,7,9,12,20,21,22,23,24,27,28,29,30,31,33,34,35,36,37,101,103,104,106,109,111,112,114],CR1:[28,28,101,109,114,12,28,35,22,23,24,23,28,24,22,31,33,34,35,36,31,101,33,104,106,109,106,104,114],CRG:[40,42,44,45,46,47,48,49,50,51,52,54,61,80,82,84,87,89,92,93],CL0:[-1,0,1,7,9,12,20,21,22,25,26,27,28,29,30,31,33,34,35,36,37,101,103,104,106,109,111,112,114],CL1:[30,30,103,112,111,12,30,37,22,25,26,26,22,25,30,31,33,34,31,36,37,33,103,104,106,104,111,112,106],
CLG:[40,42,44,45,46,47,48,49,50,51,52,56,58,59,61,80,82,84,85,89,91,94,96],CD0:[-1,0,2,8,10,13,20,21,22,24,25,27,28,29,30,31,32,34,35,36,37,100,102,105,107,108,110,113,115],CD1:[29,29,102,110,115,13,29,21,36,24,25,21,24,29,25,31,32,31,35,36,37,32,102,105,107,107,110,105,115],CDG:[41,43,44,45,46,47,48,49,50,51,53,55,59,60,81,83,84,88,90,93,94],CU0:[-1,0,2,8,10,13,20,21,22,23,26,27,28,29,30,31,32,34,35,36,37,100,102,105,107,108,110,113,115],CU1:[27,27,100,113,108,13,27,21,34,23,26,27,23,21,26,31,32,34,35,31,37,100,32,105,107,108,105,113,107],CUG:[41,43,44,45,46,47,48,49,50,51,53,57,58,60,81,83,84,86,90,91,92]},DESTROYMAPS={R0:[2,3,4,8,11,12,13,14,15,16,22,23,24,28,31,32,33,34,35,36,100,101,102,104,105,106,109,110,113,114],R1:[10,7,9,0,17,103,107,6,1,5,30,27,29,20,37,107,103,26,21,25,108,1,115,112,21,111,7,29,27,9],L0:[2,5,6,10,11,12,13,14,16,17,22,25,26,30,31,32,33,34,36,37,100,102,103,104,106,107,108,111,112,115],L1:[8,9,7,0,15,101,105,3,4,1,28,29,27,20,35,105,101,23,24,21,113,110,1,109,114,21,27,9,7,29],D0:[1,4,5,9,11,12,13,15,16,17,21,24,25,29,31,32,33,35,36,37,101,102,103,105,106,107,110,111,114,115],D1:[7,8,10,0,14,104,100,3,2,6,27,28,30,20,34,100,104,23,22,26,109,2,112,113,22,108,8,30,28,10],U0:[1,3,6,7,11,12,13,14,15,17,21,23,26,27,31,32,33,34,35,37,100,101,103,104,105,107,108,109,112,113],U1:[9,8,10,0,16,106,102,2,4,5,29,28,30,20,36,102,106,22,24,25,2,114,111,22,110,115,10,28,30,8]},DIRCLASSIC={fromTo:[[],[],[],[]],enterL:[12,22,25,26,30,31,33,34,36,37,40,42,44,45,47,48,52,54,58,59,80,82,84,85,89,91,94,96,103,104,106,111,112],exitL:[2,2,3,1,4,2,2,2,2,4,2,2,2,3,1,1,2,2,4,4,2,2,4,4,2,4,4,5,4,2,2,4,4]};DIRCLASSIC.fromTo[0]=new Array(120).fill(-1);for(var r=0;r<DIRCLASSIC.enterL.length;r++)DIRCLASSIC.fromTo[0][DIRCLASSIC.enterL[r]]=DIRCLASSIC.exitL[r];DIRCLASSIC.enterT=[13,21,23,26,27,31,32,34,35,37,41,43,44,45,46,49,53,55,58,81,83,84,86,90,91,92,100,105,107,108,113],DIRCLASSIC.exitT=[3,3,2,0,4,3,3,4,3,3,3,3,2,3,0,3,3,3,4,3,3,4,4,3,4,4,4,3,3,4,4],DIRCLASSIC.fromTo[1]=new Array(120).fill(-1);for(r=0;r<DIRCLASSIC.enterT.length;r++)DIRCLASSIC.fromTo[1][DIRCLASSIC.enterT[r]]=DIRCLASSIC.exitT[r];DIRCLASSIC.enterR=[12,22,23,24,28,31,33,34,35,36,40,42,45,46,47,50,52,56,80,82,84,87,89,92,93,101,104,106,109,114],DIRCLASSIC.exitR=[0,0,1,3,4,0,0,0,4,0,0,0,3,0,1,3,0,0,0,0,4,4,0,4,4,4,0,0,4,4],DIRCLASSIC.fromTo[2]=new Array(120).fill(-1);for(r=0;r<DIRCLASSIC.enterR.length;r++)DIRCLASSIC.fromTo[2][DIRCLASSIC.enterR[r]]=DIRCLASSIC.exitR[r];DIRCLASSIC.enterB=[13,21,24,25,29,31,32,35,36,37,41,43,44,46,47,51,53,57,59,81,83,84,88,90,93,94,103,105,107,110,115],DIRCLASSIC.exitB=[1,1,2,0,4,1,1,1,4,1,1,1,2,0,1,0,1,1,4,1,1,4,4,1,4,4,4,1,1,4,4],DIRCLASSIC.fromTo[3]=new Array(120).fill(-1);for(r=0;r<DIRCLASSIC.enterB.length;r++)DIRCLASSIC.fromTo[3][DIRCLASSIC.enterB[r]]=DIRCLASSIC.exitB[r];const DIRQUANTUM={fromTo:[[],[],[],[]],enterL:[2,5,6,10,11,13,14,16,17,32,60,62,64,65,67,68,70,72,74,78,79,80,82,84,89,95,100,102,107,108,115],exitL:[2,3,1,4,2,2,2,2,4,2,2,2,2,3,1,2,2,2,2,4,4,2,2,4,2,5,2,2,4,4,4]};DIRQUANTUM.fromTo[0]=new Array(120).fill(-1);for(r=0;r<DIRQUANTUM.enterL.length;r++)DIRQUANTUM.fromTo[0][DIRQUANTUM.enterL[r]]=DIRQUANTUM.exitL[r];DIRQUANTUM.enterT=[1,3,6,7,11,12,14,15,17,33,61,63,64,65,66,69,71,73,75,78,81,83,84,90,95,101,103,104,109,112],DIRQUANTUM.exitT=[3,2,0,4,3,3,4,3,3,3,3,3,2,3,0,3,3,3,3,4,3,3,4,3,5,3,3,4,4,4],DIRQUANTUM.fromTo[1]=new Array(120).fill(-1);for(r=0;r<DIRQUANTUM.enterT.length;r++)DIRQUANTUM.fromTo[1][DIRQUANTUM.enterT[r]]=DIRQUANTUM.exitT[r];DIRQUANTUM.enterR=[2,3,4,8,11,13,14,15,16,32,60,62,65,66,67,68,70,72,76,78,79,80,82,84,89,95,100,102,105,110,113],DIRQUANTUM.exitR=[0,1,3,4,0,0,0,4,0,0,0,0,3,0,1,0,0,0,0,0,0,0,0,4,0,5,0,0,4,4,4],DIRQUANTUM.fromTo[2]=new Array(120).fill(-1);for(r=0;r<DIRQUANTUM.enterR.length;r++)DIRQUANTUM.fromTo[2][DIRQUANTUM.enterR[r]]=DIRQUANTUM.exitR[r];DIRQUANTUM.enterB=[1,4,5,9,11,12,15,16,17,33,61,63,64,66,67,69,71,73,77,79,81,83,84,90,95,101,103,106,111,114],DIRQUANTUM.exitB=[1,2,0,4,1,1,1,4,1,1,1,1,2,0,1,1,1,1,1,4,1,1,4,1,5,1,1,4,4,4],DIRQUANTUM.fromTo[3]=new Array(120).fill(-1);for(r=0;r<DIRQUANTUM.enterB.length;r++)DIRQUANTUM.fromTo[3][DIRQUANTUM.enterB[r]]=DIRQUANTUM.exitB[r];const WIREPATHS={q:[]};WIREPATHS.q.push("M 14 16 L 16 14 L 18 16 L 16 18 Z"),WIREPATHS.q.push("M 16 0 L 16 32"),WIREPATHS.q.push("M 0 16 L 32 16"),WIREPATHS.q.push("M 16 0 l 0 6 a 10 10 0 0 0 10 10 l 6 0"),WIREPATHS.q.push("M 32 16 l -6 0 a 10 10 0 0 0 -10 10 l 0 6"),WIREPATHS.q.push("M 16 32 l 0 -6 a 10 10 0 0 0 -10 -10 l -6 0"),WIREPATHS.q.push("M 0 16 l 6 0 a 10 10 0 0 0 10 -10 l 0 -6"),WIREPATHS.q.push("M 16 14 l 2 2 l -2 2 l -2 -2 l 2 -2 M 16 16 L 16 0"),WIREPATHS.q.push("M 18 16 l -2 2 l -2 -2 l 2 -2 l 2 2 M 16 16 L 32 16"),WIREPATHS.q.push("M 16 18 l -2 -2 l 2 -2 l 2 2 l -2 2 M 16 16 L 16 32"),WIREPATHS.q.push("M 14 16 L 16 14 L 18 16 L 16 18 L 14 16 M 16 16 L 0 16"),WIREPATHS.q.push("M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16 M 16 0 L 16 32"),WIREPATHS.q.push(["M 16 0 L 16 32","M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16"]),WIREPATHS.q.push(["M 16 0 L 16 32","M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16"]),WIREPATHS.q.push("M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16 M 16 12 l 2 2 l -2 2 l -2 -2 l 2 -2 M 16 16 L 16 0"),WIREPATHS.q.push("M 16 0 L 16 11 a 1 1 0 0 0 0 10 L 16 32 M 20 16 l -2 2 l -2 -2 l 2 -2 l 2 2 M 16 16 L 32 16"),WIREPATHS.q.push("M 0 16 L 11 16 a 1 1 0 0 1 10 0 L 32 16 M 16 20 l -2 -2 l 2 -2 l 2 2 l -2 2 M 16 16 L 16 32"),WIREPATHS.q.push("M 16 0 L 16 11 a 1 1 0 0 1 0 10 L 16 32 M 12 16 L 14 14 L 16 16 L 14 18 L 12 16 M 14 16 L 0 16"),WIREPATHS.c=[],WIREPATHS.c.push("M 14 16 L 16 14 L 18 16 L 16 18 Z"),WIREPATHS.c.push("M 16 0 L 16 32"),WIREPATHS.c.push("M 0 16 L 32 16"),WIREPATHS.c.push("M 16 0 l 0 6 a 10 10 0 0 0 10 10 l 6 0"),WIREPATHS.c.push("M 32 16 l -6 0 a 10 10 0 0 0 -10 10 l 0 6"),WIREPATHS.c.push("M 16 32 l 0 -6 a 10 10 0 0 0 -10 -10 l -6 0"),WIREPATHS.c.push("M 0 16 l 6 0 a 10 10 0 0 0 10 -10 l 0 -6"),WIREPATHS.c.push("M 16 14 l 2 2 l -2 2 l -2 -2 l 2 -2 M 16 16 L 16 0"),WIREPATHS.c.push("M 18 16 l -2 2 l -2 -2 l 2 -2 l 2 2 M 16 16 L 32 16"),WIREPATHS.c.push("M 16 18 l -2 -2 l 2 -2 l 2 2 l -2 2 M 16 16 L 16 32"),WIREPATHS.c.push("M 14 16 L 16 14 L 18 16 L 16 18 L 14 16 M 16 16 L 0 16"),WIREPATHS.c.push("M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16 M 16 0 L 16 32"),WIREPATHS.c.push(["M 16 0 L 16 32","M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16"]),WIREPATHS.c.push(["M 16 0 L 16 32","M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16"]),WIREPATHS.c.push("M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16 M 16 12 l 2 2 l -2 2 l -2 -2 l 2 -2 M 16 16 L 16 0"),WIREPATHS.c.push("M 16 0 L 16 11 a 1 1 0 0 0 0 10 L 16 32 M 20 16 l -2 2 l -2 -2 l 2 -2 l 2 2 M 16 16 L 32 16"),WIREPATHS.c.push("M 0 16 L 11 16 a 1 1 0 0 1 10 0 L 32 16 M 16 20 l -2 -2 l 2 -2 l 2 2 l -2 2 M 16 16 L 16 32"),WIREPATHS.c.push("M 16 0 L 16 11 a 1 1 0 0 1 0 10 L 16 32 M 12 16 L 14 14 L 16 16 L 14 18 L 12 16 M 14 16 L 0 16");const LEVELS={names:["freeA","freeB","freeC","extraA","extraB","extraC","extraD","tut1","tut2","tut3","tut4","tut5","tut6","class1","class2","class3","class4","class5","class6","class7","classPuzzle1","classPuzzle2","classPuzzle4","classPuzzle5","classPuzzle6","classPuzzle7","vaziraniClassic","classPuzzle8","classPuzzle3","classPuzzle3B","classPuzzle9","binaryencode","adder","quant1","quant2","quant3A","quant3","quant4","quant5","quant6","quant6B","quant7","measure","adderB","adderC","entChallengeA","quantChallengeB","quantChallengeC","quantChallengeD","quantChallengeA","quantChallengeE","quantChallengeF","simpleDistill","measureB","chsh","quantumAdv3","preDenseB","teleport","quantErrorA","quantChallengeG","quantumAdv1","entChallengeB","dense","distill","quantErrorB","vaziraniQuantum","quantumAdv2","entChallengeC"]};LEVELS.num=LEVELS.names.length,LEVELS.groups=[7,6,7,7,6,8,8,7,6,6],LEVELS.unlocked=[0,0,0,0,0,0,0,0,0,0],LEVELS.tags=["FA","FB","X","?","?","?","?","A","B","C","D","E","F","A","B","C","D","E","F","G","A","B","C","D","E","F","G","A","B","C","D","E","F","A","B","C","D","E","F","G","H","A","B","C","D","E","F","G","H","A","B","C","D","E","F","G","A","B","C","D","E","F","A+","B+","C+","D+","E+","F+"],LEVELS.briefs=[-1,-1,-1,-1,-1,-1,-1,0,1,-1,2,-1,-1,3,4,6,7,-1,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,14,-1,-1,11,-1,12,13,-1,-1,-1,15,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],LEVELS.tileHash=[-66,372,-66,393,390,766,680,865,865,865,865,327,450,606,1142,978,753,679,525,923,978,978,450,749,450,978,226,709,778,686,534,450,679,750,863,461,337,337,506,506,620,748,559,1003,1003,226,750,597,662,337,750,282,126,373,249,296,909,372,337,566,269,239,1293,773,652,174,269,239],LEVELS.gateHash=[0,-489,0,-470,-1726,-318,-303,-441,-590,-594,-645,-481,-240,-240,-586,-339,-404,-303,-190,-310,-399,-339,-240,-286,-1516,-457,-782,-333,-302,-225,-136,-240,-303,-790,-499,-848,-297,-282,-359,-359,-730,-996,-361,-663,-632,-806,-1241,-1466,-560,-298,-563,-283,-615,-237,-1874,-45,-381,-665,-672,-421,-82,-199,-749,-756,-768,-1200,-90,-199],LEVELS.numStandard=LEVELS.groups[1]+LEVELS.groups[2]+LEVELS.groups[3]+LEVELS.groups[4]+LEVELS.groups[5]+LEVELS.groups[6]+LEVELS.groups[7]+LEVELS.groups[8]+LEVELS.groups[9],LEVELS.numTotal=LEVELS.numStandard+LEVELS.groups[0],LEVELS.hidden=new Array(LEVELS.numTotal).fill(0),LEVELS.hidden[3]=1,LEVELS.hidden[4]=1,LEVELS.hidden[5]=1,LEVELS.hidden[6]=1;class Overlay{static createRobotScreen(e){var t=ROBOT.screenW+2*ROBOT.margin,i=ROBOT.viewH+2*ROBOT.margin,a=FIELD.tileWidth,r=2*FIELD.tileWidth/4,s=r+1.25*FIELD.tileWidth/8,o=a/2,n=a/4,l=.75*a,h="M "+(r+o)+" "+(r+o)+" ";h+=" "+Helper.makeCurve(r+o,r+o,t-r-o,r+o,n),h+=" "+Helper.makeCurve(t-r-o,r+o,t-r-o,i-r-o,-n),h+=" "+Helper.makeCurve(t-r-o,i-r-o,r+o,i-r-o,n),h+=" "+Helper.makeCurve(r+o,i-r-o,r+o,r+o,-n);var d=[r,r,t-r,t-r],u=[r,i-r+l,i-r+l,r],c=[a/4,a/4,a/4,a/4],I=Helper.makeRoundedPath(d,u,c,1,0,0),E=[s,s,t-s,t-s],f=[s,i-s,i-s,s],S=[a/6,a/6,a/6,a/6],p=Helper.makeRoundedPath(E,f,S,1,0,0);e.save(),e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fillStyle="black",e.fill(new Path2D(I)),e.globalCompositeOperation="destination-out",e.fill(new Path2D(p)),e.restore();var T=a/16;e.save(),e.lineWidth=T/2,e.strokeStyle="#90F215",e.globalAlpha=.1;for(var R=0;R<Math.floor((t-2*r)/T);R++)e.moveTo(s,r+(R+.5)*T),e.lineTo(t-s,r+(R+.5)*T);e.stroke(),e.restore();var m=new Path2D(I+h+" Z"),g=e.createRadialGradient(t/2,i/2,t/4,t/2,i/2,t/2);g.addColorStop(0,"#66261b"),g.addColorStop(1,"#38140f"),e.save(),e.fillStyle=g,e.clip(m,"evenodd"),e.fill(m),e.restore();var A=new Path2D(I+p);e.save(),e.fillStyle="#1a110e",e.clip(A,"evenodd"),e.fill(A),e.lineWidth=Math.max(1,FIELD.tileWidth/24),e.strokeStyle="black",e.stroke(new Path2D(I)),e.stroke(new Path2D(p)),e.stroke(new Path2D(p)),e.restore();var C=(Math.sqrt(2)-1)*a/6;e.save(),e.beginPath(),e.lineWidth=Math.max(1,FIELD.tileWidth/36),e.moveTo(s+C,s+C),e.lineTo(r+o,r+o),e.moveTo(t-s-C,s+C),e.lineTo(t-r-o,r+o),e.moveTo(s+C,i-s-C),e.lineTo(r+o,i-r-o),e.moveTo(t-s-C,i-s-C),e.lineTo(t-r-o,i-r-o),e.stroke(),e.restore(),e.save(),e.lineWidth=Math.max(1,a/36),e.strokeStyle="black",e.stroke(new Path2D(h)),e.restore(),e.save(),e.beginPath(),Paths.monitorKnob(e).draw(e,1.5*s,i-r+l-s,.5*a,.5*a),Paths.monitorKnob(e).draw(e,t-1.5*s-.5*a,i-r+l-s,.5*a,.5*a),e.stroke(),e.restore(),e.save(),e.beginPath();var L=t/2,D=i-.2*a;g=e.createRadialGradient(L-.1*a,D-.1*a,0,L-.1*a,D-.1*a,.7*a);g.addColorStop(1,"#0e1818"),g.addColorStop(0,"darkslategrey"),e.fillStyle=g,e.ellipse(L,D,.7*a,.7*a/2,0,0,2*Math.PI),e.fill(),e.clip(),e.lineWidth=a/12,e.strokeStyle="#111",e.beginPath();for(R=0;R<15;R++)e.moveTo(L-.7*a+R*a/8,D-a/2),e.lineTo(L-.7*a+R*a/8,D+a/2),e.stroke();e.beginPath(),e.lineWidth=a/12,e.strokeStyle="black",e.ellipse(L,D,.7*a,.7*a/2,0,0,2*Math.PI),e.stroke(),e.restore();var b=r,O=i-r+l+2*a/8,M=t-2*r,v=a,w=a/4;Helper.fiberBox(e,b,O,M,v,w),e.save(),e.textBaseline="middle",e.textAlign="center",e.font=1.6*FIELD.tileWidth/4+"px Courier New",e.fillStyle="antiquewhite",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black","levelSelect"===ROBOT.oldMode?(e.fillText("Administron",b+M/2,O+v/4),e.fillText("40000",b+M/2,O+3*v/4)):(e.fillText("Auto-Manager",b+M/2,O+v/4),e.fillText("5000",b+M/2,O+3*v/4)),e.restore()}static createRobot(e,t=!0){var i=FIELD.tileWidth,a=(ROBOT.margin,ROBOT.height),r=ROBOT.width,s=i/24,o=FIELD.tileWidth/4,n=2*FIELD.tileWidth,l=6*FIELD.tileWidth;if(t){var h=[4*s,4*s,r/2-i-n/2,r/2-n/2,r/2+n/2,r/2+n/2+i,r-s-l,r-s-l+i,r-s-i,r-s,r-s],d=[s,a-1.5*i,a-1.5*i,a+o-.5*i,a+o-.5*i,a-1.5*i,a-1.5*i,a+o-.5*i,a+o-.5*i,a-1.5*i,s],u=[i/3,i/3,i/6,i/6,i/6,i/6,i/6,i/6,i/6,i/6,i/3],c=new Path2D(Helper.makeRoundedPath(h,d,u,1,0,0));Helper.renderOverlay(e,c)}else{h=[4*s,4*s,r/2-i-n/2,r/2-n/2,r/2+n/2,r/2+n/2+i,r-s,r-s],d=[s,a-1.5*i,a-1.5*i,a+o-.5*i,a+o-.5*i,a-1.5*i,a-1.5*i,s],u=[i/3,i/3,i/6,i/6,i/6,i/6,i/3,i/3],c=new Path2D(Helper.makeRoundedPath(h,d,u,1,0,0));Helper.renderOverlay(e,c)}var I=ROBOT.margin+ROBOT.screenW+2*ROBOT.lineGap-o,E=ROBOT.margin-o,f=ROBOT.textW+2*o,S=ROBOT.screenH+2*o,p=i/4;Helper.fiberBox(e,I,E,f,S,p);var T=r/2-1.75*i,R=a-1.5*i-o,m=3.5*i,g=i+o,A=i/4;c=new Path2D(Helper.makeRoundedPath([T,T+.9*i,T+m-.9*i,T+m],[R,R+g,R+g,R],[A,A,A,A],1,0,0));if(Helper.fiberBoxPath(e,c,T,R,m,g),t){T=r-s-l+i/4,R=a-1.5*i-o,m=5.5*i,g=i+o,A=i/4,c=new Path2D(Helper.makeRoundedPath([T,T+.9*i,T+m-.9*i,T+m],[R,R+g,R+g,R],[A,A,A,A],1,0,0));Helper.fiberBoxPath(e,c,T,R,m,g)}}static createSelect(e){var t=FIELD.tileWidth,i=FIELD.tileHeight,a=30*t,r=15*i,s=OVERLAY.margin,o=2*FIELD.tileWidth/6,n=FIELD.selBoxW,l=FIELD.selBoxH,h=[a-FIELD.selBoxW,a-FIELD.selBoxW,a-FIELD.selBoxM,a-FIELD.selBoxM],d=[FIELD.selBoxM+s,r-FIELD.selBoxM-s,r-FIELD.selBoxM-s,FIELD.selBoxM+s],u=[o,o,o,o],c=new Path2D(Helper.makeRoundedPath(h,d,u,1,0,0));e.save(),e.fillStyle="#2b2b2b",e.strokeStyle="#000",e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#555",e.fill(c),e.stroke(c),e.restore(),e.save(),e.clip(c,"evenodd"),Textures.drawFiber(e,a-n,0,n,2*l,FIELD.tileWidth/48,.5),e.restore();var I=.75*FIELD.tileWidth,E=5*FIELD.tileWidth,f=(o=1*FIELD.tileWidth/3,h=[t/2-s,t/2-s,a-t/2+s,a-t/2+s],d=[i/2-s,r-i/2+s,r-i/2+s,i/2-s],u=[o,o,o,o],[t/2+s,t/2+s,a-t/2-FIELD.selBoxW+s,a-t/2-FIELD.selBoxW+s,t/2+1*s+E,t/2+1*s+E]),S=[i/2+s+I,r-i/2-s,r-i/2-s,i/2+s,i/2+s,i/2+s+I],p=[o,o,o,o,o,o],T=[a-t/2-FIELD.selBoxW+2*s,a-t/2-FIELD.selBoxW+2*s,a-t/2-s,a-t/2-s],R=[i/2+s,9*i,9*i,i/2+s],m=[o,o,o,o],g=[a-t/2-FIELD.selBoxW+2*s,a-t/2-FIELD.selBoxW+2*s,a-t/2-s,a-t/2-s],A=[9.4*i,r-i/2-s,r-i/2-s,9.4*i],C=[o,o,o,o],L=new Path2D(Helper.makeRoundedPath(h,d,u,1,0,0)+Helper.makeRoundedPath(f,S,p,1,0,0)+Helper.makeRoundedPath(T,R,m,1,0,0)+Helper.makeRoundedPath(g,A,C,1,0,0));e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="#30473e",e.shadowColor="#555",e.fill(L,"evenodd"),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(L),e.restore();const D=new Path2D(makeOverlayPattern());e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(L,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(D),e.translate(4040,0),e.fill(D),e.translate(0,4040),e.fill(D),e.translate(-4040,0),e.fill(D),e.translate(8080,-4040),e.fill(D),e.translate(0,4040),e.fill(D),e.restore(),e.save(),e.textBaseline="top",e.textAlign="left",e.font=2.2*FIELD.tileWidth/4+"px Courier New",e.fillStyle="antiquewhite",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.fillText("Level Select:",t/2+2*s,i/2+s),e.restore()}static createUnderTitle(e){var t=FIELD.tileWidth,i=FIELD.tileHeight,a=t*(FIELD.cols-5.25),r=i*(FIELD.rows/2),s=(FIELD.tileWidth,FIELD.tileHeight,[0,0,3.4*FIELD.tileWidth]),o=[0,3.4*FIELD.tileWidth,0],n=[a,a,a-3.4*FIELD.tileWidth],l=[0,3.4*FIELD.tileWidth,0],h=[0,0,3.4*FIELD.tileWidth],d=[r,r-3.4*FIELD.tileWidth,r],u=[a,a,a-3.4*FIELD.tileWidth],c=[r,r-3.4*FIELD.tileWidth,r],I=[0,FIELD.tileWidth,FIELD.tileWidth],E=new Path2D(Helper.makeRoundedPath(s,o,I)+Helper.makeRoundedPath(n,l,I)+Helper.makeRoundedPath(h,d,I)+Helper.makeRoundedPath(u,c,I)),f=new Path2D(Helper.makeRoundedPath(s,o,I)),S=new Path2D(Helper.makeRoundedPath(n,l,I)),p=new Path2D(Helper.makeRoundedPath(h,d,I)),T=new Path2D(Helper.makeRoundedPath(u,c,I)),R=e.createLinearGradient(0,0,1.8*t,1.8*i);R.addColorStop(1,"#444"),R.addColorStop(.45,"#4e7566"),R.addColorStop(.55,"#4e7566"),R.addColorStop(0,"#444");var m=e.createLinearGradient(a,0,a-1.8*t,1.8*i);m.addColorStop(1,"#444"),m.addColorStop(.45,"#4e7566"),m.addColorStop(.55,"#4e7566"),m.addColorStop(0,"#444");var g=e.createLinearGradient(0,r,1.8*t,r-1.8*i);g.addColorStop(1,"#444"),g.addColorStop(.45,"#4e7566"),g.addColorStop(.55,"#4e7566"),g.addColorStop(0,"#444");var A=e.createLinearGradient(a,r,a-1.8*t,r-1.8*i);A.addColorStop(1,"#444"),A.addColorStop(.45,"#4e7566"),A.addColorStop(.55,"#4e7566"),A.addColorStop(0,"#444"),e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle=R,e.fill(f),e.fillStyle=m,e.fill(S),e.fillStyle=g,e.fill(p),e.fillStyle=A,e.fill(T),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(E),e.restore();const C=new Path2D(makeOverlayPattern());if(e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(E,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.translate(0,-1e3),e.fill(C),e.translate(4040,0),e.fill(C),e.translate(0,4040),e.fill(C),e.translate(-4040,0),e.fill(C),e.translate(8080,-4040),e.fill(C),e.translate(0,4040),e.fill(C),e.restore(),FIELD.showTitleMenu){var L=FIELD.tileWidth/9,D=2*FIELD.tileWidth,b=1.8*FIELD.tileHeight,O=r-b,M=[-D/2,-D/2,D/2,D/2],v=[0,b+FIELD.tileWidth/4,b+FIELD.tileWidth/4,0],w=[L,L,L,L],N=new Path2D(Helper.makeRoundedPath(M,v,w,1,a/2,O));e.save(),e.fillStyle="#2b2b2b",e.strokeStyle="#000",e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#555",e.fill(N),e.stroke(N),e.restore(),e.save(),e.clip(N,"evenodd"),Textures.drawFiber(e,a/2-D/2,O,D,b+FIELD.tileWidth/4,.5*FIELD.tileWidth/48,.5),e.restore()}}static createTitleOptions(e){"options"===STATE.state&&Helper.fiberBox(e,0,0,5*FIELD.tileWidth,4*FIELD.tileWidth,FIELD.tileWidth/4,!1,96)}static createTitle(e){var t=FIELD.tileWidth,i=FIELD.tileHeight,a=t*(FIELD.cols-5.25),r=(FIELD.rows,1.3*FIELD.tileWidth),s=FIELD.tileHeight,o=.9*FIELD.tileWidth/6,n=[-OVERLAY.margin,OVERLAY.margin+t*(FIELD.cols-5.25),OVERLAY.margin+t*(FIELD.cols-5.25),-OVERLAY.margin],l=[OVERLAY.margin+i*(FIELD.rows/2),OVERLAY.margin+i*(FIELD.rows/2),-OVERLAY.margin,-OVERLAY.margin],h=[o,o,o,o],d=1*FIELD.tileWidth/6,u=[OVERLAY.marginInner,-OVERLAY.marginInner+t*(FIELD.cols-5.25)-4.5*t,-OVERLAY.marginInner+t*(FIELD.cols-5.25)-4.5*t,-OVERLAY.marginInner+t*(FIELD.cols-5.25),-OVERLAY.marginInner+t*(FIELD.cols-5.25),a/2+r,a/2+r,a/2-r,a/2-r,OVERLAY.marginInner],c=[-OVERLAY.marginInner+i*(FIELD.rows/2),-OVERLAY.marginInner+i*(FIELD.rows/2),-OVERLAY.marginInner+i*(FIELD.rows/2)-i/4,-OVERLAY.marginInner+i*(FIELD.rows/2)-i/4,+OVERLAY.marginInner,+OVERLAY.marginInner,+OVERLAY.marginInner+s,+OVERLAY.marginInner+s,+OVERLAY.marginInner,+OVERLAY.marginInner],I=[d,.85*d,.85*d,d,d,d,d,d,d,d],E=new Path2D(Helper.makeRoundedPath(n,l,h,1,FIELD.leftMargin,FIELD.topMargin)+Helper.makeRoundedPath(u,c,I,1,FIELD.leftMargin,FIELD.topMargin));e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="#30473e",e.shadowBlur=4,e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowColor="#555",e.fill(E,"evenodd"),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(E),e.restore();const f=new Path2D(makeOverlayPattern());if(e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(E,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(f),e.translate(4040,0),e.fill(f),e.translate(0,4040),e.fill(f),e.translate(-4040,0),e.fill(f),e.translate(8080,-4040),e.fill(f),e.translate(0,4040),e.fill(f),e.restore(),e.save(),e.textBaseline="top",e.textAlign="left",e.font=FIELD.tileWidth/3+"px Courier New",e.fillStyle="antiquewhite",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.fillText("The",a/2+.05*FIELD.tileWidth,.2*FIELD.tileWidth),e.font=3*FIELD.tileWidth/3+"px Courier New",e.fillText("Q",a/2+-.65*FIELD.tileWidth,.15*FIELD.tileWidth),e.font=1*FIELD.tileWidth/2+"px Courier New",e.fillText("ubit",a/2+-.05*FIELD.tileWidth,.55*FIELD.tileWidth),e.font=1.3*FIELD.tileWidth/3+"px Courier New",e.textAlign="center",e.fillText("Factory",a/2+.3*FIELD.tileWidth,1.05*FIELD.tileWidth),e.restore(),FIELD.isTouch&&(e.save(),e.textBaseline="middle",e.textAlign="center",e.font=FIELD.tileWidth/3+"px Verdana",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="grey",e.fillStyle="antiquewhite",e.fill(Helper.roundRect(a/2+.3*FIELD.tileWidth-4.5*FIELD.tileWidth,1.75*FIELD.tileWidth,9*FIELD.tileWidth,.5*FIELD.tileWidth,FIELD.tileWidth/4)),e.shadowOffsetX=1,e.shadowOffsetY=1,e.fillStyle="black",e.fillText("Touch-screen controls are currently unsupported :(",a/2+.3*FIELD.tileWidth,2*FIELD.tileWidth),e.restore()),FIELD.showTitleMenu){e.save(),e.textBaseline="top",e.textAlign="left",e.font=1*FIELD.tileWidth/4+"px Courier New",e.fillStyle="antiquewhite",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.fillText("Best on #1:",.25*FIELD.tileWidth,14.1*FIELD.tileHeight/2),e.fillText("#2:",4*FIELD.tileWidth,14.1*FIELD.tileHeight/2),e.fillText(FIELD.version,13*FIELD.tileWidth,.2*FIELD.tileHeight),e.font=1*FIELD.tileWidth/6+"px Courier New",e.textBaseline="bottom";var S=-.9*FIELD.tileWidth;e.fillText("Research Scientist",12.2*FIELD.tileWidth+S,14*FIELD.tileHeight/2),e.fillText("AWS Center for Quantum Computing",10.5*FIELD.tileWidth+S,14.55*FIELD.tileHeight/2),e.font=1.5*FIELD.tileWidth/6+"px Courier New",e.fillText("Glen Evenbly,",10.2*FIELD.tileWidth+S,14.05*FIELD.tileHeight/2),e.textAlign="left",e.textBaseline="top",e.font=1*FIELD.tileWidth/6+"px Courier New",e.fillText("Music by Eric Matyas",.65*FIELD.tileWidth,.28*FIELD.tileHeight/2),e.fillText(" www.soundimage.org",.65*FIELD.tileWidth,.68*FIELD.tileHeight/2),e.restore()}}static createBottomGrill(e){if(!SCENARIO.disableOverlay){var t=OVERLAY.border,i=e.createLinearGradient(2.5*FIELD.tileWidth,0,2.5*FIELD.tileWidth,FIELD.tileHeight);i.addColorStop(1,"#444"),i.addColorStop(.45,"#4e7566"),i.addColorStop(.55,"#4e7566"),i.addColorStop(0,"#444"),e.save(),e.fillStyle=i,e.fillRect(0,t/4+FIELD.tileHeight*(1-FIELD.channelsTrig[4]),5*FIELD.tileWidth,FIELD.tileHeight),e.beginPath(),e.moveTo(0,t/4+FIELD.tileHeight*(1-FIELD.channelsTrig[4])),e.lineTo(5*FIELD.tileWidth,t/4+FIELD.tileHeight*(1-FIELD.channelsTrig[4])),e.strokeStyle="#222",e.lineWidth=FIELD.tileWidth/12,e.setLineDash([]),e.stroke(),e.lineWidth=FIELD.tileWidth/24,e.strokeStyle="#324d42",e.setLineDash([5,3]),e.stroke(),e.restore();var a=(FIELD.cols-7)*FIELD.tileWidth;e.save(),e.fillStyle=i,e.fillRect(a,t/4+FIELD.tileHeight*(1-FIELD.channelsTrig[5]),5*FIELD.tileWidth,FIELD.tileHeight),e.beginPath(),e.moveTo(a,t/4+FIELD.tileHeight*(1-FIELD.channelsTrig[5])),e.lineTo(a+5*FIELD.tileWidth,t/4+FIELD.tileHeight*(1-FIELD.channelsTrig[5])),e.strokeStyle="#222",e.lineWidth=FIELD.tileWidth/12,e.setLineDash([]),e.stroke(),e.lineWidth=FIELD.tileWidth/24,e.strokeStyle="#324d42",e.setLineDash([5,3]),e.stroke(),e.restore()}}static createRightGrill(e){if(!SCENARIO.disableOverlay){var t=OVERLAY.border,i=e.createLinearGradient(0,FIELD.tileHeight*(FIELD.topEntry+1)/2,FIELD.tileWidth,FIELD.tileHeight*(FIELD.topEntry+1)/2);i.addColorStop(1,"#444"),i.addColorStop(.45,"#4e7566"),i.addColorStop(.55,"#4e7566"),i.addColorStop(0,"#444"),e.save(),e.fillStyle=i,e.fillRect(FIELD.tileWidth*(1-FIELD.channelsTrig[2])+t/4,0,FIELD.tileWidth,FIELD.tileHeight*(FIELD.topEntry+1)),e.beginPath(),e.moveTo(FIELD.tileWidth*(1-FIELD.channelsTrig[2])+t/4,0),e.lineTo(FIELD.tileWidth*(1-FIELD.channelsTrig[2])+t/4,FIELD.tileHeight*(FIELD.topEntry+1)),e.strokeStyle="#222",e.lineWidth=FIELD.tileWidth/12,e.setLineDash([]),e.stroke(),e.lineWidth=FIELD.tileWidth/24,e.strokeStyle="#324d42",e.setLineDash([5,3]),e.stroke(),e.restore(),e.save(),e.fillStyle=i,e.fillRect(FIELD.tileWidth*(1-FIELD.channelsTrig[3])+t/4,FIELD.tileHeight*FIELD.bottomEntry,FIELD.tileWidth,FIELD.tileHeight*(FIELD.rows/2-1)),e.beginPath(),e.moveTo(FIELD.tileWidth*(1-FIELD.channelsTrig[3])+t/4,FIELD.tileHeight*FIELD.bottomEntry),e.lineTo(FIELD.tileWidth*(1-FIELD.channelsTrig[3])+t/4,FIELD.tileHeight*(FIELD.bottomEntry+FIELD.rows/2-1)),e.strokeStyle="#222",e.lineWidth=FIELD.tileWidth/12,e.setLineDash([]),e.stroke(),e.lineWidth=FIELD.tileWidth/24,e.strokeStyle="#324d42",e.setLineDash([5,3]),e.stroke(),e.restore()}}static createLeftGrill(e){if(!SCENARIO.disableOverlay){var t=OVERLAY.border,i=e.createLinearGradient(0,FIELD.tileHeight*(FIELD.topEntry+1)/2,FIELD.tileWidth,FIELD.tileHeight*(FIELD.topEntry+1)/2);i.addColorStop(1,"#444"),i.addColorStop(.45,"#4e7566"),i.addColorStop(.55,"#4e7566"),i.addColorStop(0,"#444"),e.save(),e.fillStyle=i,e.fillRect(-FIELD.tileWidth*(1-FIELD.channelsTrig[0]),0,FIELD.tileWidth-t/4,FIELD.tileHeight*(FIELD.topEntry+1)),e.beginPath(),e.moveTo(FIELD.tileWidth*FIELD.channelsTrig[0]-t/4,0),e.lineTo(FIELD.tileWidth*FIELD.channelsTrig[0]-t/4,FIELD.tileHeight*(FIELD.topEntry+1)),e.strokeStyle="#222",e.lineWidth=FIELD.tileWidth/12,e.setLineDash([]),e.stroke(),e.lineWidth=FIELD.tileWidth/24,e.strokeStyle="#324d42",e.setLineDash([5,3]),e.stroke(),e.restore(),e.save(),e.fillStyle=i,e.fillRect(-FIELD.tileWidth*(1-FIELD.channelsTrig[1]),FIELD.tileHeight*FIELD.bottomEntry,FIELD.tileWidth-t/4,FIELD.tileHeight*(FIELD.rows/2-1)),e.beginPath(),e.moveTo(FIELD.tileWidth*FIELD.channelsTrig[1]-t/4,FIELD.tileHeight*FIELD.bottomEntry),e.lineTo(FIELD.tileWidth*FIELD.channelsTrig[1]-t/4,FIELD.tileHeight*(FIELD.bottomEntry+FIELD.rows/2-1)),e.strokeStyle="#222",e.lineWidth=FIELD.tileWidth/12,e.setLineDash([]),e.stroke(),e.lineWidth=FIELD.tileWidth/24,e.strokeStyle="#324d42",e.setLineDash([5,3]),e.stroke(),e.restore()}}static createTutorial(e,t){var i=FIELD.tileWidth,a=FIELD.tileHeight,r=TUTORIAL.margin,s=TUTORIAL.boxWidth,o=10*i+s,n=14*a,l=FIELD.tileWidth/2,h=FIELD.tileWidth/3;const d=new Path2D(makeOverlayPattern());if(14===TUTORIAL.current)var u=[i-r,i-r,o-i+r,o-i+r],c=[r,n-r,n-r,r],I=[l,l,l,l],E=[1.2*i,1.2*i,7*i,7*i],f=[2*a,13*a,13*a,2*a],S=[h,h,h,h],p=new Path2D(Helper.makeRoundedPath(u,c,I,1,0,0)+Helper.makeRoundedPath(E,f,S,1,0,0));else if(15===TUTORIAL.current){u=[i-r,i-r,o-i+r,o-i+r],c=[r,n-r,n-r,r],I=[l,l,l,l],E=[1.2*i,1.2*i,7*i,7*i],f=[2*a,7*a,7*a,2*a],S=[h,h,h,h];var T=[1.2*i,1.2*i,7*i,7*i],R=[7.5*a,13*a,13*a,7.5*a],m=[h,h,h,h];p=new Path2D(Helper.makeRoundedPath(u,c,I,1,0,0)+Helper.makeRoundedPath(E,f,S,1,0,0)+Helper.makeRoundedPath(T,R,m,1,0,0))}else if(16===TUTORIAL.current)u=[i-r,i-r,o-i+r,o-i+r],c=[r,n-r,n-r,r],I=[l,l,l,l],E=[1.2*i,1.2*i,7*i,7*i],p=new Path2D(Helper.makeRoundedPath(u,c,I,1,0,0));else u=[i-r,i-r,o-i+r,o-i+r],c=[r,n-r,n-r,r],I=[l,l,l,l],E=[2*i,2*i,7*i,7*i],f=[2*a,7*a,7*a,2*a],S=[h,h,h,h],p=new Path2D(Helper.makeRoundedPath(u,c,I,1,0,0)+Helper.makeRoundedPath(E,f,S,1,0,0)+Helper.makeRoundedPath(E,f,S,1,0,6*a));if(1===TUTORIAL.current)e.save(),e.textBaseline="middle",e.textAlign="center",e.font=FIELD.tileWidth/3+"px Verdana",e.fillStyle="black",e.fillText("left + drag",3.2*i,2.5*i),e.fillText("left + drag",3.2*i,4.5*i),e.fillText("right + drag",3.2*i,6.5*i),e.restore();else if(8===TUTORIAL.current)e.save(),e.textBaseline="middle",e.textAlign="center",e.font=FIELD.tileWidth/2+"px Courier New",e.fillStyle="black",e.fillText("π/8",3.5*i,4.5*i),e.restore(),e.save(),e.textBaseline="middle",e.textAlign="center",e.font=FIELD.tileWidth/3+"px Verdana",e.fillStyle="black",e.fillText("+ve",3.5*i,8.8*i),e.fillText("-ve",5.5*i,8.8*i),e.restore();else if(6===TUTORIAL.current)e.save(),e.textBaseline="middle",e.textAlign="center",e.font=FIELD.tileWidth/3+"px Verdana",e.fillStyle="black",e.fillText("control",4*i,2.5*i),e.fillText("target",4*i,3.5*i),e.fillText("1-primed",3.5*i,4.6*i),e.fillText("0-primed",5.5*i,4.6*i),e.restore();else if(0===TUTORIAL.current){var g=FIELD.tileWidth/12,A=(u=[6*i,6*i,6.2*i,6.2*i],c=[7*i,11.2*i,11.2*i,7*i],I=[g,g,g,g],FIELD.tileWidth/6),C=(E=[6*i,6*i,7.2*i,7.2*i,6.8*i,6.8*i],f=[11.8*i,13.5*i,13.5*i,7*i,7*i,11.8*i],S=[A,A,A,A,A,A],new Path2D(Helper.makeRoundedPath(u,c,I,1,0,0)+Helper.makeRoundedPath(E,f,S,1,0,0)));e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="#30473e",e.fill(C,"evenodd"),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(C),e.restore(),e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(C,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(d),e.translate(0,4040),e.fill(d),e.restore(),e.save(),e.textBaseline="middle",e.textAlign="center",e.font=1*i/2+"px Courier New",e.fillStyle="antiquewhite",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.fillText("C›",6.5*i,12.2*i),e.restore(),e.save(),e.textBaseline="middle",e.textAlign="center",e.font=FIELD.tileWidth/3+"px Verdana",e.fillStyle="black",e.fillText("desired",4.5*i,9.3*i),e.fillText("outputs",4.5*i,9.8*i),e.fillText("output stream",4*i,12.2*i),e.restore()}if(e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="#304347",e.fill(p,"evenodd"),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(p),e.restore(),e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(p,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(d),e.translate(4040,0),e.fill(d),e.translate(0,4040),e.fill(d),e.translate(-4040,0),e.fill(d),e.translate(8080,-4040),e.fill(d),e.translate(0,4040),e.fill(d),e.restore(),16===TUTORIAL.current){g=FIELD.tileWidth/3,T=[-6*i,-6*i,TUTORIAL.boxWidth+i,TUTORIAL.boxWidth+i],R=[0,11*a,11*a,0],m=[g,g,g,g],C=new Path2D(Helper.makeRoundedPath(T,R,m,1,7.5*i,2*a));e.save(),e.fillStyle="#2b2b2b",e.strokeStyle="#000",e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fill(C),e.stroke(C),e.restore(),e.save(),e.clip(C,"evenodd"),Textures.drawFiber(e,1.5*i,2*a,TUTORIAL.boxWidth+7*i,11*a,FIELD.tileWidth/48,.5),e.restore()}else{g=FIELD.tileWidth/3,T=[0,0,TUTORIAL.boxWidth+i,TUTORIAL.boxWidth+i],R=[0,11*a,11*a,0],m=[g,g,g,g],C=new Path2D(Helper.makeRoundedPath(T,R,m,1,7.5*i,2*a));e.save(),e.fillStyle="#2b2b2b",e.strokeStyle="#000",e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fill(C),e.stroke(C),e.restore(),e.save(),e.clip(C,"evenodd"),Textures.drawFiber(e,7.5*i,2*a,TUTORIAL.boxWidth+i,11*a,FIELD.tileWidth/48,.5),e.restore()}if(16===TUTORIAL.current)var L=2*i,D=TUTORIAL.boxWidth+6*i;else L=8*i,D=TUTORIAL.boxWidth;e.save(),e.font=1.2/3*FIELD.tileWidth+"px Courier New",e.textBaseline="middle",e.textAlign="center",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black";FIELD.tileWidth;e.textAlign="left";for(var b=0;b<6;b++){0===b?e.fillStyle="antiquewhite":1===b?e.fillStyle="#ff4551":2===b?e.fillStyle="limegreen":3===b?e.fillStyle="cornflowerblue":4===b?e.fillStyle="goldenrod":5===b&&(e.fillStyle="plum");for(var O=2.5*a,M=0;M<TUTORIAL.info.length;M++){for(var v=Helper.parseTextColored(e,TUTORIAL.info[M],D)[b],w=0;w<v.length;w++)JSON.parse(JSON.stringify(v[w])).trim().length>0&&e.fillText(v[w],L,O),w<v.length-1&&(O+=SCENARIO.yPad2);O+=SCENARIO.yPad}}e.restore();A=FIELD.tileWidth/6;var N=[2.5*i,2.5*i,o-2.5*i,o-2.5*i],P=[.75*a,1.5*a,1.5*a,.75*a],y=[A,A,A,A];C=new Path2D(Helper.makeRoundedPath(N,P,y,1,0,0));e.save(),e.fillStyle="#2b2b2b",e.strokeStyle="#000",e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fill(C),e.stroke(C),e.restore(),e.save(),e.clip(C,"evenodd"),Textures.drawFiber(e,2.5*i,.75*a,6*i+TUTORIAL.boxWidth,.75*a,FIELD.tileWidth/48,.5),e.restore(),e.save(),e.fillStyle="antiquewhite",e.font=1.2/3*FIELD.tileWidth+"px Courier New",e.textBaseline="middle",e.textAlign="center",e.shadowBlur=2,e.shadowOffsetX=2,
e.shadowOffsetY=2,e.shadowColor="black",e.fillText(TUTORIAL.title,o/2,.75*a+.375*a),e.restore()}static create(e){var t=1;SCENARIO.disableOverlay&&(t=.5);var i=FIELD.tileWidth,a=FIELD.tileHeight,r=FIELD.cols,s=FIELD.rows,o=1*FIELD.tileHeight/8,n=OVERLAY.border,l=FIELD.tileWidth/10,h=FIELD.tileWidth/3,d=2*FIELD.tileWidth/3,u=FIELD.tileWidth/5;if(SCENARIO.division){var c=0;if(1===SCENARIO.division||2===SCENARIO.division){var I=0,E=[i*r/2+n,i*r/2+n,i*r/2+n+i-2*n,i*r/2+n+i-2*n],f=[a/2,a/2+(s/2-1)*a+I,a/2+(s/2-1)*a+I,a/2],S=[u,u,u,u];c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0))}else if(3===SCENARIO.division)I=0,E=[i*r/2+n,i*r/2+n,i*r/2+n+i-2*n,i*r/2+n+i-2*n],f=[a/2,a/2+9*a+I,a/2+9*a+I,a/2],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,-5*a,0));else if(4===SCENARIO.division)I=0,E=[6.5*i,6.5*i,10.5*i,10.5*i],f=[1.5*a,2.5*a,2.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));else if(5===SCENARIO.division)E=[5.5*i,5.5*i,6.5*i,6.5*i],f=[1.5*a,4.5*a,4.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));else if(6===SCENARIO.division)E=[9.5*i,9.5*i,10.5*i,10.5*i],f=[1.5*a,3.5*a,3.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0)+Helper.makeRoundedPath(E,f,S,1,0,10*a));else if(7===SCENARIO.division)E=[i*r/2+n,i*r/2+n,i*r/2+n+i-2*n,i*r/2+n+i-2*n],f=[a/2,a/2+(s/2-1)*a,a/2+(s/2-1)*a,a/2],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));else if(8===SCENARIO.division)E=[2.2*i+n,2.2*i+n,17.5*i+n,17.5*i+n],f=[5.5*a,6.5*a,6.5*a,5.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));else if(9===SCENARIO.division){E=[1.5*i,1.5*i,5.5*i,5.5*i],f=[4.5*a,5.5*a,5.5*a,4.5*a],S=[u,u,u,u];var p=[6.5*i,6.5*i,10.5*i,10.5*i],T=[4.5*a,5.5*a,5.5*a,4.5*a],R=[u,u,u,u];c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,5*a)+Helper.makeRoundedPath(p,T,R,1,0,5*a))}else if(10===SCENARIO.division){E=[6.5*i,6.5*i,7.5*i,7.5*i],f=[1.5*a,3.5*a,3.5*a,1.5*a],S=[u,u,u,u];var m=[6.5*i,6.5*i,1.5*i,1.5*i,6.5*i,6.5*i,7.5*i,7.5*i],g=[4.5*a,6.5*a,6.5*a,8.5*a,8.5*a,10.5*a,10.5*a,4.5*a],A=[u,u,u,u,u,u,u,u];c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0)+Helper.makeRoundedPath(E,f,S,1,0,10*a)+Helper.makeRoundedPath(m,g,A,1,0,0))}else if(11===SCENARIO.division)E=[1.5*i,1.5*i,3.5*i,3.5*i,4.5*i,4.5*i],f=[7.5*a,8.5*a,8.5*a,13.5*a,13.5*a,7.5*a],S=[u,u,u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));else if(12===SCENARIO.division)E=[12.5*i,12.5*i,13.5*i,13.5*i],f=[1.5*a,5.5*a,5.5*a,1.5*a],S=[u,u,u,u],p=[12.5*i,12.5*i,13.5*i,13.5*i],T=[1.5*a,5.5*a,5.5*a,1.5*a],R=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0)+Helper.makeRoundedPath(E,f,S,1,0,8*a));else if(13===SCENARIO.division)E=[1.5*i,1.5*i,3.5*i,3.5*i],f=[6.5*a,8.5*a,8.5*a,6.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));if(8===SCENARIO.division){var C=e.createLinearGradient(0,5.5*a,0,6.5*a);C.addColorStop(0,"#777"),C.addColorStop(1,"#999")}else if(10===SCENARIO.division){C=e.createLinearGradient(1.5*i,1.5*a,6.5*i,11.5*a);C.addColorStop(0,"#777"),C.addColorStop(1,"#999")}else if(11===SCENARIO.division){C=e.createLinearGradient(1.5*i,5.5*a,6.5*i,5.5*a);C.addColorStop(0,"#777"),C.addColorStop(1,"#999")}else if(12===SCENARIO.division){C=e.createLinearGradient(12.5*i,5.5*a,13.5*i,5.5*a);C.addColorStop(0,"#777"),C.addColorStop(1,"#999")}else if(13===SCENARIO.division){C=e.createLinearGradient(1.5*i,5.5*a,3.5*i,5.5*a);C.addColorStop(0,"#777"),C.addColorStop(1,"#999")}else{C=e.createLinearGradient(i*r/2+n,0,i*r/2+n+i-2*n,0);C.addColorStop(0,"#777"),C.addColorStop(1,"#999")}c&&(e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle=C,e.shadowBlur=4,e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowColor="#555",e.fill(c,"evenodd"),e.restore(),e.save(),e.clip(c,"evenodd"),1===SCENARIO.division||2===SCENARIO.division||7===SCENARIO.division?Textures.drawHazard(e,i*r/2,0,FIELD.tileWidth,6*FIELD.tileHeight,FIELD.tileWidth/48,.5):3===SCENARIO.division?Textures.drawHazard(e,4.5*i,0,FIELD.tileWidth,9*FIELD.tileHeight,FIELD.tileWidth/48,.5):4===SCENARIO.division?Textures.drawHazard(e,6.5*i,0,4*FIELD.tileWidth,4*FIELD.tileHeight,FIELD.tileWidth/48,.5):5===SCENARIO.division?Textures.drawHazard(e,5*i,0,2*FIELD.tileWidth,6*FIELD.tileHeight,FIELD.tileWidth/48,.5):6===SCENARIO.division?Textures.drawHazard(e,9*i,0,2*FIELD.tileWidth,13*FIELD.tileHeight,FIELD.tileWidth/48,.5):8===SCENARIO.division?Textures.drawHazard(e,2*i,5,20*FIELD.tileWidth,2*FIELD.tileHeight,FIELD.tileWidth/48,.5):9===SCENARIO.division?Textures.drawHazard(e,1*i,1*a,24*FIELD.tileWidth,10*FIELD.tileHeight,FIELD.tileWidth/48,.5):10===SCENARIO.division?Textures.drawHazard(e,1*i,1*a,24*FIELD.tileWidth,10*FIELD.tileHeight,FIELD.tileWidth/48,.5):11===SCENARIO.division?Textures.drawHazard(e,1*i,5*a,5*FIELD.tileWidth,6*FIELD.tileHeight,FIELD.tileWidth/48,.5):12===SCENARIO.division?Textures.drawHazard(e,12*i,1*a,2*FIELD.tileWidth,12*FIELD.tileHeight,FIELD.tileWidth/48,.5):13===SCENARIO.division&&Textures.drawHazard(e,1*i,6*a,4*FIELD.tileWidth,2*FIELD.tileHeight,FIELD.tileWidth/48,.5),e.restore(),e.save(),e.lineWidth=1.5,e.strokeStyle="black",e.stroke(c),e.restore());c=0;if(1===SCENARIO.division)c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,(s/2+1)*a-I));else if(2===SCENARIO.division)E=[i*r/2+n,i*r/2+n,i*r/2+n+i-2*n,i*r/2+n+i-2*n],f=[a/2,a/2+s/2*a+I,a/2+s/2*a+I,a/2],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,(s/2+0)*a));else if(3===SCENARIO.division)E=[i*r/2+n,i*r/2+n,i*r/2+n+i-2*n,i*r/2+n+i-2*n],f=[a/2,a/2+1*a+I,a/2+1*a+I,a/2],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,-5*a,(s/2+5)*a));else if(4===SCENARIO.division)I=0,E=[6.5*i,6.5*i,10.5*i,10.5*i],f=[1.5*a,3.5*a,3.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,10*a));else if(5===SCENARIO.division)E=[5.5*i,5.5*i,6.5*i,6.5*i],f=[7.5*a,13.5*a,13.5*a,7.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));else if(6===SCENARIO.division)E=[9.5*i,9.5*i,1.5*i,1.5*i,9.5*i,9.5*i,10.5*i,10.5*i,18.5*i,18.5*i,10.5*i,10.5*i],f=[4.5*a,6.5*a,6.5*a,8.5*a,8.5*a,10.5*a,10.5*a,8.5*a,8.5*a,6.5*a,6.5*a,4.5*a],S=[u,u,u,u,u,u,u,u,u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));else if(7===SCENARIO.division)E=[i*r/2+n,i*r/2+n,i*r/2+n+i-2*n,i*r/2+n+i-2*n],f=[2.5*a,7.5*a,7.5*a,2.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,(s/2+0)*a));else if(8===SCENARIO.division)E=[2.2*i+n,2.2*i+n,17.5*i+n,17.5*i+n],f=[5.5*a,6.5*a,6.5*a,5.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,3*a));else if(9===SCENARIO.division)E=[1.5*i,1.5*i,5.5*i,5.5*i],f=[4.5*a,5.5*a,5.5*a,4.5*a],S=[u,u,u,u],p=[6.5*i,6.5*i,10.5*i,10.5*i],T=[4.5*a,5.5*a,5.5*a,4.5*a],R=[u,u,u,u],m=[11.5*i,11.5*i,15.5*i,15.5*i,11.5*i,11.5*i,16.5*i,16.5*i,18.5*i,18.5*i,16.5*i,16.5*i],g=[4.5*a,5.5*a,5.5*a,9.5*a,9.5*a,10.5*a,10.5*a,8.5*a,8.5*a,6.5*a,6.5*a,4.5*a],A=[u,u,u,u,u,u,u,u,u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0)+Helper.makeRoundedPath(p,T,R,1,0,0)+Helper.makeRoundedPath(m,g,A,1,0,0));if(8===SCENARIO.division){C=e.createLinearGradient(0,8.5*a,0,9.5*a);C.addColorStop(0,"#777"),C.addColorStop(1,"#999")}else if(9===SCENARIO.division){C=e.createLinearGradient(0,4.5*a,0,9.5*a);C.addColorStop(0,"#777"),C.addColorStop(1,"#999")}c&&(e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle=C,e.shadowBlur=4,e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowColor="#555",e.fill(c,"evenodd"),e.restore(),e.save(),e.clip(c,"evenodd"),1===SCENARIO.division||2===SCENARIO.division||7===SCENARIO.division?Textures.drawHazard(e,i*r/2,a*s/2,FIELD.tileWidth,6*FIELD.tileHeight,FIELD.tileWidth/48,.5):3===SCENARIO.division?Textures.drawHazard(e,4.5*i,a*s/2,FIELD.tileWidth,6*FIELD.tileHeight,FIELD.tileWidth/48,.5):4===SCENARIO.division?Textures.drawHazard(e,6.5*i,11.5*a,4*FIELD.tileWidth,6*FIELD.tileHeight,FIELD.tileWidth/48,.5):5===SCENARIO.division?Textures.drawHazard(e,5*i,7*a,2*FIELD.tileWidth,7*FIELD.tileHeight,FIELD.tileWidth/48,.5):6===SCENARIO.division?Textures.drawHazard(e,1*i,1*a,18*FIELD.tileWidth,11*FIELD.tileHeight,FIELD.tileWidth/48,.5):8===SCENARIO.division?Textures.drawHazard(e,2*i,7,24*FIELD.tileWidth,2*FIELD.tileHeight,FIELD.tileWidth/48,.5):9===SCENARIO.division&&Textures.drawHazard(e,1*i,1*a,24*FIELD.tileWidth,10*FIELD.tileHeight,FIELD.tileWidth/48,.5),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(c),e.restore())}if(SCENARIO.device){if(e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=.2,e.fillStyle="#333",e.shadowBlur=4,e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowColor="#555",1===SCENARIO.device){E=[4.5*i,4.5*i,5.7*i,14.3*i,15.5*i,15.5*i],f=[2.5*a,5.5*a,7.5*a,7.5*a,5.5*a,2.5*a],S=[u,u,u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}else if(2===SCENARIO.device){E=[6.5*i,6.5*i,10.5*i,10.5*i],f=[2.5*a,11.5*a,11.5*a,2.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}else if(3===SCENARIO.device){E=[3.6*i,3.6*i,6.4*i,6.4*i],f=[8.5*a,9.5*a,9.5*a,8.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=1}else if(4===SCENARIO.device){E=[4.6*i,4.6*i,5.4*i,5.4*i],f=[4.5*a,6.5*a,6.5*a,4.5*a],S=[u,u,u,u],p=[4.6*i,4.6*i,5.4*i,5.4*i],T=[8.5*a,10.5*a,10.5*a,8.5*a],R=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0)+Helper.makeRoundedPath(p,T,R,1,0,0));e.globalAlpha=1}else if(5===SCENARIO.device){E=[4.5*i,4.5*i,5.5*i,5.5*i],f=[1.5*a,13.5*a,13.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}else if(6===SCENARIO.device){E=[1.5*i,1.5*i,5.5*i,5.5*i],f=[5.5*a,9.5*a,8.5*a,6.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}else if(7===SCENARIO.device){E=[1.5*i,1.5*i,8.5*i,8.5*i],f=[5.5*a,9.5*a,9.5*a,5.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}else if(8===SCENARIO.device){E=[6.5*i,6.5*i,7.5*i,7.5*i],f=[1.5*a,13.5*a,13.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}else if(9===SCENARIO.device){E=[7.5*i,7.5*i,8.5*i,8.5*i],f=[1.5*a,13.5*a,13.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}else if(10===SCENARIO.device){E=[3.5*i,3.5*i,6.5*i,6.5*i],f=[5.5*a,6.5*a,6.5*a,5.5*a],S=[u,u,u,u],p=[3.5*i,3.5*i,6.5*i,6.5*i],T=[8.5*a,9.5*a,9.5*a,8.5*a],R=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0)+Helper.makeRoundedPath(p,T,R,1,0,0));e.globalAlpha=.2}else if(11===SCENARIO.device){E=[9.5*i,9.5*i,10.5*i,10.5*i],f=[1.5*a,13.5*a,13.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}else if(12===SCENARIO.device){E=[8.5*i,8.5*i,11.5*i,11.5*i],f=[1.5*a,13.5*a,13.5*a,1.5*a],S=[u,u,u,u],c=new Path2D(Helper.makeRoundedPath(E,f,S,1,0,0));e.globalAlpha=.2}e.fill(c,"evenodd"),e.stroke(c,"evenodd"),e.restore()}"chsh"===SCENARIO.name&&(e.save(),e.textBaseline="middle",e.textAlign="left",e.font=i/2*1.2+"px Verdana",e.fillStyle="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowColor="black",e.fillText("Alice",3*i,11.5*a),e.beginPath(),e.stroke(Helper.roundRect(2.8*i,11.1*a,1.8*i,.8*a,i/4)),e.fillText("Bob",15*i,11.5*a),e.beginPath(),e.stroke(Helper.roundRect(14.8*i,11.1*a,1.6*i,.8*a,i/4)),e.restore());var L=[n,i,i,n,n,i-n,i-n,i,i,5*i+n,5*i+n,3*i+o,3*i+o,6*i-n,6*i-n,(r-6)*i+n,(r-6)*i+n,(r-3)*i-o,(r-3)*i-o,(r-5)*i-n,(r-5)*i-n,i*(r-1),i*(r-1),i*(r-1)+n,i*(r-1)+n,i*r-n,i*r-n,i*(r-1),i*(r-1),i*r-n,i*r-n,i*(r-1)+n,i*(r-1)+n,i*(r-1),i*(r-1),i,i,i-n,i-n,n],D=[(FIELD.topEntry+1)*a-n,(FIELD.topEntry+1)*a-n,(FIELD.bottomEntry+1)*a+n,(FIELD.bottomEntry+1)*a+n,(s-1)*a-o,(s-1)*a-o,(FIELD.bottomEntry+2)*a-n,(FIELD.bottomEntry+2)*a-n,a*(s-1),a*(s-1),a*(s-1)+n,a*(s-1)+n,a*s-n,a*s-n,a*(s-1),a*(s-1),a*s-n,a*s-n,a*(s-1)+n,a*(s-1)+n,a*(s-1),a*(s-1),(FIELD.bottomEntry+2)*a-n,(FIELD.bottomEntry+2)*a-n,(s-1)*a-o,(s-1)*a-o,(FIELD.bottomEntry+1)*a+n,(FIELD.bottomEntry+1)*a+n,(FIELD.topEntry+1)*a-n,(FIELD.topEntry+1)*a-n,a+o,a+o,FIELD.topEntry*a+n,FIELD.topEntry*a+n,a,a,FIELD.topEntry*a+n,FIELD.topEntry*a+n,a+o,a+o],b=[h,l,l,h,l,l,l,l,l,l,l,l,l,h,l,l,h,l,l,l,l,l,l,l,l,l,h,l,l,h,l,l,l,l,l,l,l,l,l,l],O=[FIELD.leftMargin-OVERLAY.margin,FIELD.leftMargin+OVERLAY.margin+FIELD.tileWidth*FIELD.cols,FIELD.leftMargin+OVERLAY.margin+FIELD.tileWidth*FIELD.cols,FIELD.leftMargin-OVERLAY.margin],M=[FIELD.topMargin+OVERLAY.margin+a*FIELD.rows,FIELD.topMargin+OVERLAY.margin+a*FIELD.rows,FIELD.topMargin-OVERLAY.margin,FIELD.topMargin-OVERLAY.margin],v=[d,d,d,h],w=(c=new Path2D(Helper.makeRoundedPath(L,D,b,1,FIELD.leftMargin,FIELD.topMargin)+Helper.makeRoundedPath(O,M,v,1,0,0)),new Path2D(Helper.makeRoundedPath(O,M,v,1,0,0)));const N=new Path2D(makeOverlayPattern());CANV.controls.clear();var P=CANV.controls.ctx;P.save(),P.fillStyle="#30473e",P.shadowBlur=4,P.shadowOffsetX=4,P.shadowOffsetY=4,P.shadowColor="#555",P.fill(w,"evenodd"),P.lineWidth=1,P.strokeStyle="black",P.stroke(w),P.textBaseline="middle",P.textAlign="center",P.font=2.8*i+"px Courier New",P.translate(FIELD.leftMargin-OVERLAY.margin+.5*FIELD.tileWidth*FIELD.cols,FIELD.topMargin+OVERLAY.margin+.5*a*FIELD.rows),P.rotate(-Math.PI/6),P.strokeText("CONFIDENTIAL",0,0),P.font=1*i+"px Courier New",P.strokeText("DO NOT DISSEMINATE",0,-2.2*a);var y=Math.random();y<1/3?P.strokeText("PENALTY OF DE-LECTROCUTION",0,2.2*a):y<2/3?(P.font=Math.round(.9*i)+"px Courier New",P.strokeText("PENALTY OF DOWNGRADE->WINDOWS-ME",0,2.2*a)):P.strokeText("PENALTY OF RE-FRAGMENTATION",0,2.2*a),P.beginPath(),P.stroke(Helper.roundRect(-a*(FIELD.rows+4)/2,1.1*a,a*(FIELD.rows+4),.2*a,a/12)),P.stroke(Helper.roundRect(-a*(FIELD.rows+4)/2,-1.3*a,a*(FIELD.rows+4),.2*a,a/12));var F=a,k=3*a,x=[-F/2,-F/2,-1.5*F,0,1.5*F,F/2,F/2,-F/2],B=[3*a,3*a+k,3*a+k,4*a+k,3*a+k,3*a+k,3*a,3*a],W=[0,0,0,0,0,0,0,0],q=new Path2D(Helper.makeRoundedPath(x,B,W,1,0,0));P.stroke(q);B=[-3*a,-3*a-k,-3*a-k,-4*a-k,-3*a-k,-3*a-k,-3*a,-3*a],q=new Path2D(Helper.makeRoundedPath(x,B,W,1,0,0));P.stroke(q),P.restore(),P.save(),P.fillStyle="#523314",P.globalAlpha=.15,P.clip(w,"evenodd"),P.scale(1/OVERLAY.scale,1/OVERLAY.scale),P.fill(N),P.translate(4e3,0),P.fill(N),P.translate(0,4e3),P.fill(N),P.translate(-4e3,0),P.fill(N),P.restore(),e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,t<1&&(e.globalAlpha=t),e.fillStyle="#30473e",e.shadowBlur=4,e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowColor="#555",e.fill(c,"evenodd"),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(c),e.restore(),e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(c,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(N),e.translate(4040,0),e.fill(N),e.translate(0,4040),e.fill(N),e.translate(-4040,0),e.fill(N),FIELD.cols>19&&(e.translate(8080,-4040),e.fill(N),e.translate(0,4040),e.fill(N)),e.restore(),e.save(),t<1&&(e.globalAlpha=t),e.textBaseline="middle",e.textAlign="center",e.font=1*i/2+"px Courier New",e.fillStyle="antiquewhite",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.fillText("A›",FIELD.leftMargin+i/2+n/2,FIELD.topMargin+(FIELD.topEntry+1.5)*a-n),e.fillText("B›",FIELD.leftMargin+i/2+n/2,FIELD.topMargin+(FIELD.bottomEntry+.5)*a+n),e.fillText("C›",FIELD.leftMargin+i/2+i*(r-1)-n/2,FIELD.topMargin+(FIELD.topEntry+1.5)*a-n),e.fillText("D›",FIELD.leftMargin+i/2+i*(r-1)-n/2,FIELD.topMargin+(FIELD.bottomEntry+.5)*a+n),e.restore(),e.save(),t<1&&(e.globalAlpha=t),e.textBaseline="middle",e.textAlign="center",e.font=1*i/2+"px Courier New",e.fillStyle="antiquewhite",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.fillText(String.fromCharCode(945),FIELD.leftMargin+i/2+6*i-n,FIELD.topMargin+a*(s-.5)-2*n/4),e.fillText(String.fromCharCode(946),FIELD.leftMargin+i/2+(r-7)*i+n,FIELD.topMargin+a*(s-.5)),e.font=1*i/2+"px Courier New",e.fillText("ˆ",FIELD.leftMargin+i/2+6*i-n,FIELD.topMargin+a*(s-.5)-3*n/3),e.fillText("ˆ",FIELD.leftMargin+i/2+(r-7)*i+n,FIELD.topMargin+a*(s-.5)-3*n/3),e.restore(),e.save(),t<1&&(e.globalAlpha=t),e.textBaseline="bottom",e.textAlign="left",e.font=2.2*FIELD.tileWidth/4+"px Courier New",e.fillStyle="antiquewhite",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.fillText("The Qubit Factory",3.2*i/3,3.2*a/3);var H=3.2*i/3+e.measureText("The Qubit Factory").width;e.font=1*FIELD.tileWidth/4+"px Courier New",e.fillText("  "+FIELD.version,H,3.3*a/3),e.restore(),e.save(),t<1&&(e.globalAlpha=t),Paths.entryPortal(e,0,0).draw(e,FIELD.leftMargin,a+FIELD.topMargin,FIELD.tileWidth,FIELD.tileHeight),Paths.entryPortal(e,0,1).draw(e,FIELD.leftMargin+i*(r-1),a+FIELD.topMargin,FIELD.tileWidth,FIELD.tileHeight),Paths.entryPortal(e,Math.PI,1).draw(e,FIELD.leftMargin+i*(r-1),a*(s-2)+FIELD.topMargin,FIELD.tileWidth,FIELD.tileHeight),Paths.entryPortal(e,Math.PI,0).draw(e,FIELD.leftMargin,a*(s-2)+FIELD.topMargin,FIELD.tileWidth,FIELD.tileHeight),Paths.entryPortal(e,3*Math.PI/2,0).draw(e,3*i+FIELD.leftMargin,a*(s-1)+FIELD.topMargin,FIELD.tileWidth,FIELD.tileHeight),Paths.entryPortal(e,Math.PI/2,0).draw(e,(r-4)*i+FIELD.leftMargin,a*(s-1)+FIELD.topMargin,FIELD.tileWidth,FIELD.tileHeight),e.restore();var U=FIELD.tileWidth/9,_=0*FIELD.leftPad+(FIELD.cols/2+3+(FIELD.cols-21)/4)*FIELD.tileWidth,G=0*FIELD.topPad+FIELD.tileHeight/2,V=7*FIELD.tileWidth,Q=2*FIELD.tileHeight/3,$=(O=[_,_,_+V,_+V],M=[G,G+Q,G+Q,G],v=[U,U,U,U],new Path2D(Helper.makeRoundedPath(O,M,v,1,0,0)));e.save(),t<1&&(e.globalAlpha=t),e.fillStyle="#2b2b2b",e.strokeStyle="#000",e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fill($),e.stroke($),e.restore(),e.save(),e.clip($,"evenodd"),Textures.drawFiber(e,_,G,V,Q,FIELD.tileWidth/48,.5),e.restore(),e.save(),e.globalCompositeOperation="destination-out";for(var z=PathsC.ctrlDummy(e),j=0;j<5;j++)z.draw(e,FIELD.menu2.x0+j*FIELD.tileWidth-FIELD.leftPad,FIELD.menu2.y0-FIELD.topPad,FIELD.tileWidth,FIELD.tileHeight);e.restore()}static createMenu(e,t,i,a,r,s){e.clearRect(e,0,0,t,i),a.clearRect(a,0,0,r,s),a.save();for(var o=0;o<MENU.buttons.length;o++){var n=MENU.buttons[o],l=MENU.gridPos(n.i0,n.j0);if(n.tile.draw(a,l.x0,l.y0,FIELD.tileWidth,FIELD.tileHeight),n.isGrey){var h=1.3*MENU.tileMargin;n.tile.draw(a,l.x0,l.y0,FIELD.tileWidth,FIELD.tileHeight),Paths.menuGrey(a).draw(a,l.x0-h/2,l.y0-h/2,FIELD.tileWidth+h,FIELD.tileHeight+h)}}a.restore();var d=FIELD.tileWidth/6,u=FIELD.tileHeight/6,c=3.5*FIELD.tileWidth/6,I=3*FIELD.tileHeight/6,E=FIELD.tileWidth/3,f=2*FIELD.tileWidth/3,S=[c,c,t-c,t-c],p=[I+FIELD.tileHeight,i-I,i-I,I+FIELD.tileHeight],T=[E,E,E,E],R=[d,d,t-d,t-d],m=[u,i-u,i-u,u],g=[f,f,f,f],A=new Path2D(Helper.makeRoundedPath(S,p,T,1,0,0)+Helper.makeRoundedPath(R,m,g,1,0,0)),C=[d+10,d+10,t-d-10,t-d-10],L=[u+10,i-u-10,i-u-10,u+10],D=new Path2D(Helper.makeRoundedPath(R,m,g,1,0,0)+Helper.makeRoundedPath(C,L,T,1,0,0));e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="grey",e.shadowBlur=4,e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowColor="#555",e.fill(D,"evenodd"),e.restore(),e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="#30473e",e.fill(A,"evenodd"),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(A),e.restore();const b=new Path2D(makeOverlayPattern());e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(A,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(b),e.restore();var O=1.2*FIELD.tileWidth,M=FIELD.tileHeight/2,v=(FIELD.tileWidth,FIELD.menu.pad,FIELD.menu.cols,FIELD.menu.pad,FIELD.tileWidth/9),w=[O,O,t-O,t-O],N=[0,2*FIELD.menu.topPad/3,2*FIELD.menu.topPad/3,0],P=[v,v,v,v],y=new Path2D(Helper.makeRoundedPath(w,N,P,1,0,M));e.save(),e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fillStyle="#2b2b2b",e.fill(y),e.strokeStyle="#000",e.stroke(y),e.restore(),e.save(),e.clip(y,"evenodd"),Textures.drawFiber(e,O,0,t,2*FIELD.menu.topPad/3,FIELD.tileWidth/48,.5),e.restore()}static createInstruct(e,t,i,a=!1){var r=FIELD.tileWidth/6,s=FIELD.tileHeight/6,o=(FIELD.tileWidth,FIELD.tileHeight,FIELD.tileWidth,2*FIELD.tileWidth/3),n=[r,r,t-r,t-r],l=[s,i-s,i-s,s],h=[o,o,o,o],d=new Path2D(Helper.makeRoundedPath(n,l,h,1,0,0));e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="#30473e",e.shadowBlur=4,e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowColor="#555",e.fill(d,"evenodd"),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(d),e.restore();const u=new Path2D(makeOverlayPattern());if(e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(d,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(u),e.restore(),a){var c=FIELD.tileWidth;e.save(),e.fillStyle="#30473e",e.shadowBlur=4,e.shadowOffsetX=4,e.shadowOffsetY=4,e.shadowColor="#555",e.textBaseline="middle",e.textAlign="center",e.translate(t/2,i/2),e.rotate(-Math.PI/6),e.font=Math.round(1+t/7)+"px Courier New",e.strokeText("RESTRICTED",0,0),e.beginPath(),e.stroke(Helper.roundRect(3.5*-c,-1*c,7*c,.2*c,c/12)),e.stroke(Helper.roundRect(3.5*-c,.8*c,7*c,.2*c,c/12));var I=c,E=2*c,f=[-I/2,-I/2,-1.5*I,0,1.5*I,I/2,I/2,-I/2],S=[1.5*c,1.5*c+E,1.5*c+E,2.5*c+E,1.5*c+E,1.5*c+E,1.5*c,1.5*c],p=[0,0,0,0,0,0,0,0],T=new Path2D(Helper.makeRoundedPath(f,S,p,1,0,0));e.stroke(T);S=[-1.5*c,-1.5*c-E,-1.5*c-E,-2.5*c-E,-1.5*c-E,-1.5*c-E,-1.5*c,-1.5*c],T=new Path2D(Helper.makeRoundedPath(f,S,p,1,0,0));return e.stroke(T),void e.restore()}var R=1.2*FIELD.tileWidth,m=FIELD.tileHeight/2,g=(FIELD.tileWidth,FIELD.menu.pad,FIELD.menu.cols,FIELD.menu.pad,FIELD.tileWidth/9),A=[R,R,t-R,t-R],C=[0,2*FIELD.menu.topPad/3,2*FIELD.menu.topPad/3,0],L=[g,g,g,g],D=new Path2D(Helper.makeRoundedPath(A,C,L,1,0,m));e.save(),e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fillStyle="#2b2b2b",e.fill(D),e.strokeStyle="#000",e.stroke(D),e.restore(),e.save(),e.clip(D,"evenodd"),Textures.drawFiber(e,R,0,t,2*FIELD.menu.topPad/3,FIELD.tileWidth/48,.5),e.restore();R=FIELD.tileWidth/2,m=3*FIELD.tileHeight/2,g=FIELD.tileWidth/3,A=[R,R,t-R,t-R],C=[m,FIELD.scoreHeight-FIELD.tileWidth/2,FIELD.scoreHeight-FIELD.tileWidth/2,m],L=[g,g,g,g],D=new Path2D(Helper.makeRoundedPath(A,C,L,1,0,0));e.save(),e.shadowBlur=4,e.shadowOffsetX=FIELD.tileWidth/24,e.shadowOffsetY=FIELD.tileWidth/24,e.shadowColor="#17241f",e.fillStyle="#2b2b2b",e.fill(D),e.strokeStyle="#000",e.stroke(D),e.restore(),e.save(),e.clip(D,"evenodd"),Textures.drawFiber(e,R,m,t,FIELD.scoreHeight-FIELD.tileWidth/2,FIELD.tileWidth/48,.5),e.restore()}static createAnalysis(e,t,i){var a=FIELD.tileWidth/6,r=FIELD.tileHeight/6,s=3.5*FIELD.tileWidth/6,o=3.5*FIELD.tileHeight/6,n=FIELD.tileWidth/3,l=2*FIELD.tileWidth/3,h=(a=FIELD.tileWidth/6,r=FIELD.tileHeight/6,s=3.5*FIELD.tileWidth/6,o=3.5*FIELD.tileHeight/6,n=FIELD.tileWidth/3,l=2*FIELD.tileWidth/3,[0,0,t-s,t-s,0,0,t-a,t-a]),d=[r,o,o,i-o,i-o,i-r,i-r,r],u=[0,0,n,n,0,0,l,l],c=new Path2D(Helper.makeRoundedPath(h,d,u,1,0,0));e.save(),e.globalCompositeOperation="source-over",e.globalAlpha=1,e.fillStyle="#426959",e.shadowColor="#777",e.fill(c),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(c),e.restore();const I=new Path2D(makeOverlayPattern());e.save(),e.fillStyle="#523314",e.globalAlpha=.15,e.clip(c,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.fill(I),e.translate(0,4040),e.fill(I),e.translate(4040,0),e.fill(I),e.translate(0,-4040),e.fill(I),e.restore()}static createInfo(e){var t=FIELD.tileWidth,i=FIELD.tileHeight,a=(FIELD.cols,FIELD.rows,OVERLAY.border,[-t/2,-t/2,MENU.w0+t/2,MENU.w0+t/2]),r=[FIELD.topMargin-OVERLAY.margin,MENU.y0-2*FIELD.tileHeight,MENU.y0-2*FIELD.tileHeight,FIELD.topMargin-OVERLAY.margin],s=[a[0]+t/2,a[1]+t/2,a[2]-t/2,a[3]-t/2],o=[r[0]+i/2,r[1]-i/2,r[2]-i/2,r[3]+i/2],n=[30,30,30,30],l=[15,15,15,15],h=new Path2D(Helper.makeRoundedPath(a,r,n,1,MENU.x0,0)+Helper.makeRoundedPath(s,o,l,1,MENU.x0,0)),d=e.createLinearGradient(MENU.x0,MENU.y0,MENU.x0+MENU.w0,0);d.addColorStop(1,"#4e7566"),d.addColorStop(0,"#1c3630"),e.save(),e.globalAlpha=1,e.fillStyle=d,e.fill(h,"evenodd"),e.restore(),e.save(),e.lineWidth=1,e.strokeStyle="black",e.stroke(h),e.restore();const u=new Path2D(makeOverlayPattern());e.save(),e.fillStyle="#523314",e.globalAlpha=.2,e.clip(h,"evenodd"),e.scale(1/OVERLAY.scale,1/OVERLAY.scale),e.translate(3e3,0),e.fill(u),e.restore()}static createScenarioNew(e,t,i){e.save(),e.fillStyle="antiquewhite",e.font=1.2/3*FIELD.tileWidth+"px Courier New",e.textBaseline="middle",e.textAlign="center",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.fillText(SCENARIO.title,t/2,5*FIELD.tileHeight/6);FIELD.tileWidth;e.textAlign="left";for(var a=12*FIELD.tileHeight/6,r=0;r<SCENARIO.info.length;r++){for(var s=Helper.parseText(e,SCENARIO.info[r],t-2*SCENARIO.xPad),o=0;o<s.length;o++)e.fillText(s[o],SCENARIO.xPad,a),o<s.length-1&&(a+=SCENARIO.yPad2);a+=SCENARIO.yPad}e.restore()}}class PathSet{constructor(e,t,i){this._name=e,this._w=t,this._h=i,this._paths=[],this._isFancy=!1}get name(){return this._name}get w(){return this._w}get h(){return this._h}get paths(){return this._paths}get isFancy(){return this._isFancy}set paths(e){this._paths=e}set isFancy(e){this._isFancy=e}add(e){this.paths.push(e)}draw(e,t,i,a,r,s=1,o=!1){o?this.drawSelect(e,t,i,a,r):this.isFancy||1!==s?this.drawFancy(e,t,i,a,r,s):this.drawSimple(e,t,i,a,r)}drawSimple(e,t,i,a,r){e.save();var s=a/this.w,o=r/this.h;e.shadowOffsetX=.6*s,e.shadowOffsetY=1.4*o;for(var n=(t+a/2)/s,l=(i+r/2)/o,h=-a/2/s,d=-r/2/o,u=0;u<this.paths.length;u++)if(this.paths[u].text){var c=this.paths[u].x0*(a/this.w),I=this.paths[u].y0*(r/this.h),E=this.paths[u].fontsize;e.font="normal "+E+"px helvetica",e.shadowColor="transparent",e.textAlign="center",e.textBaseline="middle",e.fillStyle=this.paths[u].fill,e.setTransform(s,0,0,o,t+c,i+I),e.fillText(this.paths[u].text,0,0),e.restore()}else{if(this.paths[u].rot)if(Math.abs(this.paths[u].rot)>.001){var f=Math.sin(this.paths[u].rot),S=Math.cos(this.paths[u].rot),p=S*s,T=f*s,R=-f*o,m=S*o,g=S*s*h-f*o*d+s*n,A=f*s*h+S*o*d+o*l;e.setTransform(p,T,R,m,g,A)}else e.setTransform(s,0,0,o,t,i);else e.setTransform(s,0,0,o,t,i);this.paths[u].fill&&(e.fillStyle=this.paths[u].fill,this.paths[u].shadowFill&&OPTS.useShads?e.shadowColor=this.paths[u].shadowFill:e.shadowColor="transparent",e.fill(this.paths[u].path)),this.paths[u].stroke&&(e.strokeStyle=this.paths[u].stroke,e.lineWidth=this.paths[u].lineWidth,e.lineCap=this.paths[u].lineCap,this.paths[u].shadowStroke&&OPTS.useShads?e.shadowColor=this.paths[u].shadowStroke:e.shadowColor="transparent",e.stroke(this.paths[u].path))}e.restore()}drawFancy(e,t,i,a,r,s=1){e.save();var o=a/this.w,n=r/this.h;e.globalAlpha=s,e.shadowOffsetX=.6*o,e.shadowOffsetY=1.4*n;for(var l=(t+a/2)/o,h=(i+r/2)/n,d=-a/2/o,u=-r/2/n,c=0;c<this.paths.length;c++)if(this.paths[c].text){this.paths[c].alpha||0===this.paths[c].alpha?e.globalAlpha=this.paths[c].alpha*s:e.globalAlpha=s;var I=this.paths[c].x0*(a/this.w),E=this.paths[c].y0*(r/this.h),f=this.paths[c].fontsize;e.font="normal "+f+"px helvetica",e.shadowColor="transparent",e.textAlign="center",e.textBaseline="middle",e.fillStyle=this.paths[c].fill,e.setTransform(o,0,0,n,t+I,i+E),e.fillText(this.paths[c].text,0,0),e.restore()}else{if(this.paths[c].alpha||0===this.paths[c].alpha?e.globalAlpha=this.paths[c].alpha*s:e.globalAlpha=s,this.paths[c].rot)if(Math.abs(this.paths[c].rot)>.001){var S=Math.sin(this.paths[c].rot),p=Math.cos(this.paths[c].rot),T=p*o,R=S*o,m=-S*n,g=p*n,A=p*o*d-S*n*u+o*l,C=S*o*d+p*n*u+n*h;e.setTransform(T,R,m,g,A,C)}else e.setTransform(o,0,0,n,t,i);else e.setTransform(o,0,0,n,t,i);this.paths[c].fill&&(e.fillStyle=this.paths[c].fill,this.paths[c].shadowFill&&OPTS.useShads?(e.shadowColor=this.paths[c].shadowFill,this.paths[c].shadowOffset&&(e.shadowOffsetX=.3*this.paths[c].shadowOffset*o,e.shadowOffsetY=.7*this.paths[c].shadowOffset*n)):e.shadowColor="transparent",e.fill(this.paths[c].path)),this.paths[c].stroke&&(e.strokeStyle=this.paths[c].stroke,e.lineWidth=this.paths[c].lineWidth,e.lineCap=this.paths[c].lineCap,this.paths[c].shadowStroke&&OPTS.useShads?(e.shadowColor=this.paths[c].shadowStroke,this.paths[c].shadowOffset&&(e.shadowOffsetX=.3*this.paths[c].shadowOffset*o,e.shadowOffsetY=.7*this.paths[c].shadowOffset*n)):e.shadowColor="transparent",e.stroke(this.paths[c].path))}e.restore()}drawSelect(e,t,i,a,r,s=!1){var o=1;e.save();var n=a/this.w,l=r/this.h;e.globalAlpha=o,e.shadowOffsetX=0*n,e.shadowOffsetY=0*l,e.shadowBlur=20;for(var h=(t+a/2)/n,d=(i+r/2)/l,u=-a/2/n,c=-r/2/l,I=0;I<this.paths.length;I++)if(this.paths[I].text){this.paths[I].alpha||0===this.paths[I].alpha?e.globalAlpha=this.paths[I].alpha*o:e.globalAlpha=o;var E=this.paths[I].x0*(a/this.w),f=this.paths[I].y0*(r/this.h),S=this.paths[I].fontsize;e.font="normal "+S+"px helvetica",e.shadowColor="transparent",e.textAlign="center",e.textBaseline="middle",e.fillStyle=this.paths[I].fill,e.setTransform(n,0,0,l,t+E,i+f),e.fillText(this.paths[I].text,0,0),e.restore()}else{if(this.paths[I].alpha||0===this.paths[I].alpha?e.globalAlpha=this.paths[I].alpha*o:e.globalAlpha=o,this.paths[I].rot)if(Math.abs(this.paths[I].rot)>.001){var p=Math.sin(this.paths[I].rot),T=Math.cos(this.paths[I].rot),R=T*n,m=p*n,g=-p*l,A=T*l,C=T*n*u-p*l*c+n*h,L=p*n*u+T*l*c+l*d;e.setTransform(R,m,g,A,C,L)}else e.setTransform(n,0,0,l,t,i);else e.setTransform(n,0,0,l,t,i);this.paths[I].fill&&(e.fillStyle=this.paths[I].fill,this.paths[I].shadowFill&&(OPTS.useShads||s)?e.shadowColor=this.paths[I].shadowFill:e.shadowColor="transparent",e.fill(this.paths[I].path)),this.paths[I].stroke&&(e.strokeStyle=this.paths[I].stroke,e.lineWidth=this.paths[I].lineWidth,e.lineCap=this.paths[I].lineCap,this.paths[I].shadowStroke&&(OPTS.useShads||s)?(e.shadowColor=this.paths[I].shadowStroke,this.paths[I].shadowOffset&&(e.shadowOffsetX=.3*this.paths[I].shadowOffset*n,e.shadowOffsetY=.7*this.paths[I].shadowOffset*l)):e.shadowColor="transparent",e.stroke(this.paths[I].path))}e.restore()}}class Paths{static undoButton(e,t,i=!1){var a=e.createRadialGradient(16,16,0,16,16,16);i?(a.addColorStop(0,"#00b0b0"),a.addColorStop(1,"#364f4f")):(a.addColorStop(0,"darkcyan"),a.addColorStop(1,"#2a3d3d"));var r="#021200",s=new Tile("undoButton",32,32),o=new Path2D("M 0 16 l 0 -4 a 12 12 0 0 1 12 -12 l 8 0 a 12 12 0 0 1 12 12 l 0 4");s.addPathRaw(o,a,"black",.5,0,"round","none","none");o=new Path2D("M 0 16 L 32 16");s.addPathRaw(o,"none","black",1,0,"round","none","none");o=new Path2D("M 5 10 L 10 6 L 10 14 Z");s.addPathRaw(o,"#003636",r,.5,0,"round","none","none");o=new Path2D("M 21 10 L 26 6 L 26 14 Z");return s.addPathRaw(o,"#003636",r,.5,0,"round","none","none"),s.addText(String(t),{x:16,y:10},r,12,"Verdana","normal",0),s}static redoButton(e,t,i=!1){var a=e.createRadialGradient(16,16,0,16,16,16);i?(a.addColorStop(0,"#00b0b0"),a.addColorStop(1,"#364f4f")):(a.addColorStop(0,"darkcyan"),a.addColorStop(1,"#2a3d3d"));var r="#021200",s=new Tile("redoButton",32,32),o=new Path2D("M 0 16 l 0 -4 a 12 12 0 0 1 12 -12 l 8 0 a 12 12 0 0 1 12 12 l 0 4");s.addPathRaw(o,a,"black",.5,0,"round","none","none");o=new Path2D("M 0 16 L 32 16");s.addPathRaw(o,"none","black",1,0,"round","none","none");o=new Path2D("M 6 6 L 6 14 L 11 10 Z");s.addPathRaw(o,"#003636",r,.5,0,"round","none","none");o=new Path2D("M 22 6 L 22 14 L 27 10 Z");return s.addPathRaw(o,"#003636",r,.5,0,"round","none","none"),s.addText(String(t),{x:16,y:10},"black",12,"Verdana","normal",0),s}static monitorKnob(e){var t=e.createRadialGradient(12,12,0,12,12,24);t.addColorStop(1,"#0e1818"),t.addColorStop(0,"darkslategrey");var i=new Tile("monitorKnob",32,32),a=new Path2D("M 4 16 a 12 12 0 0 1 24 0 a 12 12 0 0 1 -24 0");return i.addPathRaw(a,t,"black",1.5,0,"round","none","none"),i}static journalButton(e,t=!1){var i=e.createRadialGradient(12,12,0,12,12,24);t?(i.addColorStop(0,"bisque"),i.addColorStop(1,"goldenrod")):(i.addColorStop(0,"#d9b14c"),i.addColorStop(1,"darkgoldenrod"))
;var a=new Tile("latterButton",32,32),r=new Path2D("M 0 12 a 12 12 0 0 1 12 -12 L 20 0 a 12 12 0 0 1 12 12 L 32 20 a 12 12 0 0 1 -12 12 L 12 32 a 12 12 0 0 1 -12 -12 Z");return a.addPathRaw(r,i,"black",1.5,0,"round","black","none"),a.addText("J",{x:16,y:16},"black",36,"Courier New","normal",0),a}static archiveButton(e,t=!1){var i=e.createRadialGradient(12,12,0,12,12,24);t?(i.addColorStop(0,"bisque"),i.addColorStop(1,"goldenrod")):(i.addColorStop(0,"#d9b14c"),i.addColorStop(1,"darkgoldenrod"));var a=new Tile("latterButton",32,32),r=new Path2D("M 0 12 a 12 12 0 0 1 12 -12 L 20 0 a 12 12 0 0 1 12 12 L 32 20 a 12 12 0 0 1 -12 12 L 12 32 a 12 12 0 0 1 -12 -12 Z");return a.addPathRaw(r,i,"black",1.5,0,"round","black","none"),a.addText("A",{x:16,y:16},"black",36,"Courier New","normal",0),a}static selectButtons(e,t="",i=!1){var a=e.createRadialGradient(12,12,0,12,12,24);i?(a.addColorStop(0,"#00d4d4"),a.addColorStop(1,"#507575")):(a.addColorStop(0,"darkcyan"),a.addColorStop(1,"#2a3d3d"));var r=new Tile("selectButton",32,32),s=new Path2D("M 0 8 a 8 8 0 0 1 8 -8 L 24 0 a 8 8 0 0 1 8 8 L 32 24 a 8 8 0 0 1 -8 8 L 8 32 a 8 8 0 0 1 -8 -8 Z");return r.addPathRaw(s,a,"none",1.5,0,"round","black"),r.addPathRaw(s,"none","black",2,0,"round"),r.addText(t,{x:16,y:16},"black",32,"Courier New","normal",0),r}static letterButton(e,t=0,i=!1){var a=["H","B","R","C","A"],r=e.createRadialGradient(12,12,0,12,12,24);i?(r.addColorStop(0,"#00d4d4"),r.addColorStop(1,"#507575")):(r.addColorStop(0,"darkcyan"),r.addColorStop(1,"#2a3d3d"));var s=new Tile("letterButton",32,32),o=new Path2D("M 0 8 a 8 8 0 0 1 8 -8 L 24 0 a 8 8 0 0 1 8 8 L 32 24 a 8 8 0 0 1 -8 8 L 8 32 a 8 8 0 0 1 -8 -8 Z");return s.addPathRaw(o,r,"black",1.5,0,"round","black"),s.addText(a[t],{x:16,y:16},"black",36,"Courier New","normal",0),s}static blueprint(e,t=0,i=!1,a=0){if(0===t)var r="#374a52",s="#60818E",o="#82b0c4",n="#27353b";else if(1===t)r="#4e5d7a",s="#6d83ad",o="#8ba9e0",n="#2e384a";else if(2===t)r="#4a4875",s="#625f9c",o="#7571bd",n="#25243b";i&&(o=flashColor(o,.3));var l=e.createLinearGradient(0,0,32,0);l.addColorStop(0,r),l.addColorStop(.25,s),l.addColorStop(.75,s),l.addColorStop(1,r);var h=e.createLinearGradient(0,0,32,0);h.addColorStop(0,s),h.addColorStop(.5,o),h.addColorStop(1,s);var d=new Tile("blueprint",32,32),u=new Path2D("M 4 12 L 4 24 a 4 4 0 0 0 4 4 L 24 28 a 4 4 0 0 0 4 -4 L 28 12 Z");d.addPathRaw(u,h,n,.5,0,"round");u=new Path2D("M 10 4 a 6 4 0 0 0 -6 4 L 4 24 a 6 4 0 0 1 6 -4 Z");d.addPathRaw(u,l,n,.5,0,"round");u=new Path2D("M 22 4 a 6 4 0 0 1 6 4 L 28 24 a 6 4 0 0 0 -6 -4 Z");if(d.addPathRaw(u,l,n,.5,0,"round"),0===a){u=new Path2D("M 20 24 L 8 24 M 12 24 L 20 16 M 12 16 L 20 24 M 12 16 L 20 16");d.addPathRaw(u,"none","#4e6d7a",1,0,"round")}else if(1===a){u=new Path2D("M 20 24 L 8 24 M 12 24 L 20 16 M 12 16 L 16 20 M 20 24 L 20 20 M 12 16 L 20 16");d.addPathRaw(u,"none","#4e6d7a",1,0,"round")}else if(2===a){u=new Path2D("M 20 24 L 8 24 M 12 24 L 20 16 M 20 24 L 20 16 M 12 16 L 20 16");d.addPathRaw(u,"none","#354b54",1,0,"round")}else{u=new Path2D("M 20 24 L 8 24 L 16 16 L 16 24 M 12 16 L 20 16");d.addPathRaw(u,"none","#4e6d7a",1,0,"round")}return d}static flares(e,t,i){var a=new Tile("flares",32,32),r=5*Math.sqrt(Math.sin(Math.PI*(2*(i-.5))/2.5)),s=100;if(i>.5)for(var o=0;o<s;o++){var n=FLARES.colors[Math.floor(5*FLARES.elms[t+3+4*o])],l=4*FLARES.dotsizes[t+4*o],h=l+5*r*FLARES.dotsizes[t+1+4*o],d=2*Math.PI*FLARES.elms[t+2+4*o],u=16+h*Math.sin(d),c=16-h*Math.cos(d);if(i<FLARES.lifetimes[t+4*o-1])var I=1;else I=Math.exp(20*(FLARES.lifetimes[t+4*o-1]-i));var E=new Path2D("M "+u+" "+c+" L "+u+" "+c);a.addPathRaw(E,"none",n,4*FLARES.dotsizes[t+4*o-1],0,"round","none","none",0,0,[],I)}return a}static entryPortal(e,t,i=0){var a=e.createLinearGradient(0,0,32,0);a.addColorStop(0,"#333"),a.addColorStop(.5,"#666"),a.addColorStop(1,"#333");var r=new Tile("entryPortal",32,32),s=new Path2D("M 4 0 L 28 0 L 28 6 L 4 6 Z");if(r.addPathRaw(s,a,"none",1,t,"round","none","none",0),0===i){s=new Path2D("M 4.5 0.5 L 9.5 5.5 M 27.5 0.5 L 22.5 5.5 M 9.5 0.5 L 14.5 5.5 M 22.5 0.5 L 17.5 5.5 M 14.5 0.5 L 17.5 0.5 L 16 3 L 14.5 0.5");r.addPathRaw(s,"none","#30473e",2,t,"butt","none","none",0)}else if(1===i){s=new Path2D("M 4.5 5.5 L 9.5 0.5 M 27.5 5.5 L 22.5 0.5 M 9.5 5.5 L 14.5 0.5 M 22.5 5.5 L 17.5 0.5 M 14.5 5.5 L 17.5 5.5 L 16 3 L 14.5 5.5");r.addPathRaw(s,"none","#30473e",2,t,"butt","none","none",0)}s=new Path2D(Helper.makeRoundedPath([4,28,28,4],[0,0,6,6],[3,3,3,3]));return r.addPathRaw(s,"none","#1c1f1c",1,t,"round","none","none",0),r}static wormholes(e,t,i=0){var a=new Tile("wormholes",32,32);if(t<.5)var r=22*t;else r=11;if(t<.75)var s=2;else s=8*(1-t);if(1===i)var o="turquoise";else o="tan";var n=new Path2D("M 16 "+(16-r)+" a "+r+" "+r+"  0 0 1 0 "+2*r+" a "+r+" "+r+"  0 0 1 0 "+-2*r);return a.addPathRaw(n,"none",o,s,2*t,"butt","none","none",0),a}static sparkBonus(e,t,i){var a=new Tile("sparkBonus",32,32);if(0===t){var r="M 14 0 L 14 13 L 8 13 L 18 32 L 18 19 L 24 19 Z";a.addPathRaw(new Path2D(r),"turquoise","#001e8b",2,i,"round","none","none",2)}else if(1===t){r="M 18 0 L 18 13 L 24 13 L 14 32 L 14 19 L 8 19 Z";a.addPathRaw(new Path2D(r),"turquoise","#001e8b",2,i,"round","none","none",2)}return a}static starBonus(e,t,i){for(var a=new Tile("starBonus",32,32),r=16,s="M ",o=0;o<5;o++)s+=16+r*Math.sin(2*Math.PI*o/5),s+=" ",s+=16-r*Math.cos(2*Math.PI*o/5),s+=" L ",s+=16+.5*r*Math.sin(2*Math.PI*(o+.5)/5),s+=" ",s+=16-.5*r*Math.cos(2*Math.PI*(o+.5)/5),s+=o<4?" L ":" Z";return 0===t?a.addPathRaw(new Path2D(s),"gold","darkgoldenrod",2,i,"round","none","none",2):a.addPathRaw(new Path2D(s),"none","darkgoldenrod",2,i,"round","none","none",2),a}static scannersFinish(e,t){var i=new Tile("scannersFinish",32,32),a=1e-5;if(t<a)var r=1/a;else r=16/t;var s=new Path2D("M 0 0 a "+r+" "+r+" 0 0 0 32 0 Z");return i.addPathRaw(s,"black","none",1,0,"butt","none","none",2),i}static scannersSmall(e,t,i,a=0){var r="black",s=new Tile("scannersSmall",32,32),o=10.5;if(t>.1&&t<.9){var n=16,l=16-o*Math.sin((t+.01)*Math.PI),h=16+o*Math.sin((t+.01)*Math.PI),d=16-o*Math.cos((t+.01)*Math.PI),u=e.createLinearGradient(d-n/2,16,d+n/2,16);0===a?(u.addColorStop(0,"rgba(255,255,255,0.0)"),u.addColorStop(.2,"rgba(0,0,255,0.2)"),u.addColorStop(.5,"cyan"),u.addColorStop(.8,"rgba(0,0,255,0.2)"),u.addColorStop(1,"rgba(255,255,255,0.0)")):(u.addColorStop(0,"rgba(255,255,255,0.0)"),u.addColorStop(.2,"rgba(0,0,255,0.2)"),u.addColorStop(.5,"fuchsia"),u.addColorStop(.8,"rgba(0,0,255,0.2)"),u.addColorStop(1,"rgba(255,255,255,0.0)"));var c=new Path2D("M "+(d-n/2)+" "+l+" L "+(d-n/2)+" "+h+" L "+(d+n/2)+" "+h+" L "+(d+n/2)+" "+l+" Z");s.addPathRaw(c,u,"none",1,i,"butt","none","none",2)}o=10;if(t<=.1){var I=16-o*Math.cos(0),E=16-o*Math.cos(.75),f=16-o*Math.sin(0),S=16-o*Math.sin(.75),p=16+o*Math.sin(.75),T=o-9*Math.sqrt(10*t);c=new Path2D("M "+I+" "+f+" a 10 10 0 0 1 "+(E-I)+" "+(S-f)+" a "+T+" "+T+" 0 0 0 "+(I-E)+" "+(f-S)+" Z");s.addPathRaw(c,r,"none",1,i,"butt","none","none",2);c=new Path2D("M "+I+" "+f+" a 10 10 0 0 0 "+(E-I)+" "+(p-f)+" a "+T+" "+T+" 0 0 1 "+(I-E)+" "+(f-p)+" Z");s.addPathRaw(c,r,"none",1,i,"butt","none","none",2)}else if(t>=.9){I=16+o*Math.cos(0),E=16+o*Math.cos(.75),f=16-o*Math.sin(0),S=16-o*Math.sin(.75),p=16+o*Math.sin(.75),T=o-9*Math.sqrt(10*(1-t)),c=new Path2D("M "+I+" "+f+" a 10 10 0 0 0 "+(E-I)+" "+(S-f)+" a "+T+" "+T+" 0 0 1 "+(I-E)+" "+(f-S)+" Z");s.addPathRaw(c,r,"none",1,i,"butt","none","none",2);c=new Path2D("M "+I+" "+f+" a 10 10 0 0 1 "+(E-I)+" "+(p-f)+" a "+T+" "+T+" 0 0 0 "+(I-E)+" "+(f-p)+" Z");s.addPathRaw(c,r,"none",1,i,"butt","none","none",2)}else{I=16-o*Math.cos(Math.PI*(t-.1)),E=16-o*Math.cos(Math.PI*(t-.1)+.75),f=16-o*Math.sin(Math.PI*(t-.1)),S=16-o*Math.sin(Math.PI*(t-.1)+.75),p=16+o*Math.sin(Math.PI*(t-.1));var R=16+o*Math.sin(Math.PI*(t-.1)+.75);T=1,c=new Path2D("M "+I+" "+f+" a 10 10 0 0 1 "+(E-I)+" "+(S-f)+" a "+T+" "+T+" 0 0 0 "+(I-E)+" "+(f-S)+" Z");s.addPathRaw(c,r,"none",1,i,"butt","none","none",2);c=new Path2D("M "+I+" "+p+" a 10 10 0 0 0 "+(E-I)+" "+(R-p)+" a "+T+" "+T+" 0 0 1 "+(I-E)+" "+(p-R)+" Z");s.addPathRaw(c,r,"none",1,i,"butt","none","none",2)}return s}static scanners(e,t,i){var a="black",r=new Tile("scanners",32,32),s=15;if(t>.1&&t<.9){var o=16,n=16-s*Math.sin((t+.01)*Math.PI),l=16+s*Math.sin((t+.01)*Math.PI),h=16-s*Math.cos((t+.01)*Math.PI),d=e.createLinearGradient(h-o/2,16,h+o/2,16);d.addColorStop(0,"rgba(255,255,255,0.0)"),d.addColorStop(.2,"rgba(255,0,0,0.2)"),d.addColorStop(.5,"rgba(255,205,255,1)"),d.addColorStop(.8,"rgba(255,0,0,0.2)"),d.addColorStop(1,"rgba(255,255,255,0.0)");var u=new Path2D("M "+(h-o/2)+" "+n+" L "+(h-o/2)+" "+l+" L "+(h+o/2)+" "+l+" L "+(h+o/2)+" "+n+" Z");r.addPathRaw(u,d,"none",1,i,"butt","none","none",2)}s=13.5;if(t<=.1){var c=16-s*Math.cos(0),I=16-s*Math.cos(.75),E=16-s*Math.sin(0),f=16-s*Math.sin(.75),S=16+s*Math.sin(.75),p=s-9*Math.sqrt(10*t);u=new Path2D("M "+c+" "+E+" a 10 10 0 0 1 "+(I-c)+" "+(f-E)+" a "+p+" "+p+" 0 0 0 "+(c-I)+" "+(E-f)+" Z");r.addPathRaw(u,a,"none",1,i,"butt","none","none",2);u=new Path2D("M "+c+" "+E+" a 10 10 0 0 0 "+(I-c)+" "+(S-E)+" a "+p+" "+p+" 0 0 1 "+(c-I)+" "+(E-S)+" Z");r.addPathRaw(u,a,"none",1,i,"butt","none","none",2)}else if(t>=.9){c=16+s*Math.cos(0),I=16+s*Math.cos(.75),E=16-s*Math.sin(0),f=16-s*Math.sin(.75),S=16+s*Math.sin(.75),p=s-9*Math.sqrt(10*(1-t)),u=new Path2D("M "+c+" "+E+" a 10 10 0 0 0 "+(I-c)+" "+(f-E)+" a "+p+" "+p+" 0 0 1 "+(c-I)+" "+(E-f)+" Z");r.addPathRaw(u,a,"none",1,i,"butt","none","none",2);u=new Path2D("M "+c+" "+E+" a 10 10 0 0 1 "+(I-c)+" "+(S-E)+" a "+p+" "+p+" 0 0 0 "+(c-I)+" "+(E-S)+" Z");r.addPathRaw(u,a,"none",1,i,"butt","none","none",2)}else{c=16-s*Math.cos(Math.PI*(t-.1)),I=16-s*Math.cos(Math.PI*(t-.1)+.75),E=16-s*Math.sin(Math.PI*(t-.1)),f=16-s*Math.sin(Math.PI*(t-.1)+.75),S=16+s*Math.sin(Math.PI*(t-.1));var T=16+s*Math.sin(Math.PI*(t-.1)+.75);p=1,u=new Path2D("M "+c+" "+E+" a 10 10 0 0 1 "+(I-c)+" "+(f-E)+" a "+p+" "+p+" 0 0 0 "+(c-I)+" "+(E-f)+" Z");r.addPathRaw(u,a,"none",1,i,"butt","none","none",2);u=new Path2D("M "+c+" "+S+" a 10 10 0 0 0 "+(I-c)+" "+(T-S)+" a "+p+" "+p+" 0 0 1 "+(c-I)+" "+(S-T)+" Z");r.addPathRaw(u,a,"none",1,i,"butt","none","none",2)}return r}static fireRing(e,t){var i=Math.sin(t*Math.PI/2),a=32*i,r=new Tile("fireRing",32,32),s=Math.min(1,2*(1-i)),o=e.createRadialGradient(16,16,0,16,16,a);o.addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(.5,"rgba(0,0,0,0)"),o.addColorStop(.6,"rgba(0,0,0,0.5)"),o.addColorStop(.9,"darkorange"),o.addColorStop(1,"white");var n=new Path2D("M 16 "+(16+a)+" a "+a+" "+a+" 0 0 1 0 "+-2*a+" a "+a+" "+a+" 0 0 1 0 "+2*a+" Z");return r.addPathRaw(n,o,"none",2,0,"square","none","none",0,0,[],s),r}static compareRing(e,t,i){var a=24*t,r=new Tile("compareRing",32,32),s=Math.min(1,4*(1-t));if(0===i){var o=e.createRadialGradient(16,16,0,16,16,a);o.addColorStop(0,"#d93b75"),o.addColorStop(.9,"crimson"),o.addColorStop(1,"crimson")}else if(1===i){o=e.createRadialGradient(16,16,0,16,16,a);o.addColorStop(0,"limegreen"),o.addColorStop(.8,"greenyellow"),o.addColorStop(.9,"limegreen"),o.addColorStop(1,"#7fff00")}var n=new Path2D("M 16 "+(16+a)+" a "+a+" "+a+" 0 0 1 0 "+-2*a+" a "+a+" "+a+" 0 0 1 0 "+2*a+" Z");r.addPathRaw(n,o,"none",2,0,"butt","none","none",0,0,[],s);var l=Math.max(0,a-5),h=new Path2D("M 16 "+(16+l)+" a "+l+" "+l+" 0 0 1 0 "+-2*l+" a "+l+" "+l+" 0 0 1 0 "+2*l+" Z");return r.addPathRaw(h,"cut","none",2,0,"butt"),r.addPathRaw(n,o,"none",2,0,"butt","none","none",0,0,[],.5*s),r}static menuGrey(e){var t=new Tile("menuGrey",32,32),i=new Path2D(Helper.makeRoundedPath([0,0,32,32],[0,32,32,0],[6,6,6,6]));return t.addPathRaw(i,"#333","none",2,0,"round","none","none",0,0,[],.85),t}static place(e,t=!0){var i=new Tile("place",32,32),a=new Path2D("M 0 5 a 5 5 0 0 1 5 -5 L 27 0 a 5 5 0 0 1 5 5 L 32 27 a 5 5 0 0 1 -5 5 L 5 32 a 5 5 0 0 1 -5 -5 L 0 5 Z");return t?i.addPathRaw(a,"limegreen","none",2,0,"round","none","none",0,0,[],.4):i.addPathRaw(a,"crimson","none",2,0,"round","none","none",0,0,[],.4),i}static eraser(e,t=!0){var i=new Tile("place",32,32),a=new Path2D("M 0 5 a 5 5 0 0 1 5 -5 L 27 0 a 5 5 0 0 1 5 5 L 32 27 a 5 5 0 0 1 -5 5 L 5 32 a 5 5 0 0 1 -5 -5 L 0 5 Z");return t?i.addPathRaw(a,"darkorange","none",2,0,"round","none","none",0,0,[],.4):i.addPathRaw(a,"crimson","none",2,0,"round","none","none",0,0,[],.4),i}static hover(e){var t=new Tile("hover",32,32),i=new Path2D("M 0 5 a 5 5 0 0 1 5 -5 L 27 0 a 5 5 0 0 1 5 5 L 32 27 a 5 5 0 0 1 -5 5 L 5 32 a 5 5 0 0 1 -5 -5 L 0 5 Z");return t.addPathRaw(i,"goldenrod","none",2,0,"round","none","none",0,0,[],.4),t}static selected(e,t){var i=4*Math.PI/16,a=4*Math.PI/16,r=(i+a)*t,s=[];if(r<i)s=[r,a,i-r,0];else s=[0,r-i,i,a-(r-i)];var o=new Tile("selected",32,32),n=new Path2D("M 0 16 a 16 16 0 0 0 32 0 a 16 16 0 0 0 -32 0");return o.addPathRaw(n,"none","black",1,0,"butt","none","none",2,0,s),o.addPathRaw(n,"goldenrod","none",1,0,"butt","none","none",2,0,[],.5),o}static qubitHalo(e){var t=.4,i=16-16*Math.cos(t),a=16-16*Math.sin(t),r=16-16*Math.sin(t),s=16-16*Math.cos(t),o=new Tile("qubitHalo",32,32),n=new Path2D("M "+i+" "+r+" A 16 16 0 0 1 "+a+" "+s),l="#694c04",h="gold";return o.addPathRaw(n,"none",l,2.5,0,"square","none","darkslategrey",2,0,[],1),o.addPathRaw(n,"none",l,2.5,Math.PI/2,"square","none","darkslategrey",2,0,[],1),o.addPathRaw(n,"none",l,2.5,2*Math.PI/2,"square","none","darkslategrey",2,0,[],1),o.addPathRaw(n,"none",l,2.5,3*Math.PI/2,"square","none","darkslategrey",2,0,[],1),o.addPathRaw(n,"none",h,1,0,"square","none","none",2,0,[],1),o.addPathRaw(n,"none",h,1,Math.PI/2,"square","none","none",2,0,[],1),o.addPathRaw(n,"none",h,1,2*Math.PI/2,"square","none","none",2,0,[],1),o.addPathRaw(n,"none",h,1,3*Math.PI/2,"square","none","none",2,0,[],1),o}static sphere(e,t){var i=flashColor("black",t),a=flashColor("#444",t),r=flashColor("#666",t),s=e.createRadialGradient(8,8,1,16,16,16);s.addColorStop(0,r),s.addColorStop(.2,a),s.addColorStop(1,i);var o=new Tile("sphere",32,32),n=new Path2D("M 12 16 a 4 4 0 0 1 8 0 a 4 4 0 0 1 -8 0 Z");return o.addPathRaw(n,s,"none",2,0,"butt","lightslategrey","none",2,0,[],1),o}static entMass(e,t,i){var a=e.createRadialGradient(10,10,0,10,10,16);a.addColorStop(0,"#6edbff"),a.addColorStop(1,"deepskyblue");var r=t,s="#666",o="#131313",n="#BBB",l=e.createRadialGradient(8,8,1,16,16,16);l.addColorStop(0,n),l.addColorStop(.2,o),l.addColorStop(1,s);var h=new Tile("entMass",32,32),d=new Path2D("M 16 "+(16+14*r)+" a "+14*r+" "+14*r+" 0 0 1 0 "+-28*r+" a "+14*r+" "+14*r+" 0 0 1 0 "+28*r+" Z");h.addPathRaw(d,a,"none",1,0,"square");d=new Path2D("M 16 30 a 14 14 0 0 1 0 -28 a 14 14 0 0 1 0 28 Z");return h.addPathRaw(d,"none","#333",.5,0,"square"),h.addText(String(Analysis.normFloat2(t)),{x:16,y:16},"black",12,"Verdana","normal",i),h}static gear(e,t,i,a){for(var r=10,s=16,o=2*Math.PI/i,n=.1,l=.1,h="M ",d=0;d<i;d++)h+=16+r*Math.sin(t+d*o-l)+" ",h+=16-r*Math.cos(t+d*o-l)+" L ",h+=16+s*Math.sin(t+d*o+n)+" ",h+=16-s*Math.cos(t+d*o+n)+" L ",h+=16+s*Math.sin(t+(d+.5)*o-n)+" ",h+=16-s*Math.cos(t+(d+.5)*o-n)+" L ",h+=16+r*Math.sin(t+(d+.5)*o+l)+" ",h+=16-r*Math.cos(t+(d+.5)*o+l),h+=d<i-1?" ":" Z";var u=[];u.push({path:new Path2D(h),fill:a,stroke:"#111",strokeWidth:1,lineCap:"round"});for(h="",d=0;d<i;d++)h+=" M "+(16+6*Math.sin(t+(d+.25)*o))+" ",h+=16-6*Math.cos(t+(d+.25)*o)+" L ",h+=16+10*Math.sin(t+(d+.25)*o)+" ",h+=16-10*Math.cos(t+(d+.25)*o);u.push({path:new Path2D(h),stroke:"#111",strokeWidth:1,lineCap:"round"});h=new Path2D("M 16 22 a 6 6 0 0 1 0 -12 a 6 6 0 0 1 0 12 Z");u.push({path:new Path2D(h),stroke:"#111",strokeWidth:1,lineCap:"round"}),u.push({path:new Path2D(h),stroke:"#777",strokeWidth:.5,lineCap:"round"});h=new Path2D("M 16 19 a 3 3 0 0 1 0 -6 a 3 3 0 0 1 0 6 Z");return u.push({path:new Path2D(h),fill:"#777",stroke:"#111",strokeWidth:.5,lineCap:"round"}),u}static newQubit(e,t,i,a,r=0,s=0,o=[1],n=[0],l=[1],h=!1,d=!1,u=1){if(h)var c=flashColor("LightGreen",i),I=flashColor("MediumSeaGreen",i),E=flashColor("#42c77d",i),f=flashColor("DarkOrchid",i),S=flashColor("#913191",i);else c=flashColor("MediumSeaGreen",i),I=flashColor("#2b8051",i),f=flashColor("Indigo",i),E=flashColor("darkgreen",i),S=flashColor("#913191",i);if(r)var p=48,T=Math.atan2(-48,0),R=p*Math.sin(T+r.rot)+16,m=p*Math.cos(T+r.rot)+16,g=Math.sqrt(2560),A=Math.atan2(48,16),C=g*Math.sin(A+r.rot)+16,L=g*Math.cos(A+r.rot)+16;if(OPTS.useGrads){if(r)var D=e.createLinearGradient(R,m,C,L);else D=e.createLinearGradient(-32,16,64,0);D.addColorStop(0,c),D.addColorStop(Math.max(a-.1,0),c),D.addColorStop(a,I),D.addColorStop(Math.min(a+.1,1),c),D.addColorStop(1,c)}else D=c;if(r){var b=new Tile("qubit",32,32),O=new Path2D("M 16 6 a "+10*r.ratio+" 10 0 0 1 0 20 a "+10*r.ratio+" 10 0 0 1 0 -20 Z");b.addPathRaw(O,D,"none",2,r.rot,"square","lightslategrey","none",2*r.ratio);for(var M=4*Math.min(1-s,1),v=4*Math.min(s,1),w=-(r.rot-t),N=(R=[15,15,15-M,15,17,17+M,17,17,17+v,17,15,15-v],m=[18,14,14,9,9,14,14,18,18,23,23,18],[0,0,0,0,0,0,0,0,0,0,0,0]),P=[0,0,0,0,0,0,0,0,0,0,0,0],y=0;y<R.length;y++){p=Math.sqrt((R[y]-16)**2+(m[y]-16)**2),T=Math.atan2(R[y]-16,m[y]-16);N[y]=r.ratio*p*Math.sin(T-w)+16,P[y]=p*Math.cos(T-w)+16}O=new Path2D(" M "+N[0]+" "+P[0]+" L "+N[1]+" "+P[1]+" L "+N[2]+" "+P[2]+" L "+N[3]+" "+P[3]+" L "+N[4]+" "+P[4]+" L "+N[5]+" "+P[5]+" L "+N[6]+" "+P[6]+" L "+N[7]+" "+P[7]+" L "+N[8]+" "+P[8]+" L "+N[9]+" "+P[9]+" L "+N[10]+" "+P[10]+" L "+N[11]+" "+P[11]+" Z");b.addPathRaw(O,f,"none",1.7,r.rot,"butt",S,"none",1*r.ratio);O=new Path2D("M 16 7 a "+9*r.ratio+" 9 0 0 1 0 18 a "+9*r.ratio+" 9 0 0 1 0 -18 Z");if(b.addPathRaw(O,"none",D,2,r.rot,"butt"),1==r.ratio)var F=18*Math.PI;else{var k=(9-9*r.ratio)**2/(9+9*r.ratio)**2;F=Math.PI*(9+9*r.ratio)*(1+3*k/(10+Math.sqrt(4-3*k)))}var x=.1;for(y=0;y<o.length;y++)if(l[y]>x){var B=n[y]+TIMER.swirlRatio;B>1&&(B-=1);var W=o[y]**2,q=1-o[y]**2;B=n[y]+TIMER.swirlRatio;B>1&&(B-=1);W=o[y]**2,q=1-o[y]**2;var H=[W*(F/3),q*(F/3)],U=B*(W+q)*(F/3);O=new Path2D("M 16 7 a "+9*r.ratio+" 9 0 0 1 0 18 a "+9*r.ratio+" 9 0 0 1 0 -18 Z");o[y]>=0?b.addPathRaw(O,"none",E,2,r.rot,"butt",0,0,1,0,H,l[y],U):b.addPathRaw(O,"none",S,2,r.rot,"butt",0,0,1,0,H,l[y],U)}}else{b=new Tile("qubit",32,32);if(!d){var _=new Path2D("M 16 6 a 10 10 0 0 1 0 20 a 10 10 0 0 1 0 -20 Z");b.addPathRaw(_,D,"none",2,0,"square","lightslategrey","none",2)}M=4*Math.min(1-s,1),v=4*Math.min(s,1),O=new Path2D("M 15 18 L 15 14 L "+(15-M)+" 14 L 15 9 L 17 9 L "+(17+M)+" 14 L 17 14 L 17 18 L "+(17+v)+" 18 L 17 23 L 15 23 L "+(15-v)+" 18 Z");if(b.addPathRaw(O,f,"none",1.7,t,"butt",S,"none",1,0,[],u),!d)for(F=18*Math.PI,x=.1,y=0;y<o.length;y++)if(l[y]>x){B=n[y]+TIMER.swirlRatio;B>1&&(B-=1);W=o[y]**2,q=1-o[y]**2,H=[W*(F/3),q*(F/3)],U=B*(W+q)*(F/3),O=new Path2D("M 16 7 a 9 9 0 0 1 0 18 a 9 9 0 0 1 0 -18 Z");o[y]>=0?b.addPathRaw(O,"none",E,2,0,"butt",0,0,1,0,H,l[y],U):b.addPathRaw(O,"none",S,2,0,"butt",0,0,1,0,H,l[y],U)}}return b}static nakedQubit(e,t,i,a=!1){if(a)var r="#dc14aa";else r="none";var s="Indigo",o="#913191",n=new Tile("qubit",32,32),l=5*Math.min(1-i,1),h=5*Math.min(i,1),d=new Path2D("M 15 18 L 15 14 L "+(15-l)+" 14 L 15 9 L 17 9 L "+(17+l)+" 14 L 17 14 L 17 18 L "+(17+h)+" 18 L 17 23 L 15 23 L "+(15-h)+" 18 Z");return n.addPathRaw(d,s,r,1,t,"butt",o,"none",1),n}static bit(e,t,i,a=0,r=1,s=!1){if(s)var o=flashColor("wheat",i),n=flashColor("Black",i),l=flashColor("SandyBrown",i);else o=flashColor("SandyBrown",i),n=flashColor("Black",i),l=flashColor("Sienna",i);if(OPTS.useGrads){var h=e.createLinearGradient(-32,16,64,0);h.addColorStop(0,o),h.addColorStop(Math.max(a-.2,0),o),h.addColorStop(a,l),h.addColorStop(Math.min(a+.2,1),o),h.addColorStop(1,o)}else h=o;var d=flashColor("#333333",i),u=new Tile("bit",32,32),c=new Path2D("M 16 6 a 10 10 0 0 1 0 20 a 10 10 0 0 1 0 -20 Z");u.addPathRaw(c,h,"none",2,0,"square","lightslategrey","none",2,0,[],r);c=new Path2D("M 16 7 a 9 9 0 0 1 0 18 a 9 9 0 0 1 0 -18 Z");if(u.addPathRaw(c,"none",l,2,0,"square","none","none",0,0,[],r),0===t){c=new Path2D("M 12 15 a 4 4 0 0 1 8 0 L 20 17 a 4 4 0 0 1 -8 0 Z");u.addPathRaw(c,"none",n,2,0,"round","none",d,1,0,[],1)}else{c=new Path2D("M 14 13 L 16 11 L 16 20 M 14 20 L 18 20");u.addPathRaw(c,"none",n,2,0,"butt","none",d,1,0,[],1)}return u}static measure(e,t,i,a,r=!1){if(r)var s="black",o="#666";else{flashColor("#d92b2b",a);var n=flashColor("black",a),l=flashColor("#444",a),h=flashColor("#666",a);o=e.createRadialGradient(8,8,1,16,16,16);o.addColorStop(0,h),o.addColorStop(.2,l),o.addColorStop(1,n);s="#d92b2b"}var d=new Tile("qCombineGate",32,32),u=new Path2D("M 16 30 a 14 14 0 0 1 0 -28 a 14 14 0 0 1 0 28 Z");d.addPathRaw(u,o,"none",2,0,"square","lightslategrey","none");u=new Path2D("M 14 2 L 18 2 L 18 30 L 14 30 Z");d.addPathRaw(u,"grey","none",2,i,"butt");u=new Path2D("M 18 2 L 18 30 M 14 2 L 14 30");d.addPathRaw(u,"none",s,2,i,"butt");u=new Path2D("M 30 14 a 10 10 0 0 0 -6 -7 L 23 14 Z");d.addPathRaw(u,s,"none",2,i-Math.PI/2,"round");u=new Path2D("M 30 18 a 10 10 0 0 1 -6 7 L 23 18 Z");return d.addPathRaw(u,s,"none",2,i-Math.PI/2,"round"),d}static wormholesOld(e,t,i=0){var a=new Tile("wormholes",32,32);if(t<.5)var r=22*t*.95;else r=10.45;if(t<.75)var s=2;else{s=8*(1-t);s<.5&&(s=.5)}if(0===i)var o="turquoise";else o="fuchsia";var n=new Path2D("M 16 "+(16-r)+" a "+r+" "+r+"  0 0 1 0 "+2*r+" a "+r+" "+r+"  0 0 1 0 "+-2*r);return a.addPathRaw(n,"none","black",s,5*t,"butt","none","none",0),a.addPathRaw(n,"none",o,s,5*t+1,"butt","none","none",0,0,[3*Math.PI*r/20,2*Math.PI*r/20]),a}static qFlip(e,t,i,a){var r=flashColor("black",a),s=flashColor("#444",a),o=flashColor("#666",a),n=e.createRadialGradient(8,8,1,16,16,16);n.addColorStop(0,o),n.addColorStop(.2,s),n.addColorStop(1,r),i-=Math.PI/2,i>Math.PI&&(i-=2*Math.PI),i<=-Math.PI&&(i+=2*Math.PI);flashColor("#d92b2b",a);var l=new Tile("flipGate",32,32),h=new Path2D("M 16 30 a 14 14 0 0 1 0 -28 a 14 14 0 0 1 0 28 Z");l.addPathRaw(h,n,"none",2,0,"square","lightslategrey","none");h=new Path2D("M 8 16 L 25 16");l.addPathRaw(h,"none","lightgrey",3,i,"round");h=new Path2D("M 11 11 L 11 21 L 6 17 L 6 15 Z");l.addPathRaw(h,"lightgrey","none",1,i,"round");h=new Path2D("M 16 22 a 9 9 0 0 0 0 -12");l.addPathRaw(h,"none","#d92b2b",2,i,"butt");h=new Path2D("M 12 13 l 2 -7 l 7 4 Z");l.addPathRaw(h,"#d92b2b","none",2,i,"butt");h=new Path2D("M 12 19 l 2 7 l 7 -4 Z");return l.addPathRaw(h,"#d92b2b","none",2,i,"butt"),l}static greyTile(e,t=!1){if(t){var i=new Tile("greyTile",32,32),a=new Path2D(Helper.makeRoundedPath([0,32,32,0],[0,0,32,32],[6,6,6,6]));i.addPathRaw(a,"black","none",1,0,"butt","none","none",2,0,[],.5)}else{var r=e.createLinearGradient(0,0,32,0);r.addColorStop(0,"grey"),r.addColorStop(.25,"darkgrey"),r.addColorStop(.75,"darkgrey"),r.addColorStop(1,"slategrey");i=new Tile("greyTile",32,32),a=new Path2D(Helper.makeRoundedPath([0,32,32,0],[0,0,32,32],[6,6,6,6]));i.addPathRaw(a,r,"#666",1,0,"butt","none","none")}return i}static scannersCircular(e,t,i,a=0){var r="black",s=new Tile("scannersCircular",32,32),o=10.5;if(t>.1&&t<.9){var n=16,l=16-o*Math.sin((t+.01)*Math.PI),h=16+o*Math.sin((t+.01)*Math.PI),d=16-o*Math.cos((t+.01)*Math.PI),u=16+o*Math.cos((t+.01)*Math.PI),c=e.createLinearGradient(d-n/2,16,d+n/2,16);0===a?(c.addColorStop(0,"rgba(255,255,255,0.0)"),c.addColorStop(.2,"rgba(0,0,255,0.2)"),c.addColorStop(.5,"cyan"),c.addColorStop(.8,"rgba(0,0,255,0.2)"),c.addColorStop(1,"rgba(255,255,255,0.0)")):(c.addColorStop(0,"rgba(255,255,255,0.0)"),c.addColorStop(.2,"rgba(0,0,255,0.2)"),c.addColorStop(.5,"fuchsia"),c.addColorStop(.8,"rgba(0,0,255,0.2)"),c.addColorStop(1,"rgba(255,255,255,0.0)"));var I=new Path2D("M "+(d-n/2)+" "+l+" L "+(u-n/2)+" "+h+" L "+(u+n/2)+" "+h+" L "+(d+n/2)+" "+l+" Z");s.addPathRaw(I,c,"none",1,i,"butt","none","none",2)}o=10;if(t<=.1){var E=16-o*Math.cos(0),f=16-o*Math.cos(.75),S=16-o*Math.sin(0),p=16-o*Math.sin(.75),T=16+o*Math.sin(.75),R=o-9*Math.sqrt(10*t);I=new Path2D("M "+E+" "+S+" a 10 10 0 0 1 "+(f-E)+" "+(p-S)+" a "+R+" "+R+" 0 0 0 "+(E-f)+" "+(S-p)+" Z");s.addPathRaw(I,r,"none",1,i,"butt","none","none",2);I=new Path2D("M "+E+" "+S+" a 10 10 0 0 0 "+(f-E)+" "+(T-S)+" a "+R+" "+R+" 0 0 1 "+(E-f)+" "+(S-T)+" Z");s.addPathRaw(I,r,"none",1,i,"butt","none","none",2)}else if(t>=.9){E=16+o*Math.cos(0),f=16+o*Math.cos(.75),S=16-o*Math.sin(0),p=16-o*Math.sin(.75),T=16+o*Math.sin(.75),R=o-9*Math.sqrt(10*(1-t)),I=new Path2D("M "+E+" "+S+" a 10 10 0 0 0 "+(f-E)+" "+(p-S)+" a "+R+" "+R+" 0 0 1 "+(E-f)+" "+(S-p)+" Z");s.addPathRaw(I,r,"none",1,i,"butt","none","none",2);I=new Path2D("M "+E+" "+S+" a 10 10 0 0 1 "+(f-E)+" "+(T-S)+" a "+R+" "+R+" 0 0 0 "+(E-f)+" "+(S-T)+" Z");s.addPathRaw(I,r,"none",1,i,"butt","none","none",2)}else{E=16-o*Math.cos(Math.PI*(t-.1)),f=16-o*Math.cos(Math.PI*(t-.1)+.75),S=16-o*Math.sin(Math.PI*(t-.1)),p=16-o*Math.sin(Math.PI*(t-.1)+.75),T=16+o*Math.sin(Math.PI*(t-.1));var m=16+o*Math.sin(Math.PI*(t-.1)+.75);R=1,I=new Path2D("M "+E+" "+S+" a 10 10 0 0 1 "+(f-E)+" "+(p-S)+" a "+R+" "+R+" 0 0 0 "+(E-f)+" "+(S-p)+" Z");s.addPathRaw(I,r,"none",1,i,"butt","none","none",2);I=new Path2D("M "+E+" "+T+" a 10 10 0 0 0 "+(f-E)+" "+(m-T)+" a "+R+" "+R+" 0 0 1 "+(E-f)+" "+(T-m)+" Z");s.addPathRaw(I,r,"none",1,i,"butt","none","none",2)}return s}static greyBit(e,t){var i=new Tile("bit",32,32),a=new Path2D("M 16 6 a 10 10 0 0 1 0 20 a 10 10 0 0 1 0 -20 Z");i.addPathRaw(a,"#666","none",2,0,"square","lightslategrey","none",2,0,[],1);a=new Path2D("M 16 7 a 9 9 0 0 1 0 18 a 9 9 0 0 1 0 -18 Z");if(i.addPathRaw(a,"none","#333",2,0,"square","none","none",0,0,[],1),0===t){a=new Path2D("M 12 15 a 4 4 0 0 1 8 0 L 20 17 a 4 4 0 0 1 -8 0 Z");i.addPathRaw(a,"none","Black",2,0,"round","none","#333333",1,0,[],1)}else{a=new Path2D("M 14 13 L 16 11 L 16 20 M 14 20 L 18 20");i.addPathRaw(a,"none","Black",2,0,"butt","none","#333333",1,0,[],1)}return i}static greyQubit(e,t,i){var a=new Tile("qubit",32,32),r=new Path2D("M 16 6 a 10 10 0 0 1 0 20 a 10 10 0 0 1 0 -20 Z");a.addPathRaw(r,"#666","none",2,0,"square","lightslategrey","none",2,0,[],1);r=new Path2D("M 16 7 a 9 9 0 0 1 0 18 a 9 9 0 0 1 0 -18 Z");a.addPathRaw(r,"none","#333",2,0,"square","none","none",0,0,[],1);var s=5*Math.min(1-i,1),o=5*Math.min(i,1);r=new Path2D("M 15 18 L 15 14 L "+(15-s)+" 14 L 15 9 L 17 9 L "+(17+s)+" 14 L 17 14 L 17 18 L "+(17+o)+" 18 L 17 23 L 15 23 L "+(15-o)+" 18 Z");return a.addPathRaw(r,"Black","#333",1,t,"butt","black","none",1),a}}class PathsC{static ctrl(e,t,i){return"ctrlStart"===t?PathsC.ctrlStart(e,i.flash,i.depth,i.closure,i.type,i.hovered):"ctrlPlay"===t?PathsC.ctrlPlay(e,i.flash,i.depth,i.closure,i.type,i.hovered):"ctrlStep"===t?PathsC.ctrlStep(e,i.flash,i.depth,i.closure,i.type,i.hovered):"ctrlBack"===t?PathsC.ctrlBack(e,i.flash,i.depth,i.closure,i.type,i.hovered):"ctrlNorm"===t?PathsC.ctrlNorm(e,i.flash,i.depth,i.closure,i.type,i.hovered):void 0}static ctrlStart(e,t,i,a,r=0,s=!1){var o=new Tile("ctrlStart",32,32);if(s)var n="white";else n="#e6dfd5";if(0===r){var l=flashColor("forestgreen",t),h=e.createRadialGradient(8,8,1,16,16,20);h.addColorStop(0,flashColor("#68e868",t)),h.addColorStop(1,l);var d=16+7*Math.sin(.5),u=16-7*Math.sin(.5),c=16-7*Math.cos(.5);if(2-3*t>=0)var I="darkslategrey";else I="none";var E=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4,4,28,28],[5,5,5,5]));o.addPathRaw(E,h,"none",1,0,"butt","darkslategrey","darkslategrey",3);var f=new Path2D("M 9 28 a 5 5 0 0 1 -5 -5 L 4 9 a 5 5 0 0 1 5 -5 L 23 4 a 5 5 0 0 1 5 5 ");if(i>0?o.addPathRaw(f,"none",l,1,0,"butt","none","darkslategrey",2*i):o.addPathRaw(f,"none",l,1,0,"butt","none","none",2*i),o.addPathRaw(E,"none",l,1,0,"butt","none","none",0),0===i){E=new Path2D("M "+d+" "+c+" A 7 7 0 0 1 16 23 A 7 7 0 0 1 "+u+" "+c+"M 16 13.5 L 16 7.5");o.addPathRaw(E,"none",n,2.5,0,"round","none",I,Math.max(0,2-3*t))}else{var S=2*i*.3,p=2*i*.7;E=new Path2D("M "+(d+S)+" "+(c+p)+" A 7 7 0 0 1 "+(16+S)+" "+(23+p)+" A 7 7 0 0 1 "+(u+S)+" "+(c+p)+" M "+(16+S)+" "+(13.5+p)+" l 0 -6");o.addPathRaw(E,"none",n,2.5,0,"round","none",I,Math.max(0,2-3*t))}}else if(1===r){l=flashColor("crimson",t),h=e.createRadialGradient(8,8,1,16,16,20);h.addColorStop(0,flashColor("#f76363",t)),h.addColorStop(1,l);d=16+7*Math.sin(.5),u=16-7*Math.sin(.5),c=16-7*Math.cos(.5);if(2-3*t>=0)I="darkslategrey";else I="none";E=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4,4,28,28],[5,5,5,5]));o.addPathRaw(E,h,"none",1,0,"butt","darkslategrey","none",3);f=new Path2D("M 9 28 a 5 5 0 0 1 -5 -5 L 4 9 a 5 5 0 0 1 5 -5 L 23 4 a 5 5 0 0 1 5 5");i>0?o.addPathRaw(f,"none",l,1,0,"butt","none","darkslategrey",2*i):o.addPathRaw(f,"none",l,1,0,"butt","none","none",2*i),o.addPathRaw(E,"none",l,1,0,"butt","none","none",0);S=2*i*.3,p=2*i*.7,E=new Path2D(Helper.makeRoundedPath([10+S,22+S,22+S,10+S],[10+p,10+p,22+p,22+p],[3,3,3,3]));o.addPathRaw(E,"none",n,2.5,0,"round","none",I,Math.max(0,2-3*t))}return o}static ctrlDummy(e){var t=new Tile("ctrlDummy",32,32),i=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4,4,28,28],[5,5,5,5]));return t.addPathRaw(i,"black","none",1,0,"butt","none","none",3),t}static ctrlPlay(e,t,i,a,r=0,s=!1){var o=new Tile("ctrlPlay",32,32),n=flashColor("steelblue",t),l=e.createRadialGradient(8,8,1,16,16,20);if(l.addColorStop(0,flashColor("powderblue",t)),l.addColorStop(1,n),s)var h="white";else h="#e6dfd5";Math.sin(.5),Math.sin(.5),Math.cos(.5);if(2-3*t>=0)var d="darkslategrey";else d="none";var u=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4,4,28,28],[5,5,5,5]));o.addPathRaw(u,l,"none",1,0,"butt","darkslategrey","darkslategrey",3);var c=new Path2D("M 9 28 a 5 5 0 0 1 -5 -5 L 4 9 a 5 5 0 0 1 5 -5 L 23 4 a 5 5 0 0 1 5 5");if(i>0?o.addPathRaw(c,"none",n,1,0,"butt","none","darkslategrey",2*i):o.addPathRaw(c,"none",n,1,0,"butt","none","none",0),o.addPathRaw(u,"none",n,1,0,"butt","none","none",0),0===i){if(0===r){u=new Path2D("M 13 10 l 0 12 M 19 10 l 0 12");o.addPathRaw(u,"none",h,3.5,0,"round","none",d,Math.max(0,2-3*t))}else if(1===r){u=new Path2D("M 12 10 l 10 6 l -10 6 l 0 -12");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t))}}else{var I=2*i*.3,E=2*i*.7;if(0===r){u=new Path2D("M "+(13+I)+" "+(10+E)+" l 0 12 M "+(19+I)+" "+(10+E)+" l 0 12");o.addPathRaw(u,"none",h,3.5,0,"round","none",d,Math.max(0,2-3*t))}else if(1===r){u=new Path2D("M "+(12+I)+" "+(10+E)+" l 10 6 l -10 6 l 0 -12");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t))}}if(a>=0){var f=e.createRadialGradient(8,8,1,16,16,20);f.addColorStop(0,"#4e7566"),f.addColorStop(1,"#444");u=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4+30*(1-a),4+30*(1-a),28+30*(1-a),28+30*(1-a)],[5,5,5,5]));o.addPathRaw(u,f,"#0e1c16",2,0,"butt","none","none",3)}return o}static ctrlStep(e,t,i,a,r=0,s=!1){var o=new Tile("ctrlStep",32,32),n=flashColor("steelblue",t),l=e.createRadialGradient(8,8,1,16,16,20);if(l.addColorStop(0,flashColor("powderblue",t)),l.addColorStop(1,n),s)var h="white";else h="#e6dfd5";Math.sin(.5),Math.sin(.5),Math.cos(.5);if(2-3*t>=0)var d="darkslategrey";else d="none";var u=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4,4,28,28],[5,5,5,5]));o.addPathRaw(u,l,"none",1,0,"butt","none","none",3);var c=new Path2D("M 9 28 a 5 5 0 0 1 -5 -5 L 4 9 a 5 5 0 0 1 5 -5 L 23 4 a 5 5 0 0 1 5 5");if(i>0?o.addPathRaw(c,"none",n,1,0,"butt","none","darkslategrey",2*i):o.addPathRaw(c,"none",n,1,0,"butt","none","none",2*i),o.addPathRaw(u,"none",n,1,0,"butt","none","none",0),0===i){if(0===r){u=new Path2D("M 8 11 l 5 5 l -5 5 l 0 -10 M 14 11 l 5 5 l -5 5 l 0 -10 M 20 11 l 5 5 l -5 5 l 0 -10");o.addPathRaw(u,"none",h,2,0,"round","none",d,Math.max(0,2-3*t))}else if(1===r){u=new Path2D("M 15 10 L 22 16 L 15 22 L 15 10 M 11 10 L 11 22");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t))}}else{var I=2*i*.3,E=2*i*.7;if(0===r){u=new Path2D("M "+(8+I)+" "+(11+E)+" l 5 5 l -5 5 l 0 -10 M "+(14+I)+" "+(11+E)+" l 5 5 l -5 5 l 0 -10 M "+(20+I)+" "+(11+E)+" l 5 5 l -5 5 l 0 -10");o.addPathRaw(u,"none",h,2,0,"round","none",d,Math.max(0,2-3*t))}else if(1===r){u=new Path2D("M "+(15+I)+" "+(10+E)+" l 7 6 l -7 6 l 0 -12 M "+(11+I)+" "+(10+E)+" l 0 12")
;o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t))}}if(a>=0){var f=e.createRadialGradient(8,8,1,16,16,20);f.addColorStop(0,"#4e7566"),f.addColorStop(1,"#444");u=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4+30*(1-a),4+30*(1-a),28+30*(1-a),28+30*(1-a)],[5,5,5,5]));o.addPathRaw(u,f,"#0e1c16",2,0,"butt","none","none",3)}return o}static ctrlBack(e,t,i,a,r=0,s=!1){var o=new Tile("ctrlBack",32,32),n=flashColor("steelblue",t),l=e.createRadialGradient(8,8,1,16,16,20);if(l.addColorStop(0,flashColor("powderblue",t)),l.addColorStop(1,n),s)var h="white";else h="#e6dfd5";Math.sin(.5),Math.sin(.5),Math.cos(.5);if(2-3*t>=0)var d="darkslategrey";else d="none";var u=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4,4,28,28],[5,5,5,5]));o.addPathRaw(u,l,"none",1,0,"butt","none","none",3);var c=new Path2D("M 9 28 a 5 5 0 0 1 -5 -5 L 4 9 a 5 5 0 0 1 5 -5 L 23 4 a 5 5 0 0 1 5 5");if(i>0?o.addPathRaw(c,"none",n,1,0,"butt","none","darkslategrey",2*i):o.addPathRaw(c,"none",n,1,0,"butt","none","none",2*i),o.addPathRaw(u,"none",n,1,0,"butt","none","none",0),0===i){if(0===r){u=new Path2D("M 24 11 l -5 5 l 5 5 l 0 -10 M 18 11 l -5 5 l 5 5 l 0 -10 M 12 11 l -5 5 l 5 5 l 0 -10");o.addPathRaw(u,"none",h,2,0,"round","none",d,Math.max(0,2-3*t))}else if(1===r){u=new Path2D("M 17 10 L 10 16 L 17 22 L 17 10 M 21 10 l 0 12");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t))}}else{var I=2*i*.3,E=2*i*.7;if(0===r){u=new Path2D("M "+(24+I)+" "+(11+E)+" l -5 5 l 5 5 l 0 -10 M "+(18+I)+" "+(11+E)+" l -5 5 l 5 5 l 0 -10 M "+(12+I)+" "+(11+E)+" l -5 5 l 5 5 l 0 -10");o.addPathRaw(u,"none",h,2,0,"round","none",d,Math.max(0,2-3*t))}else if(1===r){u=new Path2D("M "+(17+I)+" "+(10+E)+" l -7 6 l 7 6 l 0 -12 M "+(21+I)+" "+(10+E)+" l 0 12");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t))}}if(a>=0){var f=e.createRadialGradient(8,8,1,16,16,20);f.addColorStop(0,"#4e7566"),f.addColorStop(1,"#444");u=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4+30*(1-a),4+30*(1-a),28+30*(1-a),28+30*(1-a)],[5,5,5,5]));o.addPathRaw(u,f,"#0e1c16",2,0,"butt","none","none",3)}return o}static ctrlNorm(e,t,i,a,r=0,s=!1){var o=new Tile("ctrlNorm",32,32),n=flashColor("steelblue",t),l=e.createRadialGradient(8,8,1,16,16,20);if(l.addColorStop(0,flashColor("powderblue",t)),l.addColorStop(1,n),s)var h="white";else h="#e6dfd5";Math.sin(.5),Math.sin(.5),Math.cos(.5);if(2-3*t>=0)var d="darkslategrey";else d="none";var u=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4,4,28,28],[5,5,5,5]));o.addPathRaw(u,l,"none",1,0,"butt","none","none",3);var c=new Path2D("M 9 28 a 5 5 0 0 1 -5 -5 L 4 9 a 5 5 0 0 1 5 -5 L 23 4 a 5 5 0 0 1 5 5");if(i>0?o.addPathRaw(c,"none",n,1,0,"butt","none","darkslategrey",2*i):o.addPathRaw(c,"none",n,1,0,"butt","none","none",2*i),o.addPathRaw(u,"none",n,1,0,"butt","none","none",0),0===i){u=new Path2D("M 16 22 a 6 6 0 0 0 0 -12 a 6 6 0 0 0 -6 6");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t));u=new Path2D("M 10 16 l -2 0 l 2 3 l 2 -3 l -2 0");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t))}else{var I=2*i*.3,E=2*i*.7;u=new Path2D("M "+(16+I)+" "+(22+E)+" a 6 6 0 0 0 0 -12 a 6 6 0 0 0 -6 6");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t));u=new Path2D("M "+(10+I)+" "+(16+E)+" l -2 0 l 2 3 l 2 -3 l -2 0");o.addPathRaw(u,"none",h,2.5,0,"round","none",d,Math.max(0,2-3*t))}if(a>=0){var f=e.createRadialGradient(8,8,1,16,16,20);f.addColorStop(0,"#4e7566"),f.addColorStop(1,"#444");u=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4+30*(1-a),4+30*(1-a),28+30*(1-a),28+30*(1-a)],[5,5,5,5]));o.addPathRaw(u,f,"#0e1c16",2,0,"butt","none","none",3)}return o}static tickerStatic(e,t){var i=new Tile("ticker",16,32),a="#858585",r=e.createLinearGradient(0,16,16,16);r.addColorStop(0,a),r.addColorStop(.5,"rgb(175,175,175)"),r.addColorStop(1,a);var s=new Path2D(Helper.makeRoundedPath([1,15,15,1],[6,6,16,16],[4,4,0,0]));i.addPathRaw(s,r,"black",1,0,"butt");s=new Path2D(Helper.makeRoundedPath([1,15,15,1],[26,26,16,16],[4,4,0,0]));if(i.addPathRaw(s,r,"black",1,0,"butt"),0===t){s=new Path2D("M 4 16 a 4 7 0 0 1 8 0");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 4 16 a 4 7 0 0 0 8 0");i.addPathRaw(s,"none","black",2,0,"butt")}else if(1===t){s=new Path2D("M 8 16 L 8 9 l -3 3");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 8 16 L 8 23 M 5 23 L 11 23");i.addPathRaw(s,"none","black",2,0,"butt")}else if(2===t){s=new Path2D("M 5 13 a 3 4 0 0 1 6 0 L 9.5 16");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 9.5 16 L 6 23 L 12 23");i.addPathRaw(s,"none","black",2,0,"butt")}else if(3===t){s=new Path2D("M 6 16 l 3 -0.5 a 5 4 0 0 0 0 -6.5 l -4 0.5");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 6 16 l 3 0.5 a 5 4 0 0 1 0 6.5 l -4 -0.5");i.addPathRaw(s,"none","black",2,0,"butt")}else if(4===t){s=new Path2D("M 6 16 L 10 10 L 10 16");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 6 16 L 4 19 L 12.5 19 M 10 16 L 10 23.5");i.addPathRaw(s,"none","black",2,0,"butt")}else if(5===t){s=new Path2D("M 11 10 L 6 10 L 5 16 L 7 16");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 5 16 L 8 16 a 6 4 0 0 1 0 6.5 l -4 -1");i.addPathRaw(s,"none","black",2,0,"butt")}else if(6===t){s=new Path2D("M 5 16 a 6 6 0 0 1 5 -6");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 5 19.5 a 3 3 0 0 1 6 0 a 3 3.5 0 0 1 -6 0 L 5 16");i.addPathRaw(s,"none","black",2,0,"butt")}else if(7===t){s=new Path2D("M 4.5 11 L 4.5 10 L 11.5 10 L 9 16");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 9 16 L 5.5 23.5");i.addPathRaw(s,"none","black",2,0,"butt")}else if(8===t){s=new Path2D("M 5 12.5 a 3 3 0 0 0 6 0 a 3 3.5 0 0 0 -6 0");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 5 19.5 a 3 3 0 0 1 6 0 a 3 3.5 0 0 1 -6 0");i.addPathRaw(s,"none","black",2,0,"butt")}else if(9===t){s=new Path2D("M 5 12.5 a 3 3 0 0 0 6 0 a 3 3.5 0 0 0 -6 0 M 11 12.5 L 11 16");i.addPathRaw(s,"none","black",2,0,"butt");s=new Path2D("M 11 16 a 6 6 0 0 1 -5 6");i.addPathRaw(s,"none","black",2,0,"butt")}return i}static tickerDynamic(e,t,i,a=-1){if(0===i)return PathsC.tickerStatic(e,t);var r=new Tile("ticker",16,32),s="#858585",o=e.createLinearGradient(0,16,16,16);o.addColorStop(0,s),o.addColorStop(.5,"rgb(175,175,175)"),o.addColorStop(1,s);var n=new Path2D(Helper.makeRoundedPath([1,15,15,1],[6,6,16,16],[4,4,0,0]));r.addPathRaw(n,o,"black",1,0,"butt");var l=new Path2D(Helper.makeRoundedPath([1,15,15,1],[26,26,16,16],[4,4,0,0]));if(r.addPathRaw(l,o,"black",1,0,"butt"),a<0&&(a=(t+1)%10),0===a)var h=new Path2D("M 4 16 a 4 7 0 0 1 8 0");else if(1===a)h=new Path2D("M 8 16 L 8 9 l -3 3");else if(2===a)h=new Path2D("M 5 13 a 3 4 0 0 1 6 0 L 9.5 16");else if(3===a)h=new Path2D("M 6 16 l 3 -0.5 a 5 4 0 0 0 0 -6.5 l -4 0.5");else if(4===a)h=new Path2D("M 6 16 L 10 10 L 10 16");else if(5===a)h=new Path2D("M 11 10 L 6 10 L 5 16 L 7 16");else if(6===a)h=new Path2D("M 5 16 a 6 6 0 0 1 5 -6");else if(7===a)h=new Path2D("M 4.5 11 L 4.5 10 L 11.5 10 L 9 16");else if(8===a)h=new Path2D("M 5 12.5 a 3 3 0 0 0 6 0 a 3 3.5 0 0 0 -6 0");else if(9===a)h=new Path2D("M 5 12.5 a 3 3 0 0 0 6 0 a 3 3.5 0 0 0 -6 0 M 11 12.5 L 11 16");if(r.addPathRaw(h,"none","black",2,0,"butt"),0===t)var d=new Path2D("M 4 16 a 4 7 0 0 0 8 0");else if(1===t)d=new Path2D("M 8 16 L 8 23 M 5 23 L 11 23");else if(2===t)d=new Path2D("M 9.5 16 L 6 23 L 12 23");else if(3===t)d=new Path2D("M 6 16 l 3 0.5 a 5 4 0 0 1 0 6.5 l -4 -0.5");else if(4===t)d=new Path2D("M 6 16 L 4 19 L 12.5 19 M 10 16 L 10 23.5");else if(5===t)d=new Path2D("M 5 16 L 8 16 a 6 4 0 0 1 0 6.5 l -4 -1");else if(6===t)d=new Path2D("M 5 19.5 a 3 3 0 0 1 6 0 a 3 3.5 0 0 1 -6 0 L 5 16");else if(7===t)d=new Path2D("M 9 16 L 5.5 23.5");else if(8===t)d=new Path2D("M 5 19.5 a 3 3 0 0 1 6 0 a 3 3.5 0 0 1 -6 0");else if(9===t)d=new Path2D("M 11 16 a 6 6 0 0 1 -5 6");if(r.addPathRaw(d,"none","black",2,0,"butt"),i<.5){if(0===t)h=new Path2D("M 4 16 a 4 7 0 0 1 8 0");else if(1===t)h=new Path2D("M 8 16 L 8 9 l -3 3");else if(2===t)h=new Path2D("M 5 13 a 3 4 0 0 1 6 0 L 9.5 16");else if(3===t)h=new Path2D("M 6 16 l 3 -0.5 a 5 4 0 0 0 0 -6.5 l -4 0.5");else if(4===t)h=new Path2D("M 6 16 L 10 10 L 10 16");else if(5===t)h=new Path2D("M 11 10 L 6 10 L 5 16 L 7 16");else if(6===t)h=new Path2D("M 5 16 a 6 6 0 0 1 5 -6");else if(7===t)h=new Path2D("M 4.5 11 L 4.5 10 L 11.5 10 L 9 16");else if(8===t)h=new Path2D("M 5 12.5 a 3 3 0 0 0 6 0 a 3 3.5 0 0 0 -6 0");else if(9===t)h=new Path2D("M 5 12.5 a 3 3 0 0 0 6 0 a 3 3.5 0 0 0 -6 0 M 11 12.5 L 11 16");var u=1/(1-2*i);o=e.createLinearGradient(0,16,16,16);o.addColorStop(0,flashColor(s,2*i)),o.addColorStop(.5,flashColor("#afafaf",2*i)),o.addColorStop(1,flashColor(s,2*i)),r.addPathRaw(n,o,"black",1,0,"butt","none","none",0,{xScale:1,yScale:u,x0:0,y0:.5*(u-1)}),r.addPathRaw(h,"none","black",2,0,"butt","none","none",0,{xScale:1,yScale:u,x0:0,y0:.5*(u-1)})}if(i>.5){if(0===a)d=new Path2D("M 4 16 a 4 7 0 0 0 8 0");else if(1===a)d=new Path2D("M 8 16 L 8 23 M 5 23 L 11 23");else if(2===a)d=new Path2D("M 9.5 16 L 6 23 L 12 23");else if(3===a)d=new Path2D("M 6 16 l 3 0.5 a 5 4 0 0 1 0 6.5 l -4 -0.5");else if(4===a)d=new Path2D("M 6 16 L 4 19 L 12.5 19 M 10 16 L 10 23.5");else if(5===a)d=new Path2D("M 5 16 L 8 16 a 6 4 0 0 1 0 6.5 l -4 -1");else if(6===a)d=new Path2D("M 5 19.5 a 3 3 0 0 1 6 0 a 3 3.5 0 0 1 -6 0 L 5 16");else if(7===a)d=new Path2D("M 9 16 L 5.5 23.5");else if(8===a)d=new Path2D("M 5 19.5 a 3 3 0 0 1 6 0 a 3 3.5 0 0 1 -6 0");else if(9===a)d=new Path2D("M 11 16 a 6 6 0 0 1 -5 6");u=1/(2*i-1),o=e.createLinearGradient(0,16,16,16);o.addColorStop(0,flashColor(s,2*(1-i))),o.addColorStop(.5,flashColor("#afafaf",2*(1-i))),o.addColorStop(1,flashColor(s,2*(1-i))),r.addPathRaw(l,o,"black",1,0,"butt","none","none",0,{xScale:1,yScale:u,x0:0,y0:.5*(u-1)}),r.addPathRaw(d,"none","black",2,0,"butt","none","none",0,{xScale:1,yScale:u,x0:0,y0:.5*(u-1)})}return r}static token(e,t=!1,i=!1,a=!1,r=0,s=0,o=!1){var n=new PathSet("token",32,32);if(!a)return n;if(!i)return o?n:(n.add({text:e,x0:16,y0:16,fill:"black",fontsize:12}),n);if(t)var l=10+6*r,h=s-.5;else l=14,h=0;for(var d="M ",u=0;u<5;u++)d+=16+l*Math.sin(h+2*Math.PI*u/5),d+=" ",d+=16-l*Math.cos(h+2*Math.PI*u/5),d+=" L ",d+=16+.6*l*Math.sin(h+2*Math.PI*(u+.5)/5),d+=" ",d+=16-.6*l*Math.cos(h+2*Math.PI*(u+.5)/5),d+=u<4?" L ":" Z";if(t){var c=CANV.select.ctx.createRadialGradient(16,16,0,16,16,16);c.addColorStop(0,"gold"),c.addColorStop(1,"darkgoldenrod"),n.add({path:new Path2D(d),fill:c})}else n.add({path:new Path2D(d),stroke:"darkgoldenrod",lineWidth:2});return n.add({text:e,x0:16,y0:16,fill:"black",fontsize:12}),n}static tokenBase(e,t=!1,i=!1,a=!1,r=0,s=!1){var o=new PathSet("token",32,32);if(!a)return o;if(!i){if(s)return o;var n=CANV.select.ctx.createRadialGradient(16,16,0,16,16,16);n.addColorStop(0,"#BBB"),n.addColorStop(1,"grey");var l=new Path2D("M 16 32 a 16 16 0 0 1 0 -32 a 16 16 0 0 1 0 32 Z");return o.add({path:l,stroke:"darkgrey",fill:n,lineWidth:2}),o}if(0===r)var h="limegreen",d="green",u="darkgreen";else if(1===r)h="skyblue",d="royalblue",u="#3355bd";else if(2===r)h="tomato",d="firebrick",u="darkred";else if(3===r)h="mediumorchid",d="darkmagenta",u="#750075";else if(4===r)h="Gold",d="#dba00d",u="DarkGoldenRod";n=CANV.select.ctx.createRadialGradient(16,16,0,16,16,16);n.addColorStop(0,h),n.addColorStop(1,d);l=new Path2D("M 16 32 a 16 16 0 0 1 0 -32 a 16 16 0 0 1 0 32 Z");return o.add({path:l,fill:n,shadowFill:d}),o.add({path:l,fill:n,stroke:u,lineWidth:2,shadowFill:d}),o}static ctrlGrey(e){var t=new Tile("ctrlGrey",32,32),i=new Path2D(Helper.makeRoundedPath([4,28,28,4],[4,4,28,28],[5,5,5,5]));return t.addPathRaw(i,"#555","#333",2,0,"butt","none","none",3),t}}class PathsG{static make(e,t,i=!1){var a=t.type,r=0,s=MDATA.GATEID[a]+t.orient,o=Math.floor(s/20),n=s%20,l=new PathSet(String(a),32,32);return i&&(l.isFancy=!0),"sync"===a?(l=PathsG.syncUnder(l,t.undercol,t.orient),r=t.orient%2+3):"switch"===a||"qControl"===a?(l=PathsG.switchUnder(l,t.undercol,t.orient),r=1+("qControl"===a)):"measure"===a&&(r=5),"compare"!==a&&"qCompare"!==a&&"qDubCompare"!==a&&"cOneCompare"!==a&&(l=PathsG.base(l,t.basecol,!t.isControlled,r,t.rot),t.orient>=0&&(l=PathsG.connectors(l,r,TILE_EDGES[o][n],t.cdir))),l=PathsG.symbol(l,t),l}static simpleSwitch(e){var t=new PathSet("switch",32,32);if(e%2==0)var i=new Path2D("M 0 16 L 32 16");else i=new Path2D("M 16 0 L 16 32");if(t.add({path:i,stroke:"MidnightBlue",lineWidth:2,lineCap:"round",shadowStroke:"dodgerblue"}),0===e){i=new Path2D("M 14 16 L 10 32 L 22 32 L 18 16 Z");t.add({path:i,fill:"Darkgoldenrod",lineCap:"butt",shadowFill:"goldenrod"});i=new Path2D("M 14 16 L 11 32 L 21 32 L 18 16 Z");t.add({path:i,fill:"goldenrod",lineCap:"butt"})}else if(1===e){i=new Path2D("M 16 14 L 0 10 L 0 22 L 16 18 Z");t.add({path:i,fill:"Darkgoldenrod",lineCap:"butt",shadowFill:"goldenrod"});i=new Path2D("M 16 14 L 0 11 L 0 21 L 16 18 Z");t.add({path:i,fill:"goldenrod",lineCap:"butt"})}else if(2===e){i=new Path2D("M 14 16 L 10 0 L 22 0 L 18 16 Z");t.add({path:i,fill:"Darkgoldenrod",lineCap:"butt",shadowFill:"goldenrod"});i=new Path2D("M 14 16 L 11 0 L 21 0 L 18 16 Z");t.add({path:i,fill:"goldenrod",lineCap:"butt"})}else if(3===e){i=new Path2D("M 16 14 L 32 10 L 32 22 L 16 18 Z");t.add({path:i,fill:"Darkgoldenrod",lineCap:"butt",shadowFill:"goldenrod"});i=new Path2D("M 16 14 L 32 11 L 32 21 L 16 18 Z");t.add({path:i,fill:"goldenrod",lineCap:"butt"})}i=new Path2D("M 8 16 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");t.add({path:i,fill:GRADS.gates,shadowFill:"dodgerblue"});i=new Path2D("M 12.5 16 a 3.5 3.5 0 0 1 7 0 a 3.5 3.5 0 0 1 -7 0 Z");return t.add({path:i,fill:"CornflowerBlue",shadowFill:"blue"}),t}static simpleControl(e,t){var i=new PathSet("qControl",32,32);if(t%2==0)var a=new Path2D("M 0 16 L 32 16");else a=new Path2D("M 16 0 L 16 32");if(i.add({path:a,stroke:"Darkred",lineWidth:2,lineCap:"round",shadowStroke:"#DD0000"}),0===t){a=new Path2D("M 14 16 L 10 32 L 22 32 L 18 16 Z");i.add({path:a,fill:"Darkgoldenrod",lineCap:"butt",shadowFill:"goldenrod"});a=new Path2D("M 14 16 L 11 32 L 21 32 L 18 16 Z");i.add({path:a,fill:"goldenrod",lineCap:"butt"})}else if(1===t){a=new Path2D("M 16 14 L 0 10 L 0 22 L 16 18 Z");i.add({path:a,fill:"Darkgoldenrod",lineCap:"butt",shadowFill:"goldenrod"});a=new Path2D("M 16 14 L 0 11 L 0 21 L 16 18 Z");i.add({path:a,fill:"goldenrod",lineCap:"butt"})}else if(2===t){a=new Path2D("M 14 16 L 10 0 L 22 0 L 18 16 Z");i.add({path:a,fill:"Darkgoldenrod",lineCap:"butt",shadowFill:"goldenrod"});a=new Path2D("M 14 16 L 11 0 L 21 0 L 18 16 Z");i.add({path:a,fill:"goldenrod",lineCap:"butt"})}else if(3===t){a=new Path2D("M 16 14 L 32 10 L 32 22 L 16 18 Z");i.add({path:a,fill:"Darkgoldenrod",lineCap:"butt",shadowFill:"goldenrod"});a=new Path2D("M 16 14 L 32 11 L 32 21 L 16 18 Z");i.add({path:a,fill:"goldenrod",lineCap:"butt"})}a=new Path2D("M 8 16 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");i.add({path:a,fill:GRADS.gates,shadowFill:"#DD0000"});a=new Path2D("M 15 13 L 11 13 L 15 10 L 17 10 L 21 13 L 17 13 L 17 17 L 17 20 L 17 20 L 15 20 L 15 20 L 15 17 L 15 14");return i.add({path:a,fill:"#d92b2b",rot:e,shadowFill:"#590000"}),i}static switchUnder(e,t,i=0){if(i=Math.round(i),0===i){var a=new Path2D("M 14 16 L 10 32 L 22 32 L 18 16 Z");e.add({path:a,fill:t[0],lineCap:"butt",shadowFill:t[1]});a=new Path2D("M 14 16 L 11 32 L 21 32 L 18 16 Z");e.add({path:a,fill:t[1],lineCap:"butt"})}else if(1===i){a=new Path2D("M 16 14 L 0 10 L 0 22 L 16 18 Z");e.add({path:a,fill:t[0],lineCap:"butt",shadowFill:t[1]});a=new Path2D("M 16 14 L 0 11 L 0 21 L 16 18 Z");e.add({path:a,fill:t[1],lineCap:"butt"})}else if(2===i){a=new Path2D("M 14 16 L 10 0 L 22 0 L 18 16 Z");e.add({path:a,fill:t[0],lineCap:"butt",shadowFill:t[1]});a=new Path2D("M 14 16 L 11 0 L 21 0 L 18 16 Z");e.add({path:a,fill:t[1],lineCap:"butt"})}else if(3===i){a=new Path2D("M 16 14 L 32 10 L 32 22 L 16 18 Z");e.add({path:a,fill:t[0],lineCap:"butt",shadowFill:t[1]});a=new Path2D("M 16 14 L 32 11 L 32 21 L 16 18 Z");e.add({path:a,fill:t[1],lineCap:"butt"})}return e}static syncUnder(e,t,i=0){if(i=Math.round(i),0===i){var a=new Path2D("M 10 32 a 20 20 0 0 1 8 -16 M 22 32 a 20 20 0 0 0 -8 -16");e.add({path:a,stroke:t[0],lineWidth:6,lineCap:"butt",shadowStroke:t[1]});a=new Path2D("M 10 32 a 20 20 0 0 1 8 -16 M 22 32 a 20 20 0 0 0 -8 -16");e.add({path:a,stroke:t[1],lineWidth:2,lineCap:"round"})}else if(1===i){a=new Path2D("M 0 10 a 20 20 0 0 1 16 8 M 0 22 a 20 20 0 0 0 16 -8");e.add({path:a,stroke:t[0],lineWidth:6,lineCap:"butt",shadowStroke:t[1]});a=new Path2D("M 0 10 a 20 20 0 0 1 16 8 M 0 22 a 20 20 0 0 0 16 -8");e.add({path:a,stroke:t[1],lineWidth:2,lineCap:"round"})}else if(2===i){a=new Path2D("M 10 0 a 20 20 0 0 0 8 16 M 22 0 a 20 20 0 0 1 -8 16");e.add({path:a,stroke:t[0],lineWidth:6,lineCap:"butt",shadowStroke:t[1]});a=new Path2D("M 10 0 a 20 20 0 0 0 8 16 M 22 0 a 20 20 0 0 1 -8 16");e.add({path:a,stroke:t[1],lineWidth:2,lineCap:"round"})}else if(3===i){a=new Path2D("M 32 10 a 20 20 0 0 0 -16 8 M 32 22 a 20 20 0 0 1 -16 -8");e.add({path:a,stroke:t[0],lineWidth:6,lineCap:"butt",shadowStroke:t[1]});a=new Path2D("M 32 10 a 20 20 0 0 0 -16 8 M 32 22 a 20 20 0 0 1 -16 -8");e.add({path:a,stroke:t[1],lineWidth:2,lineCap:"round"})}return e}static targetRing(e,t){var i=new Path2D("M 3 20 l 0 -8 a 9 9 0 0 1 9 -9 l 8 0 a 9 9 0 0 1 9 9 l 0 8 a 9 9 0 0 1 -9 9 l -8 0 a 9 9 0 0 1 -9 -9 Z");e.add({path:i,stroke:t[0],lineWidth:6,shadowStroke:t[1]});i=new Path2D("M 2 20 l 0 -8 a 10 10 0 0 1 10 -10 l 8 0 a 10 10 0 0 1 10 10 l 0 8 a 10 10 0 0 1 -10 10 l -8 0 a 10 10 0 0 1 -10 -10 Z");return e.add({path:i,stroke:t[1],lineWidth:2}),e}static base(e,t,i=!0,a=0,r=0){if(i){if(0===a||3===a||4===a||5===a)var s="lightslategrey";else if(1===a)s="dodgerblue";else if(2===a)s="#DD0000"}else s="transparent";if(0===a)var o=new Path2D("M 16 30 a 14 14 0 0 1 0 -28 a 14 14 0 0 1 0 28 Z");else if(a<=2)o=new Path2D("M 8 16 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");else if(3===a)o=new Path2D("M 30 16 a 14 10 0 0 1 -28 0 a 14 10 0 0 1 28 0 Z");else if(4===a)o=new Path2D("M 16 30 a 10 14 0 0 1 0 -28 a 10 14 0 0 1 0 28 Z");else if(5===a){var n=.2,l=16+14*Math.sin(r+n),h=16-14*Math.cos(r+n),d=16+14*Math.sin(Math.PI+r-n),u=16-14*Math.cos(Math.PI+r-n);o=new Path2D("M "+l+" "+h+" a 14 14 0 0 1 "+(d-l)+" "+(u-h)+" Z");e.add({path:o,fill:t,shadowFill:s});l=16+14*Math.sin(r-n),h=16-14*Math.cos(r-n),d=16+14*Math.sin(-Math.PI+r+n),u=16-14*Math.cos(-Math.PI+r+n),o=new Path2D("M "+l+" "+h+" a 14 14 0 0 0 "+(d-l)+" "+(u-h)+" Z")}return e.add({path:o,fill:t,shadowFill:s}),e}static connectors(e,t=0,i=[0,0,0,0],a=-1){if([0,3,4,5].indexOf(t)>=0){if(OPTS.fancyGraphics)var r=["DarkRed","DarkBlue","DarkGreen"];else r=["#DB4325","DarkBlue","#006164"];if(i[0]&&0!==a&&(s=new Path2D("M 2 20 a 1 4 0 0 0 0 -8 a 3 4 0 0 0 0 8 Z"),e.add({path:s,fill:r[i[0]-1]})),i[2]&&2!==a){var s=new Path2D("M 30 20 a 3 4 0 0 0 0 -8 a 1 4 0 0 0 0 8 Z");e.add({path:s,fill:r[i[2]-1]})}if(i[1]&&1!==a){s=new Path2D("M 20 2 a 4 3 0 0 0 -8 0 a 4 1 0 0 0 8 0 Z");e.add({path:s,fill:r[i[1]-1]})}if(i[3]&&3!==a){s=new Path2D("M 20 30 a 4 1 0 0 0 -8 0 a 4 3 0 0 0 8 0 Z");e.add({path:s,fill:r[i[3]-1]})}}return e}static creation(e,t,i,a,r=0){var s=i*Math.PI/2;if(0===r)var o="cornflowerblue",n="blue";else o="#d92b2b",n="#590000";if(Number.isInteger(t)){if(0===t){var l=new Path2D("M 11 16 a 5 5 0 0 1 10 0 a 5 5 0 0 1 -10 0 M 21 16 L 27 16 M 27 16 l -3 -2 l 0 4 L 27 16");e.add({path:l,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n})}else if(1===t){l=new Path2D("M 11 16 a 5 5 0 0 1 10 0 M 16 16 L 13 19 M 16 16 L 19 19");e.add({path:l,stroke:o,lineWidth:2,lineCap:"round",shadowStroke:n});l=new Path2D("M 27 16 l -3 -2 l 0 4 L 27 16");e.add({path:l,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n})}else if(2===t){l=new Path2D("M 13 13 L 19 19 M 19 13 L 13 19 M 11 16 a 5 5 0 0 1 10 0 a 5 5 0 0 1 -10 0 M 21 16 L 27 16 M 27 16 l -3 -2 l 0 4 L 27 16");e.add({path:l,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n})}}else{if(e.isFancy=!0,t<1)var h=(1-t)**2;else if(t>2)h=(2-t)**2;else h=0;l=new Path2D("M 11 16 a 5 5 0 0 1 10 0 a 5 5 0 0 1 -10 0 M 21 16 L 27 16 M 27 16 l -3 -2 l 0 4 L 27 16");if(e.add({path:l,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n,alpha:h}),t<=1)var d=t**2;else if(t<2)d=(2-t)**2;else d=0;l=new Path2D("M 11 16 a 5 5 0 0 1 10 0 M 16 16 L 13 19 M 16 16 L 19 19");e.add({path:l,stroke:o,lineWidth:2,lineCap:"round",shadowStroke:n,alpha:d});l=new Path2D("M 27 16 l -3 -2 l 0 4 L 27 16");if(e.add({path:l,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n,alpha:d}),t<=2&&t>1)var u=(t-1)**2;else if(t>2)u=(3-t)**2;else u=0;l=new Path2D("M 13 13 L 19 19 M 19 13 L 13 19 M 11 16 a 5 5 0 0 1 10 0 a 5 5 0 0 1 -10 0 M 21 16 L 27 16 M 27 16 l -3 -2 l 0 4 L 27 16");e.add({path:l,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n,alpha:u})}if(-2!=a){if(-1===a)var c=String.fromCharCode(8734),I=14;else c=String(a),I=10;1===i?e.add({text:c,x0:16,y0:8,fill:"lightgrey",fontsize:I}):e.add({text:c,x0:16,y0:25,fill:"lightgrey",fontsize:I})}return e}static symbol(e,t){const i="CornflowerBlue",a="Blue",r="#d92b2b",s="#590000",o="lightgrey",n="darkslategrey",l=GRADS.flame;if("qCombine"===t.type){var h=t.rot+t.orient*Math.PI/2;if(0===t.state){var d=new Path2D("M 4 16 L 27 16 M 16 4 a 12 12 0 0 0 10 12 M 16 28 a 12 12 0 0 1 10 -12 M 27 16 L 20 12 L 20 20 L 27 16");e.add({path:d,stroke:r,lineWidth:2,rot:h,lineCap:"square",shadowStroke:s})}else if(1===t.state){d=new Path2D("M 4 16 L 28 16");e.add({path:d,stroke:r,lineWidth:2,rot:h,lineCap:"square",shadowStroke:s});d=new Path2D("M 14 22 L 14 10 L 22 16 Z");e.add({path:d,fill:r,rot:h,shadowFill:s})}else if(2===t.state){if(t.counterMax>0){d=new Path2D("M 4 16 L 28 16");e.add({path:d,stroke:r,lineWidth:2,rot:h,lineCap:"square",shadowStroke:s});d=new Path2D("M 14 22 L 14 10 L 22 16 Z");e.add({path:d,fill:r,rot:h,shadowFill:s})}else{d=new Path2D("M 4 16 L 12 16 M 20 16 L 28 16 M 14 20 L 18 12");e.add({path:d,stroke:r,lineWidth:2,rot:h,lineCap:"square",shadowStroke:s})}e.add({text:String(t.counterMax),x0:16,y0:24,fill:"lightgrey",size:10})}}else if("cCombine"===t.type){h=t.rot+t.orient*Math.PI/2;if(0===t.state){d=new Path2D("M 4 16 L 27 16 M 16 4 a 12 12 0 0 0 10 12 M 16 28 a 12 12 0 0 1 10 -12 M 27 16 L 20 12 L 20 20 L 27 16");e.add({path:d,stroke:i,lineWidth:2,rot:h,lineCap:"square",shadowStroke:a})}else{d=new Path2D("M 4 16 L 28 16");e.add({path:d,stroke:i,lineWidth:2,rot:h,lineCap:"square",shadowStroke:a});d=new Path2D("M 14 22 L 14 10 L 22 16 Z");e.add({path:d,fill:i,rot:h,shadowFill:a})}}else if("cSplit"===t.type){h=t.rot+t.orient*Math.PI/2,d=new Path2D("M 4 16 L 9 16 a 7 8 0 0 1 7 8 l -2.5 0 l 2.5 3 l 2.5 -3 L 16 24 L 16 26 M 4 16 L 9 16 a 7 8 0 0 0 7 -8 l -2.5 0 l 2.5 -3 l 2.5 3 L 16 8 L 16 6 M 4 16 L 24 16 l 0 -2.5 l 3 2.5 l -3 2.5 L 24 16 L 26 16");e.add({path:d,stroke:i,lineWidth:2,rot:h,lineCap:"round",shadowStroke:a})}else if("rotate"===t.type)if(1===t.state){d=new Path2D("M 12 12 a 4 4 0 0 1 8 0 a 4 4 0 0 1 -4 4 l 0 4 M 16 23 L 16 27");e.add({path:d,stroke:r,lineWidth:3,lineCap:"butt",shadowStroke:s})}else if(2===t.state){d=new Path2D("M 12 12 a 4 4 0 0 1 8 0 a 4 4 0 0 1 -4 4 l 0 4 M 16 23 L 16 27");e.add({path:d,stroke:r,lineWidth:3,lineCap:"butt",shadowStroke:s})}else{var u=Helper.boundAngle(t.rot);if(u<0){d=new Path2D("M 16 16 L 16 6 a 10 10 0 0 0 "+10*Math.sin(u)+" "+(10-10*Math.cos(u)));e.add({path:d,stroke:r,lineWidth:3,lineCap:"butt",shadowStroke:s});d=new Path2D("M 10 15 L 10 12 a 10 10 0 0 0 -5 4 a 10 10 0 0 0 5 4 L 10 17 L 27 17 L 27 15 L 10 15 Z");e.add({path:d,fill:o,rot:u+Math.PI/2,shadowFill:"darkslategrey"})}else{d=new Path2D("M 16 16 L 16 6 a 10 10 0 0 1 "+10*Math.sin(u)+" "+(10-10*Math.cos(u)));e.add({path:d,stroke:r,lineWidth:3,lineCap:"butt",shadowStroke:s});d=new Path2D("M 10 15 L 10 12 a 10 10 0 0 0 -5 4 a 10 10 0 0 0 5 4 L 10 17 L 27 17 L 27 15 L 10 15 Z");e.add({path:d,fill:o,rot:u+Math.PI/2,shadowFill:"darkslategrey"})}d=new Path2D("M 12 16 a 4 4 0 0 1 8 0 a 4 4 0 0 1 -8 0");e.add({path:d,fill:r,shadowFill:s})}else if("trash"===t.type){var c=new Path2D,I=(d=new Path2D("M1006 2223 c 64 -145 88 -310 64 -439 -28 -148 -109 -335 -258 -588 -70 -119 -77 -127 -86 -105 -38 93 -151 318 -227 455 -49 89 -99 184 -109 212 -41 108 -36 202 21 371 16 47 27 86 25 88 -7 8 -103 -30 -149 -59 -108 -69 -212 -231 -259 -403 -30 -111 -33 -414 -4 -518 39 -147 103 -269 187 -361 53 -58 107 -102 115 -93 2 2 16 50 29 106 29 119 53 173 66 149 4 -8 18 -69 29 -134 37 -211 111 -562 129 -618 34 -97 105 -182 215 -256 56 -38 66 -32 66 42 0 70 28 271 51 371 28 117 103 264 263 512 227 351 241 387 241 605 -1 130 -3 153 -28 225 -55 163 -191 354 -306 427 -52 33 -87 38 -75 11z"),new DOMMatrix);I.a=.01,I.b=0,I.c=0,I.d=.01,I.e=9,I.f=4,c.addPath(d,I),e.add({path:c,fill:l,shadowFill:n}),1===t.state&&t.counter>=0&&e.add({text:String(t.counter),x0:16,y0:25,fill:"lightgrey",fontsize:10})}else if("switch"===t.type){if(e.isFancy=!0,0===t.rot){d=new Path2D("M 12 15 a 4 4 0 0 1 8 0 L 20 17 a 4 4 0 0 1 -8 0 Z");e.add({path:d,stroke:i,lineWidth:2,lineCap:"square",shadowStroke:a,alpha:(1-t.talpha)**.25})}else if(1===t.rot){d=new Path2D("M 14 13 L 16 11 L 16 20 M 14 20 L 18 20");e.add({path:d,stroke:i,lineWidth:2,lineCap:"butt",shadowStroke:a,alpha:(1-t.talpha)**.25})}d=new Path2D("M 12.5 16 a 3.5 3.5 0 0 1 7 0 a 3.5 3.5 0 0 1 -7 0 Z");e.add({path:d,fill:i,shadowFill:a,alpha:t.talpha})}else if("qControl"===t.type){u=Helper.boundAngle(t.rot),d=new Path2D("M 15 13 L 11 13 L 15 10 L 17 10 L 21 13 L 17 13 L 17 17 L 17 20 L 17 20 L 15 20 L 15 20 L 15 17 L 15 14");e.add({path:d,fill:r,rot:u,shadowFill:s})}else if("measure"===t.type){u=Helper.boundAngle(t.rot),d=new Path2D("M 30 14 a 10 10 0 0 0 -6 -5 L 23 12 L 3 12 L 2 14 Z");e.add({path:d,fill:r,rot:u-Math.PI/2,shadowFill:s});d=new Path2D("M 30 18 a 10 10 0 0 1 -6 5 L 23 20 L 3 20 L 2 18 Z");e.add({path:d,fill:r,rot:u-Math.PI/2,shadowFill:s})}else if("cInvert"===t.type){u=t.rot;if(0===t.state){if(u===Math.round(u)){if(0===t.orient)if(0==u){d=new Path2D("M 5 16 L 10 16 M 24 16 L 27 16 M 10 11 L 19 16 L 10 21 L 10 11 M 20 16 a 2 2 0 0 1 4 0 a 2 2 0 0 1 -4 0");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a})}else{d=new Path2D("M 5 16 L 27 16");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a})}else if(1==t.orient)if(0==u){d=new Path2D("M 16 27 L 16 23 M 16 5 L 16 9 M 10 11 L 19 16 L 10 21 L 10 11 M 20 16 a 2 2 0 0 1 4 0 a 2 2 0 0 1 -4 0");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a})}else{d=new Path2D("M 16 5 L 16 27");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a})}}else if(e.isFancy=!0,0===t.orient){d=new Path2D("M 5 16 L 10 16 M 24 16 L 27 16 M 10 11 L 19 16 L 10 21 L 10 11 M 20 16 a 2 2 0 0 1 4 0 a 2 2 0 0 1 -4 0");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a,alpha:1-u});d=new Path2D("M 5 16 L 27 16");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a,alpha:u})}else if(1==t.orient){d=new Path2D("M 16 27 L 16 23 M 16 5 L 16 9 M 10 11 L 19 16 L 10 21 L 10 11 M 20 16 a 2 2 0 0 1 4 0 a 2 2 0 0 1 -4 0");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a,alpha:1-u});d=new Path2D("M 16 5 L 16 27");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a,alpha:u})}}else if(1===t.state){if(e.isFancy=!0,0===t.orient){d=new Path2D("M 27 16 L 24 16 M 24 14 L 24 18 M 5 16 L 8 16 M 8 14 L 8 18 M 12 15 a 4 4 0 0 1 8 0 L 20 17 a 4 4 0 0 1 -8 0 Z");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a,alpha:1-u});d=new Path2D("M 5 16 L 27 16");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a,alpha:u})}else if(1==t.orient){d=new Path2D("M 16 5 L 16 8 M 14 8 L 18 8 M 16 27 L 16 24 M 14 24 L 18 24 M 12 15 a 4 4 0 0 1 8 0 L 20 17 a 4 4 0 0 1 -8 0 Z");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a,alpha:1-u});d=new Path2D("M 16 5 L 16 27");e.add({path:d,stroke:i,lineWidth:2,lineCap:"round",shadowStroke:a,alpha:u})}}else if(3===t.state){d=new Path2D("M 12 12 a 4 4 0 0 1 8 0 a 4 4 0 0 1 -4 4 l 0 4 M 16 23 L 16 27");e.add({path:d,stroke:i,lineWidth:3,lineCap:"butt",shadowStroke:a})}}else if("sync"===t.type){d=new Path2D("M 10 16 a 6 6 0 0 1 12 0 a 6 6 0 0 1 -12 0");e.add({path:d,stroke:l,lineWidth:2,lineCap:"square",shadowStroke:n})}else if("delay"===t.type){var E=t.rot+t.state;if(E<-.5&&(E+=8),E>7.5&&(E-=8),E>0){d=new Path2D("M 16 10 l 0 -7");e.add({path:d,stroke:o,lineWidth:3,lineCap:"butt"})}if(E>0)if(E<=4){var f=11*Math.sin(E*Math.PI/4),S=11*(1-Math.cos(E*Math.PI/4));d=new Path2D("M 16 5 a 11 11 0 0 1 "+f+" "+S);e.add({path:d,stroke:o,lineWidth:3,lineCap:"butt",shadowStroke:n})}else{f=11*Math.sin(E*Math.PI/4),S=11*(Math.cos((E-4)*Math.PI/4)-1),d=new Path2D("M 16 27 a 11 11 0 0 1 "+f+" "+S);e.add({path:d,stroke:o,lineWidth:3,lineCap:"butt",shadowStroke:n});d=new Path2D("M 16 5 a 11 11 0 0 1 0 22");e.add({path:d,stroke:o,lineWidth:3,lineCap:"butt",shadowStroke:n})}var p=16+6*Math.sin(E*Math.PI/4),T=16-6*Math.cos(E*Math.PI/4),R=16+14*Math.sin(E*Math.PI/4),m=16-14*Math.cos(E*Math.PI/4);d=new Path2D("M "+p+" "+T+"L "+R+" "+m);e.add({path:d,stroke:o,lineWidth:3,lineCap:"butt",shadowStroke:n});d=new Path2D("M 10 16 a 6 6 0 0 1 12 0 a 6 6 0 0 1 -12 0");e.add({path:d,stroke:l,lineWidth:2,lineCap:"square",shadowStroke:n})}else if("upgrade"===t.type){d=new Path2D("M 28 15 L 23 15 a 15 8 0 0 0 -11 -6 L 12 15 L 4 15 L 4 17 L 12 17 L 12 23 a 15 8 0 0 0 11 -6 L 28 17 Z");e.add({path:d,fill:l,rot:t.orient*Math.PI/2,shadowFill:n});d=new Path2D("M 10 15 L 10 12 a 10 10 0 0 0 -5 4 a 10 10 0 0 0 5 4 L 10 17 L 27 17 L 27 15 L 10 15 Z");e.add({path:d,fill:o,rot:t.rot+Math.PI/2,shadowFill:n})}else if("qFlip"===t.type){u=Helper.boundAngle(t.rot);if(t.state===Math.round(t.state)){if(0===t.state){d=new Path2D("M 10 15 L 10 12 a 10 10 0 0 0 -5 4 a 10 10 0 0 0 5 4 L 10 17 L 27 17 L 27 15 L 10 15 Z");e.add({path:d,fill:o,rot:u+Math.PI/2,shadowFill:n});d=new Path2D("M 16 22 l -2 -1 l 1 4 l 4 -2 L 16 22 L 16 23 a 9 9 0 0 0 0 -14 l 0 1 l -2 1 l 1 -4 l 4 2 L 16 10");e.add({path:d,stroke:r,lineWidth:2,rot:u+Math.PI/2,lineCap:"butt",shadowStroke:s})}else if(1===t.orient){d=new Path2D("M 16 5 L 16 27");e.add({path:d,stroke:r,lineWidth:2,lineCap:"round",shadowStroke:s})}else if(0===t.orient){d=new Path2D("M 5 16 L 27 16");e.add({path:d,stroke:r,lineWidth:2,lineCap:"round",shadowStroke:s})}}else{e.isFancy=!0;d=new Path2D("M 10 15 L 10 12 a 10 10 0 0 0 -5 4 a 10 10 0 0 0 5 4 L 10 17 L 27 17 L 27 15 L 10 15 Z");e.add({path:d,fill:o,rot:u+Math.PI/2,shadowFill:n,alpha:1-t.state});d=new Path2D("M 16 22 l -2 -1 l 1 4 l 4 -2 L 16 22 L 16 23 a 9 9 0 0 0 0 -14 l 0 1 l -2 1 l 1 -4 l 4 2 L 16 10");if(e.add({path:d,stroke:r,lineWidth:2,rot:u+Math.PI/2,lineCap:"butt",shadowStroke:s,alpha:1-t.state}),1===t.orient){d=new Path2D("M 16 5 L 16 27");e.add({path:d,stroke:r,lineWidth:2,lineCap:"round",shadowStroke:s,alpha:t.state})}else if(0===t.orient){d=new Path2D("M 5 16 L 27 16");e.add({path:d,stroke:r,lineWidth:2,lineCap:"round",shadowStroke:s,alpha:t.state})}}}else if("cCreate"===t.type)e=PathsG.creation(e,t.rot,t.orient,t.remaining,0);else if("qCreate"===t.type)e=PathsG.creation(e,t.rot,t.orient,t.remaining,1);else if("compare"===t.type){if(t.state<5)var g="Wheat",A="SandyBrown";else g="SandyBrown",A="Sienna";if(t.ctx){var C=t.ctx.createLinearGradient(-32,16,64,0);C.addColorStop(0,g),C.addColorStop(Math.max(TIMER.glareRatio-.1,0),g),C.addColorStop(TIMER.glareRatio,A),C.addColorStop(Math.min(TIMER.glareRatio+.1,1),g),C.addColorStop(1,g)}else C=g;d=new Path2D("M 16 6 a 10 10 0 0 1 0 20 a 10 10 0 0 1 0 -20 Z");e.add({path:d,fill:C,shadowFill:"lightslategrey"});d=new Path2D("M 16 7 a 9 9 0 0 1 0 18 a 9 9 0 0 1 0 -18 Z");e.add({path:d,stroke:A,lineWidth:2,lineCap:"square"});d=new Path2D("M 10 16 l -10 -4 l 0 8 Z");e.add({path:d,fill:"MidnightBlue",rot:t.orient*Math.PI/2,shadowFill:"lightslategrey"});d=new Path2D("M 16 10 l -4 -10 l 8 0 Z");e.add({path:d,fill:"MidnightBlue",rot:t.orient*Math.PI/2,shadowFill:"lightslategrey"})
}else if("qCompare"===t.type){if(t.state<5){g="lightgreen",A="MediumSeaGreen";var L="DarkOrchid",D="purple"}else if(t.state>=5)g=flashColor("MediumSeaGreen",TIMER.trigRatioDub),A=flashColor("darkgreen",TIMER.trigRatioDub),L=flashColor("Indigo",TIMER.trigRatioDub),D=flashColor("purple",TIMER.trigRatioDub);if(t.ctx){C=t.ctx.createLinearGradient(-32,16,64,0);C.addColorStop(0,g),C.addColorStop(Math.max(TIMER.glareRatio-.1,0),g),C.addColorStop(TIMER.glareRatio,A),C.addColorStop(Math.min(TIMER.glareRatio+.1,1),g),C.addColorStop(1,g)}else C=g;d=new Path2D("M 16 6 a 10 10 0 0 1 0 20 a 10 10 0 0 1 0 -20 Z");e.add({path:d,fill:C,shadowFill:"lightslategrey"});d=new Path2D("M 16 7 a 9 9 0 0 1 0 18 a 9 9 0 0 1 0 -18 Z");e.add({path:d,stroke:A,lineWidth:2,lineCap:"square"});d="M 16 5 L 13 0 L 19 0 Z M 5 16 L 0 13 L 0 19 Z M 27 16 L 32 13 L 32 19 Z";if(e.add({path:new Path2D(d),rot:-t.orient*Math.PI/2,stroke:"DarkRed",lineWidth:3}),t.state>0){d=new Path2D("M 15 23 L 15 14 L 11 14 L 15 9 L 17 9 L 21 14 L 17 14 L 17 23 Z");e.add({path:d,fill:L,rot:t.rot,shadowFill:D,shadowOffset:1}),e.isFancy=!0}}else if("qDubCompare"===t.type){if(t.state<5)g="lightgreen",A="MediumSeaGreen";else if(t.state>=5)g=flashColor("MediumSeaGreen",TIMER.trigRatioDub),A=flashColor("darkgreen",TIMER.trigRatioDub);if(t.ctx){C=t.ctx.createLinearGradient(-32,16,64,0);C.addColorStop(0,g),C.addColorStop(Math.max(TIMER.glareRatio-.1,0),g),C.addColorStop(TIMER.glareRatio,A),C.addColorStop(Math.min(TIMER.glareRatio+.1,1),g),C.addColorStop(1,g)}else C=g;d=new Path2D("M 16 6 a 10 10 0 0 1 0 20 a 10 10 0 0 1 0 -20 Z");e.add({path:d,fill:C,shadowFill:"lightslategrey"});d=new Path2D("M 16 7 a 9 9 0 0 1 0 18 a 9 9 0 0 1 0 -18 Z");e.add({path:d,stroke:A,lineWidth:2,lineCap:"square"});d="M 6 16 L 0 13 L 0 19 Z";e.add({path:new Path2D(d),stroke:"DarkRed",lineWidth:3,rot:t.rot*Math.PI/2})}else if("cOneCompare"===t.type){g="Wheat",A="SandyBrown";if(t.ctx){C=t.ctx.createLinearGradient(-32,16,64,0);C.addColorStop(0,g),C.addColorStop(Math.max(TIMER.glareRatio-.1,0),g),C.addColorStop(TIMER.glareRatio,A),C.addColorStop(Math.min(TIMER.glareRatio+.1,1),g),C.addColorStop(1,g)}else C=g;d=new Path2D("M 16 6 a 10 10 0 0 1 0 20 a 10 10 0 0 1 0 -20 Z");e.add({path:d,fill:C,shadowFill:"lightslategrey"});d=new Path2D("M 16 7 a 9 9 0 0 1 0 18 a 9 9 0 0 1 0 -18 Z");e.add({path:d,stroke:A,lineWidth:2,lineCap:"square"});d=new Path2D("M 16 10 l -4 -10 l 8 0 Z");if(e.add({path:d,fill:"MidnightBlue",rot:3*Math.PI/2,shadowFill:"lightslategrey"}),t.counterMax>0){var b=Math.round(t.counter/t.counterMax*100);e.add({text:String(b),x0:16,y0:16,fill:"black",fontsize:12})}}return e}}class PathsI{static icon(e,t,i){return"plusIcon"===t?PathsI.plusIcon(e,i):"minusIcon"===t?PathsI.minusIcon(e,i):"switchIcon"===t?PathsI.switchIcon(e,i):"lockIcon"===t?PathsI.lockIcon(e,i):"tagIcon"===t?PathsI.tagIcon(e,i):"zeroIcon"===t?PathsI.zeroIcon(e,i):"oneIcon"===t?PathsI.oneIcon(e,i):"leftRightIcon"===t?PathsI.leftRightIcon(e,i):"questionIcon"===t?PathsI.questionIcon(e,i):void 0}static eraserIcon(e){var t=new Tile("eraserIcon",16,16),i=new Path2D("M 5 13 L 3 11 a 1.5 1.5 0 0 1 0 -2 L 9 3 a 1.5 1.5 0 0 1 2 0 L 13 5 a 1.5 1.5 0 0 1 0 2 L 7 13 Z");t.addPathRaw(i,"antiquewhite","#111",1,0,"round");i=new Path2D("M 4 8 L 9 3 a 1.5 1.5 0 0 1 2 0 L 13 5 a 1.5 1.5 0 0 1 0 2 L 8 12 Z");t.addPathRaw(i,"pink","#111",1,0,"round");i=new Path2D("M 2 13 L 14 13");return t.addPathRaw(i,"none","#111",1,0,"round"),t}static escIcon(e,t=!1){var i=new Tile("escIcon",16,16),a=new Path2D("M 1 14 L 9 14 a 4 4 0 0 0 0 -10 L 1 4 L 6 1 L 6 7 L 1 4"),r="#111";return t&&(r="#555"),i.addPathRaw(a,"none",r,4,0,"round"),i}static musicIcon(e,t=!0,i=!1){var a=new Tile("musicIcon",16,16),r="#111";i&&(r="#555");var s=new Path2D("M 4 15 L 4 6 L 14 1 L 14 10");a.addPathRaw(s,"none",r,4,0,"round");s=new Path2D("M 12.5 10 L 12.5 10 M 2.5 15 L 2.5 15");if(a.addPathRaw(s,"none",r,8,0,"round"),!t){s=new Path2D("M 4 0 L 12 16");a.addPathRaw(s,"none","darkred",2.5,0,"round")}return a}static sfxIcon(e,t=!0,i=!1){var a=new Tile("sfxIcon",16,16),r="#111";i&&(r="#555");var s=new Path2D("M 1 4 L 1 12 L 5 12 L 5 4 Z");a.addPathRaw(s,r,"none",4,0,"round");s=new Path2D("M 7 4 L 7 12 L 15 16 L 15 0 Z");if(a.addPathRaw(s,r,"none",4,0,"round"),!t){s=new Path2D("M 4 0 L 12 16");a.addPathRaw(s,"none","darkred",2.5,0,"round")}return a}static questionIcon(e,t){var i=t.hover;if(i)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("questionIcon",16,16),o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 5 6 a 3 3 0 0 1 6 0 a 3 3 0 0 1 -3 3 l 0 4");return s.addPathRaw(o,"none","black",2.5,0,"round"),s}static leftRightIcon(e,t){var i=t.hover;if(i)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("leftRightIcon",16,16);if(0===t.type){var o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 4 8 L 11 4 L 11 12 Z");s.addPathRaw(o,"black","none",2.5,0,"round")}else if(1===t.type){o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 12 8 L 5 4 L 5 12 Z");s.addPathRaw(o,"black","none",2.5,0,"round")}else if(2===t.type){o=new Path2D("M 3 3 L 13 13 M 3 13 L 13 3");var n="black";if(i)n="grey";s.addPathRaw(o,"none",n,2.5,0,"round")}return s}static oneIcon(e,t){var i=t.hover;if(i)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("oneIcon",16,16),o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 8 4 L 8 12");return s.addPathRaw(o,"none","black",2.5,0,"round"),s}static zeroIcon(e,t){var i=t.hover;if(i)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("zeroIcon",16,16),o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 5 6.5 a 3 3 0 0 1 6 0 L 11 9.5 a 3 3 0 0 1 -6 0 Z");return s.addPathRaw(o,"none","black",2,0,"round"),s}static switchIcon(e,t){var i=t.hover;if(i)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("switchIcon",16,16),o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 6 3 L 6 12 l -2 -2 M 10 13 L 10 4 l 2 2");return s.addPathRaw(o,"none","black",2,0,"round"),s}static tagIcon(e,t){var i=e.createRadialGradient(8,8,0,8,8,16);i.addColorStop(0,"bisque"),i.addColorStop(1,"darkgoldenrod");var a=new Tile("tagIcon",16,16),r=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");a.addPathRaw(r,i,"black",1,0,"round");var s=30,o="normal";return a.addText(String(t.counter),{x:17,y:17},"black",s,"Verdana",o),a}static lockIcon(e,t){var i=t.hover;if(i)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("lockIcon",16,16);if(t.state){var o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 12 8 L 12 13 L 4 13 L 4 8 Z");s.addPathRaw(o,"black","none",2,0,"round");o=new Path2D("M 5 8 a 3 3 0 0 1 6 0");s.addPathRaw(o,"none","black",2,0,"round")}else{o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 12 8 L 12 13 L 4 13 L 4 8 Z");s.addPathRaw(o,"black","none",2,0,"round");o=new Path2D("M 11 8 a 3 3 0 0 0 -6 -3");s.addPathRaw(o,"none","black",2,0,"round")}return s}static highlightIcon(e,t,i){if(t)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("highlightIcon",16,16),o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");if(s.addPathRaw(o,r,"black",1,0,"round"),0===i);else if(1===i){o=new Path2D("M 4 7 a 4 4 0 0 1 8 0 L 12 9 a 4 4 0 0 1 -8 0 Z");s.addPathRaw(o,"none","black",2,0,"butt")}else if(2===i){o=new Path2D("M 6 5 L 8 3 L 8 13 M 6 13 L 10 13");s.addPathRaw(o,"none","black",2,0,"butt")}return s}static plusIcon(e,t){var i=t.hover;if(i)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("plusIcon",16,16),o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 4 8 L 12 8 M 8 4 L 8 12");return s.addPathRaw(o,"none","black",2,0,"round"),s}static minusIcon(e,t){var i=t.hover;if(i)var a="bisque";else a="goldenrod";var r=e.createRadialGradient(8,8,0,8,8,16);r.addColorStop(0,a),r.addColorStop(1,"darkgoldenrod");var s=new Tile("plusIcon",16,16),o=new Path2D("M 0 8 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");s.addPathRaw(o,r,"black",1,0,"round");o=new Path2D("M 4 8 L 12 8");return s.addPathRaw(o,"none","black",2,0,"round"),s}}class PathsX{static boardArrow(e,t,i,a,r=1){var s=[];if(a>0&&a<1){if(a=Math.max(0,a),a=Math.min(1,a),1===t){var o=e.createLinearGradient(-32,-32,64,64);o.addColorStop(0,"Darkred"),o.addColorStop(Math.max(a-.2,0),"Darkred"),o.addColorStop(a,"tomato"),o.addColorStop(Math.min(a+.2,1),"Darkred"),o.addColorStop(1,"Darkred")}else if(2===t){o=e.createLinearGradient(-32,-32,64,64);o.addColorStop(0,"MidnightBlue"),o.addColorStop(Math.max(a-.2,0),"MidnightBlue"),o.addColorStop(a,"RoyalBlue"),o.addColorStop(Math.min(a+.2,1),"MidnightBlue"),o.addColorStop(1,"MidnightBlue")}}else if(1===t)o="Darkred";else if(2===t)o="MidnightBlue";if(0===i);else if(1===i){var n="M 16 0 L 13 6 L 19 6 Z";s.push({path:new Path2D(n),stroke:o,lineWidth:3})}else if(2===i){n="M 32 16 L 26 13 L 26 19 Z";s.push({path:new Path2D(n),stroke:o,lineWidth:3})}return s}static gear(e,t,i,a){for(var r=10,s=16,o=2*Math.PI/i,n=.1,l=.1,h="M ",d=0;d<i;d++)h+=16+r*Math.sin(t+d*o-l)+" ",h+=16-r*Math.cos(t+d*o-l)+" L ",h+=16+s*Math.sin(t+d*o+n)+" ",h+=16-s*Math.cos(t+d*o+n)+" L ",h+=16+s*Math.sin(t+(d+.5)*o-n)+" ",h+=16-s*Math.cos(t+(d+.5)*o-n)+" L ",h+=16+r*Math.sin(t+(d+.5)*o+l)+" ",h+=16-r*Math.cos(t+(d+.5)*o+l),h+=d<i-1?" ":" Z";var u=[];u.push({path:new Path2D(h),fill:a,stroke:"#111",strokeWidth:1,lineCap:"round"});for(h="",d=0;d<i;d++)h+=" M "+(16+6*Math.sin(t+(d+.25)*o))+" ",h+=16-6*Math.cos(t+(d+.25)*o)+" L ",h+=16+10*Math.sin(t+(d+.25)*o)+" ",h+=16-10*Math.cos(t+(d+.25)*o);u.push({path:new Path2D(h),stroke:"#111",strokeWidth:1,lineCap:"round"});h=new Path2D("M 16 22 a 6 6 0 0 1 0 -12 a 6 6 0 0 1 0 12 Z");u.push({path:new Path2D(h),stroke:"#111",strokeWidth:1,lineCap:"round"}),u.push({path:new Path2D(h),stroke:"#777",strokeWidth:.5,lineCap:"round"});h=new Path2D("M 16 19 a 3 3 0 0 1 0 -6 a 3 3 0 0 1 0 6 Z");return u.push({path:new Path2D(h),fill:"#777",stroke:"#111",strokeWidth:.5,lineCap:"round"}),u}static qWire(e,t,i){if(i>0&&i<1){i=Math.max(0,i),i=Math.min(1,i);var a=e.createLinearGradient(-32,-32,64,64);a.addColorStop(0,"Darkred"),a.addColorStop(Math.max(i-.2,0),"Darkred"),a.addColorStop(i,"tomato"),a.addColorStop(Math.min(i+.2,1),"Darkred"),a.addColorStop(1,"Darkred");var r=e.createLinearGradient(-32,-32,64,64);r.addColorStop(0,"MidnightBlue"),r.addColorStop(Math.max(i-.2,0),"MidnightBlue"),r.addColorStop(i,"RoyalBlue"),r.addColorStop(Math.min(i+.2,1),"MidnightBlue"),r.addColorStop(1,"MidnightBlue")}else a="Darkred",r="MidnightBlue";var s=[];return 12===t?(s.push({path:new Path2D(WIREPATHS.q[t][0]),stroke:a,strokeWidth:2,shadowStroke:"#DD0000"}),s.push({path:new Path2D(WIREPATHS.q[t][1]),stroke:r,strokeWidth:2,shadowStroke:"dodgerblue"})):13===t?(s.push({path:new Path2D(WIREPATHS.q[t][0]),stroke:r,strokeWidth:2,shadowStroke:"dodgerblue"}),s.push({path:new Path2D(WIREPATHS.q[t][1]),stroke:a,strokeWidth:2,shadowStroke:"#DD0000"})):s.push({path:new Path2D(WIREPATHS.q[t]),stroke:a,strokeWidth:2,shadowStroke:"#DD0000"}),s}static cWire(e,t,i){if(i>0&&i<1){i=Math.max(0,i),i=Math.min(1,i);var a=e.createLinearGradient(-32,-32,64,64);a.addColorStop(0,"Darkred"),a.addColorStop(Math.max(i-.2,0),"Darkred"),a.addColorStop(i,"tomato"),a.addColorStop(Math.min(i+.2,1),"Darkred"),a.addColorStop(1,"Darkred");var r=e.createLinearGradient(-32,-32,64,64);r.addColorStop(0,"MidnightBlue"),r.addColorStop(Math.max(i-.2,0),"MidnightBlue"),r.addColorStop(i,"RoyalBlue"),r.addColorStop(Math.min(i+.2,1),"MidnightBlue"),r.addColorStop(1,"MidnightBlue")}else a="Darkred",r="MidnightBlue";var s=[];return 12===t?(s.push({path:new Path2D(WIREPATHS.c[t][0]),stroke:r,strokeWidth:2,shadowStroke:"dodgerblue"}),s.push({path:new Path2D(WIREPATHS.c[t][1]),stroke:a,strokeWidth:2,shadowStroke:"#DD0000"})):13===t?(s.push({path:new Path2D(WIREPATHS.c[t][0]),stroke:a,strokeWidth:2,shadowStroke:"#DD0000"}),s.push({path:new Path2D(WIREPATHS.c[t][1]),stroke:r,strokeWidth:2,shadowStroke:"dodgerblue"})):s.push({path:new Path2D(WIREPATHS.c[t]),stroke:r,strokeWidth:2,shadowStroke:"dodgerblue"}),s}static mWire(e,t,i){if(i>0&&i<1){i=Math.max(0,i),i=Math.min(1,i);var a=e.createLinearGradient(-32,-32,64,64);a.addColorStop(0,"Darkred"),a.addColorStop(Math.max(i-.2,0),"Darkred"),a.addColorStop(i,"tomato"),a.addColorStop(Math.min(i+.2,1),"Darkred"),a.addColorStop(1,"Darkred");var r=e.createLinearGradient(-32,-32,64,64);r.addColorStop(0,"MidnightBlue"),r.addColorStop(Math.max(i-.2,0),"MidnightBlue"),r.addColorStop(i,"RoyalBlue"),r.addColorStop(Math.min(i+.2,1),"MidnightBlue"),r.addColorStop(1,"MidnightBlue")}else a="Darkred",r="MidnightBlue";var s=[];if(16===t&&s.push({path:new Path2D("M 8 16 L 24 16 L 21 13 M 24 16 L 21 19"),stroke:"black",strokeWidth:15,shadowStroke:"lightslategrey"}),t<=7){if(t>3){var o=r,n=a,l="dodgerblue",h="#DD0000";t-=4}else o=a,n=r,l="#DD0000",h="dodgerblue";0===t?(s.push({path:new Path2D("M 0 16 L 11 16 a 1 1 0 0 0 10 0 L 32 16"),stroke:o,strokeWidth:2,shadowStroke:l}),s.push({path:new Path2D("M 16 12 l 2 2 l -2 2 l -2 -2 l 2 -2 M 16 16 L 16 0"),stroke:n,strokeWidth:2,shadowStroke:h})):1===t?(s.push({path:new Path2D("M 16 0 L 16 11 a 1 1 0 0 0 0 10 L 16 32"),stroke:o,strokeWidth:2,shadowStroke:l}),s.push({path:new Path2D("M 20 16 l -2 2 l -2 -2 l 2 -2 l 2 2 M 16 16 L 32 16"),stroke:n,strokeWidth:2,shadowStroke:h})):2===t?(s.push({path:new Path2D("M 0 16 L 11 16 a 1 1 0 0 1 10 0 L 32 16"),stroke:o,strokeWidth:2,shadowStroke:l}),s.push({path:new Path2D("M 16 20 l -2 -2 l 2 -2 l 2 2 l -2 2 M 16 16 L 16 32"),stroke:n,strokeWidth:2,shadowStroke:h})):3===t&&(s.push({path:new Path2D("M 16 0 L 16 11 a 1 1 0 0 1 0 10 L 16 32"),stroke:o,strokeWidth:2,shadowStroke:l}),s.push({path:new Path2D("M 12 16 L 14 14 L 16 16 L 14 18 L 12 16 M 14 16 L 0 16"),stroke:n,strokeWidth:2,shadowStroke:h}))}else{if(t>11){o=r,n=a,h="#DD0000",l="dodgerblue";t-=4}else o=a,n=r,l="#DD0000",h="dodgerblue";8===t?(s.push({path:new Path2D("M 10 16 l 2 -2 l 2 2 l -2 2 l -2 -2 M 12 16 L 0 16"),stroke:o,strokeWidth:2,shadowStroke:l}),s.push({path:new Path2D("M 16 10 l 2 2 l -2 2 l -2 -2 l 2 -2 M 16 12 L 16 0"),stroke:n,strokeWidth:2,shadowStroke:h})):9===t?(s.push({path:new Path2D("M 16 10 l 2 2 l -2 2 l -2 -2 l 2 -2 M 16 12 L 16 0"),stroke:o,strokeWidth:2,shadowStroke:l}),s.push({path:new Path2D("M 22 16 l -2 2 l -2 -2 l 2 -2 l 2 2 M 20 16 L 32 16"),stroke:n,strokeWidth:2,shadowStroke:h})):10===t?(s.push({path:new Path2D("M 22 16 l -2 2 l -2 -2 l 2 -2 l 2 2 M 20 16 L 32 16"),stroke:o,strokeWidth:2,shadowStroke:l}),s.push({path:new Path2D("M 16 22 l -2 -2 l 2 -2 l 2 2 l -2 2 M 16 20 L 16 32"),stroke:n,strokeWidth:2,shadowStroke:h})):11===t&&(s.push({path:new Path2D("M 16 22 l -2 -2 l 2 -2 l 2 2 l -2 2 M 16 20 L 16 32"),stroke:o,strokeWidth:2,shadowStroke:l}),s.push({path:new Path2D("M 10 16 l 2 -2 l 2 2 l -2 2 l -2 -2 M 12 16 L 0 16"),stroke:n,strokeWidth:2,shadowStroke:h}))}return s}static base(e,t,i=!0,a=0,r=0){if(i){if(0===a||3===a||4===a)var s="lightslategrey";else if(1===a)s="dodgerblue";else if(2===a)s="#DD0000"}else s="none";if(0===a)var o=new Path2D("M 16 30 a 14 14 0 0 1 0 -28 a 14 14 0 0 1 0 28 Z");else if(a<=2)o=new Path2D("M 8 16 a 8 8 0 0 1 16 0 a 8 8 0 0 1 -16 0");else if(3===a)o=new Path2D("M 30 16 a 14 10 0 0 1 -28 0 a 14 10 0 0 1 28 0 Z");else if(4===a)o=new Path2D("M 16 30 a 10 14 0 0 1 0 -28 a 10 14 0 0 1 0 28 Z");else if(5===a){var n=.2,l=16+14*Math.sin(r+n),h=16-14*Math.cos(r+n),d=16+14*Math.sin(Math.PI+r-n),u=16-14*Math.cos(Math.PI+r-n);o=new Path2D("M "+l+" "+h+" a 14 14 0 0 1 "+(d-l)+" "+(u-h)+" Z");e.push({path:o,fill:t,shadowFill:s});l=16+14*Math.sin(r-n),h=16-14*Math.cos(r-n),d=16+14*Math.sin(-Math.PI+r+n),u=16-14*Math.cos(-Math.PI+r+n),o=new Path2D("M "+l+" "+h+" a 14 14 0 0 0 "+(d-l)+" "+(u-h)+" Z")}return e.push({path:o,fill:t,shadowFill:s}),e}static connectors(e,t=0,i=[0,0,0,0]){if([0,3,4,5].indexOf(t)>=0){var a=["DarkRed","DarkBlue","DarkGreen"];if(i[0]&&(r=new Path2D("M 2 20 a 1 4 0 0 0 0 -8 a 3 4 0 0 0 0 8 Z"),e.push({path:r,fill:a[i[0]-1]})),i[2]){var r=new Path2D("M 30 20 a 3 4 0 0 0 0 -8 a 1 4 0 0 0 0 8 Z");e.push({path:r,fill:a[i[2]-1]})}if(i[1]){r=new Path2D("M 20 2 a 4 3 0 0 0 -8 0 a 4 1 0 0 0 8 0 Z");e.push({path:r,fill:a[i[1]-1]})}if(i[3]){r=new Path2D("M 20 30 a 4 1 0 0 0 -8 0 a 4 3 0 0 0 8 0 Z");e.push({path:r,fill:a[i[3]-1]})}}return e}static targetRing(e,t){var i=new Path2D("M 3 20 l 0 -8 a 9 9 0 0 1 9 -9 l 8 0 a 9 9 0 0 1 9 9 l 0 8 a 9 9 0 0 1 -9 9 l -8 0 a 9 9 0 0 1 -9 -9 Z");e.push({path:i,stroke:t[0],lineWidth:6,shadowStroke:t[1]});i=new Path2D("M 2 20 l 0 -8 a 10 10 0 0 1 10 -10 l 8 0 a 10 10 0 0 1 10 10 l 0 8 a 10 10 0 0 1 -10 10 l -8 0 a 10 10 0 0 1 -10 -10 Z");return e.push({path:i,stroke:t[1],lineWidth:2}),e}static targetBase(e,t,i=0){if(i=Math.round(i),0===i){var a=new Path2D("M 14 16 L 10 32 L 22 32 L 18 16 Z");e.push({path:a,fill:t[0],lineCap:"butt",shadowFill:t[1]});a=new Path2D("M 14 16 L 11 32 L 21 32 L 18 16 Z");e.push({path:a,fill:t[1],lineCap:"butt"})}else if(1===i){a=new Path2D("M 16 14 L 0 10 L 0 22 L 16 18 Z");e.push({path:a,fill:t[0],lineCap:"butt",shadowFill:t[1]});a=new Path2D("M 16 14 L 0 11 L 0 21 L 16 18 Z");e.push({path:a,fill:t[1],lineCap:"butt"})}else if(2===i){a=new Path2D("M 14 16 L 10 0 L 22 0 L 18 16 Z");e.push({path:a,fill:t[0],lineCap:"butt",shadowFill:t[1]});a=new Path2D("M 14 16 L 11 0 L 21 0 L 18 16 Z");e.push({path:a,fill:t[1],lineCap:"butt"})}else if(3===i){a=new Path2D("M 16 14 L 32 10 L 32 22 L 16 18 Z");e.push({path:a,fill:t[0],lineCap:"butt",shadowFill:t[1]});a=new Path2D("M 16 14 L 32 11 L 32 21 L 16 18 Z");e.push({path:a,fill:t[1],lineCap:"butt"})}return e}static sync(e,t,i=0){if(i=Math.round(i),0===i){var a=new Path2D("M 10 32 a 20 20 0 0 1 8 -16 M 22 32 a 20 20 0 0 0 -8 -16");e.push({path:a,stroke:t[0],lineWidth:6,lineCap:"butt",shadowStroke:t[1]});a=new Path2D("M 10 32 a 20 20 0 0 1 8 -16 M 22 32 a 20 20 0 0 0 -8 -16");e.push({path:a,stroke:t[1],lineWidth:2,lineCap:"round"})}else if(1===i){a=new Path2D("M 0 10 a 20 20 0 0 1 16 8 M 0 22 a 20 20 0 0 0 16 -8");e.push({path:a,stroke:t[0],lineWidth:6,lineCap:"butt",shadowStroke:t[1]});a=new Path2D("M 0 10 a 20 20 0 0 1 16 8 M 0 22 a 20 20 0 0 0 16 -8");e.push({path:a,stroke:t[1],lineWidth:2,lineCap:"round"})}else if(2===i){a=new Path2D("M 10 0 a 20 20 0 0 0 8 16 M 22 0 a 20 20 0 0 1 -8 16");e.push({path:a,stroke:t[0],lineWidth:6,lineCap:"butt",shadowStroke:t[1]});a=new Path2D("M 10 0 a 20 20 0 0 0 8 16 M 22 0 a 20 20 0 0 1 -8 16");e.push({path:a,stroke:t[1],lineWidth:2,lineCap:"round"})}else if(3===i){a=new Path2D("M 32 10 a 20 20 0 0 0 -16 8 M 32 22 a 20 20 0 0 1 -16 -8");e.push({path:a,stroke:t[0],lineWidth:6,lineCap:"butt",shadowStroke:t[1]});a=new Path2D("M 32 10 a 20 20 0 0 0 -16 8 M 32 22 a 20 20 0 0 1 -16 -8");e.push({path:a,stroke:t[1],lineWidth:2,lineCap:"round"})}return e}static snappersSync(e,t,i,a,r=0,s=0,o=1){r+=FIELD.tileWidth/2,s+=FIELD.tileWidth/2;var n=FIELD.tileWidth/32;if(e.strokeStyle="teal",e.lineCap="round",e.lineJoin="round",e.lineWidth=4*o*FIELD.tileWidth/32,e.shadowBlur=0,e.shadowOffsetX=2*n*.3,e.shadowOffsetY=2*n*.7,e.shadowColor="darkslategrey",i%2==0)var l=(i+1)*Math.PI/2+Math.PI/4*t+Math.PI/4-.15,h=(i+1)*Math.PI/2+Math.PI/4*t+Math.PI/4+.15,d=2*n*Math.sin(a*Math.PI/2),u=2*n*Math.sin(a*Math.PI/2);else d=-2*n*Math.sin(a*Math.PI/2),u=2*n*Math.sin(a*Math.PI/2),l=(i+1)*Math.PI/2+Math.PI/4*t+Math.PI/4-.15,h=(i+1)*Math.PI/2+Math.PI/4*t+Math.PI/4+.15;var c=9*n*Math.sin(l)+d,I=-9*n*Math.cos(l)+u,E=9*n*Math.sin(h)+d,f=-9*n*Math.cos(h)+u,S=(9+2*o)*n*Math.sin(h+.05)+d,p=-(9+2*o)*n*Math.cos(h+.05)+u,T=(9+2*o)*n*Math.sin(l-.05)+d,R=-(9+2*o)*n*Math.cos(l-.05)+u;e.beginPath(),e.moveTo(r+c,s+I),e.lineTo(r+E,s+f),e.lineTo(r+S,s+p),e.lineTo(r+T,s+R),e.lineTo(r+c,s+I),e.moveTo(r-c,s+I),e.lineTo(r-E,s+f),e.lineTo(r-S,s+p),e.lineTo(r-T,s+R),e.lineTo(r-c,s+I),e.moveTo(r+c,s-I),e.lineTo(r+E,s-f),e.lineTo(r+S,s-p),e.lineTo(r+T,s-R),e.lineTo(r+c,s-I),e.moveTo(r-c,s-I),e.lineTo(r-E,s-f),e.lineTo(r-S,s-p),e.lineTo(r-T,s-R),e.lineTo(r-c,s-I),e.closePath(),e.stroke()}static flare(e,t,i,a=0,r=0,s){var o=2*(i-.5),n=o**.25;a+=FIELD.tileWidth/2,r+=FIELD.tileWidth/2;var l=FIELD.tileWidth/32;if(e.lineCap="round",e.lineJoin="round",e.shadowColor="transparent",s)var h=FLARES.colors0;else h=FLARES.colors1;for(var d=h.length,u=t%10*10,c=0;c<FLARES.amount;c++)if(o<FLARES.lifetimes[c+u]){e.strokeStyle=h[(c+u)%d],e.lineWidth=5*l*FLARES.dotsizes[c+u],e.globalAlpha=1-o/FLARES.lifetimes[c+u];var I=FLARES.start[c+u]+n*FLARES.travel[c+u],E=16*l*FLARES.x0[c+u]*I+a,f=16*l*FLARES.y0[c+u]*I+r;e.beginPath(),e.moveTo(E,f),e.lineTo(E+.1,f+.1),e.stroke()}e.globalAlpha=1}static snappersDelay(e,t,i,a,r=0,s=0,o=1){r+=FIELD.tileWidth/2,s+=FIELD.tileWidth/2;var n=FIELD.tileWidth/64;e.strokeStyle="teal",e.lineCap="round",e.lineJoin="round",e.lineWidth=8*o*FIELD.tileWidth/64,e.fillStyle="teal",e.shadowBlur=0,e.shadowOffsetX=4*n*.3,e.shadowOffsetY=4*n*.7,e.shadowColor="darkslategrey";if(i>0)var l=Math.PI/4*t;else l=Math.PI/4*(3*t);e.beginPath();for(var h=0;h<4;h++){var d=4*Math.sin(a*Math.PI/2),u=4*Math.sin(a*Math.PI/2);h>1&&(d*=-1),1!=h&&2!=h||(u*=-1);var c=Math.PI/4-.15+l+h*Math.PI/2,I=Math.PI/4+.15+l+h*Math.PI/2,E=20*Math.sin(c)+d,f=20*Math.cos(c)+u,S=20*Math.sin(I)+d,p=20*Math.cos(I)+u,T=(20+4*o)*Math.sin(I+.05)+d,R=(20+4*o)*Math.cos(I+.05)+u,m=(20+4*o)*Math.sin(c-.05)+d,g=(20+4*o)*Math.cos(c-.05)+u;e.moveTo(r+n*E,s+n*f),e.lineTo(r+n*S,s+n*p),e.lineTo(r+n*T,s+n*R),e.lineTo(r+n*m,s+n*g),e.lineTo(r+n*E,s+n*f)}e.stroke()}static snappersSwitch(e,t,i=0,a=0,r=0,s=1,o=-1){if(0!==s){o<0&&(o=r),i+=FIELD.tileWidth/2,a+=FIELD.tileWidth/2;var n=FIELD.tileWidth/64;if(e.strokeStyle="teal",e.lineCap="butt",e.lineJoin="round",e.shadowBlur=0,e.shadowOffsetX=4*n*.3,e.shadowOffsetY=4*n*.7,e.shadowColor="darkslategrey",0===t)var l=i+FIELD.tileWidth,h=a;else if(1===t)l=i,h=a+FIELD.tileHeight;else if(2===t)l=i-FIELD.tileWidth,h=a;else if(3===t)l=i,h=a-FIELD.tileHeight;e.lineWidth=4*FIELD.tileWidth/48,e.beginPath(),e.arc(i,a,24*n,r*(-Math.PI/2-.4)-Math.PI+t*Math.PI/2,r*(Math.PI/2+.4)-Math.PI+t*Math.PI/2),e.stroke(),e.lineWidth=6*s*FIELD.tileWidth/48;var d=14+4*s;e.beginPath();var u=-Math.PI/2-.2-t*Math.PI/2,c=-Math.PI/2+.2-t*Math.PI/2,I=8*Math.sin(-Math.PI/2-t*Math.PI/2),E=8*Math.cos(-Math.PI/2-t*Math.PI/2);e.moveTo(i+n*(14*Math.sin(u)+I),a+n*(14*Math.cos(u)+E)),e.lineTo(i+n*(14*Math.sin(c)+I),a+n*(14*Math.cos(c)+E)),e.lineTo(i+n*(d*Math.sin(c+.1)+I),a+n*(d*Math.cos(c+.1)+E)),e.lineTo(i+n*(d*Math.sin(u-.1)+I),a+n*(d*Math.cos(u-.1)+E)),e.lineTo(i+n*(14*Math.sin(u)+I),a+n*(14*Math.cos(u)+E)),e.lineTo(i+n*(14*Math.sin(c)+I),a+n*(14*Math.cos(c)+E)),e.stroke();var f=1e-5;if(!(o>1-f)){d=14+4*s*(1-o);e.lineWidth=6*(1-o)*s*FIELD.tileWidth/48,e.beginPath();u=0*Math.PI/4-.2-t*Math.PI/2,c=0*Math.PI/4+.2-t*Math.PI/2,I=15*Math.sin(-t*Math.PI/2),E=15*Math.cos(-t*Math.PI/2);e.moveTo(l+n*(14*Math.sin(u)+I),h+n*(14*Math.cos(u)+E)),e.lineTo(l+n*(14*Math.sin(c)+I),h+n*(14*Math.cos(c)+E)),e.lineTo(l+n*(d*Math.sin(c+.1)+I),h+n*(d*Math.cos(c+.1)+E)),e.lineTo(l+n*(d*Math.sin(u-.1)+I),h+n*(d*Math.cos(u-.1)+E)),e.lineTo(l+n*(14*Math.sin(u)+I),h+n*(14*Math.cos(u)+E)),e.lineTo(l+n*(14*Math.sin(c)+I),h+n*(14*Math.cos(c)+E)),e.stroke(),e.beginPath();u=Math.PI/2-.2-t*Math.PI/2,c=Math.PI/2+.2-t*Math.PI/2,I=15*Math.sin(Math.PI/2-t*Math.PI/2),E=15*Math.cos(Math.PI/2-t*Math.PI/2);e.moveTo(l+n*(14*Math.sin(u)+I),h+n*(14*Math.cos(u)+E)),e.lineTo(l+n*(14*Math.sin(c)+I),h+n*(14*Math.cos(c)+E)),e.lineTo(l+n*(d*Math.sin(c+.1)+I),h+n*(d*Math.cos(c+.1)+E)),e.lineTo(l+n*(d*Math.sin(u-.1)+I),h+n*(d*Math.cos(u-.1)+E)),e.lineTo(l+n*(14*Math.sin(u)+I),h+n*(14*Math.cos(u)+E)),e.lineTo(l+n*(14*Math.sin(c)+I),h+n*(14*Math.cos(c)+E)),e.stroke(),e.beginPath();u=Math.PI-.2-t*Math.PI/2,c=Math.PI+.2-t*Math.PI/2,I=15*Math.sin(Math.PI-t*Math.PI/2),E=15*Math.cos(Math.PI-t*Math.PI/2);e.moveTo(l+n*(14*Math.sin(u)+I),h+n*(14*Math.cos(u)+E)),e.lineTo(l+n*(14*Math.sin(c)+I),h+n*(14*Math.cos(c)+E)),e.lineTo(l+n*(d*Math.sin(c+.1)+I),h+n*(d*Math.cos(c+.1)+E)),e.lineTo(l+n*(d*Math.sin(u-.1)+I),h+n*(d*Math.cos(u-.1)+E)),e.lineTo(l+n*(14*Math.sin(u)+I),h+n*(14*Math.cos(u)+E)),e.lineTo(l+n*(14*Math.sin(c)+I),h+n*(14*Math.cos(c)+E)),e.stroke()}}}static snappersTarget(e,t,i=0,a=0,r=0,s=1){i+=FIELD.tileWidth/2,a+=FIELD.tileWidth/2;var o=FIELD.tileWidth/64;if(e.strokeStyle="teal",e.lineCap="butt",e.lineJoin="round",e.shadowBlur=0,e.shadowOffsetX=4*o*.3,e.shadowOffsetY=4*o*.7,e.shadowColor="darkslategrey",0===t)var n=i-FIELD.tileWidth,l=a;else if(1===t)n=i,l=a-FIELD.tileHeight;else if(2===t)n=i+FIELD.tileWidth,l=a;else if(3===t)n=i,l=a+FIELD.tileHeight;e.lineWidth=6*s*FIELD.tileWidth/64,e.beginPath(),e.arc(n,l,24*o,(1-r)*(-Math.PI/2-.4)-Math.PI+t*Math.PI/2,(1-r)*(Math.PI/2+.4)-Math.PI+t*Math.PI/2),e.stroke(),e.beginPath(),e.arc(i,a,30*o,r*(-Math.PI/4-.45)-Math.PI/4+t*Math.PI/2,r*(Math.PI/4)-Math.PI/4+t*Math.PI/2),e.stroke(),e.beginPath(),e.arc(i,a,30*o,r*(-Math.PI/4)+Math.PI/4+t*Math.PI/2,r*(Math.PI/4+.45)+Math.PI/4+t*Math.PI/2),e.stroke(),e.lineWidth=8*s*FIELD.tileWidth/64,e.beginPath();var h=-Math.PI/2-.2-t*Math.PI/2,d=-Math.PI/2+.2-t*Math.PI/2,u=6*Math.sin(-Math.PI/2-t*Math.PI/2),c=6*Math.cos(-Math.PI/2-t*Math.PI/2);e.moveTo(n+o*(14*Math.sin(h)+u),l+o*(14*Math.cos(h)+c)),e.lineTo(n+o*(14*Math.sin(d)+u),l+o*(14*Math.cos(d)+c)),e.lineTo(n+o*(20*Math.sin(d+.1)+u),l+o*(20*Math.cos(d+.1)+c)),e.lineTo(n+o*(20*Math.sin(h-.1)+u),l+o*(20*Math.cos(h-.1)+c)),e.lineTo(n+o*(14*Math.sin(h)+u),l+o*(14*Math.cos(h)+c)),e.lineTo(n+o*(14*Math.sin(d)+u),l+o*(14*Math.cos(d)+c)),e.stroke(),e.beginPath();h=Math.PI/4-.2-t*Math.PI/2,d=Math.PI/4+.2-t*Math.PI/2,u=15*Math.sin(Math.PI/4-t*Math.PI/2),c=15*Math.cos(Math.PI/4-t*Math.PI/2);e.moveTo(i+o*(14*Math.sin(h)+u),a+o*(14*Math.cos(h)+c)),e.lineTo(i+o*(14*Math.sin(d)+u),a+o*(14*Math.cos(d)+c)),e.lineTo(i+o*(20*Math.sin(d+.1)+u),a+o*(20*Math.cos(d+.1)+c)),e.lineTo(i+o*(20*Math.sin(h-.1)+u),a+o*(20*Math.cos(h-.1)+c)),e.lineTo(i+o*(14*Math.sin(h)+u),a+o*(14*Math.cos(h)+c)),e.lineTo(i+o*(14*Math.sin(d)+u),a+o*(14*Math.cos(d)+c)),e.stroke(),e.beginPath();h=3*Math.PI/4-.2-t*Math.PI/2,d=3*Math.PI/4+.2-t*Math.PI/2,u=15*Math.sin(3*Math.PI/4-t*Math.PI/2),c=15*Math.cos(3*Math.PI/4-t*Math.PI/2);e.moveTo(i+o*(14*Math.sin(h)+u),a+o*(14*Math.cos(h)+c)),e.lineTo(i+o*(14*Math.sin(d)+u),a+o*(14*Math.cos(d)+c)),e.lineTo(i+o*(20*Math.sin(d+.1)+u),a+o*(20*Math.cos(d+.1)+c)),e.lineTo(i+o*(20*Math.sin(h-.1)+u),a+o*(20*Math.cos(h-.1)+c)),e.lineTo(i+o*(14*Math.sin(h)+u),a+o*(14*Math.cos(h)+c)),e.lineTo(i+o*(14*Math.sin(d)+u),a+o*(14*Math.cos(d)+c)),e.stroke()}static creationGate(e,t,i,a,r=0){var s=i*Math.PI/2;if(0===r)var o="cornflowerblue",n="blue";else o="#d92b2b",n="#590000";if(t<1)var l=(1-t)**2;else if(t>2)l=(2-t)**2;else l=0;var h=new Path2D("M 11 16 a 5 5 0 0 1 10 0 a 5 5 0 0 1 -10 0 M 21 16 L 27 16 M 27 16 l -3 -2 l 0 4 L 27 16");if(e.push({path:h,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n,alpha:l}),t<=1)var d=t**2;else if(t<2)d=(2-t)**2;else d=0;h=new Path2D("M 11 16 a 5 5 0 0 1 10 0 M 16 16 L 13 19 M 16 16 L 19 19");e.push({path:h,stroke:o,lineWidth:2,lineCap:"round",shadowStroke:n,alpha:d});h=new Path2D("M 27 16 l -3 -2 l 0 4 L 27 16");if(e.push({path:h,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n,alpha:d}),t<=2&&t>1)var u=(t-1)**2;else if(t>2)u=(3-t)**2;else u=0;h=new Path2D("M 13 13 L 19 19 M 19 13 L 13 19 M 11 16 a 5 5 0 0 1 10 0 a 5 5 0 0 1 -10 0 M 21 16 L 27 16 M 27 16 l -3 -2 l 0 4 L 27 16");if(e.push({path:h,stroke:o,lineWidth:2,rot:s,lineCap:"round",shadowStroke:n,alpha:u}),-2!=a){if(-1===a)var c=String.fromCharCode(8734),I=16;else c=String(a),I=9;1===i?e.push({text:c,x0:16,y0:8,fill:"lightgrey",size:I}):e.push({text:c,x0:16,y0:26,fill:"lightgrey",size:I})}return e}}class Placement{static check(){MENU.selected>=0&&"placing"===STATE.state&&"boardtile"===STATE.under.type&&"constructing"===STATE.mode&&(STATE.validPlacement=Placement.checkValidity(MENU.buttons[MENU.selected].tile.name,STATE.under.i0,STATE.under.j0,STATE.under.i0+STATE.under.j0*IBOARD.width))}static draw(){var e=CANV.base.ctx,t="cwiring"===STATE.state||"qwiring"===STATE.state;if(t&&"boardtile"===STATE.under.type){var i=!1,a=STATE.under.i0,r=STATE.under.j0,s=a+r*FIELD.cols;1===SCENARIO.editable[s]&&(i=!0);var o=IBOARD.findPos(a,r);Paths.place(e,i).draw(e,o.x0,o.y0,FIELD.tileWidth,FIELD.tileHeight)}else{var n="erasing"===STATE.state||"destroying"===STATE.state;if(n&&"boardtile"===STATE.under.type){i=!1,a=STATE.under.i0,r=STATE.under.j0,s=a+r*FIELD.cols;1===SCENARIO.editable[s]&&(i=!0);o=IBOARD.findPos(a,r);Paths.eraser(e,i).draw(e,o.x0,o.y0,FIELD.tileWidth,FIELD.tileHeight)}else if(MENU.selected>=0&&"placing"===STATE.state&&"boardtile"===STATE.under.type){var l=IBOARD.findPos(STATE.under.i0,STATE.under.j0);if("constructing"===STATE.mode){var h=.5,d=MENU.buttons[MENU.selected];if(Paths.place(e,STATE.validPlacementLoc).draw(e,l.x0,l.y0,FIELD.tileWidth,FIELD.tileHeight),["sync","switch","qControl"].indexOf(d.tile.name)>=0){a=STATE.under.i0,r=STATE.under.j0;var u=MENU.selProperties.orient;if(0===u?r+=1:1===u?a-=1:2===u?r-=1:3===u&&(a+=1),a>0&&a<FIELD.cols&&r>0&&r<FIELD.rows){o=IBOARD.findPos(a,r);Paths.place(e,STATE.validPlacementAdj).draw(e,o.x0,o.y0,FIELD.tileWidth,FIELD.tileHeight)}}var c=JSON.parse(JSON.stringify(MENU.selProperties));if(["cCombine","qCombine","cSplit","cCreate","qCreate","switch","compare","sync","qControl","upgrade"].indexOf(d.tile.name)>=0?c.orient=(MENU.selProperties.orient+STATE.extraOrient)%4:["cInvert","cCompare","delay","measure","qFlip","rotate","qCompare"].indexOf(d.tile.name)>=0&&(c.orient=(MENU.selProperties.orient+STATE.extraOrient)%2),"cWire"===d.tile.name){var I=new PathSet("cWire",32,32);I.add({path:new Path2D("M 14 16 L 16 14 L 18 16 L 16 18 Z"),stroke:"MidnightBlue",lineWidth:2,lineCap:"round",shadowStroke:"dodgerblue"}),I.isFancy=!0,I.draw(e,l.x0,l.y0,FIELD.tileWidth,FIELD.tileHeight,h)}else if("qWire"===d.tile.name){I=new PathSet("qWire",32,32);I.add({path:new Path2D("M 14 16 L 16 14 L 18 16 L 16 18 Z"),stroke:"Darkred",lineWidth:2,lineCap:"round",shadowStroke:"#DD0000"}),I.isFancy=!0,I.draw(e,l.x0,l.y0,FIELD.tileWidth,FIELD.tileHeight,h)}else if("switch"===d.tile.name){I=PathsG.simpleSwitch(c.orient);I.draw(e,l.x0,l.y0,FIELD.tileWidth,FIELD.tileHeight,h)}else if("qControl"===d.tile.name){I=PathsG.simpleControl(c.rot,c.orient);I.draw(e,l.x0,l.y0,FIELD.tileWidth,FIELD.tileHeight,h)}else{I=PathsG.make(CANV.ctxMB,c);I.isFancy=!0,I.draw(e,l.x0,l.y0,FIELD.tileWidth,FIELD.tileHeight,h)}if("switch"===d.tile.name||"qControl"===d.tile.name){var E=l.x0,f=l.y0;0===c.orient?f+=FIELD.tileHeight:1===c.orient?E-=FIELD.tileWidth:2===c.orient?f-=FIELD.tileHeight:3===c.orient&&(E+=FIELD.tileWidth);var S=!0;if((E>=FIELD.cols*FIELD.tileHeight||E<=0)&&(S=!1),(f>=FIELD.rows*FIELD.tileWidth||f<=0)&&(S=!1),S){var p=PathsG.targetRing(new PathSet("",32,32),["DarkGoldenRod","GoldenRod"]);p.isFancy=!0,p.draw(e,E,f,FIELD.tileWidth,FIELD.tileHeight,h)}}else if("sync"===d.tile.name){
E=l.x0,f=l.y0;0===c.orient?f+=FIELD.tileHeight:1===c.orient?E-=FIELD.tileWidth:2===c.orient?f-=FIELD.tileHeight:3===c.orient&&(E+=FIELD.tileWidth);var T=(c.orient+2)%4;c.orient=T;S=!0;if((E>=FIELD.cols*FIELD.tileHeight||E<=0)&&(S=!1),(f>=FIELD.rows*FIELD.tileWidth||f<=0)&&(S=!1),S){I=PathsG.make(CANV.ctxM,c);I.isFancy=!0,I.draw(e,E,f,FIELD.tileWidth,FIELD.tileHeight,h)}}}}}}static checkValidity(e,t,i,a){if(STATE.extraOrient=0,STATE.validPlacementLoc=!1,STATE.validPlacementAdj=!0,SCENARIO.editable[a]<1||2===SCENARIO.editable[a])return STATE.tooltip="Invalid placement",!1;if("qWire"===e){var r=IBOARD.getGate(t,i,IBOARD.getState(t,i));return r?["qControl","qFlip","rotate","qCombine","measure","upgrade","sync","delay","trash","qCreate"].indexOf(r.type)>=0?(STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0):(STATE.tooltip="Invalid placement",!1):(STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0)}if("cWire"===e){r=IBOARD.getGate(t,i,IBOARD.getState(t,i));return r?["cCombine","cSplit","cCreate","switch","sync","upgrade","cInvert","delay","measure","trash"].indexOf(r.type)>=0?(STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0):(STATE.tooltip="Invalid placement",!1):(STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0)}if(["measure","qFlip","rotate","delay","qCreate"].indexOf(e)>=0){var s=STATE.under.i0,o=STATE.under.j0,n=IBOARD.getTile(s-1,o),l=IBOARD.getTile(s+1,o),h=IBOARD.getTile(s,o-1),d=IBOARD.getTile(s,o+1),u=70===n||72===n,c=70===l||72===l,I=71===h||73===h,E=71===d||73===d;(u||c)&&(I||E)||(u||c?"qCreate"===e?u&&c||(u?STATE.extraOrient=(6-MENU.selProperties.orient%4)%4:c&&(STATE.extraOrient=(4-MENU.selProperties.orient%4)%4)):MENU.selProperties.orient%2!=0&&(STATE.extraOrient=1):(I||E)&&("qCreate"===e?I&&E||(I?STATE.extraOrient=(7-MENU.selProperties.orient%4)%4:E&&(STATE.extraOrient=(5-MENU.selProperties.orient%4)%4)):MENU.selProperties.orient%2!=1&&(STATE.extraOrient=1)))}if(["measure","cInvert","delay","cCreate"].indexOf(e)>=0){s=STATE.under.i0,o=STATE.under.j0,n=IBOARD.getTile(s-1,o),l=IBOARD.getTile(s+1,o),h=IBOARD.getTile(s,o-1),d=IBOARD.getTile(s,o+1),u=40===n||42===n,c=40===l||42===l,I=41===h||43===h,E=41===d||43===d;(u||c)&&(I||E)||(u||c?"measure"===e?MENU.selProperties.orient%2!=1&&(STATE.extraOrient=1):"cCreate"===e?u&&c||(u?STATE.extraOrient=(6-MENU.selProperties.orient%4)%4:c&&(STATE.extraOrient=(4-MENU.selProperties.orient%4)%4)):MENU.selProperties.orient%2!=0&&(STATE.extraOrient=1):(I||E)&&("measure"===e?MENU.selProperties.orient%2!=0&&(STATE.extraOrient=1):"cCreate"===e?I&&E||(I?STATE.extraOrient=(7-MENU.selProperties.orient%4)%4:E&&(STATE.extraOrient=(5-MENU.selProperties.orient%4)%4)):MENU.selProperties.orient%2!=1&&(STATE.extraOrient=1)))}var f=IBOARD.checkWhichControl(t,i);if("switch"===f.type){if(["cCombine","upgrade","cInvert","measure","qFlip","rotate","qCombine"].indexOf(e)>=0){if(["upgrade","cInvert","measure","qFlip","rotate"].indexOf(e)>=0)if(f.dir%2==0){if(MENU.selProperties.orient%2==0)return STATE.extraOrient=1,STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0}else if(f.dir%2!=0&&MENU.selProperties.orient%2!=0)return STATE.extraOrient=1,STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0;return STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0}return STATE.tooltip="Incompatible control/target",!1}if("qControl"===f.type){if(["qFlip","rotate"].indexOf(e)>=0){if(f.dir%2==0){if(MENU.selProperties.orient%2==0)return STATE.extraOrient=1,STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0}else if(f.dir%2!=0&&MENU.selProperties.orient%2!=0)return STATE.extraOrient=1,STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0;return STATE.tooltip="Valid placement",STATE.validPlacementLoc=!0,!0}return STATE.tooltip="Incompatible control/target",!1}if(["switch","sync","qControl"].indexOf(e)>=0){STATE.validPlacementLoc=!0;s=t,o=i;var S=MENU.selProperties.orient;0===S?o+=1:1===S?s-=1:2===S?o-=1:3===S&&(s+=1);var p=s+o*IBOARD.width,T=IBOARD.checkWhichControl(s,o);if(SCENARIO.editable[p]<1)return STATE.tooltip="sync"===e?"Invalid placement":"Invalid target placement",STATE.validPlacementAdj=!1,!1;if("switch"===e){if(T.dir>=0&&T.dir!==(S+1)%4)return STATE.tooltip="Tile is already controlled",STATE.validPlacementAdj=!1,!1;var R=IBOARD.getGate(s,o,0);return R?["cCombine","qCombine"].indexOf(R.type)>=0?(STATE.tooltip="Valid placement",!0):["upgrade","cInvert","measure","qFlip","rotate"].indexOf(R.type)>=0&&S%2==R.orient%2?(STATE.tooltip="Valid placement",!0):(STATE.tooltip="Incompatible control/target",STATE.validPlacementAdj=!1,!1):(STATE.tooltip="Valid placement",!0)}if("qControl"===e){if(T.dir>=0&&T.dir!==(S+1)%4)return STATE.tooltip="Tile is already controlled",STATE.validPlacementAdj=!1,!1;R=IBOARD.getGate(s,o,0);return R?["qFlip","rotate"].indexOf(R.type)>=0&&S%2==R.orient%2?(STATE.tooltip="Valid placement",!0):(STATE.tooltip="Incompatible control/target",STATE.validPlacementAdj=!1,!1):(STATE.tooltip="Valid placement",!0)}return"sync"===e&&T.dir>=0&&T.dir!==(S+1)%4?(STATE.tooltip="Incompatible control/target",STATE.validPlacementAdj=!1,!1):(STATE.tooltip="Valid placement",!0)}return STATE.validPlacementLoc=!0,STATE.tooltip="Valid placement",!0}}class PopWindow{static init(){POPWINDOW.isOpen=!1,POPWINDOW.isHover=!1,POPWINDOW.movableWindow=document.getElementById("popmovableWindow"),POPWINDOW.windowHeader=POPWINDOW.movableWindow.querySelector(".popwindow-header"),POPWINDOW.isDragging=!1,POPWINDOW.offsetX=0,POPWINDOW.offsetY=0,POPWINDOW.closeButton=document.getElementById("closeWindowBtn"),POPWINDOW.resizeHandle=document.getElementById("resizeHandle"),POPWINDOW.rightResizeHandle=document.getElementById("rightResizeHandle"),POPWINDOW.bottomResizeHandle=document.getElementById("bottomResizeHandle"),POPWINDOW.isResizing=!1,POPWINDOW.startWidth=0,POPWINDOW.startHeight=0,POPWINDOW.startX=0,POPWINDOW.startY=0,POPWINDOW.text=document.querySelector(".popwindow-text"),POPWINDOW.windowHeader.addEventListener("mousedown",e=>{POPWINDOW.isDragging=!0,POPWINDOW.offsetX=e.clientX-POPWINDOW.movableWindow.getBoundingClientRect().left,POPWINDOW.offsetY=e.clientY-POPWINDOW.movableWindow.getBoundingClientRect().top}),window.addEventListener("mouseup",()=>{POPWINDOW.isDragging=!1}),window.addEventListener("mousemove",e=>{POPWINDOW.isDragging&&(POPWINDOW.movableWindow.style.left=e.clientX-POPWINDOW.offsetX+"px",POPWINDOW.movableWindow.style.top=e.clientY-POPWINDOW.offsetY+"px")}),POPWINDOW.closeButton.addEventListener("click",()=>{POPWINDOW.movableWindow.style.display="none",POPWINDOW.isOpen=!1,POPWINDOW.isHover=!1}),POPWINDOW.resizeHandle.addEventListener("mousedown",e=>{POPWINDOW.isResizing=!0,POPWINDOW.startX=e.clientX,POPWINDOW.startY=e.clientY,POPWINDOW.startWidth=parseInt(document.defaultView.getComputedStyle(POPWINDOW.movableWindow).width,10),POPWINDOW.startHeight=parseInt(document.defaultView.getComputedStyle(POPWINDOW.movableWindow).height,10),window.addEventListener("mousemove",PopWindow.doResize),window.addEventListener("mouseup",PopWindow.stopResizing)}),POPWINDOW.rightResizeHandle.addEventListener("mousedown",e=>{POPWINDOW.isResizing||(POPWINDOW.isResizing=!0,POPWINDOW.startX=e.clientX,POPWINDOW.startY=e.clientY,POPWINDOW.startWidth=parseInt(document.defaultView.getComputedStyle(POPWINDOW.movableWindow).width,10),POPWINDOW.startHeight=parseInt(document.defaultView.getComputedStyle(POPWINDOW.movableWindow).height,10),window.addEventListener("mousemove",PopWindow.doRightResize),window.addEventListener("mouseup",PopWindow.stopRightResizing))}),POPWINDOW.bottomResizeHandle.addEventListener("mousedown",e=>{POPWINDOW.isResizing||(POPWINDOW.isResizing=!0,POPWINDOW.startX=e.clientX,POPWINDOW.startY=e.clientY,POPWINDOW.startWidth=parseInt(document.defaultView.getComputedStyle(POPWINDOW.movableWindow).width,10),POPWINDOW.startHeight=parseInt(document.defaultView.getComputedStyle(POPWINDOW.movableWindow).height,10),window.addEventListener("mousemove",PopWindow.doBottomResize),window.addEventListener("mouseup",PopWindow.stopBottomResizing))})}static doResize(e){POPWINDOW.isResizing&&(POPWINDOW.movableWindow.style.width=POPWINDOW.startWidth+e.clientX-POPWINDOW.startX+"px",POPWINDOW.movableWindow.style.height=POPWINDOW.startHeight+e.clientY-POPWINDOW.startY+"px")}static stopResizing(e){POPWINDOW.isResizing=!1,window.removeEventListener("mousemove",PopWindow.doResize),window.removeEventListener("mouseup",PopWindow.stopResizing)}static doRightResize(e){POPWINDOW.isResizing&&(POPWINDOW.movableWindow.style.width=POPWINDOW.startWidth+e.clientX-POPWINDOW.startX+"px",POPWINDOW.movableWindow.style.height=POPWINDOW.startHeight+"px")}static stopRightResizing(e){POPWINDOW.isResizing=!1,window.removeEventListener("mousemove",PopWindow.doRightResize),window.removeEventListener("mouseup",PopWindow.stopRightResizing)}static doBottomResize(e){POPWINDOW.isResizing&&(POPWINDOW.movableWindow.style.height=POPWINDOW.startHeight+e.clientY-POPWINDOW.startY+"px",POPWINDOW.movableWindow.style.width=POPWINDOW.startWidth+"px")}static stopBottomResizing(e){POPWINDOW.isResizing=!1,window.removeEventListener("mousemove",PopWindow.doBottomResize),window.removeEventListener("mouseup",PopWindow.stopBottomResizing)}static reset(){POPWINDOW.movableWindow.style.height=8*FIELD.tileWidth+"px",POPWINDOW.movableWindow.style.width=8*FIELD.tileWidth+"px",POPWINDOW.movableWindow.style.minHeight=3*FIELD.tileWidth+"px",POPWINDOW.movableWindow.style.minWidth=5*FIELD.tileWidth+"px",POPWINDOW.movableWindow.style.left=FIELD.leftPad+(FIELD.cols+1)*FIELD.tileWidth+FIELD.midPad+"px",POPWINDOW.movableWindow.style.top=FIELD.midHeight+"px",POPWINDOW.text.scrollTop=0}static setText(){var e="-------------------------------------\n";"quant1"===SCENARIO.name?(e+="Finally! The day has arrived that I get to work with actual qubits and quantum gates; I can hardly wait! \n \n",e+="My initial experimentations have already revealed some key insights: \n ",e+="• the action of a rotation gate is undone by an equal rotation in the opposite direction. \n ",e+="• the action of a flip gate is undone by an identical flip gate. \n \n",e+="It should follow that the action of a *sequence* of rotation/flip gates can be undone by undoing each gate individually. However, it appears that the order in which gates are applied is important to getting the correct result...\n "):"quant3"===SCENARIO.name?(e+="My initial experiments with quantum flip and rotate gates proved relatively uneventful. The gates behaved much as I thought they would. I was beginning to think the differences between bits and qubits might be relatively superficial: that they are simply the differences that one might expect when switching from a discrete to a continuous medium. However, my introduction to qubit measurements has thoroughly disabused me of these notions.  \n \n",e+="The problem that I am currently tasked with, which involves sorting between ▲-state and ▶-state qubits, boggles my mind. Imagine a large bag containing a number of apples and oranges, and that our goal is to pull pieces of fruit from the bag one at a time and to separate them into their two types. Sounds simple, right? What if I told you that the act of removing each fruit from the bag could transmute it into something else entirely; that an apple could become an orange (or something *between* an apple and an orange) depending on the details of how it was taken from the bag as well an element of chance. It sounds absurd, but this seems to be the reality that qubits inhabit! \n \n",e+="More concretely, I have found that the act of observing a qubit, i.e. by passing it through a measurement device, will change its state to align or anti-align with the device. A qubit initially in the ▲-state could transform into a ▶-state under measurement (assuming the measurement device was horizontally aligned). In this situation it would be impossible to distinguish, based on the measurement outcome alone, whether the initial state was ▲ or ▶. Indeed, regardless of the setting of the measurement device, input states ▲ and ▶ both have a chance of producing the same measurement result and output state. However, there must exist a measurement setting that minimizes this chance, hence maximizes the likelihood of successfully distinguishing between the different input states... \n"):"quant6B"===SCENARIO.name?(e+="The qubits dance and change before my eyes, seeming to switch direction in fleeting moments. The truth of this illusion is disturbing to me: I know that they somehow exist simultaneously in both directions and yet are not fully in either. \n \n",e+="Another realization disturbs me further: the qubits have always been this way. The only thing that has changed is my perception of them; the same reality viewed through a different lens. One thing is clear to me: to succeed further I must become fluent in the ability to view and understand qubits from different perspectives. \n"):"quant7"===SCENARIO.name?(e+="In my short experience with qubits and quantum gates I have observed many significant differences between them and their classical counterparts. However, it is with my current introduction to entanglement that I see a truly radically departure from anything comparable within the classical setting. \n \n",e+="The concept of entanglement is fascinating! A pair of qubits, when set in an entangled state, behave as a single entity with each qubit able to exert some nebulous influence over the other. This quality can remain even when the qubits are taken a great distance apart, and even though they do not communicate nor transmit information in any way that can be fathomed. If one-half of an entangled pair is measured then the state of the partner will instantaniously adjust in state to compensate for the measurement result, even though the partner should not have any way of knowing what the measurement result was (or even that a measurement took place). \n \n",e+="Although much is still beyond my comprehension, I can't help but see the enormity of the implications given rise by entanglement. A group of classical bits is no more than the sum of its parts; describing each individual bit of a group accounts for a full description of the group itself. In contrast, a group of entangled qubits can behave collectively as an single object, vastly more complex than the sum of its individual qubits would suggest. \n"):"adderC"===SCENARIO.name?(e+="Previously, many of the quantum tasks that I have been assigned have been solvable via a straight-forward adaption of a corresponding classical task. One such task was reproducing the `XOR` gate using quantum components, which could be accomplished by switching from classical controlled-inversion gates to appropriate quantum controlled-flip gates. \n \n",e+="However, I am finding that some quantum tasks are instead *much* more challenging than their classical counterparts, as exemplified by my present task of producing the quantum `AND` gate. The difficulty here lies with the lack of a quantum equivalent to the classical re-zero gate. As such, I must produce a completely new design using only the quantum flip and rotate gates that I have available to me. \n \n",e+="[update] I have made a breakthrough in the design of a quantum `AND` gate based on the following sequence of 90° rotations: \n",e+="• perform +90° rotation on `α` if `A` is in state ▼. \n ",e+="• perform +90° rotation on `α` if `B` is in state ▼. \n ",e+="• perform -90° rotation on `α` if (`A` XOR `B`) is in state ▼. \n \n",e+="This sequence of operations does not solve the task completely, as I must still revert qubits from `A` and `B` to their original states before they are output, although I believe that a few additional gates could resolve this final issue. \n "):"entChallengeA"===SCENARIO.name?(e+="From my previous tests I have seen that if two qubits are entangled together then their measurement results will be correlated; once one qubit is measured then the other will collapse into a fixed state (contingent on the measurement outcome). \n\n",e+="In this regard, I believe that I have found an example of a maximally entangled (hence maximally correlated) state. This state is prepared as following: \n ",e+="• First I prepare two qubits, one in state ▶ and the other in state ▲. \n",e+="• Then I enact a controlled flip between the two qubits, with the (vertically aligned) control acting on the ▶ qubit and the (horizontally aligned) flip acting on the ▲ qubit. \n\n "):"quantChallengeB"===SCENARIO.name?(e+="In the realm of quantum gates nothing is irrevocable; every action that can be done can also be undone. Thus, I am confident in my ability to solve the latest challenge presented to me. I have been tasked with figuring out how to undo the action of a pair of sealed devices, each containing a two-qubit gate whose make and design have been long forgotten. \n \n",e+="My first call of action was to run the factory and examine the entangled output states produced by each device, which each are described by their *four* state amplitudes. By experimenting with changing the basis of each qubit in the output, I was able to find a special choice of basis in which only *two* of the amplitudes were non-zero. I believe that this is the key! \n\n",e+="By implementing a controlled flip or rotation between the qubit pairs, with the control set to align with the special basis identified in the previous step, it should be possible to disentangle each pair. Once they are disentangled, restoring the single qubits to their original states should be relatively simple... \n"):"quantChallengeA"===SCENARIO.name?(e+="They say that the definition is insanity is doing the same thing over and over again, but expecting different results. Yet many of the quantum tasks that I am required to solve precisely rely on doing the same thing over and over until the desired outcome is achieved. \n \n",e+="How can I continue in an environment where insanity not only encouraged, but is necessary to succeed? \n"):"quantChallengeF"===SCENARIO.name?(e+="Although my experience with quantum components remains limited, it is clear to me that the ability of qubits to entangle with one another is a key advantage over computation with regular bits. Entanglement is something uniquely quantum; it has no classical analogue. Entanglement, when shared between two or more parties, can potentially be utilized to achieve results that are impossible with classical components. \n \n",e+="But therein lies the rub. Entanglement can only be created through *local* interaction between qubits; they must initially be together in the same place. So it often remains a necessary step to distribute the entangled qubits to different parties who could be geographically separated by large distances. \n \n",e+="The goal of my current assignment is to help remedy the challenge of distributing entangled qubits by instituting a `meet in the middle` type approach. I have already discovered several steps which bring me closer to this goal: \n ",e+="• First, I create pairs of entangled qubits, using controlled-flip gates as usual, on both the top and the bottom segments of the factory. \n",e+="• Then I send one-half of each qubit pair from the top and the bottom to the center segment, before entangling these together to create a four-qubit entangled state (i.e. between the top qubit, the two central qubits, and the bottom qubit). \n ",e+="• By then measuring the two central qubits with appropriate measurement settings, a maximally entangled state between the top and bottom qubits is realized. \n\n",e+="However, a problem still remains. The character of the entangled states that are created via this process are not uniform; they depend on the measurement results from the final step. There must be a way the fix these states such that they are always consistant with the desired output... \n \n"):"simpleDistill"===SCENARIO.name?(e+="Despite its esoteric nature there are many ways in which entanglement behaves as if it were some kind of chemical compound. Entanglement can be created, destroyed, shifted from one location to another, and even transferred between vessels. My current assignment extends this analogy with a task that is intimately familiar to chemists everywhere: I must `distill` some entanglement, which is initially `diluted` amongst three qubits, into a more `concentrated` form held within two qubits. \n \n",e+="I believe that the process should be fairly straight-forward. By measuring one of the three qubits the state is reduced to an entangled state on two remaining qubits. The two-qubit states that can be generated from this process can be explored in the state analyzer (or directly by running the factory with a given measurement setting). So it only remains for me to explore different measurement options until I find one such that the remaining two qubits could be maximally entangled. \n \n",e+="[update] I have made significant progress: by measuring the bottom qubit with a *vertically* aligned measurement I find that there is a 25% chance that the remaining two qubits will successfully form a maximally entangled state (although not in the specific form requested). Thus, several additional steps need to be taken in order to fully complete the problem: (1) separate out the successful creations of maximally entangled states from the failures and (2) manipulate final states using single qubit gates until they are in the requested form. \n"):"chsh"===SCENARIO.name?(e+="Two coworkers, codenames `Alice` and `Bob`, face what should be an impossible task. They are required to cooperate in order to win a game, and yet each lacks some information, only possessed by the other, that is necessary to assure success. If that were the end of the story then they would simply be forced to guess, and the outcome of the game would be soley determined by luck. However, this is not the end of the story as they share between them pairs of entangled qubits, whose enigmatic nature can twist the vagaries of fortune to their benefit. \n \n",e+="I have most of it figured out already. From my previous experiments with entanglement I know that if Alice and Bob were each perform the same measurement on their half of the entangled qubit pair then they would *always* get the same result, regardless of how the measurement angle was set. Similarly, it follows that if they were to perform oppositely aligned measurements then they would always get opposite results. By extension it stands to reason that if the difference in angle between Alice and Bobs measurement angle gate alignments is small (<90°) then they are more likely produce agreeing measurement results, while if the angle is large (>90°) then they are more likely produce disagreeing measurement results. It follows that, by choosing their measurement angles appropriately, Alice and Bob can influence how likely they are to produce matching/differing measurement results and thus increase their chances of winning the game. \n \n",e+="If my reasoning is correct, then Alice and Bob should try to maximize the difference in their measurement angles when both receive `1` bits from the center, but minimize the difference in their measurement angles in all other cases. However, I am yet to find a configuration of the measurement devices that satisfies this criteria...\n "):"quantumAdv3"===SCENARIO.name?(e+="I have been tasked to examine some pairs of qubits to see whether or not they are entangled. My initial reaction was to propose the following: that we should measure both qubits from each pair and then check whether the measurement outcomes are co-dependent, since this is a defining feature of entanglement. However, I was subsequently informed of a serious handicap that would prohibit me from executing this proposal; I am to have access to only *one-half* of each qubit pair. How can I possibly check for entanglement under these circumstances?!? \n \n",e+="[update] I have made a breakthrough in my understanding! While experimenting in the state analyzer I observed the following: if a qubit is part of a maximally entangled pair then it will always return a 50/50 random measurement outcome, regardless of the measurement angle setting. Conversely, I already know that if a qubit is *not* entangled then there will always be some measurement setting that will return a deterministic (i.e. 100/0) measurement outcome. Perhaps it could be possible to implement a design that distinguishes between entangled/non-entangled qubits based on this understanding? \n"):"teleport"===SCENARIO.name?(e+="I have tentatively been assigned to `Project Teleport`, the goal of which is to transport the state of a source qubit such that an exact copy can be reconstructed at a destination. At first, I objected to the name. Imagine that a sculptor were to send the instructions for one of their sculptures to a far off place, and then these instructions were used to create a copy of the sculpture in that place. Would we say that the sculpture was teleported? No, that would be preposterous! However, the more that I think about it, the more that I begin to change my mind about the suitability of the name `Teleport` for the current project. What if the recreated object was perfect and utterly indistinguishable from the original in every conceivable facet? Who could say that this was not then the original? \n \n",e+="Initially I am allotted with a quantity of preset `resource` qubit pairs that are entangled between the source/destination. From my previous work with entangled qubit pairs I know that if I were to measure the source qubit then, regardless of the measurement result, the destination qubit will `collapse` into the same state as the (post-measurement) source qubit. The theory behind the teleportation protocol is to somehow piggy-back a data qubit, initially located at the source, onto the pre-existing entanglement of the resource qubits such that the destination qubit is `collapsed` into the same state as this data qubit. If possible, this protocol would enable the `state` of a data qubit to be transferred from source to destination *without* having to send any actual qubits. \n \n",e+="My preliminary attempt at implementing the teleportation protocol consist of the following steps: \n",e+="• I begin by entangling the data and resource qubit at the source using a controlled-flip. This creates an entangled state on three qubits (i.e. between the two qubits at the source and the qubit at the destination). \n",e+="• I then measure each of the two source qubits with differently configured measurement settings. This subsequently collapses the destination qubit into an unentangled state. \n\n",e+="By setting the measurement device of the latter step appropriately I find that if both measurements yield the `0` state then the destination qubit exactly matches the initial state of the data qubit, consistent with our goal. However, it either of the measurements yield the `1` state then I find that the destination qubit is somehow a mirrored reflection of the data qubit. Thus, it still remains for me to somehow `correct` the destination qubit for the cases that this mirroring occurs. \n "):"dense"===SCENARIO.name?(e+="My previous attempts to store multiple bits of classical data within a single qubit did not prove viable. But I have a new idea: given that an entangled state of multiple qubits behaves much as a singular object, could it be possible to store multiple bits of data within an *entangled* qubit state? \n\n",e+="The test problem is as follows. We begin with a pair of entangled qubits, one at the source and one at the destination, and our goal is to transmit two bits of information from the source to the destination while only actually sending a single qubit. I believe that I have already made significant headway towards this goal: \n ",e+="• I begin by enacting a *vertical* flip of the source qubit if the first source bit is in the `1` state.  \n",e+="• Then I enact a *horizontal* flip of the source qubit if the second source bit is in the `1` state.  \n",e+="• The source qubit is then sent to the destination. \n\n",e+="At this point I have one of four different two-qubit entangled states at the destination (depending on what the bit values were at the source). By properly manipulating and measuring the entangled state I believe that it should be possible to determine with certainty what both of the source bits were... \n"):"distill"===SCENARIO.name?(e+="Recently I have been encountering a vexing problem: my proposals, although flawless at conceptual level, are sullied by the imperfections inherent to reality. In particular, protocols that rely on utilization of entangled qubit pairs are failing due to them possessing weaker than expected entanglement. \n \n",e+="However, I believe that this problem can be corrected via the process of *distillation*: \n",e+="• I begin by taking two pairs of weakly entangled qubits and entangle them together to create a four-qubit entangled state.  \n",e+="• Then, with the proper choice of measurements (and sufficient luck), I believe that it should be possible to produce a perfectly entangled qubit pair from the four-qubit entangled state... \n"):"quantErrorA"===SCENARIO.name?(e+="In composing the laws of quantum it seems that the architects of our reality have given with one hand and taken with the other in equal measure. For, despite whatever advantages qubits may possess over regular bits, they are also shackled by inherent disadvantages. \n \n",e+="A particularly vexing disadvantage of qubits comes with respect to the duplication of data. When dealing with classical data, i.e. strings of bits, the activity of duplicating data is so trivial and commonplace that it does not warrant a second thought. However, in contrast, the limitations of quantum measurements imply that it is simply not possible to duplicate an arbitrary string of qubits. Which brings me neatly to my current predicament. \n \n",e+="Previously, when tasked with correcting for transmission errors occurring in bit strings, the duplication of data was key to my strategy. By generating and then later comparing multiple copies of the same data I was able to detect and correct for most errors that occurred. Presently, when faced with the task of correcting transmission errors in qubit strings, the inability to duplicate qubits implies that an entirely different strategy will be necessary. How can one prevent data loss from occurring when no more than a single copy of the data can exist?!? \n \n",e+="[update] After much trial and error I believe that I am close to a conceptual breakthrough. Even though the duplication of qubits is impossible, it may still be possible to `spread-out` the information from a single qubit over a group of multiple qubits. This way, even if some of the individual qubits experience errors, so long as the majority of qubits within the group remain intact it should still be possible to recover the data held by the original qubit. My preliminary design consists of the following steps: \n",e+="• [Pre-transmission] Create some `helper` qubits in a known state ▲, and then entangle these helper qubits together with the data qubit that is to be transmitted. This process effectively `encodes` the logical data within an entangled state on the larger group qubits. \n",e+="• [Post-transmission] Decode the entangled state by apply the reverse of the operations used to encode the data qubit in the first step. If no errors occurred during the transmission then all of the qubits (i.e. data + helpers) should be returned to their original states. \n",
e+="• [Post-transmission] After the decoding step, each of the helper qubits should then be measured to determine whether or not they are in their original states. If any of the measurements indicate that a helper qubit is *not* in its original state then this in indicative that some kind of error occurred. \n \n",e+="Utilizing the steps outlined above I am able, with high probability, to detect when an error occurs during transmission. However, in the cases that an error does occur, it still remains for me to implement a solution to correct the error. Perhaps the pattern of measurement results from the helper qubits, properly interpreted, may indicate how each error could be corrected? \n \n"):"quantChallengeG"===SCENARIO.name&&(e+="I have stumbled across a mystery; one which defies my comprehension of quantum devices. I was experimenting with a quantum controlled-flip gate, which takes as input a control and a target qubit. In my understanding, the function of the control qubit is to configure the gate which acts on the target qubit. However, by pure chance, I happened to find a configuration of inputs such that the control qubit is transformed to a new state, but the target qubit is left in its original state. At first I thought that this must be due to a faulty control gate but, upon examination, I found that the gate is indeed working correctly. How can this be possible? \n\n",e+="A configuration for a controlled-flip gate that produces this strange result is as follows: \n",e+="• Set the target flip gate to be anti-aligned with input target qubit.\n",e+="• Set the control part of the gate in any direction, so long as it is not aligned to the input control qubit.\n\n",e+="[update] After a great deal of thought I believe that I have started to make sense of the situation. When a flip gate is anti-aligned with a qubit it only changes the *sign* of the qubit state. Usually this would not have any significant consequence. However, it the context of a controlled-flip, the sign of only *some* of the state amplitudes may be flipped (which is significant!). \n\n",e+="For instance, assume that the control qubit is initially set in the superposition (▶ + ◀), which we recall is equivalent to the ▲-state. Then, during activation of thecontrol gate, it is possible for the sign on only the second part of the superposition to change, such that the state of the control qubit becomes (▶ - ◀), which is now equivalent to the ▼-state. \n\n",e+="The fact that a control qubit can be modified by a quantum control gate marks a significant departure from the classical counterparts, given that a control bit is always left invariant by the action of a classical control gate. I wonder if this difference can be exploited for any practical purpose? \n\n"),e+="-------------------------------------",POPWINDOW.windowHeader.style.fontSize=Math.round(.33*FIELD.tileWidth)+"px",POPWINDOW.windowHeader.style.lineHeight="1.5",POPWINDOW.closeButton.style.fontSize=Math.round(.33*FIELD.tileWidth)+"px",POPWINDOW.closeButton.style.lineHeight="1.5",POPWINDOW.text.style.fontSize=Math.round(.3*FIELD.tileWidth)+"px",POPWINDOW.text.style.lineHeight="1.5",POPWINDOW.text.innerText=e}}class Qubit{constructor(e,t,i,a,r,s,o=-1){this._i0=e,this._j0=t,this._last=i,this._next=a,this._action=r,this._isGhost=!1,this._isHovered=!1,this._entGroup=0,this._entInd=-1,this._entID=-1,this._ent=0,this._measureRot=0,s>Math.PI&&(s-=2*Math.PI),this._ampsComp=[Math.cos(s/2),Math.sin(s/2)],"natural"===OPTS.basis?(this._ampsFinal=[1,0],this._basisRot=s,this._basisVecs=[Math.cos(s/2),Math.sin(s/2),-Math.sin(s/2),Math.cos(s/2)],this._ampsRot=[1,0],this._lockedBasis=!1):"free"===OPTS.basis?(this._ampsFinal=[1,0],this._basisRot=s,this._basisVecs=[Math.cos(s/2),Math.sin(s/2),-Math.sin(s/2),Math.cos(s/2)],this._ampsRot=[1,0],this._lockedBasis=!1):"comp"===OPTS.basis?(this._ampsRot=[...this._ampsComp],this._ampsFinal=[...this._ampsComp],this._basisRot=0,this._basisVecs=[1,0,0,1],this._lockedBasis=!0):(this._ampsFinal=[1,0],this._basisRot=s,this._basisVecs=[Math.cos(s/2),Math.sin(s/2),-Math.sin(s/2),Math.cos(s/2)],this._ampsRot=[1,0],this._lockedBasis=!1),o<0?(this._id=GLOBAL_ID,GLOBAL_ID+=1):this._id=o}get i0(){return this._i0}get j0(){return this._j0}get last(){return this._last}get next(){return this._next}get action(){return this._action}get id(){return this._id}get isGhost(){return this._isGhost}get ampsComp(){return this._ampsComp}get basisRot(){return this._basisRot>Math.PI&&(this._basisRot-=2*Math.PI),this._basisRot<-Math.PI&&(this._basisRot+=2*Math.PI),this._basisRot}get measureRot(){return this._measureRot}get ampsRot(){return this._ampsRot}get ent(){return this._ent}get ampsFinal(){return this.entGroup?this.entGroup._ampsFinal:this._ampsFinal}get isHovered(){return this._isHovered}get lockedBasis(){return this._lockedBasis}get entGroup(){return this._entGroup}get basisVecs(){return this._basisVecs}get entInd(){return this._entInd}get entID(){return this._entID}get offsets(){return this.entGroup?this.entGroup.offsets:[0,this.ampsRot[1]**2]}set i0(e){this._i0=e}set j0(e){this._j0=e}set last(e){this._last=e}set next(e){this._next=e}set action(e){this._action=e}set isGhost(e){this._isGhost=e}set entGroup(e){this._entGroup=e}set ampsComp(e){this._ampsComp=e}set basisRot(e){this._basisRot=e}set basisVecs(e){this._basisVecs=e}set ampsRot(e){this._ampsRot=e}set measureRot(e){this._measureRot=e}set ampsFinal(e){this._ampsFinal=e}set isHovered(e){this._isHovered=e}set lockedBasis(e){this._lockedBasis=e}set entGroup(e){this._entGroup=e}set entInd(e){this._entInd=e}set entID(e){this._entID=e}set ent(e){this._ent=e}setPolarize(e){e>Math.PI&&(e-=2*Math.PI),this._basisRot=e,this._basisVecs=[Math.cos(e/2),Math.sin(e/2),-Math.sin(e/2),Math.cos(e/2)],this._ampsComp=[Math.cos(e/2),Math.sin(e/2)],this._ampsRot=[1,0],this._ampsFinal=[1,0]}copy(){var e=new Qubit(this._i0,this._j0,this._last,this._next,this._action,this._basisRot,this._id);return e.isGhost=this.isGhost,e.basisRot=this.basisRot,e.entGroup=this.entGroup,e.lockedBasis=this.lockedBasis,e.basisVecs=[...this.basisVecs],e.ampsComp=[...this.ampsComp],e.ampsRot=[...this.ampsRot],e.ampsFinal=[...this.ampsFinal],e.entInd=this.entInd,e.entID=this.entID,e.measureRot=this.measureRot,e.ent=this.ent,e}computeEnt(){return this.entGroup?this.ent=this.entGroup.computeEnt(this.entInd):this.ent=0,this.ent}computeNaturalBasis(){if(this.entGroup)var e=this.entGroup.computeNaturalBasis(this.entInd);else{var t=this.ampsComp[0]**2,i=this.ampsComp[0]*this.ampsComp[1],a=Math.sqrt(4*i**2+4*t**2-4*t+1),r=(1+a)/2,s=.001;if(r<.5+s)e=0;else if(Math.abs(i)>=s)e=2*Math.atan((r-t)/i);else if(t>=.5)e=0;else if(t<.5)e=Math.PI}return e}setEntGroup(e,t){this.entGroup=e,this.entInd=t,this.entID=e.id}setAmpsComp(e){this.ampsComp=[Math.cos(e/2),Math.sin(e/2)],this.computeRotAmps()}computeMeasureProb(){if(this.entGroup){var e=this.measureRot,t=this.entGroup.ampsComp,i=this.entGroup.allOrders[this.entInd],a=0;for(const s of i){var r=s+2**this.entInd;a+=(Math.cos(e/2)*t[s]+Math.sin(e/2)*t[r])**2}ANALYSIS.prob=a}else{e=this.measureRot;var s=[Math.cos(e/2),Math.sin(e/2)];ANALYSIS.prob=(s[0]*this.ampsComp[0]+s[1]*this.ampsComp[1])**2}}computeRotAmps(){if(this.entGroup)this.entGroup.computeRotAmps();else{var e=[0,0];e[0]=this.basisVecs[0]*this.ampsComp[0]+this.basisVecs[1]*this.ampsComp[1],e[1]=this.basisVecs[2]*this.ampsComp[0]+this.basisVecs[3]*this.ampsComp[1],this.ampsRot=e,this.computeFinalAmps()}}rotateBasis(e){if(this.entGroup)this.entGroup.rotateBasis(e,this.entInd);else{var t=[0,0];t[0]=Math.cos(e/2)*this.ampsComp[0]+Math.sin(e/2)*this.ampsComp[1],t[1]=-Math.sin(e/2)*this.ampsComp[0]+Math.cos(e/2)*this.ampsComp[1],this._ampsRot=t,this.basisVecs=[Math.cos(e/2),Math.sin(e/2),-Math.sin(e/2),Math.cos(e/2)],this.computeFinalAmps()}}static computeFinalAmpsStatic(e,t){var i=1e-5;if(Math.abs(e[0])<i)var a=1;else a=Math.sign(e[0]);if(Math.abs(e[2])<i)var r=1;else r=Math.sign(e[2]);return[t[0]*a,t[1]*r]}computeFinalAmps(){if(this.entGroup)Entangled.computeFinalAmps(this.entGroup);else{var e=1e-5;if(Math.abs(this.basisVecs[0])<e){this.basisRot=Math.PI;var t=Math.sign(this.basisVecs[1])}else{this.basisRot=2*Math.atan(this.basisVecs[1]/this.basisVecs[0]);t=Math.sign(this.basisVecs[0])}if(Math.abs(this.basisVecs[2])<e)var i=Math.sign(this.basisVecs[3]);else i=Math.sign(this.basisVecs[2]);this.ampsFinal=[this.ampsRot[0]*t,this.ampsRot[1]*i]}}projectMeasure(e){var t=1e-5;if(e>Math.PI+t&&(e-=2*Math.PI),e<-Math.PI+t&&(e+=2*Math.PI),this.entGroup)var i=this.entGroup.projectMeasure(this.entInd,e);else{var a=[Math.cos(e/2),Math.sin(e/2)];i=(a[0]*this.ampsComp[0]+a[1]*this.ampsComp[1])**2}return i}applyMeasure(e){var t=1e-5;if(e>Math.PI+t&&(e-=2*Math.PI),e<-Math.PI+t&&(e+=2*Math.PI),Math.abs(e)<t&&(e=0),this.entGroup){var i=this.entGroup,a=this.entGroup.applyMeasure(this.entInd,e);return i.removeUnentangled(),a}var r=[Math.cos(e/2),Math.sin(e/2)],s=(Math.sin(e/2),Math.cos(e/2),(r[0]*this.ampsComp[0]+r[1]*this.ampsComp[1])**2);if(s>Helper.random()){this.ampsComp=[Math.cos(e/2),Math.sin(e/2)],this.lockedBasis||(this.basisVecs=[Math.cos(e/2),Math.sin(e/2),-Math.sin(e/2),Math.cos(e/2)]),this.computeRotAmps();a=0}else{this.ampsComp=e<=0?[-Math.sin(e/2),Math.cos(e/2)]:[Math.sin(e/2),-Math.cos(e/2)],this.lockedBasis||(this.basisVecs=[Math.cos(e/2),Math.sin(e/2),-Math.sin(e/2),Math.cos(e/2)]),this.computeRotAmps();a=1}return this.computeFinalAmps(),a}applyRot(e){var t=1e-5;if(e>Math.PI+t&&(e-=2*Math.PI),e<-Math.PI+t&&(e+=2*Math.PI),this.entGroup)this.entGroup.applyRot(this.entInd,e);else{var i=[0,0];if(i[0]=Math.cos(e/2)*this.ampsComp[0]-Math.sin(e/2)*this.ampsComp[1],i[1]=Math.sin(e/2)*this.ampsComp[0]+Math.cos(e/2)*this.ampsComp[1],this._ampsComp=i,!this.lockedBasis){var a=[0,0,0,0];a[0]=Math.cos(e/2)*this.basisVecs[0]-Math.sin(e/2)*this.basisVecs[1],a[1]=Math.sin(e/2)*this.basisVecs[0]+Math.cos(e/2)*this.basisVecs[1],a[2]=Math.cos(e/2)*this.basisVecs[2]-Math.sin(e/2)*this.basisVecs[3],a[3]=Math.sin(e/2)*this.basisVecs[2]+Math.cos(e/2)*this.basisVecs[3],this.basisVecs=a}var r=[0,0];r[0]=this.basisVecs[0]*this.ampsComp[0]+this.basisVecs[1]*this.ampsComp[1],r[1]=this.basisVecs[2]*this.ampsComp[0]+this.basisVecs[3]*this.ampsComp[1],this._ampsRot=r,this.computeFinalAmps()}}applyFlip(e){var t=1e-5;if(e>Math.PI+t&&(e-=2*Math.PI),e<-Math.PI+t&&(e+=2*Math.PI),this.entGroup)this.entGroup.applyFlip(this.entInd,e);else{var i=[0,0];if(i[0]=Math.cos(e)*this.ampsComp[0]+Math.sin(e)*this.ampsComp[1],i[1]=Math.sin(e)*this.ampsComp[0]-Math.cos(e)*this.ampsComp[1],this._ampsComp=i,!this.lockedBasis){this.basisRot;var a=[0,0,0,0];a[0]=Math.cos(e)*this.basisVecs[0]+Math.sin(e)*this.basisVecs[1],a[1]=Math.sin(e)*this.basisVecs[0]-Math.cos(e)*this.basisVecs[1],a[2]=Math.cos(e)*this.basisVecs[2]+Math.sin(e)*this.basisVecs[3],a[3]=Math.sin(e)*this.basisVecs[2]-Math.cos(e)*this.basisVecs[3],this.basisVecs=a}var r=[0,0];r[0]=this.basisVecs[0]*this.ampsComp[0]+this.basisVecs[1]*this.ampsComp[1],r[1]=this.basisVecs[2]*this.ampsComp[0]+this.basisVecs[3]*this.ampsComp[1],this._ampsRot=r,this.computeFinalAmps()}}static computeAlfsManual(e,t){var i=1e-4;if(Math.abs(t[0])<i)return[0,1];if(Math.abs(t[1])<i)return[1,0];var a=.1,r=2,s=[0,t[0]**2,1,1+t[0]**2];e<.5&&(e+=1);for(var o=e+a/2,n=e-a/2,l=2*r-1;l>=0;l--)if(o>s[l]){var h=l;break}for(l=h;l>=0;l--)if(n>s[l]){var d=l;break}var u=h-d+1,c=new Array(r).fill(0);if(1===u)d>=r?c[d-r]=1:c[d]=1;else{var I=(s[d+1]-n)/a,E=(o-s[h])/a;if(d>=r?c[d-r]+=I:c[d]+=I,h>=r?c[h-r]+=E:c[h]+=E,u>2)for(l=d+1;l<h;l++){var f=(s[l+1]-s[l])/a;l>=r?c[l-r]+=f:c[l]+=f}}return c}computeAlfs(e){if(this.entGroup)return this.entGroup.computeAlfs(e);var t=1e-4;if(Math.abs(this._ampsRot[0])<t)return[0,1];if(Math.abs(this._ampsRot[1])<t)return[1,0];var i=.1,a=2,r=[0,this._ampsRot[0]**2,1,1+this._ampsRot[0]**2];e<.5&&(e+=1);for(var s=e+i/2,o=e-i/2,n=2*a-1;n>=0;n--)if(s>r[n]){var l=n;break}for(n=l;n>=0;n--)if(o>r[n]){var h=n;break}var d=l-h+1,u=new Array(a).fill(0);if(1===d)h>=a?u[h-a]=1:u[h]=1;else{var c=(r[h+1]-o)/i,I=(s-r[l])/i;if(h>=a?u[h-a]+=c:u[h]+=c,l>=a?u[l-a]+=I:u[l]+=I,d>2)for(n=h+1;n<l;n++){var E=(r[n+1]-r[n])/i;n>=a?u[n-a]+=E:u[n]+=E}}return u}arrow(e){return this.entGroup?this.entGroup.computeArrow(e,this.entInd):e[1]}pack(){var e=1e-5;if(Math.abs(this.ampsComp[0])<e)var t=Math.PI;else t=2*Math.atan(this.ampsComp[1]/this.ampsComp[0]);var i=[this._i0,this._j0,this._last,this._next,this._action,t,this._isGhost];return i}findNextDir(e){if(this._next>=0)return this._next;var t=e.getTile(this._i0,this._j0);return this._next=DIRQUANTUM.fromTo[this._last][t],this._next}static moveAdjacentCombine(e,t,i,a){if(64===i)var r=a.getQubit(e-1,t+1),s=a.getQubit(e-2,t),o=a.getQubit(e-1,t-1);else if(65===i)r=a.getQubit(e-1,t-1),s=a.getQubit(e,t-2),o=a.getQubit(e+1,t-1);else if(66===i)r=a.getQubit(e+1,t-1),s=a.getQubit(e+2,t),o=a.getQubit(e+1,t+1);else if(67===i)r=a.getQubit(e+1,t+1),s=a.getQubit(e,t+2),o=a.getQubit(e-1,t+1);r&&"move"===r.action&&r.move(a),s&&"move"===s.action&&s.move(a),o&&"move"===o.action&&o.move(a)}move(e){var t=e.findAdjacent(this.i0,this.j0,this.findNextDir(e)),i=t.i1,a=t.j1,r=(this.next+2)%4,s=e.getTile(i,a),o=e.getTile(this.i0,this.j0),n=Math.floor(s/20);if(DIRQUANTUM.fromTo[r][s]<0||[74,75,76,77].includes(s))return this.action="halt",!0;var l=e.getGate(i,a);if(l&&"qCompare"===l.type){if(i>this.i0)var h=1;else if(i<this.i0)h=3;else if(a>this.j0)h=2;else if(a<this.j0)h=4;else h=0;if(0===l.state&&this.isGhost){l.state=h;var d=1e-5;Math.abs(this.ampsComp[0])<d?l.rot=Math.PI:l.rot=2*Math.atan(this.ampsComp[1]/this.ampsComp[0]);var u=this.i0+this.j0*e.width,c=i+a*e.width;return this.i0=i,this.j0=a,this.last=r,this.next=-1,this.action="disappear",e.moveQubit(this,u,c),[64,65,66,67].includes(o)&&Qubit.moveAdjacentCombine(i,a,o,e),!0}if(l.state!=h&&[1,2,3,4].indexOf(l.state)>=0){l.state=5,l.action="precompare";u=this.i0+this.j0*e.width,c=i+a*e.width;return this.i0=i,this.j0=a,this.last=r,this.next=-1,this.action="freeze",e.moveQubit(this,u,c),[64,65,66,67].includes(o)&&Qubit.moveAdjacentCombine(i,a,o,e),!0}return"freeze"===this.action||(this.action="halt",!0)}if(!e.checkIfEmpty(i,a))return!e.checkIfMoving(i,a)&&(this.action="halt",!0);u=this.i0+this.j0*e.width,c=i+a*e.width;if(0===n||1===n||5===n)return this.i0=i,this.j0=a,this.last=r,this.next=-1,this.action="halt",e.moveQubit(this,u,c),[64,65,66,67].includes(o)&&Qubit.moveAdjacentCombine(i,a,o,e),!0;if(3===n||4===n){l=e.getGate(i,a,e.state[c]);var I="free"===l.action||"reset"===l.action,E=e.checkWhichControl(i,a,"switch").gate;return E&&1===E.state&&E.rot>1&&(I=!1),"qCombine"===l.type&&2===l.state&&l.counterMax<=0&&(I=!1),I?(this.i0=i,this.j0=a,this.last=r,this.next=-1,this.action="wait",e.moveQubit(this,u,c),[64,65,66,67].includes(o)&&Qubit.moveAdjacentCombine(i,a,o,e),l.action="pretransform",!0):(this.action="halt",!0)}}}class QubitHalo{static draw(e){if(!(["qubiting","qubitbasis","analysisgatecontrolling"].indexOf(STATE.state)<0||("running"===STATE.mode||"paused"===STATE.mode)&&TIMER.boardTime%1>1e-5)){var t=STATE.grab.k0.id;if("constructing"===STATE.mode)var i=IBOARD;else i=RBOARD[TIMER.tick];for(var a=0,r=i._qubitList,s=0;s<r.length;s++)if(r[s].id===t){a=r[s];break}if(0===a)return STATE.state="free",void(STATE.grab={type:"free",i0:-1,j0:-1,k0:-1});e.save();SEL_STYLES.r0;var o=IBOARD.x0+(a.i0+.5)*FIELD.tileWidth,n=IBOARD.y0+(a.j0+.5)*FIELD.tileHeight,l=1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio),h=-(l-1)/2*FIELD.iconWidth/3,d=-(l-1)/2*FIELD.iconHeight/3;if("qubitbasis"!==STATE.state){var u=0,c=0;if("qubiticon"===STATE.pressed.type){var I=TIMER.totalTime-STATE.pressed.i0;I>TIMER.iconMax&&(STATE.pressed={type:"none",i0:0,j0:0,k0:0})}if("qubiticon"===STATE.pressed.type){var E=.5*(1-Math.cos(2*Math.PI*(I/TIMER.iconMax)))*(FIELD.tileWidth/48);u=3*E/4,c=7*E/4}var f=!1;"qubiticon"===STATE.under.type&&(f=!0);var S=PathsI.icon(e,"lockIcon",{hover:f,state:a.lockedBasis});if(S.draw(e,u+o-FIELD.tileWidth/6+FIELD.tileWidth/3.5+h,c+n+FIELD.tileWidth/6+d,l*FIELD.tileWidth/3,l*FIELD.tileHeight/3),a.entGroup){var p=a.entGroup,T=p.numQubits;for(s=0;s<T;s++){var R=p.qubitList[s],m=IBOARD.x0+(R.i0+.5)*FIELD.tileWidth,g=IBOARD.y0+(R.j0+.5)*FIELD.tileHeight;S=PathsI.icon(e,"tagIcon",{counter:R.entInd+1});S.draw(e,m-FIELD.tileWidth/2,g-FIELD.tileHeight/2,FIELD.tileHeight/3,FIELD.tileHeight/3)}}}e.restore(),QubitHalo.ring(e,o,n,a.basisRot)}}static ring(e,t,i,a){var r=SEL_STYLES.color5,s=SEL_STYLES.color4,o=3*SEL_STYLES.r0/4;e.save(),e.beginPath(),e.arc(t,i,o,0,2*Math.PI),e.lineWidth=1*FIELD.tileWidth/48,e.strokeStyle="seagreen",e.stroke(),e.beginPath(),e.setLineDash([SEL_STYLES.lineDash,SEL_STYLES.lineGap]),e.lineDashOffset=(SEL_STYLES.lineDash+SEL_STYLES.lineGap)*TIMER.dashRatio,e.lineWidth=1*FIELD.tileWidth/48,e.strokeStyle="#333",e.arc(t,i,o,0,2*Math.PI),e.stroke(),e.restore();var n=1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio);e.save(),e.beginPath(),e.arc(o*Math.sin(a)+t,-o*Math.cos(a)+i,.9*n*SEL_STYLES.handleRad,0,2*Math.PI);var l="qubiting"===STATE.state&&"qubitcontrol"===STATE.under.type&&STATE.under.k0%2==0,h="qubitbasis"===STATE.state&&0===STATE.grab.l0;e.fillStyle=l||h?"lemonchiffon":r,e.fill(),e.lineWidth=FIELD.tileWidth/48,e.strokeStyle="black",e.stroke(),e.restore(),e.save(),e.beginPath(),e.arc(o*Math.sin(a+Math.PI)+t,-o*Math.cos(a+Math.PI)+i,.9*n*SEL_STYLES.handleRad,0,2*Math.PI);l="qubiting"===STATE.state&&"qubitcontrol"===STATE.under.type&&STATE.under.k0%2==1,h="qubitbasis"===STATE.state&&1===STATE.grab.l0;e.fillStyle=l||h?"lemonchiffon":s,e.fill(),e.lineWidth=FIELD.tileWidth/48,e.strokeStyle="black",e.stroke(),e.restore()}}class RedWire{static placeUp(e,t){var i=IBOARD.getTile(e,t),a=IBOARD.getTile(e,t-1),r=CONSTRUCTMAPS.QU0.indexOf(i),s=CONSTRUCTMAPS.QUG.indexOf(i),o=CONSTRUCTMAPS.QD0.indexOf(a),n=CONSTRUCTMAPS.QDG.indexOf(a),l=e+t*FIELD.cols,h=e+(t-1)*FIELD.cols,d=(r>=0||s>=0)&&(o>=0||n>=0),u=Math.abs(SCENARIO.editable[l])>0&&Math.abs(SCENARIO.editable[h])>0;d&&u?(SFX.wire.play(),r>=0&&IBOARD.setTile(e,t,CONSTRUCTMAPS.QU1[r]),o>=0&&IBOARD.setTile(e,t-1,CONSTRUCTMAPS.QD1[o])):a<0&&SCENARIO.editable[h]&&IBOARD.setTile(e,t-1,0)}static placeDown(e,t){var i=IBOARD.getTile(e,t),a=IBOARD.getTile(e,t+1),r=CONSTRUCTMAPS.QD0.indexOf(i),s=CONSTRUCTMAPS.QDG.indexOf(i),o=CONSTRUCTMAPS.QU0.indexOf(a),n=CONSTRUCTMAPS.QUG.indexOf(a),l=e+t*FIELD.cols,h=e+(t+1)*FIELD.cols,d=(r>=0||s>=0)&&(o>=0||n>=0),u=Math.abs(SCENARIO.editable[l])>0&&Math.abs(SCENARIO.editable[h])>0;d&&u?(SFX.wire.play(),r>=0&&IBOARD.setTile(e,t,CONSTRUCTMAPS.QD1[r]),o>=0&&IBOARD.setTile(e,t+1,CONSTRUCTMAPS.QU1[o])):a<0&&SCENARIO.editable[h]&&IBOARD.setTile(e,t+1,0)}static placeLeft(e,t){var i=IBOARD.getTile(e,t),a=IBOARD.getTile(e-1,t),r=CONSTRUCTMAPS.QL0.indexOf(i),s=CONSTRUCTMAPS.QLG.indexOf(i),o=CONSTRUCTMAPS.QR0.indexOf(a),n=CONSTRUCTMAPS.QRG.indexOf(a),l=e+t*FIELD.cols,h=e-1+t*FIELD.cols,d=(r>=0||s>=0)&&(o>=0||n>=0),u=Math.abs(SCENARIO.editable[l])>0&&Math.abs(SCENARIO.editable[h])>0;d&&u?(SFX.wire.play(),r>=0&&IBOARD.setTile(e,t,CONSTRUCTMAPS.QL1[r]),o>=0&&IBOARD.setTile(e-1,t,CONSTRUCTMAPS.QR1[o])):a<0&&SCENARIO.editable[h]&&IBOARD.setTile(e-1,t,0)}static placeRight(e,t){var i=IBOARD.getTile(e,t),a=IBOARD.getTile(e+1,t),r=CONSTRUCTMAPS.QR0.indexOf(i),s=CONSTRUCTMAPS.QRG.indexOf(i),o=CONSTRUCTMAPS.QL0.indexOf(a),n=CONSTRUCTMAPS.QLG.indexOf(a),l=e+t*FIELD.cols,h=e+1+t*FIELD.cols,d=(r>=0||s>=0)&&(o>=0||n>=0),u=Math.abs(SCENARIO.editable[l])>0&&Math.abs(SCENARIO.editable[h])>0;d&&u?(SFX.wire.play(),r>=0&&IBOARD.setTile(e,t,CONSTRUCTMAPS.QR1[r]),o>=0&&IBOARD.setTile(e+1,t,CONSTRUCTMAPS.QL1[o])):a<0&&SCENARIO.editable[h]&&IBOARD.setTile(e+1,t,0)}static place(){var e=STATE.under.i0-STATE.grab.i0,t=STATE.under.j0-STATE.grab.j0,i=Math.sign(e),a=Math.sign(t);if(i>0){for(var r=STATE.grab.j0,s=STATE.grab.i0,o=0;o<Math.abs(e);o++)RedWire.placeRight(s+o,r);STATE.grab={type:STATE.under.type,i0:s+Math.abs(e),j0:r,k0:s+Math.abs(e)+r*FIELD.cols}}else if(i<0){for(r=STATE.grab.j0,s=STATE.grab.i0,o=0;o<Math.abs(e);o++)RedWire.placeLeft(s-o,r);STATE.grab={type:STATE.under.type,i0:s-Math.abs(e),j0:r,k0:s-Math.abs(e)+r*FIELD.cols}}else if(a>0){for(r=STATE.grab.j0,s=STATE.grab.i0,o=0;o<Math.abs(t);o++)RedWire.placeDown(s,r+o);STATE.grab={type:STATE.under.type,i0:s,j0:r+Math.abs(t),k0:s+(r+Math.abs(t))*FIELD.cols}}else if(a<0){for(r=STATE.grab.j0,s=STATE.grab.i0,o=0;o<Math.abs(t);o++)RedWire.placeUp(s,r-o);STATE.grab={type:STATE.under.type,i0:s,j0:r-Math.abs(t),k0:s+(r-Math.abs(t))*FIELD.cols}}else;}}class Render{static dynamicGatesCheap(e,t,i,a,r=0,s=!1){r||(r=[0,0,e._width,e._height]);var o=e.gateList.length,n=["DarkGoldenRod","GoldenRod"],l=[flashColor("DarkGoldenRod",TIMER.trigRatioDub),flashColor("GoldenRod",TIMER.trigRatioDub)];if(s){var h=["black","#444","#666"],d=i.createRadialGradient(8,8,1,16,16,16);d.addColorStop(0,h[2]),d.addColorStop(.2,h[1]),d.addColorStop(1,h[0])}else d=GRADS.gates;if(TIMER.trigRatioDub<1e-5)var u=d;else if(OPTS.fancyGraphics){h=[flashColor("black",TIMER.trigRatioDub),flashColor("#444",TIMER.trigRatioDub),flashColor("#666",TIMER.trigRatioDub)],u=i.createRadialGradient(8,8,1,16,16,16);u.addColorStop(0,h[2]),u.addColorStop(.2,h[1]),u.addColorStop(1,h[0])}else u=flashColor("black",TIMER.trigRatioDub);for(var c=d,I=0;I<o;I++){var E=e.gateList[I],f=E.j0*e.width+E.i0,S=E.i0>=r[0]&&E.i0<=r[2],p=E.j0>=r[1]&&E.j0<=r[3];if(E.layer===e.state[f]&&S&&p){var T=e.checkWhichControl(E.i0,E.j0),R=e.x0+E.i0*FIELD.tileWidth,m=e.y0+E.j0*FIELD.tileHeight,g={type:E.type,orient:E.orient,rot:E.rot,state:E.state,remaining:-1,counter:E.counter,isControlled:T.dir>=0,ctx:i,counterMax:E.counterMax,cdir:T.dir,talpha:0};if(("qCreate"===E.type||"cCreate"===E.type)&&E.counterMax>=0?g.remaining=E.counterMax-E.counter:"delay"===E.type&&("transform"===E.action?(g.rot=E.state-E.rot-TIMER.trigRatio,g.state=0):"reset"===E.action?(g.rot=E.state*TIMER.trigRatio,g.state=0):"free"===E.action&&(g.rot=E.state,g.state=0)),"sync"===E.type?(Render.resolveSync(e,t,E)>0?g.undercol=l:g.undercol=n,g.basecol=c):"switch"===E.type||"qControl"===E.type?("transform"===E.action||"entangle"===E.action?g.undercol=l:g.undercol=n,g.basecol=c):"compare"===E.action?TIMER.ratio>.5&&(g.state=0):"cCombine"===E.type||"qCombine"===E.type?g.basecol=c:"free"===E.action?g.basecol=c:"transform"===E.action||"pretransform"===E.action||"reset"===E.action?g.basecol=u:g.basecol=c,"switch"===E.type&&1===E.state){var A=t.getGate(E.i0,E.j0),C=E.rot>1,L=A.rot>1;g.talpha=L*TIMER.trigRatio+(1-TIMER.trigRatio)*C}if("switch"===T.type){A=e.getGate(E.i0,E.j0,t.getState(E.i0,E.j0));g=Render.resolveSwitch(i,E,A,g)}else"qControl"===T.type&&("entangle"===T.action?g.basecol=u:g.basecol=c);if(PathsG.make(i,g).draw(i,R,m,FIELD.tileWidth,FIELD.tileHeight),"switch"===E.type&&1===E.state){C=E.rot>1,L=A.rot>1;var D=L*TIMER.trigRatio+(1-TIMER.trigRatio)*C;PathsX.snappersSwitch(a,E.orient+1,R,m,1-D,1)}if("cCreate"===E.type){if("create"===E.action){if(TIMER.ratio>=.5){var b=t.getBit(E.i0,E.j0),O=Paths.bit(i,b.value,TIMER.trigRatioDub,TIMER.glareRatio);O.draw(i,R,m,FIELD.tileWidth,FIELD.tileHeight)}O=Paths.wormholes(a,TIMER.trigRatio);O.draw(a,R,m,FIELD.tileWidth,FIELD.tileHeight)}}else if("qCreate"===E.type){if("create"===E.action){if(TIMER.ratio>=.5){var M=t.getQubit(E.i0,E.j0);if(M){var v=M.computeAlfs(TIMER.blinkRatio);O=Paths.newQubit(i,M.basisRot,TIMER.trigRatioDub,TIMER.glareRatio,0,v[1],M.ampsFinal,[0,M.ampsFinal[0]**2],v);O.draw(i,R,m,FIELD.tileWidth,FIELD.tileHeight)}}O=Paths.wormholes(a,TIMER.trigRatio,1);O.draw(a,R,m,FIELD.tileWidth,FIELD.tileHeight)}}else if("sync"===E.type){if(OPTS.useSnappers){var w=Render.resolveSyncSnappers(e,t,E);PathsX.snappersSync(a,w.snapRot,E.orient%2,w.snapExtend,R,m)}}else if("delay"===E.type){if(OPTS.useSnappers){w=Render.resolveDelay(e,t,E);PathsX.snappersDelay(a,w.snapRot,E.orient%2,w.snapExtend,R,m)}}else if("switch"===E.type){if("transform"===E.action){O=Paths.scannersSmall(a,TIMER.trigRatio,E.orient%2*Math.PI/2);O.draw(a,R,m,FIELD.tileWidth,FIELD.tileHeight)}}else if("qControl"===E.type){if("entangle"===E.action){O=Paths.scannersSmall(a,TIMER.trigRatio,E.rot,1);O.draw(a,R,m,FIELD.tileWidth,FIELD.tileHeight)}}else if("measure"===E.type){if("transform"===E.action){O=Paths.scanners(a,TIMER.trigRatio,E.rot);O.draw(a,R,m,FIELD.tileWidth,FIELD.tileHeight)}}else if("compare"===E.type||"qCompare"===E.type){if("compare"===E.action&&TIMER.ratio>.5){A=t.getGate(E.i0,E.j0);PathsX.flare(a,TIMER.tick,TIMER.ratio,R,m,1===A.counter)}}else if("qDubCompare"===E.type){if("transform"===E.action&&TIMER.ratio>.5){A=t.getGate(E.i0,E.j0);PathsX.flare(a,TIMER.tick,TIMER.ratio,R,m,1===A.counter)}}else if("cOneCompare"===E.type&&"transform"===E.action&&TIMER.ratio>.5){A=t.getGate(E.i0,E.j0);PathsX.flare(a,TIMER.tick,TIMER.ratio,R,m,!0)}}}}static singleGatesCheap(e,t,i,a=-1,r=-1){for(var s=e.gateList.length,o=["DarkGoldenRod","GoldenRod"],n=GRADS.gates,l=(GRADS.flame,0);l<s;l++){var h=e.gateList[l],d=h.j0*e.width+h.i0;if(h.layer===e.state[d]){var u=e.checkWhichControl(h.i0,h.j0),c=e.x0+h.i0*FIELD.tileWidth,I=e.y0+h.j0*FIELD.tileHeight,E={type:h.type,orient:h.orient,rot:h.rot,state:h.state,remaining:-1,counter:h.counter,isControlled:u.dir>=0,undercol:o,basecol:n,ctx:t,counterMax:h.counterMax,cdir:u.dir,talpha:0};("qCreate"===h.type||"cCreate"===h.type)&&h.counterMax>=0&&(E.remaining=h.counterMax-h.counter),"forwardTrans"===STATE.mode&&(E.talpha=TIMER.transRatio),PathsG.make(t,E).draw(t,c,I,FIELD.tileWidth,FIELD.tileHeight);var f=!1;if(h.i0===a&&h.j0===r){f=!0;var S=("gatemanip"===STATE.state||"free"===STATE.state)&&STATE.grab.i0===a&&STATE.grab.j0===r;S&&(f=!1),"free"!==STATE.state&&"gatemanip"!==STATE.state&&"qubiting"!==STATE.state&&(f=!1),SCENARIO.editable[d]<1&&(f=!1)}if(f){var p=1*(1.2+.15*Math.cos(8*Math.PI*TIMER.qubitGlowRatio)),T=Paths.qubitHalo(i);T.draw(i,c-(p-1)/2*FIELD.tileWidth,I-(p-1)/2*FIELD.tileHeight,p*FIELD.tileWidth,p*FIELD.tileHeight)}"switch"===h.type&&1===h.state&&"forwardTrans"===STATE.mode&&PathsX.snappersSwitch(i,h.orient+1,c,I,0,TIMER.transRatio),"forwardTrans"===STATE.mode&&OPTS.useSnappers&&("sync"===h.type?OPTS.useSnappers&&PathsX.snappersSync(i,0,h.orient%2,1,c,I,TIMER.transRatio):"delay"===h.type&&OPTS.useSnappers&&PathsX.snappersDelay(i,0,h.orient%2,1,c,I,TIMER.transRatio))}}}static boardWires(e,t,i=0,a=0,r=!0){a||(a=[0,0,e._width,e._height]);for(var s=[],o=[],n=[],l=0;l<e._height;l++)for(var h=0;h<e._width;h++){var d=l*e._width+h;if(e._tiles[d]>=0){var u=(i-h-l)/6,c=Math.floor(e._tiles[d]/20),I=e._tiles[d]%20,E=!0;0===c?s.push(PathsX.qWire(t,I,u)):1===c?s.push(PathsX.cWire(t,I,u)):5===c?s.push(PathsX.mWire(t,I,u)):40===e._tiles[d]||42===e._tiles[d]?s.push(PathsX.cWire(t,2,u)):41===e._tiles[d]||43===e._tiles[d]?s.push(PathsX.cWire(t,1,u)):70===e._tiles[d]||72===e._tiles[d]?s.push(PathsX.qWire(t,2,u)):71===e._tiles[d]||73===e._tiles[d]?s.push(PathsX.qWire(t,1,u)):E=!1,E&&(o.push(e.x0+h*FIELD.tileWidth),n.push(e.y0+l*FIELD.tileHeight))}}if(RenderLoops.drawWires(t,s,o,n,FIELD.tileWidth,FIELD.tileHeight),r)for(var f=[0,0,18,18,5,13],S=[5,8,5,8,13,13],p=0;p<6;p++)if(SCENARIO.channelsCol[p]){var T=e.x0+f[p]*FIELD.tileWidth,R=e.y0+S[p]*FIELD.tileHeight;u=(i-f[p]-S[p])/6;if(p<2)var m=2;else if(p<4)m=0;else m=1;m*=Math.sign(SCENARIO.channelsCol[p]);var g=PathsX.boardArrow(t,Math.abs(SCENARIO.channelsCol[p]),m,u);RenderLoops.drawSimple(t,g,T,R,FIELD.tileWidth,FIELD.tileHeight)}if(SCENARIO.text0){T=e.x0+(SCENARIO.text0.i0+.5)*FIELD.tileWidth,R=e.y0+(SCENARIO.text0.j0+.5)*FIELD.tileHeight;t.save(),t.textBaseline="middle",t.textAlign="center",t.font=FIELD.tileWidth/3+"px Verdana",t.fillStyle="black",t.fillText(SCENARIO.text0.text,T,R),t.restore()}if(SCENARIO.text1){T=e.x0+(SCENARIO.text1.i0+.5)*FIELD.tileWidth,R=e.y0+(SCENARIO.text1.j0+.5)*FIELD.tileHeight;t.save(),t.textBaseline="middle",t.textAlign="center",t.font=FIELD.tileWidth/3+"px Verdana",t.fillStyle="black",t.fillText(SCENARIO.text1.text,T,R),t.restore()}if(SCENARIO.text2){T=e.x0+(SCENARIO.text2.i0+.5)*FIELD.tileWidth,R=e.y0+(SCENARIO.text2.j0+.5)*FIELD.tileHeight;t.save(),t.textBaseline="middle",t.textAlign="center",t.font=FIELD.tileWidth/3+"px Verdana",t.fillStyle="black",t.fillText(SCENARIO.text2.text,T,R),t.restore()}}static boardDynamic(e,t,i=0,a=[1,1,1]){i||(i=[0,0,e._width,e._height]);var r=a[0],s=a[1],o=a[2],n=CANV.base.ctx,l=CANV.effects.ctx,h=CANV.controls.ctx;if(CANV.base.clear(),CANV.effects.clear(),n.imageSmoothingEnabled=!1,l.imageSmoothingEnabled=!1,h.imageSmoothingEnabled=!1,OPTS.displayBoard)if(0!==e&&0!==t){var d=20,u=(e.width+d)*TIMER.wireRatio;r&&Render.boardWires(e,n,u,i),Render.controlTarget(e,n),s&&Render.dynamicGatesCheap(e,t,n,l,i),o&&Render.dynamicQubits(e,t,n,l,h,i)}else Render.boardSingle(IBOARD)}static boardDynamicTutorial(e,t){var i=[0,0,e._width,e._height],a=1,r=1,s=1,o=CANV.tutorialGates.ctx,n=CANV.tutorialEffects.ctx,l=CANV.tutorialControls.ctx;CANV.tutorialGates.clear(),CANV.tutorialEffects.clear(),CANV.tutorialControls.clear(),a&&Render.boardWires(e,o,0,i),Render.controlTarget(e,o),r&&Render.dynamicGatesCheap(e,t,o,n,i,!0),s&&Render.dynamicQubits(e,t,o,n,l,i)}static boardSingle(e,t=-1,i=-1){CANV.base.clear(),CANV.effects.clear(),TIMER.construct<0&&CANV.controls.clear();var a=CANV.base.ctx,r=CANV.effects.ctx,s=CANV.controls.ctx,o=20,n=(e.width+o)*TIMER.wireRatio;Render.boardWires(e,a,n,0),Render.controlTarget(e,a),Render.singleGatesCheap(e,a,r,t,i),Render.singleQubits(e,a,s)}static boardSingleTutorial(e){var t=CANV.tutorialGates.ctx,i=CANV.tutorialEffects.ctx;CANV.tutorialGates.clear(),CANV.tutorialEffects.clear(),Render.boardWires(e,t,0,0,!1),Render.controlTarget(e,t),Render.singleGatesCheap(e,t,i,TUTORIAL.i0High,TUTORIAL.j0High),Render.singleQubits(e,t)}static singleQubits(e,t,i=0){i||(i=t);for(var a=0;a<e._height;a++)for(var r=0;r<e._width;r++){var s=a*e._width+r;if(e._bits[0][s]){var o=e.x0+r*FIELD.tileWidth,n=e.y0+a*FIELD.tileHeight,l=e._bits[0][s],h=Paths.bit(t,l.value,0,TIMER.glareRatio,1,l.isGhost);h.draw(t,o,n,FIELD.tileWidth,FIELD.tileHeight)}if(e._qubits[s]){o=e.x0+r*FIELD.tileWidth,n=e.y0+a*FIELD.tileHeight;var d=e._qubits[s];if(d.isHovered&&"qubit"===STATE.under.type&&TIMER.construct<0){var u=1+.2*Math.cos(8*Math.PI*TIMER.qubitGlowRatio),c=(h=Paths.qubitHalo(i,this.basisRot,!0,-1),.9*(1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio)));h.draw(i,o-(c-1)/2*FIELD.tileWidth,n-(c-1)/2*FIELD.tileHeight,c*FIELD.tileWidth,c*FIELD.tileHeight)}else u=1;var I=(u-1)/2*FIELD.tileWidth,E=(u-1)/2*FIELD.tileWidth;if(d.entGroup){var f=d.entGroup.id%ENTBLOBS._colors.length,S=2*d.entGroup.id%ENTBLOBS.numBlobs,p=(2*d.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(t,S,f,o,n,1,e._qubits[s].ent),ENTBLOBS.draw(t,p,f,o,n,-1,e._qubits[s].ent)}var T=d.computeAlfs(TIMER.blinkRatio);h=Paths.newQubit(t,d.basisRot,0,TIMER.glareRatio,0,d.arrow(T),d.ampsFinal,d.offsets,T,d.isGhost);h.draw(t,o-I,n-E,u*FIELD.tileWidth,u*FIELD.tileHeight)}}}static dynamicQubits(e,t,i,a,r,s){for(var o=TIMER.ratio,n=TIMER.glareRatioTrig,l=TIMER.trigRatio,h=TIMER.popRatio,d=TIMER.trigRatioDub,u=TIMER.defaultTimePerTick/TIMER.timePerTick,c=[],I=0;I<t._bitList.length;I++)c.push(t._bitList[I].id);var E=[];for(I=0;I<t._qubitList.length;I++)E.push(t._qubitList[I].id);for(var f=s[1];f<s[3];f++)for(var S=s[0];S<s[2];S++){var p=f*e._width+S;if(e._bits[0][p]){var T=e.x0+S*FIELD.tileWidth,R=e.y0+f*FIELD.tileHeight,m=e._bits[0][p];if("freeze"===m.action){var g=Paths.bit(i,m.value,0,n,0);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else if("ghost"===m.action){if(TIMER.ratio<.5){g=Paths.bit(i,m.value,d,n,0);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}else if("move"===m.action||"halt"===m.action){var A=c.indexOf(m.id),C=t._bitList[A],L=m.findNextDir(e),D=C.i0===S&&C.j0===f&&L>=0&&!m.isGhost&&u<3&&"tutorial"!=STATE.mode;if(D){var b=0,O=0;if(0===L)b=-FIELD.tileWidth;else if(1===L)O=-FIELD.tileHeight;else if(2===L)b=FIELD.tileWidth;else if(3===L)O=FIELD.tileHeight;var M=T+.15*l*d*b,v=R+.15*l*d*O}else{var w=e.x0+C.i0*FIELD.tileWidth,N=e.y0+C.j0*FIELD.tileHeight;M=h*w+(1-h)*T,v=h*N+(1-h)*R}
g=Paths.bit(i,m.value,0,n,1,m.isGhost);g.draw(i,M,v,FIELD.tileWidth,FIELD.tileHeight)}else if("transform"===m.action){g=Paths.bit(i,m.value,d,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else if("upgrade"===m.action){A=E.indexOf(m.id);var P=t._qubitList[A];if(o<=.5){g=Paths.bit(i,m.value,d,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else{var y=P.computeAlfs(TIMER.blinkRatio);g=Paths.newQubit(i,P.basisRot,0,n,0,y[1],P.ampsFinal,[0,P.ampsFinal[0]**2],y,P.isGhost);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}else if("flip"===m.action)if(o<=.5){g=Paths.bit(i,m.value,d,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else{g=Paths.bit(i,1-m.value,d,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else if("nullflip"===m.action){g=Paths.bit(i,m.value,0,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else if("delete"===m.action){if(o<.5){g=Paths.bit(i,m.value,d,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else if("tutorial"!==STATE.mode){g=Paths.fireRing(i,l);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}else{g=Paths.bit(i,m.value,0,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}if(e._bits[1][p]){T=e.x0+S*FIELD.tileWidth,R=e.y0+f*FIELD.tileHeight,m=e._bits[1][p];if("ghost"===m.action){if(TIMER.ratio<.5){g=Paths.bit(i,m.value,d,n,0);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}else if("move"===m.action||"halt"===m.action){A=c.indexOf(m.id),C=t._bitList[A],L=m.findNextDir(e),D=C.i0===S&&C.j0===f&&L>=0&&!m.isGhost&&u<3&&"tutorial"!=STATE.mode;if(D){b=0,O=0;if(0===L)b=-FIELD.tileWidth;else if(1===L)O=-FIELD.tileHeight;else if(2===L)b=FIELD.tileWidth;else if(3===L)O=FIELD.tileHeight;M=T+.15*l*d*b,v=R+.15*l*d*O}else w=e.x0+C.i0*FIELD.tileWidth,N=e.y0+C.j0*FIELD.tileHeight,M=h*w+(1-h)*T,v=h*N+(1-h)*R;g=Paths.bit(i,m.value,0,n);g.draw(i,M,v,FIELD.tileWidth,FIELD.tileHeight)}else if("transform"===m.action){g=Paths.bit(i,m.value,d,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else if("freeze"===m.action){g=Paths.bit(i,m.value,0,n,0);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else{g=Paths.bit(i,m.value,0,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}if(e._bits[2][p]){T=e.x0+S*FIELD.tileWidth,R=e.y0+f*FIELD.tileHeight,m=e._bits[2][p];if("move"===m.action||"halt"===m.action){A=c.indexOf(m.id),C=t._bitList[A],L=m.findNextDir(e),D=C.i0===S&&C.j0===f&&L>=0&&!m.isGhost&&u<3&&"tutorial"!=STATE.mode;if(D){b=0,O=0;if(0===L)b=-FIELD.tileWidth;else if(1===L)O=-FIELD.tileHeight;else if(2===L)b=FIELD.tileWidth;else if(3===L)O=FIELD.tileHeight;M=T+.15*l*d*b,v=R+.15*l*d*O}else w=e.x0+C.i0*FIELD.tileWidth,N=e.y0+C.j0*FIELD.tileHeight,M=h*w+(1-h)*T,v=h*N+(1-h)*R;g=Paths.bit(i,m.value,0,n);g.draw(i,M,v,FIELD.tileWidth,FIELD.tileHeight)}else if("transform"===m.action){g=Paths.bit(i,m.value,d,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}else{g=Paths.bit(i,m.value,0,n);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}if(e._qubits[p]){T=e.x0+S*FIELD.tileWidth,R=e.y0+f*FIELD.tileHeight,P=e._qubits[p];if(P.isHovered){var F=1+.2*Math.cos(8*Math.PI*TIMER.qubitGlowRatio),k=(g=Paths.qubitHalo(r,this.basisRot,!0,-1),.9*(1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio)));g.draw(r,T-(k-1)/2*FIELD.tileWidth,R-(k-1)/2*FIELD.tileHeight,k*FIELD.tileWidth,k*FIELD.tileHeight)}else F=1;var x=(F-1)/2*FIELD.tileWidth,B=(F-1)/2*FIELD.tileWidth;if("move"===P.action||"halt"===P.action){A=E.indexOf(P.id);var W=t._qubitList[A];L=P.findNextDir(e),D=W.i0===S&&W.j0===f&&L>=0&&!P.isGhost&&u<3&&"tutorial"!=STATE.mode;if(D){b=0,O=0;if(0===L)b=-FIELD.tileWidth;else if(1===L)O=-FIELD.tileHeight;else if(2===L)b=FIELD.tileWidth;else if(3===L)O=FIELD.tileHeight;M=T+.15*l*d*b,v=R+.15*l*d*O}else w=e.x0+W.i0*FIELD.tileWidth,N=e.y0+W.j0*FIELD.tileHeight,M=h*w+(1-h)*T,v=h*N+(1-h)*R;if(P.entGroup)var q=P.ent;else q=0;if(W.entGroup)var H=W.ent;else H=0;if(q||H){var U=P.entGroup.id%ENTBLOBS._colors.length,_=2*P.entGroup.id%ENTBLOBS.numBlobs,G=(2*P.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,M,v,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,M,v,-1,H*o+q*(1-o))}y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,P.arrow(y),P.ampsFinal,P.offsets,y,P.isGhost);g.draw(i,M-x,v-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else if("disappear"===P.action);else if("qDubCompare"===P.action){if(o<.5){W=t.getQubit(P.i0,P.j0),q=P.entGroup?P.ent:0;if(P.entGroup){U=P.entGroup.id%ENTBLOBS._colors.length,_=2*P.entGroup.id%ENTBLOBS.numBlobs,G=(2*P.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,l,n,0,P.arrow(y),P.ampsFinal,P.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}}else if("freeze"===P.action){var V=1-l;y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,y[1],P.ampsFinal,[0,P.ampsFinal[0]**2],y,P.isGhost,!0,V);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else if("controlled"===P.action){W=t.getQubit(P.i0,P.j0);if(P.entGroup)q=P.ent;else q=0;if(W.entGroup)H=W.ent;else H=0;if(q||H)if(P.entGroup){U=P.entGroup.id%ENTBLOBS._colors.length,_=2*P.entGroup.id%ENTBLOBS.numBlobs,G=(2*P.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}else if(W.entGroup){U=W.entGroup.id%ENTBLOBS._colors.length,_=2*W.entGroup.id%ENTBLOBS.numBlobs,G=(2*W.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}if(o<.5)y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,P.arrow(y),P.ampsFinal,P.offsets,y);else y=W.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,W.basisRot,0,n,0,W.arrow(y),W.ampsFinal,W.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else if("flip"===P.action){W=t.getQubit(P.i0,P.j0);if(P.entGroup)q=P.ent;else q=0;if(W.entGroup)H=W.ent;else H=0;if(q||H)if(P.entGroup){U=P.entGroup.id%ENTBLOBS._colors.length,_=2*P.entGroup.id%ENTBLOBS.numBlobs,G=(2*P.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}else if(W.entGroup){U=W.entGroup.id%ENTBLOBS._colors.length,_=2*W.entGroup.id%ENTBLOBS.numBlobs,G=(2*W.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}A=E.indexOf(P.id),W=t._qubitList[A];var Q=e.getGate(P.i0,P.j0,e.getState(P.i0,P.j0));if(o<.5)y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,{ratio:1-d,rot:Q.rot},P.arrow(y),P.ampsFinal,P.offsets,y);else y=W.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,W.basisRot,0,n,{ratio:1-d,rot:Q.rot},W.arrow(y),W.ampsFinal,W.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else if("rotate"===P.action){W=t.getQubit(P.i0,P.j0);if(P.entGroup)q=P.ent;else q=0;if(W.entGroup)H=W.ent;else H=0;if(q||H)if(P.entGroup){U=P.entGroup.id%ENTBLOBS._colors.length,_=2*P.entGroup.id%ENTBLOBS.numBlobs,G=(2*P.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}else if(W.entGroup){U=W.entGroup.id%ENTBLOBS._colors.length,_=2*W.entGroup.id%ENTBLOBS.numBlobs,G=(2*W.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}var $=e.checkControl(S,f,["qControl"]);if(0===o){y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,P.arrow(y),P.ampsFinal,P.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else if(P.entGroup||$>=0){var z=P.basisRot,j=W.basisRot;z-j>Math.PI&&(j+=2*Math.PI),j-z>Math.PI&&(z+=2*Math.PI);var Y=z+l*(j-z);if(o<=.5){y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,Y,0,n,0,P.arrow(y),P.ampsFinal,P.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else{y=W.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,Y,0,n,0,W.arrow(y),W.ampsFinal,W.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}}else{if(P.lockedBasis){Q=e.getGate(P.i0,P.j0),z=P.basisRot,j=z+Q.rot;z-j>Math.PI&&(j+=2*Math.PI)}else{p=P.j0*e.width+P.i0,Q=e.getGate(P.i0,P.j0,e.state[p]);if(Q.rot>=0){z=P.basisRot;if(Q.state>0)j=W.basisRot;else j=z+Q.rot}else if(Q.rot<0){z=P.basisRot;if(Q.state>0)j=W.basisRot;else j=z+Q.rot}z-j>Math.PI+1e-5&&(j+=2*Math.PI),j-z>Math.PI+1e-5&&(z+=2*Math.PI)}var X=P.copy();X.applyRot(l*(j-z));y=X.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,X.basisRot,0,n,0,y[1],X.ampsFinal,[0,X.ampsFinal[0]**2],y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}}else if("measure"===P.action)if(P.entGroup){if(o<.5){U=P.entGroup.id%ENTBLOBS._colors.length,_=2*P.entGroup.id%ENTBLOBS.numBlobs,G=(2*P.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,P.ent),ENTBLOBS.draw(i,G,U,T,R,-1,P.ent)}W=t.getQubit(P.i0,P.j0);if(o<=.5){y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,P.arrow(y),P.ampsFinal,P.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else{y=W.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,W.basisRot,0,n,0,W.arrow(y),W.ampsFinal,W.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}}else{A=E.indexOf(P.id),W=t._qubitList[A];if(o<=.5){y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,y[1],P.ampsFinal,[0,P.ampsFinal[0]**2],y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else{y=W.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,W.basisRot,0,n,0,y[1],W.ampsFinal,[0,W.ampsFinal[0]**2],y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}}else if("delete"===P.action){if(P.entGroup){if(o<.5){U=P.entGroup.id%ENTBLOBS._colors.length,_=2*P.entGroup.id%ENTBLOBS.numBlobs,G=(2*P.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,(1-o)*P.ent),ENTBLOBS.draw(i,G,U,T,R,-1,(1-o)*P.ent)}if(o<=.5){y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,P.arrow(y),P.ampsFinal,P.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else if("tutorial"!==STATE.mode){g=Paths.fireRing(i,l);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}else if(o<=.5){y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,d,n,0,y[1],P.ampsFinal,[0,P.ampsFinal[0]**2],y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else if("tutorial"!==STATE.mode){g=Paths.fireRing(i,l);g.draw(i,T,R,FIELD.tileWidth,FIELD.tileHeight)}}else if("wait"===P.action){W=t.getQubit(P.i0,P.j0);if(P.entGroup)q=P.ent;else q=0;if(W.entGroup)H=W.ent;else H=0;if(q||H)if(P.entGroup){U=P.entGroup.id%ENTBLOBS._colors.length,_=2*P.entGroup.id%ENTBLOBS.numBlobs,G=(2*P.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}else if(W.entGroup){U=W.entGroup.id%ENTBLOBS._colors.length,_=2*W.entGroup.id%ENTBLOBS.numBlobs,G=(2*W.entGroup.id+1)%ENTBLOBS.numBlobs;ENTBLOBS.draw(i,_,U,T,R,1,H*o+q*(1-o)),ENTBLOBS.draw(i,G,U,T,R,-1,H*o+q*(1-o))}y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,P.arrow(y),P.ampsFinal,P.offsets,y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}else{y=P.computeAlfs(TIMER.blinkRatio),g=Paths.newQubit(i,P.basisRot,0,n,0,y[1],P.ampsFinal,[0,P.ampsFinal[0]**2],y);g.draw(i,T-x,R-B,F*FIELD.tileWidth,F*FIELD.tileHeight)}}}}static resolveSwitch(e,t,i,a){if("cCombine"===t.type||"qCombine"===t.type){a.orient=0;var r=t.orient*Math.PI/2,s=i.orient*Math.PI/2;return r>Math.PI&&(r-=2*Math.PI),s>Math.PI&&(s-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI),s<-Math.PI&&(s+=2*Math.PI),s-r>Math.PI?s-=2*Math.PI:r-s>Math.PI&&(s+=2*Math.PI),a.rot=(1-TIMER.trigRatio)*r+TIMER.trigRatio*s,a}if("rotate"===t.type||"measure"===t.type||"upgrade"===t.type){r=t.rot,s=i.rot;return r>Math.PI&&(r-=2*Math.PI),s>Math.PI&&(s-=2*Math.PI),r<.01-Math.PI&&(r=Math.PI),s<.01-Math.PI&&(s=Math.PI),a.rot=TIMER.trigRatio*s+(1-TIMER.trigRatio)*r,a}if("qFlip"===t.type){if(1===t.state)a.rot=i.rot,a.state=TIMER.trigRatio*i.state+(1-TIMER.trigRatio)*t.state;else if(1===i.state)a.rot=t.rot,a.state=TIMER.trigRatio*i.state+(1-TIMER.trigRatio)*t.state;else{r=t.rot,s=i.rot;r>Math.PI&&(r-=2*Math.PI),s>Math.PI&&(s-=2*Math.PI),a.rot=TIMER.trigRatio*s+(1-TIMER.trigRatio)*r}return a}return"cInvert"===t.type?(a.rot=(1-TIMER.trigRatio)*t.rot+TIMER.trigRatio*i.rot,a):(TIMER.ratio<.5?a.rot=t.rot:a.rot=i.rot,a)}static resolveDelay(e,t,i,a){a=t.getGate(i.i0,i.j0);var r=0,s=0,o=1;return"free"===i.action?"free"===a.action||"transform"===a.action&&(r=TIMER.trigRatio,o=1-TIMER.trigRatio):"transform"===i.action?(r=1,o=0):"reset"===i.action?"free"===a.action?(r=1-TIMER.trigRatio,o=TIMER.trigRatio):"transform"===a.action&&(r=1-TIMER.trigRatioDub,s=1,o=TIMER.trigRatioDub):(r=1,o=0),{snapRot:r,snapExtend:o,orient:s}}static resolveSync(e,t,i){var a=i.i0,r=i.j0,s=a,o=r;0===i.orient?o+=1:1===i.orient?s-=1:2===i.orient?o-=1:3===i.orient&&(s+=1);var n=t.getGate(a,r),l=e.getGate(s,o),h=t.getGate(s,o),d=0;return"pretransform"===i.action?"pretransform"===n.action?d=0:"reset"===n.action&&(d=TIMER.trigRatioDub):"free"===i.action?"pretransform"===l.action?"pretransform"===h.action?d=0:"reset"===h.action&&(d=TIMER.trigRatioDub):"free"===l.action&&(d="pretransform"===n.action||"pretransform"===h.action?0:"reset"===n.action||"reset"===h.action?TIMER.trigRatioDub:0):"reset"===i.action&&(d="reset"===n.action?TIMER.trigRatioDub:("pretransform"===n.action||h.action,0)),d}static resolveSyncSnappers(e,t,i){var a=i.i0,r=i.j0,s=t.getGate(a,r),o=0,n=1;return"free"===i.action?"free"===s.action||("pretransform"===s.action?(o=TIMER.trigRatio,n=1-TIMER.trigRatio):"reset"===s.action&&(o=TIMER.trigRatioDub/2,n=1-TIMER.trigRatioDub/2)):"pretransform"===i.action?"reset"===s.action?(o=1-TIMER.trigRatio,n=TIMER.trigRatio):(o=1,n=0):"reset"===i.action&&("free"===s.action?(o=0,n=1):"pretransform"===s.action?(o=TIMER.trigRatio,n=1-TIMER.trigRatio):"reset"===s.action&&(o=TIMER.trigRatioDub/2,n=1-TIMER.trigRatioDub/2)),{snapRot:o,snapExtend:n}}static controlTarget(e,t){for(var i=["DarkGoldenRod","GoldenRod"],a=[flashColor("DarkGoldenRod",TIMER.trigRatioDub),flashColor("GoldenRod",TIMER.trigRatioDub)],r=0;r<e.gateList.length;r++){var s=e.gateList[r];if("switch"===s.type||"qControl"===s.type&&s.state<2){new Tile("gate",32,32);var o=s.i0,n=s.j0;0===s.orient?n+=1:1===s.orient?o-=1:2===s.orient?n-=1:3===s.orient&&(o+=1);var l=e.x0+o*FIELD.tileWidth,h=e.y0+n*FIELD.tileHeight;if("transform"===s.action||"entangle"===s.action){var d=PathsX.targetRing([],a);RenderLoops.drawSimple(t,d,l,h,FIELD.tileWidth,FIELD.tileHeight)}else{d=PathsX.targetRing([],i);RenderLoops.drawSimple(t,d,l,h,FIELD.tileWidth,FIELD.tileHeight)}}}}}class RenderLoops{static drawWireSingle(e,t,i,a,r,s,o=32,n=32,l=1){e.save(),1!==l&&(e.globalAlpha=l),e.lineCap="round",e.lineJoin="round",e.shadowColor="transparent",e.lineWidth=2,e.shadowBlur=0,e.shadowOffsetX=r/o*2*.3,e.shadowOffsetY=s/n*2*.7,e.setTransform(r/o,0,0,s/n,i,a);for(var h=0;h<t.length;h++)e.shadowColor=t[h].shadowStroke,e.strokeStyle=t[h].stroke,e.stroke(t[h].path);e.restore()}static drawWires(e,t,i,a,r,s,o=32,n=32){e.save(),e.lineCap="round",e.lineJoin="round",e.shadowColor="transparent",e.lineWidth=2,e.shadowBlur=0,e.shadowOffsetX=r/o*2*.3,e.shadowOffsetY=s/n*2*.7;for(var l=0;l<t.length;l++){e.setTransform(r/o,0,0,s/n,i[l],a[l]);for(var h=t[l],d=0;d<h.length;d++)e.shadowColor=h[d].shadowStroke,e.strokeStyle=h[d].stroke,e.stroke(h[d].path)}e.restore()}static drawSimple(e,t,i,a,r,s,o=32,n=32){e.save(),e.lineCap="round",e.lineJoin="round",e.shadowColor="transparent",e.shadowBlur=0,e.shadowOffsetX=r/o*2*.3,e.shadowOffsetY=s/n*2*.7,e.setTransform(r/o,0,0,s/n,i,a);for(var l=0;l<t.length;l++)t[l].shadowStroke?e.shadowColor=t[l].shadowStroke:e.shadowColor="transparent",e.lineWidth=t[l].lineWidth,e.strokeStyle=t[l].stroke,e.stroke(t[l].path);e.restore()}static drawGates(e,t,i,a,r,s,o=32,n=32){e.save(),e.lineJoin="round",e.shadowColor="transparent",e.lineWidth=2,e.shadowBlur=0,e.shadowOffsetX=r/o*2*.3,e.shadowOffsetY=s/n*2*.7,e.setTransform(r/o,0,0,r/o,i,a);for(var l=0;l<t.length;l++)t[l].fill&&(e.fillStyle=t[l].fill,t[l].shadowFill?e.shadowColor=t[l].shadowFill:e.shadowColor="transparent",e.fill(t[l].path)),t[l].stroke&&(e.strokeStyle=t[l].stroke,e.lineWidth=t[l].lineWidth,t[l].shadowStroke?e.shadowColor=t[l].shadowStroke:e.shadowColor="transparent",e.stroke(t[l].path));e.restore()}}class ResetConsts{static resize(e=!1){if(OPTS.autoResize||e){var t=Math.floor(window.innerWidth/31.25),i=Math.floor(window.innerHeight/15.25),a=Math.max(16,Math.min(t,i));return FIELD.defaultWidth=a,a}return FIELD.defaultWidth}static all(){FIELD.leftPad0=FIELD.tileWidth/2,FIELD.topPad0=FIELD.tileHeight/4,FIELD.midPad=0,FIELD.divPad=0,FIELD.leftPad=FIELD.leftPad0,FIELD.topPad=FIELD.topPad0,FIELD.iconWidth=FIELD.tileWidth/3,FIELD.iconHeight=FIELD.tileHeight/3,FIELD.leftMargin=FIELD.tileWidth/2,FIELD.topMargin=FIELD.tileHeight/2,FIELD.tempRows=0,SCENARIO.menuGrey&&(FIELD.tempRows=SCENARIO.menuGrey.length),FIELD.menu={x0:FIELD.leftPad+(FIELD.cols+1)*FIELD.tileWidth+FIELD.midPad,y0:FIELD.topPad,pad:FIELD.tileWidth/4,cols:6,rows:FIELD.tempRows,topPad:FIELD.tileHeight},FIELD.menu2={x0:FIELD.leftPad+(FIELD.cols/2-2)*FIELD.tileWidth,y0:FIELD.topPad+(FIELD.rows-.4)*FIELD.tileHeight},FIELD.iconWidth=FIELD.tileWidth/3,FIELD.iconHeight=FIELD.tileHeight/3,FIELD.menuHeight=FIELD.menu.topPad+(FIELD.tileHeight+FIELD.menu.pad)*(FIELD.menu.rows+1),FIELD.menuWidth=(FIELD.menu.cols+1)*(FIELD.tileWidth+FIELD.menu.pad),FIELD.totWidth=FIELD.leftPad+FIELD.tileWidth*(FIELD.cols+1)+FIELD.midPad+(FIELD.menu.cols+1)*(FIELD.tileWidth+FIELD.menu.pad),FIELD.totHeight=FIELD.topPad+FIELD.tileHeight*(FIELD.rows+1),FIELD.midWidth=FIELD.leftPad+FIELD.tileWidth*(FIELD.cols+1)+FIELD.midPad,FIELD.midHeight=FIELD.topPad+FIELD.menuHeight+FIELD.divPad,FIELD.scoreHeight=FIELD.totHeight-FIELD.midHeight,FIELD.analysisLeft=FIELD.leftPad+FIELD.tileWidth*(FIELD.cols+1)-FIELD.tileWidth/2,FIELD.analysisWidth=FIELD.menuWidth,STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.under={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},INPUTS.mousemove=0,INPUTS.mousedown=0,INPUTS.mouseup=0,INPUTS.wheel=0,INPUTS.keydown=0,INPUTS.resize=0,ANALYSIS.xPad=5/8*FIELD.tileWidth,ANALYSIS.xMid=3*FIELD.tileWidth/4,ANALYSIS.xGap=0*FIELD.tileWidth/3,ANALYSIS.yPad=1*FIELD.tileHeight,ANALYSIS.yGap=2*FIELD.tileHeight/4,ANALYSIS.basisSpace=24*FIELD.tileWidth/48,ANALYSIS.basisSize=2*FIELD.tileWidth/3,ANALYSIS.barSize=2*FIELD.tileWidth,ANALYSIS.barPad=.18*FIELD.tileWidth,ANALYSIS.yMeasure=ANALYSIS.yPad+2*FIELD.tileHeight+2*ANALYSIS.basisSpace+FIELD.tileHeight/4,OVERLAY.scale=48/FIELD.tileWidth*8,OVERLAY.margin=FIELD.tileWidth/3,OVERLAY.border=FIELD.tileWidth/5.5,SCENARIO.xPad=7*FIELD.tileWidth/8,SCENARIO.yPad=7*FIELD.tileHeight/8,SCENARIO.yPad2=8*FIELD.tileHeight/16,SCENARIO.scoreWidth=6.4*FIELD.tileWidth,SCENARIO.finishedHeight=2*FIELD.tileHeight,SCENARIO.scoreHeight=SCENARIO.scoreHeightRaw*FIELD.tileHeight,SEL_STYLES.iconWidth=FIELD.iconWidth,SEL_STYLES.handleRad=FIELD.tileWidth/9,SEL_STYLES.r0=.85*FIELD.tileHeight,Canvs.deactivateAll(CANV),CANV.interface.activate(),CANV.base.activate(),CANV.baseWires.activate(),CANV.effects.activate(),CANV.controls.activate(),CANV.blueprint.activate(),CANV.letterButton.activate(),CANV.overlay.activate(),CANV.overlayLeft.activate(),CANV.overlayRight.activate(),CANV.overlayBottom.activate(),CANV.FPS.activate(),CANV.debug.activate(),CANV.tooltip.activate(),CANV.ticker.activate(),CANV.victoryText.activate(),CANV.victoryBase.activate(),CANV.menu2.activate(),CANV.analysisOverlay.activate(),CANV.analysis.activate(),CANV.menuText.activate(),CANV.scenario.activate(),CANV.scenarioMask.activate(),CANV.menuOverlay.activate(),CANV.scenarioOverlay.activate(),CANV.score.activate(),CANV.scoreBase.activate(),CANV.menu.activate(),CANV.menuBack.activate(),CANV.archive.activate(),CANV.journal.activate(),CANV.toggles.activate(),CANV.undos.activate(),CANV.menuEraser.activate(),Helper.drawToggles(),Svgs.deactivateAll(SVG),SVG.board.activate(),SVG.menu.activate(),SVG.analysis.activate(),SVG.analysis.svg.style.width=0,CTRLMENU.reset(CANV.menu2),CTRLMENU.drawControl(CANV.menu2),PopWindow.setText(),PopWindow.reset()}static title(){FIELD.leftPad0=FIELD.tileWidth/4,FIELD.topPad0=FIELD.tileHeight/8,FIELD.leftPad=FIELD.tileWidth/4,FIELD.topPad=FIELD.tileHeight/8,FIELD.leftMargin=FIELD.tileWidth/4,FIELD.topMargin=FIELD.tileHeight/4,FIELD.totWidth=10*FIELD.tileWidth+35*FIELD.tileWidth/8,FIELD.totHeight=15*FIELD.tileHeight/2,Canvs.deactivateAll(CANV),CANV.interface.activate(),CANV.title.activate(),CANV.titleAbout.activate(),CANV.titleText.activate(),CANV.titleLearn.activate(),CANV.underlay.activate(),CANV.effects.activate(),CANV.base.activate(),CANV.overlay.activate(),CANV.FPS.activate(),CANV.debug.activate(),CANV.toggles.activate(),Helper.drawToggles(),Svgs.deactivateAll(SVG),SVG.title.activate(),FIELD.showTitleMenu&&(SVG.chromeicon.activate(),SVG.edgeicon.activate(),SVG.braveicon.activate(),SVG.operaicon.activate(),SVG.fireicon.activate(),SVG.safariicon.activate()),OVERLAY.scale=48/FIELD.tileWidth*16,OVERLAY.margin=FIELD.tileWidth/6,OVERLAY.marginInner=FIELD.tileWidth/3,OVERLAY.border=FIELD.tileWidth/11,INPUTS.mousemove=0,INPUTS.mousedown=0,INPUTS.mouseup=0,INPUTS.wheel=0,INPUTS.keydown=0,INPUTS.resize=0,Overlay.createTitle(CANV.overlay.ctx),Overlay.createUnderTitle(CANV.underlay.ctx),Overlay.createTitleOptions(CANV.titleAbout.ctx),TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.visibility="visible"}static tutorial(){for(TUTORIAL.leftPad=6*FIELD.tileWidth,TUTORIAL.topPad=1*FIELD.tileHeight/2,TUTORIAL.boxHeight=5*FIELD.tileHeight,TUTORIAL.boxWidth=9*FIELD.tileHeight,TUTORIAL.margin=FIELD.tileWidth/4,SCENARIO.text0=0,SCENARIO.text1=0,SCENARIO.text2=0,CANV.tutorialBase.activate(),CANV.tutorialExtra.activate(),CANV.tutorialGates.activate(),CANV.tutorialEffects.activate(),CANV.tutorialControls.activate(),CANV.tutorialHeader.activate(),SVG.tutorialB.deactivate(),SVG.tutorial.activate(),SVG.tutorial.svg.style.zIndex="29",CANV.interface.clear(),document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible";UBOARD.length>2;)UBOARD.pop();INPUTS.mousemove=0,INPUTS.mousedown=0,INPUTS.mouseup=0,INPUTS.wheel=0,INPUTS.keydown=0,INPUTS.resize=0,FIELD.cameraX=-1*FIELD.tileWidth,FIELD.cameraY=-1*FIELD.tileHeight,STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},PERSIST0[SCENARIO.name].briefed=!0,TutsOpen(),Timer.initTutorial(),Overlay.createTutorial(CANV.tutorialBase.ctx,CANV.tutorialControls.ctx)}static robot(e=1,t=!0){if(ROBOT.lipMove=!0,ROBOT.lipMax=1,ROBOT.bob=.5+Math.random(),ROBOT.isDone=!1,FIELD.disableBriefs&&!FIELD.forced)return STATE.mode=ROBOT.oldMode,!1;if(FIELD.forced=!1,("constructing"===ROBOT.oldMode||"finished"===ROBOT.oldMode)&&!RobotSpeech.grab(SCENARIO.name,0,!0))return STATE.mode=ROBOT.oldMode,!1;"levelSelect"===ROBOT.oldMode?ROBOT.leftPad=1.3*FIELD.tileWidth:ROBOT.leftPad=.5*FIELD.tileWidth,ROBOT.topPad=10*FIELD.tileHeight/2,ROBOT.margin=3*FIELD.tileWidth/4,ROBOT.screenW=3*FIELD.tileWidth,ROBOT.screenH=5*FIELD.tileWidth,ROBOT.viewH=3*FIELD.tileWidth,ROBOT.textW=14*FIELD.tileHeight,ROBOT.screenGap=FIELD.tileWidth,ROBOT.lineGap=.6*FIELD.tileWidth,ROBOT.paraGap=SCENARIO.yPad,ROBOT.height=2*ROBOT.margin+ROBOT.screenH+1.5*FIELD.tileHeight,ROBOT.width=2.5*ROBOT.margin+ROBOT.screenGap+ROBOT.textW+ROBOT.screenW,CANV.robotBase.activate(),CANV.robotScreen.activate(),CANV.robotScreenBase.activate(),CANV.robotText.activate(),CANV.robotButton.activate();var i=!1;if(SCENARIO.archive&&"finished"===ROBOT.oldMode&&(i=!0),Overlay.createRobot(CANV.robotBase.ctx,i),Overlay.createRobotScreen(CANV.robotScreenBase.ctx),INPUTS.mousemove=0,INPUTS.mousedown=0,INPUTS.mouseup=0,INPUTS.wheel=0,INPUTS.keydown=0,INPUTS.resize=0,STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},CANV.robotText.ctx.font=1.2/3*FIELD.tileWidth+"px Courier New",CANV.robotText.ctx.textBaseline="top",CANV.robotText.ctx.textAlign="left",CANV.robotText.ctx.shadowBlur=2,CANV.robotText.ctx.shadowOffsetX=2,CANV.robotText.ctx.shadowOffsetY=2,CANV.robotText.ctx.shadowColor="black",CANV.robotText.ctx.fillStyle="antiquewhite",CANV.robotText.clear(),RTIMER.pageTime&&TextParser.draw(CANV.robotText.ctx,0,0,ROBOT.lineGap,RTIMER.pageTime/RTIMER.charTime,ROBOT.lines,ROBOT.lineTime,ROBOT.wordTime,ROBOT.paraGaps),!t)return!0;if(Timer.initRobot(),"levelSelect"===ROBOT.oldMode)TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible",ROBOT.currSpeech=0,ROBOT.currName="intro"+String(e),RobotSpeech.grab(ROBOT.currName,ROBOT.currSpeech);else if("constructing"===ROBOT.oldMode)TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible",RobotSpeech.grab(SCENARIO.name,0);else if("finished"===ROBOT.oldMode)if(SCENARIO.starred){var a=RobotSpeech.grab(SCENARIO.name,2,!0);a?RobotSpeech.grab(SCENARIO.name,2):RobotSpeech.grab(SCENARIO.name,1)}else RobotSpeech.grab(SCENARIO.name,1);return!0}static levelSelect(){TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.visibility="visible",FIELD.leftPad0=FIELD.tileWidth/4,FIELD.topPad0=FIELD.tileHeight/8,FIELD.leftPad=FIELD.tileWidth/4,FIELD.topPad=FIELD.tileHeight/8,FIELD.leftMargin=FIELD.tileWidth/4,FIELD.topMargin=FIELD.tileHeight/4,FIELD.totWidth=31*FIELD.tileWidth,FIELD.totHeight=15*FIELD.tileHeight,FIELD.selBoxW=8.5*FIELD.tileWidth,FIELD.selBoxH=13*FIELD.tileHeight,FIELD.selBoxM=FIELD.tileWidth/2,Canvs.deactivateAll(CANV),CANV.selectAward.activate(),CANV.selectOverlay.activate(),CANV.select.activate(),CANV.selectBase.activate(),CANV.selectText.activate(),CANV.selectButtons.activate(),CANV.debug.activate(),CANV.FPS.activate(),CANV.interface.activate(),CANV.toggles.activate(),Helper.drawToggles(),Svgs.deactivateAll(SVG),SVG.select.activate(),OVERLAY.scale=48/FIELD.tileWidth*8,OVERLAY.margin=FIELD.tileWidth/3,OVERLAY.border=FIELD.tileWidth/5.5,SCENARIO.yPad=7*FIELD.tileHeight/8,SCENARIO.yPad2=8*FIELD.tileHeight/16,INPUTS.mousemove=0,INPUTS.mousedown=0,INPUTS.mouseup=0,INPUTS.wheel=0,INPUTS.keydown=0,INPUTS.resize=0,STATE.selected={type:"none",i0:-1,j0:-1,k0:-1},STATE.under={type:"none",i0:-1,j0:-1,k0:-1},STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},Overlay.createSelect(CANV.selectOverlay.ctx),TIMER.timePerTick=1500,SELECTOR.unlockCheck(),SELECTOR.initialize(),SELECTOR.drawBase(CANV.selectBase),SELECTOR.draw(CANV.select,CANV.selectText),SELECTOR.drawText(CANV.selectText),PopWindow.reset(),POPWINDOW.movableWindow.style.display="none",POPWINDOW.isOpen=!1,POPWINDOW.isHover=0;for(var e=[1,2,3,6,8],t=0;t<e.length;t++){var i=LEVELS.unlocked[e[t]],a=FIELD.availableBriefs[t];if(i&&!a)return FIELD.availableBriefs[t]=1,void(FIELD.neededBrief=t)}if(FIELD.totComplete>=LEVELS.numStandard-5){if(!FIELD.availableBriefs[5])return FIELD.availableBriefs[5]=1,void(FIELD.neededBrief=5)}else FIELD.availableBriefs[5]=0;if(FIELD.totComplete+FIELD.totStar===2*LEVELS.numStandard){if(!FIELD.availableBriefs[6])return FIELD.availableBriefs[6]=1,void(FIELD.neededBrief=6)}else FIELD.availableBriefs[6]=0;FIELD.neededBrief=-1}static refresh(){var e="constructing"===STATE.mode;Ticker.draw(CANV.ticker,FIELD.tileWidth/6,-FIELD.tileWidth/6,2*FIELD.tileWidth/3,4*FIELD.tileWidth/3,e),FIELD.menu.rows=SCENARIO.menuGrey.length,CANV.menu.clear(),CANV.menuText.clear(),Menu.resize(),"constructing"===STATE.mode?MENU.closure=Math.max(0,Math.min(1,(TIMER.construct-.2*TIMER.constructMax)/(.8*TIMER.constructMax)))**2:MENU.closure=1,MENU.draw(CANV.menu,CANV.menuText);for(var t=MENU.buttons.length,i=0;i<t;i++){var a=MENU.buttons[i];a.isGrey=SCENARIO.menuGrey[a.j0][a.i0]}Overlay.createRightGrill(CANV.overlayRight.ctx),Overlay.createLeftGrill(CANV.overlayLeft.ctx),Overlay.createBottomGrill(CANV.overlayBottom.ctx),Overlay.create(CANV.overlay.ctx),Overlay.createAnalysis(CANV.analysisOverlay.ctx,CANV.analysisOverlay.w0,CANV.analysisOverlay.h0),Overlay.createMenu(CANV.menuOverlay.ctx,CANV.menuOverlay.w0,CANV.menuOverlay.h0,CANV.menuBack.ctx,CANV.menuBack.w0,CANV.menuBack.h0),Overlay.createInstruct(CANV.scenarioOverlay.ctx,CANV.scenarioOverlay.w0,CANV.scenarioOverlay.h0),Overlay.createScenarioNew(CANV.scenario.ctx,CANV.scenario.w0,CANV.scenario.h0),Overlay.createInstruct(CANV.scenarioMask.ctx,CANV.scenarioMask.w0,CANV.scenarioMask.h0,!0),Tooltip.draw(),CANV.menu2.clear(),CTRLMENU.drawControl(CANV.menu2),Score.drawBase(CANV.scoreBase,!0),Score.draw(CANV.score,CANV.menuText),CANV.baseWires.clear(),"constructing"===STATE.mode?CANV.baseWires.clear():Render.boardWires(IBOARD,CANV.baseWires.ctx),POPWINDOW.isOpen&&(POPWINDOW.movableWindow.style.display="block"),Blueprint.draw()}static translate(){var e=FIELD.menu.cols,t=FIELD.menu.rows;FIELD.menu={x0:FIELD.leftPad+(FIELD.cols+1)*FIELD.tileWidth+FIELD.midPad,y0:FIELD.topPad,pad:FIELD.tileWidth/4,cols:e,rows:t,topPad:FIELD.tileHeight},FIELD.menu2={x0:FIELD.leftPad+(FIELD.cols/2-2)*FIELD.tileWidth,y0:FIELD.topPad+(FIELD.rows-.4)*FIELD.tileHeight},FIELD.totWidth=FIELD.leftPad+FIELD.tileWidth*(FIELD.cols+1)+FIELD.midPad+(FIELD.menu.cols+1)*(FIELD.tileWidth+FIELD.menu.pad),FIELD.totHeight=FIELD.topPad+FIELD.tileHeight*(FIELD.rows+1),FIELD.midWidth=FIELD.leftPad+FIELD.tileWidth*(FIELD.cols+1)+FIELD.midPad,FIELD.midHeight=FIELD.topPad+FIELD.menuHeight+FIELD.divPad,FIELD.scoreHeight=FIELD.totHeight-FIELD.midHeight,FIELD.analysisLeft=FIELD.leftPad+FIELD.tileWidth*(FIELD.cols+1)-FIELD.tileWidth/2,FIELD.analysisWidth=FIELD.menuWidth,Canvs.translateAll(CANV),Svgs.translateAll(SVG)}}class Robot{static draw(e,t,i,a,r,s){"levelSelect"===ROBOT.oldMode?Robot.drawWoman(e,t,i,a,r,s):Robot.drawMan(e,t,i,a,r,s)}static drawWoman(e,t,i,a,r,s){r=2*r**2-1,ROBOT.isDone&&r+1<.1&&(ROBOT.lipMove=!1),ROBOT.lipMove||(r=.1*r-.9),Math.abs(i)<.1&&(ROBOT.lipMove?ROBOT.bob=1.75*Math.random():ROBOT.bob=1*Math.random());var o=.25*ROBOT.bob*i;e.save(),e.strokeStyle="teal",e.fillStyle="teal",e.lineCap="round",e.lineJoin="round",e.lineWidth=.2,e.shadowBlur=6,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowColor="teal",e.scale(t,t);var n=4,l=8,h=8,d=5,u=5,c=7,I=.2*Math.PI;e.beginPath(),e.ellipse(l,h,d,u,0,0,2*Math.PI),Robot.shadowStroke(e,n),e.beginPath(),e.moveTo(l-.7*d,h+2*u),e.quadraticCurveTo(l-1*d,h+1.2*u,l-.5*d,h+.9*u),e.moveTo(l+.7*d,h+2*u),e.quadraticCurveTo(l+1*d,h+1.2*u,l+.5*d,h+.9*u),e.moveTo(l+.2*d,h+u),e.lineTo(l-.2*d,h+u+.2*u),e.lineTo(l-.2*d,h+2*u),e.moveTo(l-.3*d,h+u-.02*u),e.lineTo(l-.05*d,h+u+.13*u),Robot.shadowStroke(e,n),e.beginPath(),e.ellipse(l,h+1.3*u,.3,.3,0,0,2*Math.PI),Robot.shadowStroke(e,n);var E=5*Math.sin(.075*Math.PI+.3*o),f=5*Math.sin(.075*Math.PI-.3*o);e.beginPath(),e.moveTo(l-E,h+.55*u),e.lineTo(l-E,h+.45*u),e.lineTo(l+f,h+.45*u),e.lineTo(l+f,h+.55*u),e.quadraticCurveTo(l-5*Math.sin(.3*o),h+.55*u+.4*r+1.2,l-E,h+.55*u),Robot.shadowStroke(e,n);var S=5*Math.sin(.1*Math.PI+.3*o);Robot.shadowStrokePath(e,n,Helper.roundRect(l-S-.65,h-.4,1.3,1.3,.4)),e.beginPath(),e.ellipse(l-S+.1,h+.1,.4,.4,0,Math.PI,1.5*Math.PI),Robot.shadowStroke(e,n),e.beginPath();S=5*Math.sin(.1*Math.PI-.3*o);Robot.shadowStrokePath(e,n,Helper.roundRect(l+S-.65,h-.4,1.3,1.3,.4)),e.beginPath(),e.ellipse(l+S+.1,h+.1,.4,.4,0,Math.PI,1.5*Math.PI),Robot.shadowStroke(e,n),e.beginPath(),e.moveTo(l+.95*d,c),e.lineTo(l+5*Math.sin(I-.3*o+.45),c),e.lineTo(l+5*Math.sin(I-.3*o+.45),c+.9*u),e.lineTo(l+5*Math.sin(I-.3*o),c+1.15*u),e.lineTo(l+5*Math.sin(I-.3*o),c),e.lineTo(l-5*Math.sin(I+.3*o),c),e.lineTo(l-5*Math.sin(I+.3*o),c+1.15*u),e.lineTo(l-5*Math.sin(I+.3*o+.45),c+.9*u),e.lineTo(l-5*Math.sin(I+.3*o+.45),c),e.lineTo(l-.95*d,c),Robot.shadowStroke(e,n);var p=[.8,.7,.6,.5,.4,.3,.2,.1,0,-.1,-.2,-.3,-.4,-.5,-.6,-.7,-.8];e.beginPath();for(var T=0;T<p.length;T++){S=5*Math.sin(1.5*p[T]+.3*o);e.moveTo(l-S,c),e.quadraticCurveTo(l-S,h-.9*u,l,h-u)}S=5*Math.sin(1.5*p[2]+.3*o);e.moveTo(l-S,c),e.lineTo(l-S,c+.95*u);S=5*Math.sin(1.5*p[3]+.3*o);e.moveTo(l-S,c),e.lineTo(l-S,c+1.05*u);S=5*Math.sin(1.5*p[13]+.3*o);e.moveTo(l-S,c),e.lineTo(l-S,c+1.05*u)
;S=5*Math.sin(1.5*p[14]+.3*o);e.moveTo(l-S,c),e.lineTo(l-S,c+.95*u),e.stroke(),e.beginPath(),e.ellipse(l,h-u,d/2-.3*o,u/4,0,.9*Math.PI,2.1*Math.PI),Robot.shadowStroke(e,n),e.restore()}static drawMan(e,t,i,a,r,s){Math.abs(i)<.1&&(ROBOT.lipMove?ROBOT.bob=1.75*Math.random():ROBOT.bob=1*Math.random());var o=.25*ROBOT.bob*i;e.save(),e.strokeStyle="teal",e.fillStyle="teal",e.lineCap="round",e.lineJoin="round",e.lineWidth=.2,e.shadowBlur=6,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowColor="teal",e.scale(t,t);var n=4,l=8,h=8,d=5,u=4;e.beginPath(),e.ellipse(l,h,d,u,0,0,2*Math.PI),Robot.shadowStroke(e,n);var c=.15*Math.PI,I=-.1*Math.PI;e.beginPath(),e.ellipse(l+5*Math.sin(c+.3*o),h+5*Math.sin(I),.8*Math.cos(0*c+0*o),Math.cos(I),0,0,2*Math.PI),Robot.shadowStroke(e,n),e.beginPath(),e.ellipse(l+5*Math.sin(c+.3*o),h+5*Math.sin(I),.48*Math.cos(0*c+0*o),.6*Math.cos(I),0,Math.PI,1.5*Math.PI),e.stroke(),e.beginPath(),e.ellipse(l+5*Math.sin(.3*o-c),h+5*Math.sin(I),.8*Math.cos(0*c+0*o),Math.cos(I),0,0,2*Math.PI),Robot.shadowStroke(e,n),e.beginPath(),e.ellipse(l+5*Math.sin(.3*o-c),h+5*Math.sin(I),.48*Math.cos(0*c+0*o),.6*Math.cos(I),0,Math.PI,1.5*Math.PI),e.stroke(),e.beginPath(),e.moveTo(l-1*d,h+2*u),e.quadraticCurveTo(l-1*d,h+1.2*u,l-.5*d,h+.9*u),e.moveTo(l+1*d,h+2*u),e.quadraticCurveTo(l+1*d,h+1.2*u,l+.5*d,h+.9*u),e.moveTo(l,h+u),e.ellipse(l,h+u,.2*d,.2*d,0,0*Math.PI,1*Math.PI),e.moveTo(l-.1*d,h+1.2*u),e.lineTo(l-.2*d,h+2*u),e.moveTo(l+.1*d,h+1.2*u),e.lineTo(l+.2*d,h+2*u),Robot.shadowStroke(e,n),e.beginPath(),e.ellipse(8+5*Math.sin(.3*o),7,.8*Math.cos(.3*o),1,0,0,1*Math.PI,!1),Robot.shadowStroke(e,n),ROBOT.isDone&&r+1<.1&&(ROBOT.lipMove=!1),ROBOT.lipMove||(r=.1*r-.9);var E=.4*r**2,f=.15*(1-r**2),S=[[.1,.3+f,.2+f/2,.1,0,-.1,-.2-f/2,-.3-f,-.1,.1],[.05,.15+f/2],[0,0],[-.05,-.15-f/2]],p=[[8.5,9.5+E,9.2+E,9.6+E,9.3+E,9.6+E,9.2+E,9.5+E,8.5,8.5],[8.5,9.2+E],[8.5,9.3+E],[8.5,9.2+E]];Robot.pathStroke(e,o,n,S,p),e.restore()}static pathStroke(e,t,i,a,r){for(var s=0;s<a.length;s++){e.beginPath(),e.moveTo(8+5*Math.sin(a[s][0]+.3*t),r[s][0]);for(var o=1;o<a[s].length;o++)e.lineTo(8+5*Math.sin(a[s][o]+.3*t),r[s][o]);Robot.shadowStroke(e,i)}}static shadowFill(e,t){e.shadowOffsetX=0,e.shadowOffsetY=0,e.fill(),e.shadowOffsetX=-t,e.shadowOffsetY=-t,e.fill(),e.shadowOffsetX=t,e.shadowOffsetY=t,e.fill(),e.shadowOffsetX=-t,e.shadowOffsetY=t,e.fill(),e.shadowOffsetX=t,e.shadowOffsetY=-t,e.fill()}static shadowStroke(e,t){e.shadowOffsetX=0,e.shadowOffsetY=0,e.stroke(),e.shadowOffsetX=-t,e.shadowOffsetY=-t,e.stroke(),e.shadowOffsetX=t,e.shadowOffsetY=t,e.stroke(),e.shadowOffsetX=-t,e.shadowOffsetY=t,e.stroke(),e.shadowOffsetX=t,e.shadowOffsetY=-t,e.stroke()}static shadowStrokePath(e,t,i){e.shadowOffsetX=0,e.shadowOffsetY=0,e.stroke(i),e.shadowOffsetX=-t,e.shadowOffsetY=-t,e.stroke(i),e.shadowOffsetX=t,e.shadowOffsetY=t,e.stroke(i),e.shadowOffsetX=-t,e.shadowOffsetY=t,e.stroke(i),e.shadowOffsetX=t,e.shadowOffsetY=-t,e.stroke(i)}static drawButton(){CANV.robotButton.clear();var e=CANV.robotButton.ctx;if("robbutton"===STATE.under.type){var t=FIELD.tileWidth;if(0===STATE.under.i0)var i=ROBOT.width/2-1.75*t,a=[i,i+.9*t,i+3.5*t-.9*t,i+3.5*t],r=[t/4,3*t/2,3*t/2,t/4],s=[t/4,t/4,t/4,t/4],o=new Path2D(Helper.makeRoundedPath(a,r,s,1,0,0));else i=ROBOT.width-t/24-6*FIELD.tileWidth+t/4,a=[i,i+.9*t,i+5.5*t-.9*t,i+5.5*t],r=[t/4,3*t/2,3*t/2,t/4],s=[t/4,t/4,t/4,t/4],o=new Path2D(Helper.makeRoundedPath(a,r,s,1,0,0));e.save(),e.globalAlpha=.3,e.fillStyle="grey",e.fill(o),e.restore()}e.save(),e.fillStyle="antiqueWhite",e.textBaseline="middle",e.textAlign="center",e.shadowBlur=2,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="black",e.font=1.2/3*FIELD.tileWidth+"px Courier New",e.fillText("(space)",ROBOT.width/2,1.1*FIELD.tileWidth);var n="Next";if("finished"===ROBOT.oldMode&&ROBOT.isDone&&(n="Return"),e.font=(1.1+.1*RTIMER.pulse)*(1.2/3)*FIELD.tileWidth+"px Courier New",e.fillText(n,ROBOT.width/2,.65*FIELD.tileWidth),"finished"===ROBOT.oldMode&&SCENARIO.archive){e.font=1.2/3*FIELD.tileWidth+"px Courier New",e.fillText("(external link)",ROBOT.width-3*FIELD.tileWidth,1.1*FIELD.tileWidth);n="Historical Archive";e.font=1.2/3*FIELD.tileWidth+"px Courier New",e.fillText(n,ROBOT.width-3*FIELD.tileWidth,.65*FIELD.tileWidth)}e.restore()}}class RobotSpeech{static advanceText(){if(ROBOT.isDone){if(ROBOT.lipMove=!0,ROBOT.currSpeech+=1,"constructing"===ROBOT.oldMode)return void Helper.esc();if("finished"===ROBOT.oldMode)return Helper.esc(),void Helper.esc();var e=RobotSpeech.grab(ROBOT.currName,ROBOT.currSpeech,!0);e?(SFX.click.play(),RobotSpeech.grab(ROBOT.currName,ROBOT.currSpeech)):Helper.esc()}else SFX.click.play(),RTIMER.pageTime=1+ROBOT.totTime*RTIMER.charTime,CANV.robotText.clear(),TextParser.draw(CANV.robotText.ctx,0,0,ROBOT.lineGap,RTIMER.pageTime/RTIMER.charTime,ROBOT.lines,ROBOT.lineTime,ROBOT.wordTime,ROBOT.paraGaps),ROBOT.isDone=!0}static analyze(e){for(var t=[],i=[],a=0,r=0;r<e.length;r++){var s=TextParser.box(CANV.robotText.ctx,e[r],ROBOT.textW);a+=s.length;for(var o=0;o<s.length;o++)i.push(0),t.push(s[o]);i[a-1]=1}ROBOT.paraGaps=i,ROBOT.lines=t;var n=TextParser.process(ROBOT.lines);ROBOT.lineTime=n.line,ROBOT.wordTime=n.word;var l=0;for(r=0;r<ROBOT.lineTime.length;r++)l+=ROBOT.lineTime[r];ROBOT.totTime=l,ROBOT.isDone=!1,RTIMER.pageTime=-300}static grab(e,t,i=!1,a=!1){var r=[];return"intro0"===e?0===t?(r.push('"Welcome to The Qubit Factory, [new employee $$r10r:#'+PERSIST0.generic.nameTag+'| ].  It is my function to guide you through the onboarding process."'),r.push('"Here at The Qubit Factory we pride ourselves on creating only the $$b40r:finest| , $$b40r:old-fashioned| , $$b40r:robo-articulated qubits. We are sure that your unique talents and skills will enable you to provide quality service for our customers and add value to our brand."')):1===t&&r.push('"I have assigned a series of commencement tasks to you. Please complete promptly in order to avoid $$r40r:cognitive $$r40r:reformatting| ."'):"intro1"===e?0===t?r.push('"Congratulations [new employee $$r10r:#'+PERSIST0.generic.nameTag+'| ] on completion of the commencement tasks. We hope that you are beginning to feel like a part of our corporate family."'):1===t&&(r.push('"Your success has not only warranted your continued employment, but also greater autonomy. You will no longer have direct supervision on every task and may choose in what order tasks are completed."'),r.push('"However, usage of our patented $$r40r:quantum $$r40r:technology will remain off limits until you have demonstrated appreciable competency with our $$b40r:classical $$b40r:technology first."')):"intro2"===e?0===t?(r.push('"Good job, [novice employee $$r10r:#'+PERSIST0.generic.nameTag+'| ]. My records indicate that you have passed your next completion milestone. You should now feel comfortable with the basics of $$b40r:classical $$b40r:technology| ."'),r.push('"You may now either continue with more advanced tasks in $$b40r:classical $$b40r:technology or you may proceed with introductory tasks in $$r40r:quantum $$r40r:technology| ."')):1===t&&(r.push('"While the choice is yours, my recommendation is to continue with the $$b40r:classical $$b40r:technology tasks, as the skills learned therein will serve you well in your future endeavors."'),r.push('"[Friendly reminder: all acquired skills remain the sole property of The Qubit Factory and will be reclaimed upon employee departure]."')):"intro3"===e?0===t?(r.push('"Congratulations [seasoned employee $$r10r:#'+PERSIST0.generic.nameTag+'| ] on satisfactory completion of the introductory tasks in $$r40r:quantum $$r40r:technology| ."'),r.push('"You should now be familiar with the fundamentals of $$r40r:qubits and their manipulation using $$r40r:quantum $$r40r:gates| . Accordingly, we have now granted you access to more sophisticated quantum production lines."')):1===t&&(r.push('"While your performance thus far has been commendable, we must caution you that the tasks going forward will exhibit a significant increase in difficulty, such that we expect a corresponding rise in employee task malfunction."'),r.push('"Please temper your self-confidence protocols accordingly."')):"intro4"===e?0===t?(r.push('"Well done, [veteran employee $$r10r:#'+PERSIST0.generic.nameTag+'| ], you have come a long way indeed!"'),r.push('"My records indicate that you demonstrated an exceptionally high degree of competency with both $$b40r:classical and $$r40r:quantum technology. It is thus that you have now been granted access to the most advanced production lines in the factory."')):1===t&&(r.push('"Few have risen to this level of achievement. Fewer still will rise further."'),r.push('"I shall follow your progress with great anticipation."')):"intro5"===e?0===t?(r.push('"Congratulations, [senior employee $$r10r:#'+PERSIST0.generic.nameTag+'| ]. My records indicate that you have completed a majority of the available tasks to a satisfactory level."'),r.push('"Your design contributions have facilitated a substantial increase in factory output as well as customer satisfaction with our product. We have adjusted your status designation and compensation accordingly."')):1===t&&(r.push('"However, while your design output thus far has been extraordinary, take note that many challenges are still available to you. Completion of these remaining challenges would signify true mastery of quantum machinery and quantum protocol."'),r.push('"We hope that you will continue in producing and refining sophisticated factory designs."')):"intro6"===e?0===t?(r.push('"Astounding! Records indicate that you, [sovereign employee $$r10r:#'+PERSIST0.generic.nameTag+'| ], have completed all of the tasks to the highest degree of proficiency."'),r.push('"This is truly an exceptional achievement, one which showcases mastery over both the $$b40r:classical and $$r40r:quantum computing principles, as well as an appreciation of the similarities / differences between the two settings."')):1===t&&(r.push('"While the age of classical computers is already well established, the proliferation of quantum computers and technology is only just beginning."'),r.push('"Please apply your knowledge responsibly."')):"tut1"===e?0===t?(r.push('"Hello there! Ready to get started? Our initial order is straight-forward; we have a store of $$b40r:bits and $$r40r:qubits already configured and ready to ship. Simply direct them to the appropriate outputs."'),r.push('"Hit the $$g40r:green $$g40r:power $$g40r:button to start the factory once you have completed construction."')):1===t&&(r.push('"Great job!"'),r.push('"See that $$d40r:dancing $$d40r:star above? That is an award signifying exceptional performance. This time it was given for free, but later on the star will only be given if you go above and beyond in your duties." ')):"tut2"===e?0===t?(r.push('"It turns out that the previous shipment did require alterations to their bits and qubits after all; the request must have been filed incorrectly."'),r.push('"I have already placed the gates necessary for these alterations, but they still need to be connected. Hit the `H` in the bottom-right of the console to open the $$d40r:employee $$d40r:handbook if you need further instruction." ')):1===t&&(r.push('"Good job, another success!"'),r.push('"A second free $$d40r:dancing $$d40r:star? Maintaining high employee morale is important after all!" '),r.push('"Whats that? No, it`s not just free because I was unable to think of an appropriate challenge condition..." ')):"tut3"===e?0===t?(r.push('"You will not believe this, but it turns out that the request for bit/qubit alterations was later cancelled! Unfortunately the factory components have already been bolted in place, so you must prevent the alterations without any new construction."'),r.push('"FYI: see the three $$d40r:colored $$d40r:blueprints in the bottom left corner? Switching between them will allow you to store multiple different factory configurations."')):1===t&&(r.push('"Well done!"'),r.push('"Three for three of the $$d40r:dancing $$d40r:stars? Slow down there buddy. You are making the rest of us look bad." ')):"tut4"===e?0===t?(r.push('"In order to increase production I have decided to retrofit one of our older factories."'),r.push('"The components in this factory are rusted in place, such that they cannot be altered in any way. Fortunately there are gaps in the production line where gates may be fitted, so you should be able find a way to make it work."')):1===t&&(r.push('"Great job, production is skyrocketing!"'),r.push('"The combination of my $$d40r:visionary $$d40r:leadership together with your $$b40r:rudimentary $$b40r:manual $$b40r:labor is unstoppable." ')):"tut5"===e?0===t?(r.push('"So... you will never believe this but I got the date on the order wrong. The order was already fulfilled $$d10r:last $$d10r:year! What a hilarious predicament that could have happened to anyone."'),r.push('"Anyway, I need you to $$r40r:scrap $$r40r:the $$r40r:factory and dispose of the remaining bits and qubits before the higher-ups find out..."')):1===t&&r.push('"Phew! All the evidence has been successfully disposed of. Clean as a whistle. Well, aside from the toxic fumes from all the bit-incineration, of course. $$g10r:Crazy $$g10r:toxic| . Good thing I remembered to close my office door!"'):"tut6"===e?0===t?(r.push('"I know that you have gotten off to a rough start but, as a means to make it up to you, I am allowing you to debut my latest invention: the $$d10r:Encryptinator-1200| . It uses the latest technolocial breakthroughs to offer unbreakable, 100-percent secure data encryption. Gauranteed!"'),r.push('"The $$d40r:Encryptinator-1200 is ready to go, just hook it up to the factory input and output lines!"')):1===t&&(r.push('"Pretty impressive, huh? Don`t get discouraged, if you continue to work hard then one day you might begin to build devices rivaling the majesty of my $$d40r:Encryptinator| ."'),r.push('"Also, even though this bonus star technically should be mine, I`ll let you hold onto it for now..."')):"class7"===e?0===t?(r.push('"Hello again! You find me in the midst of another $$d10r:minor $$d10r:dilemma; I accidentally left a production line running for too long such that the order for one customer got mixed into the order for another."'),r.push('"So I need you to find a way to separate off a precise number of bits from start of the bit-stream. Perhaps the $$b40r:`creation` gate could be jury-rigged into a counter?"')):1===t?(r.push('"Nicely done."'),r.push('"Although I can see a substantial number of waste bits still left on the factory floor. Let`s hope that the higher-ups do not see the mess that you made..."')):2===t&&(r.push('"Great work!"'),r.push('"And I see that you avoided leaving unnecessary waste bits that would otherwise draw attention to the situation. Your attention to detail has earned you a $$d40r:gold $$d40r:star| ."')):"classPuzzle1"===e||("classPuzzle2"===e?0===t?(r.push('"As part of a product diversification strategy The Qubit Factory is to begin offering $$b40r:remote $$b40r:bit $$b40r:processing. Customers send us their bits, we do stuff to them, then send them back. All for a tidy profit, or course!"'),r.push('"The first process that we are going to offer is $$d40r:binary $$d40r:addition, and I need you to implement the XOR and AND logic gates which form the key components necessary for this process."')):1===t&&(r.push('"Great work!"'),r.push('"I have sent you a link to the ancient $$d10r:sacred $$d10r:texts relevant to this factory in case you wish to futher expand your education. This text is also now accessible from the $$d40r:`A` button next to the level title."')):"classPuzzle7"===e?0===t?(r.push('"I have just been informed that the last shipment of bit wires that we received are $$d40r:faulty; they cannot be crossed over one another without danger of $$d40r:short-circuit."'),r.push('"Maintaining a safe working environment is of paramount importance to all of us here at The Qubit Factory, so I need you to find a way for our factories to remain operational without explicit use of line-crossings."')):1===t&&r.push('"Phew, you managed to keep things operating smoothly and safely until the replacement shipment of bit wires arrived. It`s a good thing too; factory accidents involving wayward bits are terrible for PR, believe you me!"'):"vaziraniClassic"===e?0===t?(r.push('"We have just received out first shipment of $$d40r:`multi-control` devices from a new supplier. Each device has 3 channels that can enact a controlled inversion of a target bit. Or at least they should, but many appear to be defective."'),r.push('"I need you to design a test for defective channels in these multi-control devices. Use the bottom-right `R` button to change the starting device if needed."')):1===t&&(r.push('"Good work on identifying the defective devices."'),r.push('"Who would have guessed that supplies from $$b20r:`Bobs $$b20r:Bargain $$b20r:Bit $$b20r:Devices` would be so unreliable? Not me when I ordered them, that`s for sure!"')):"classPuzzle3"===e?0===t?(r.push('"So due to a clerical mistake I may have ordered a extra shipment of $$b40r:`inversion` gates rather than the $$b40r:`re-zero` gates that we needed."'),r.push('"But life goes on, as they say. So I need you to jury-rig some $$d40r:AND-gates without using any $$b40r:`re-zero` gates. We are also running short on $$g40r:`delay` gates so if you could also avoid using them too, that`d be great."')):1===t&&r.push('"Phew! Crisis averted. The logical computations are continuing uninterrupted!"'):"classPuzzle3B"===e?0===t?(r.push('"Due to an excessive consumption of $$b40r:`inversion` $$w44r:gates, the origin of which remains a $$w44r:mystery, our factory is now facing a $$d40r:critical $$d40r:shortage. However, the good news is that our shipment of $$b40r:`re-zero` gates just arrived."'),r.push('"So I need you to figure out a way to implement $$d40r:XOR-gates without using any of our few remaining $$b40r:`inversion` gates. We are also running short on $$b40r:`creation` gates so if you could also avoid using them too, that`d be great."')):1===t&&(r.push('"Phew, thanks to you we have weathered the great $$b20r:`inversion` $$w20r:gate $$w20r:shortage."'),r.push('"Let us all remember to practice responsible use of company resources after this incident."')):"classPuzzle6"===e?0===t?(r.push('"We have received word that some of our bits are $$b20r:flipping during long-distance transit. 0`s are becoming 1`s and 1`s are becoming 0`s; it is quite the $$d40r:kerfuffle, truth be told."'),r.push('"I need you to find a solution that will allow transmitted bits to be recovered more reliably."')):1===t?(r.push('"Not bad; the error-rate is certainly better than it was before you started."'),r.push('"The losses are still significant however. Is there any way that your method could be improved? That would be swell!"')):2===t&&(r.push('"Amazing work!"'),r.push('"Your ingenious solution will save the factory a veritable $$d20r:fortune in customer refunds and replacement bits!"'),r.push('"Please enjoy the gold star as a token of my appreciation for all your hard work."')):"quant1"===e?0===t?(r.push('"Hello again! Fancy meeting you here on one of our $$r40r:quantum $$r40r:production $$r40r:lines| . In this first task I need you to figure out how to undo the changes made to our qubits made by some pre-existing machinery."'),r.push('"What`s this? It appears that your predecessor left their journal notes accessible via the $$d40r:`J` button. Even though this employee ultimately proved to be a disappointment their old notes could still prove useful."')):1===t&&(r.push('"Great work, as usual."'),r.push('"Make sure to check the $$d20r:employee $$d20r:handbook if there are any aspects of $$r20r:qubits or $$r20r:unitary $$r20r:gates that you need further clarification on."')):"quant2"===e?0===t?(r.push('"One of our contractors was recently diagnosed with [R-G-B] processing inversion; unfortunately they have installed the $$r20r:quantum $$r20r:conduit in place of the $$b20r:classical $$b20r:conduit and vice-versa."'),r.push('"I need you to find a work-around. Is it possible we could just inter-convert between $$r20r:qubits / $$b20r:bit as needed?"')):1===t&&(r.push('"Good job!"'),r.push('"Although I must admit that I don`t understand the hype surrounding $$r40r:qubits given that it appears we can switch back-and-forth between $$b40r:bits at will. There has to be more to it?"')):"quant3A"===e?0===t?(r.push('$$d20r:"Unacceptable! I have just been informed that the result of a $$d40r:qubit $$d40r:measurement is sometimes left to chance; two outcomes are possible. This is not the $$b40r:clock-work $$b40r:certainty of computation that I signed up for."'),r.push('"However, the $$d40r:probability of each outcome is known and can be viewed in the $$d40r:state $$d40r:analyzer, thus the cummulative outcome over a large number of trials can be predicted. See the handbook if you have any questions."')):1===t&&(r.push('"Well done! Although I still find the concept of $$d40r:uncertainty appalling, at least there is a $$d40r:tolerance on the success threshold in the appropriate factories. However, you should be aware that sometimes even a correct solution may fail due to $$r40r:bad $$r40r:luck| ."'),r.push('"Make sure to consult the relevant entries of the employee handbook if you want to learn more about the full functionality of the $$d40r:state $$d40r:analyzer."')):"quant3"===e?0===t?(r.push('"Hello hello! We have what looks to be a simple task today; I just need you to convert the initial qubits into bits in order to transfer over a $$b40r:classical $$b40r:line before reverting back to qubits."'),r.push('"Whats that? These qubits are now encoded in ▲ or ▶ states? Well, I don`t see how that could possibly cause any problems..."')):1===t&&(r.push('"Oh, I see now. Only qubits that are oppositely-aligned can be $$d40r:perfectly distinguished with measurements, even though qubits in states ▲ and ▶ states could still be distinguished with reasonably $$d40r:high $$d40r:probability| ."'),r.push('"The implications are troubling; it follows that we cannot exactly determine the state of $$r40r:unknown $$r40r:qubits unless they are all aligned/anti-aligned on a common axis. Oh well, problems for another day..."')):"quant4"===e?0===t?(r.push('"In order to improve our factory`s public image we have been mandated to introduce a $$g40r:waste-qubit $$g40r:recycling $$g40r:program. The recycler should take in arbitrary qubits and output clean `▲` qubits states, ready for reuse."'),r.push('"However, unlike the case with $$b40r:classical $$b40r:gates, there is no single gate that can force an arbitrary qubit into a fixed state. Notice, however, that $$b40r:classical $$b40r:controls can also work with $$r40r:quantum $$r40r:gates| ..."')):1===t&&(r.push('"Wow, isn`t environmentalism great? No more $$g40r:qubit $$g40r:incineration $$g40r:vapors for us!"'),r.push('"Well... unless it begins to adversely affect our bottom line, of course. Let`s keep our stockpile of $$r40r:incinerators around for now just in case..."')):"quant5"===e?0===t?(r.push('"Today`s task requires the use of a new component. The quantum version of the $$r40r:control gate allows you to alter the effect of a $$d40r:target gate depending on the relative alignment between the control gate and an input qubit| ."'),r.push('"For this task you should ensure that the control gate remains aligned or anti-aligned with any input qubits otherwise you may create $$d40r:entangled $$d40r:states| , which you lack the proper training to handle."')):1===t&&r.push('"Well done! As you can see the qubit $$r40r:control gate seems to behave very similarly to the bit $$b40r:control gate. However, as you will soon find out, it can actually do much, much more..."'):"quant6"===e?0===t?(r.push('"Welcome back. Today we finish the previous qubit processing task, where the rotation state of one qubit must be added to another. However, the bad news is that we have run out of $$r40r:`rotation` gates so you must instead make do with $$r40r:`flip` gates. I`m sure that you`ll figure something out."'),r.push('"Once more, you should refrain from creating $$d40r:entangled $$d40r:states given that you still lack the proper training."')):1===t&&r.push('"Congratulations, now that you are familiar with the basics of the quantum version of the $$r40r:control gate we can begin to consider more $$d40r:sophisticated applications."'):"quant6B"===e?0===t?(r.push('"Wow, check it out! The input qubits in this factory `blink` back and forth between two different states, indicating that they are in a $$d40r:superposition. Don`t be fooled, however. These are still the same as other qubits that we have been dealing with in earlier factories; the only difference is we are now viewing them in a different $$d40r:basis| ."'),r.push('"See the employee handbook for more details."')):1===t&&(r.push('"I know what you are thinking. Given that changing the basis of a qubit ONLY changes its appearance, then why is this useful? That is a good question!"'),r.push('"In many tasks you will find that $$d40r:changing $$d40r:the $$d40r:basis can be helpful to understand the action of $$r40r:measurements and $$r40r:control gates. Later, once we begin handling entangled states, the proper understanding of $$d40r:superpositions and $$d40r:basis $$d40r:changes will be indispensable."')):"quant7"===e?0===t?(r.push('$$w23r:"Behold! The fabled $$d20r:entangled $$d20r:state. $$w23r:Glorious. $$w23r:Majestic. $$w23r:Sublime. By inputting a superposition state (▼/▲) to the control gate the target gate both (acts/does nothing) according to the superposition, and thus the entangled state is born."'),r.push('"Entangled states are $$r40r:tricky $$r42r:beasts; a measurement on one qubit can change the state of another, as you are about to find out..."')):1===t&&(r.push('"Wow, seeing is believing; a measurement on one qubit of an entangled pair does indeed affect the state of the other. That is some $$d24r:spooky $$d24r:action-at-a-distance!"'),r.push('"I wonder how else entanglement may be exploited?"')):"measure"===e?0===t?(r.push('"From previous factories we have seen than certain qubit states, such as ▲/▶ for example, cannot $$d40r:always be distinguished via measurement. This follows as no matter what measurement is done both qubit states have a non-zero chance of giving the $$d40r:same $$d40r:result."'),r.push('"But what if we have two $$b40r:identical $$b40r:copies of each qubit state? Surely you could find a way to improve the accuracy in this case?"')):1===t&&(r.push('"Ah! Just as I anticipated. While we can never perfectly distinguish between certain states, we can still improve our certainty by using more than one copy of the state."'),r.push('"I shall dub this process $$d40r:TOM-o-graphy. Named after myself, of course."'),r.push('"Wait? You didn`t know that my name was Tom?"')):"entChallengeA"===e?0===t?(r.push('"A disgrunted former employee locked their station using some kind of weird device. This device takes qubits as input and will only unlock if certain measurement results are obtained."'),r.push('"I have tried all possible combinations of input qubits, but nothing seems to work! Perhaps you will have more luck?"')):1===t&&(r.push('"Well done! The entangled state that you prepared is truly fascinating: if both qubits are measured on the same axis, regardless of what that axis is, the measurement results will always match."'),r.push('"I`m sure that this entangled state, with it`s $$d40r:perfect $$d40r:correlation, will be useful in a whole host of other applications."')):"quantChallengeF"===e?0===t?(r.push('"As you are learning, utilization of $$d40r:entanglement is key to realizing some $$g40r:funky quantum effects, technically speaking. Thus it is high-priority that we develop more cost-effective infrastructure to distribute entangled qubits to our customers."'),r.push('"I need you to find a way to generate entanglement between $$b40r:two $$b40r:separated $$b40r:parties without having to send an entangled qubit across the entire distance."')):1===t&&(r.push('"Great work! So, rather than directly exchanging qubits, both parties only need to send qubits to some intermediate `hub`, yet the result is that they still possess half of an entangled pair? Sounds good to me."'),r.push('"I expect that this innovation will both reduce our shipping costs as well as simplify our logistic chain significantly."')):"simpleDistill"===e?0===t?(r.push('"Hello! Today our task is to repurpose an old factory to convert $$d40r:imperfectly $$d40r:entangled three-qubit states into $$d40r:perfectly $$d40r:entangled two-qubit states. This task can be achieved by measuring one of the three qubits in a precise way, or so I am told. Doesn`t sound too hard."'),r.push('"Note that we don`t need $$r40r:perfect $$r40r:efficiency; it is okay if the conversion does not succeed for every three-qubit state."')):1===t&&(r.push('"Good job!"'),r.push('"I understand now. Starting from some $$b40r:weaker $$b40r:entanglement spread over many qubits, we can $$d40r:`distill` $$b40r:stronger $$b40r:entanglement on a smaller set of qubits. I have a feeling that this idea will be useful in a variety of future tasks..."')):"preDenseB"===e?0===t?(r.push('"I have a $$d20r:brilliant $$d20r:idea! So we know that, while $$b40r:bits have only two states, $$r40r:qubits can be in many different states. So it should be possible to encode $$b40r:multiple $$b40r:bits of data into a $$r40r:single $$r40r:qubit, right? Just think of the possibilities. I`m gonna be rich!"'),r.push('"I`ll leave it to you to figure out the details of encoding and decoding."')):1===t&&(r.push('"Oh, so that is disappointing. While it is technically possible to encode multiple bits into a single qubit, we can still only ever retrieve at most a single bit. And even then the retrieval is not reliable."'),r.push('"Let`s revisit this idea again later..."')):"dense"===e?0===t?(r.push('"I thought that we could return back to the idea of encoding multiple bits of data into a single qubit."'),r.push('"What if the source/destination begin by sharing some $$b40r:entangled $$b40r:qubit $$b40r:pairs? These could be shipped out ahead of time before we need to transfer any data. Perhaps the entanglement can be utilized in decoding procedure? Entanglement is pretty much just magic after all..."')):1===t&&(r.push('"Brilliant!"'),r.push('"I get it now. So, while entanglement alone cannot be used to transmit information, the presence of entanglement can be used to facilitate data transfer using qubits $$d40r:more $$d40r:efficiently than would otherwise be possible."')):"teleport"===e?0===t?(r.push('"The shipping of qubit orders is taking too long! In this day and age customers demand $$d40r:INSTANT gratification. I need you to find a way to fulfill qubit orders that uses only $$b40r:bit-communication channels for transmission."'),r.push('"To facilitate this we have pre-shipped $$r40r:entangled $$r40r:qubits ahead of time to all of our customers. Note that we do not know in advance what qubits our customers will order so your method should work to send arbitrary qubits."')):1===t&&(r.push('"Great work! I understand now. By utilizing $$r40r:pre-existing $$r40r:entanglement in conjunction with transmission of classical data, the state of each qubit is effectively teleported from one place to another without having to transmit any actual qubits. Like a magic trick!"'),r.push('"Customers can now receive their $$r40r:qubit orders as quickly as we can send $$b40r:standard $$b40r:bits. Eat your heart out same-day-shipping!"')):"distill"===e?0===t?(r.push('"Good news! By switching the supplier of entangling gates to $$g40r:`Quinns $$g40r:Quirky $$g40r:Qubit $$g40r:Devices` I have managed to reduce our expenses significantly."'),
r.push('"However the entangled pairs that we pre-ship to customers are now, how should we say, $$d40r:less $$d40r:than $$d40r:perfect. I need you to find a way to compensate for this in the transmission protocol that you designed previously."')):1===t&&(r.push('"Aha! So we can just distill some $$r40r:strongly entangled qubits from many sets of the $$b40r:weakly entangled qubits, and then use the strongly entangled qubits in the transmission protocol?"'),r.push('"Easy as pi!"')):"quantChallengeG"===e?0===t?(r.push('"Today`s factory is already partially constructed. Unfortunately the control gates were inserted $$d40r:backwards along the main production line and we are now unable to redo these components."'),r.push('"This is quite the conundrum; I need you to find a way to alter the qubits to our specifications using only the $$d40r:control $$d40r:side of the quantum control gate."')):1===t&&(r.push('"Jolly good job!"'),r.push('"Note that this demonstrates a clear distinction between the $$b40r:classical and $$r40r:quantum controls, as the $$b40r:classical control cannot alter the state of control bits in any way. Maybe we could find a way to exploit this difference for a practical purpose?"')):"vaziraniQuantum"===e?0===t?(r.push('"We have just received out first shipment of the $$r40r:quantum version of $$d40r:`multi-control` devices. They function similarly to the classical $$d40r:`multi-control` devices that you tested previously. Remember those?"'),r.push('"Similar to last time, I need you to design a test for defective channels in these multi-control devices. However, time is money, so now you may only test each device with a $$d40r:single input."')):1===t&&(r.push('"Well done! The defective channels have all been identified."'),r.push('"Did you notice how the $$r40r:quantum task could be completed more efficiently than was possible with the equivalent $$b40r:classical task? I wonder in what other processes that quantum devices will have an $$d40r:efficiency $$d40r:advantage over comparable classical devices?"')):"quantErrorA"===e?0===t?(r.push('"Ugh! Our qubits are being damaged during shipping and handling. Customers are complaining that they are not receiving correct orders... and I have to deal with them!"'),r.push('"I need you to find a way to correct qubit errors that occur during transit. As you know, unknown qubits cannot be duplicated, so you will have to find a different error correction strategy than was used for bits..."')):1===t?(r.push('"Ahh, so you encoded a single qubit into an entangled state of several qubits before shipping? Very clever!"'),r.push('"I wonder if this idea can be pushed further...?"')):2===t&&r.push('$$d10r:"OUTSTANDING!!! I had not imagined that such incredible accuracy could be achieved..."'):"quantErrorB"===e?0===t?(r.push('"Due to further cut-backs all of our qubit transition lines now act to modify sent qubits in an $$d40r:unpredictable $$d40r:manner."'),r.push('"However, we still require that the sent qubits should somehow be reverted to their original states. Perhaps, given some pre-existing entanglement between the source/destination, you can build an enhanced error correction protocol?"')):1===t?(r.push('"A satisfactory result, although a substantial number of qubits were still shipped incorrectly."'),r.push('"Boy oh boy, it sure would be great is $$d10r:someone were to find an improved method..."')):2===t&&(r.push('$$d10r:"Perfection! Who would have thought that this was doable given such lousy transmission channels?"'),r.push('"Proper utilization of entanglement really does seem to allow the impossible to become reality."')):"entChallengeB"===e?0===t?(r.push('"Today we get to work with the famed $$d40r:GHZ entangled states. What does GHZ stand for? Nobody knows! It`s meaning has been lost to $$d44r:history. Either that or I am too lazy to look it up. One or the other."'),r.push('"Anyway we need to find a way to identify GHZ states from non-GHZ states. Perhaps a good start would be to build a quantum circuit that would transform a GHZ state into an unentangled state..."')):1===t&&(r.push('"Great job!"'),r.push('"Wow, who could have guessed that dealing with multi-qubit entangled states would be so complicated?"')):"entChallengeC"===e?0===t?(r.push('"A straight-forward job today; we just need to finish up the GHZ identification task from last time."'),r.push('"There is a small dilemma; we seem to be running short on quantum control gates so you will have to make do without..."')):1===t&&r.push('"Great work with the GHZ identification. See, that wasn`t so bad! You did fine without using any quantum control gates."'):"extraA"===e?0===t?(r.push('"Why it seems that you have stumbled upon a deserted, top-secret qubit cloning facility."'),r.push('"Rumor has it that the facility was abandoned when the cloned qubits became violent and deranged, devouring all in sight. Or perhaps it was simply abandoned as the cloning process failed to produce sufficiently accurate results? Either way you are welcome to try to do better..."')):1===t?(r.push('"Not bad. Most of the original qubits have been replicated perfectly."'),r.push('"Is it just my imagination, or do some of the others look a little bit twitchy to you?"')):2===t&&(r.push('"Great work! You have pushed the art of cloning to its limits."'),r.push('"Alas, perfect cloning remains forever out of reach..."')):"extraB"===e?0===t?(r.push('"What is $$w10r:this?!? Is this $$d40r:entanglement for ants!?!"'),r.push('"The entanglement should be at least $$w10r:... three times bigger than this!"')):1===t&&r.push('"Have you ever wondered if there was more to life, other than being $$w20r:really, $$w20r:really, ridiculously good at entangling qubits?"'):"extraC"===e?0===t?(r.push('"Did you hear the news? Binary addition is $$w10r:sooooo yesteryear. All of the hip, modern factories are now into $$d40r:binary $$d40r:multiplication; it`s like addition, but $$d10r:extreme!"'),r.push('"Just try not to take up too much factory real-estate; rent is not cheap these days!"')):1===t?(r.push('"Well ... you got a working factory for bit multiplication, which is no small feat."'),r.push('"But it would be great if you could find a way to compactify the design."')):2===t&&(r.push('"Wow! A fully-functional bit multiplication device; it is amazing what can be fit within the confines of a single factory. And with room to spare!"'),r.push('"Bit processing sure has come a long way."')):"adder"===e?0===t?(r.push('"In order for us to maintain our $$d40r:competitive $$d40r:advantage it is important that we keep our facilities at the cutting edge of modern tech."'),r.push('"That`s right, we are upgrading to a 64-bit OS! It is my great honor to bestow upon you the task of prototyping the 64-bit addition unit. Miniaturization is important here; please keep your design as compact as possible."')):1===t?r.push('"Good job, your addition module has passed the requisite testing. However, although your design functions correctly, it still takes up significant factory floor real-estate. Are you able to compactify your design?"'):2===t&&(r.push('"Incredible! You managed to fit a 64-bit adder in less than 500sq feet of factory floor space!"'),r.push('"What an amazing age that we live in..."')):"extraD"===e?0===t?(r.push('"Here it is, the holy-grail of bit-processing; can you build a factory capable of detecting occurrences of $$d40r:ANY specified pattern in a dataset?"'),r.push('"Imagine what we could do if such a revolutionary $$d40r:`search` feature could be constructed? The sky is the limit!"'),r.push('"I don`t expect it to be easy though..."')):1===t&&(r.push('"Hot damn! I genuinely was not expecting anyone to construct a functioning factory. This is seriously impressive!"'),r.push('"Unless, of course, you found a much simpler solution than I thought possible? In which case maybe I am just dumb?"'),r.push('"Either way, jolly good show!"')):"chsh"===e?0===t?(r.push('"Today we focus on a team-building exercise. Alice and Bob are separated on the left/right sides of a factory and cannot communicate. They each will receive a $$d40r:random bit and then must try to guess what bit the other has in order to win the exercise. How do they know what bit the other has? That`s the neat part, they don`t!"'),r.push('"However they do share some $$r40r:entangled $$r40r:qubit $$r40r:pairs; can this entanglement be used to improve the win rate?"')):1===t&&(r.push('"Ah, I see! By utilizing shared entanglement, you were able to help Alice and Bob collaborate to win significantly more often than $$d40r:chance would otherwise allow?"'),r.push('"Notice, however, that the entanglement can not be used to transmit information directly, else the game could be won $$d40r:every time. Still, there is definitely some kind of spooky action-at-a-distance happening!"')):"binaryencode"===e&&(0===t?(r.push('"Due to a logistical mistake our storage warehouses are overflowing with excess `1` bits. Storage is not cheap, and we are bursting at the seams!"'),r.push('"I need you to build a factory that translates a large quantity of `1` bits into a smaller string of bits via a $$b40r:binary $$b40r:encoding. In this system a single bit can represent different values depending on its location within a bit string."')):1===t&&(r.push('"Good work! Our storage problem has been solved thanks to your efforts."'),r.push('"The new system is so efficient that we could represent quantities larger than the number of particles in the $$d40r:known $$d40r:universe with a bit-string of only a few hundred bits. The encoding procedure might take quite some though... "')))),a?r:i?r.length>0:(RobotSpeech.analyze(r),r.length>0)}}class Score{static drawBase(e,t=!1){var i=e.ctx,a=e.w0;e.h0;if("forwardTrans"===STATE.mode){e.clear();var r=TIMER.transRatioTrig}else if("backwardTrans"===STATE.mode){e.clear();r=TIMER.transRatioTrig}else{if("constructing"===STATE.mode){e.clear();r=0;return void e.clear()}r=1;if(!t)return}var s=SCENARIO.scoreWidth,o=SCENARIO.scoreHeight,n=FIELD.tileWidth/9,l=[a/2-s/2,a/2-s/2,a/2+s/2,a/2+s/2],h=[0,r*o,r*o,0],d=[n,n,n,n],u=new Path2D(Helper.makeRoundedPath(l,h,d,1,0,0));i.save(),i.globalAlpha=1,i.shadowBlur=4,i.shadowOffsetX=FIELD.tileWidth/24,i.shadowOffsetY=FIELD.tileWidth/24,i.shadowColor="#17241f",i.fillStyle="#2b2b2b",i.fill(u),i.strokeStyle="#000",i.stroke(u),i.restore(),i.save(),i.clip(u,"evenodd"),Textures.drawFiber(i,a/2-s/2,0,s,r*o,FIELD.tileWidth/48,.5),i.restore()}static draw(e,t){var i=e.ctx,a=e.w0,r=(e.h0,t.ctx),s=(t.w0,t.h0,RBOARD[TIMER.tick].success),o=RBOARD[TIMER.tick].failure;if("forwardTrans"===STATE.mode){e.clear();var n=TIMER.transRatioTrig;s=0,o=0}else if("backwardTrans"===STATE.mode){e.clear();n=TIMER.transRatioTrig}else{if("constructing"===STATE.mode){n=0;return void e.clear()}n=1;e.clear()}var l=n*SCENARIO.scoreHeight;if(SCENARIO.successful>=0){if(i.save(),i.textBaseline="top",i.textAlign="center",i.font=1.2*FIELD.tileWidth/3+"px Courier New",i.fillStyle="antiquewhite",i.shadowBlur=2,i.shadowOffsetX=2,i.shadowOffsetY=2,i.shadowColor="black",SCENARIO.repetitions>1){var h=[];if(h.push("Requirement: "+SCENARIO.successRep+" of "+SCENARIO.repetitions),h.push("Progress: "+SCENARIO.correctReps+" of "+(SCENARIO.currentRep-1)),4===SCENARIO.victoryCond){var d=(FIELD.cols-2)*(FIELD.rows-2),u=100-Math.round(100*FIELD.cleanTiles/d);h.push(SCENARIO.starText+u+"%)")}else h.push(SCENARIO.starText)}else if(0===SCENARIO.victoryCond){h=[];h.push("Requirement: "+SCENARIO.numCorrect+" of "+SCENARIO.maxTrials),h.push("Progress: "+s+" of "+(s+o)),h.push(SCENARIO.starText)}else if(1===SCENARIO.victoryCond){h=[];h.push("Requirement: incinerate all bits and qubits"),h.push(SCENARIO.starText)}else if(2===SCENARIO.victoryCond){h=[];if(!RBOARD[TIMER.tick])return;if("chsh"===SCENARIO.name){var c=RBOARD[TIMER.tick].getGate(10,1);if(c.counterMax)var I=Math.round(c.counter/c.counterMax*100);else I=0}else{c=RBOARD[TIMER.tick].getGate(18,5);var E=RBOARD[TIMER.tick].getGate(18,8);if(c.counterMax)I=Math.round(c.counter/c.counterMax*100);else I=0;if(E.counterMax)var f=Math.round(E.counter/E.counterMax*100);else f=0}"chsh"===SCENARIO.name?(h.push("Outputs: "+s+" of "+SCENARIO.maxTrials),h.push("Current win rate:"+I+"%"),h.push(SCENARIO.starText)):(h.push("Outputs: "+s+" of "+SCENARIO.maxTrials),h.push("Status: C="+I+"%, D="+f+"%"),h.push(SCENARIO.starText))}else if(3===SCENARIO.victoryCond){h=[];h.push("Requirement: "+SCENARIO.numCorrect),h.push("Progress: "+s),h.push(SCENARIO.starText)}else if(4===SCENARIO.victoryCond){h=[];h.push("Requirement: "+SCENARIO.numCorrect+" of "+SCENARIO.maxTrials),h.push("Progress: "+s+" of "+(s+o));d=(FIELD.cols-2)*(FIELD.rows-2),u=100-Math.round(100*FIELD.cleanTiles/d);h.push(SCENARIO.starText+u+"%)")}for(var S=l-SCENARIO.scoreHeight+1.75*SCENARIO.yPad,p=0;p<h.length;p++){for(var T=Helper.parseText(i,h[p],SCENARIO.scoreWidth),R=0;R<T.length;R++)i.fillText(T[R],a/2,S),R<T.length-1&&(S+=SCENARIO.yPad2);S+=SCENARIO.yPad}i.restore(),t.clear(),r.save(),r.textBaseline="top",r.textAlign="center",r.font=1.2*FIELD.tileWidth/3+"px Courier New",r.fillStyle="antiquewhite",r.shadowBlur=2,r.shadowOffsetX=2,r.shadowOffsetY=2,r.shadowColor="black",r.fillText("Level status",a/2-FIELD.tileWidth/2,FIELD.tileWidth/6),r.restore()}}static check(){RBOARD[TIMER.tick].success+RBOARD[TIMER.tick].failure>=SCENARIO.maxTrials&&(STATE.mode="finished",RBOARD[TIMER.tick].success>=SCENARIO.numCorrect?SCENARIO.successful=1:SCENARIO.successful=0)}}class SelectLevel{constructor(){this._plaqueList=[],this._tokenList=[],this._hovered=-1,this._selected=-1,this._scale=1}get scale(){return this._scale}get tokenList(){return this._tokenList}get plaqueList(){return this._plaqueList}get hovered(){return this._hovered}get selected(){return this._selected}set plaqueList(e){this._plaqueList=e}set tokenList(e){this._tokenList=e}set hovered(e){this._hovered=e}set selected(e){this._selected=e}addToken(e){this.tokenList.push(e)}addPlaque(e){this.plaqueList.push(e)}removeHover(){for(var e=this.tokenList.length,t=0;t<e;t++)this.tokenList[t].isHover=!1;var i=this.plaqueList.length;for(t=0;t<i;t++)this.plaqueList[t].isHover=!1}unlockCheck(){for(var e=0,t=[0,0,0,0,0,0,0,0,0,0],i=[0,0,0,0,0,0,0,0,0,0],a=0,r=0,s=0,o=0,n=0;n<LEVELS.groups.length;n++)for(var l=0;l<LEVELS.groups[n];l++){var h=!1;null!=PERSIST0[LEVELS.names[e]].complete&&(h=PERSIST0[LEVELS.names[e]].complete,h&&(LEVELS.hidden[e]?s+=1:(t[n]+=1,a+=1)));var d=!1;null!=PERSIST0[LEVELS.names[e]].complete&&(d=PERSIST0[LEVELS.names[e]].star,d&&(LEVELS.hidden[e]?o+=1:(i[n]+=1,r+=1))),e+=1}FIELD.totStar=r,FIELD.totComplete=a,FIELD.hiddenStar=o,FIELD.hiddenComplete=s;var u=[0,0,0,0,0,0,0,0,0,0];if(u[0]=FIELD.developerMode,u[1]=!0,u[2]=t[1]>=6,u[3]=t[2]>=5,u[4]=t[3]>=5,u[5]=t[2]>=5,u[6]=t[5]>=6,u[7]=t[6]>=5,u[8]=t[4]>=4&&t[7]>=4,u[9]=!1,u[10]=t[9]>=5,LEVELS.unlocked=[...u],t[2]+t[3]+t[4]===LEVELS.groups[2]+LEVELS.groups[3]+LEVELS.groups[4]?FIELD.isActiveAward[0]=1:FIELD.isActiveAward[0]=0,i[2]+i[3]+i[4]===LEVELS.groups[2]+LEVELS.groups[3]+LEVELS.groups[4]?FIELD.isActiveAward[1]=1:FIELD.isActiveAward[1]=0,t[5]+t[6]+t[7]===LEVELS.groups[5]+LEVELS.groups[6]+LEVELS.groups[7]?FIELD.isActiveAward[2]=1:FIELD.isActiveAward[2]=0,i[5]+i[6]+i[7]===LEVELS.groups[5]+LEVELS.groups[6]+LEVELS.groups[7]?FIELD.isActiveAward[3]=1:FIELD.isActiveAward[3]=0,t[8]+t[9]===LEVELS.groups[8]+LEVELS.groups[9]?FIELD.isActiveAward[4]=1:FIELD.isActiveAward[4]=0,i[8]+i[9]===LEVELS.groups[8]+LEVELS.groups[9]?FIELD.isActiveAward[5]=1:FIELD.isActiveAward[5]=0,s===FIELD.numBonusLevels?FIELD.isActiveAward[6]=1:FIELD.isActiveAward[6]=0,o===FIELD.numBonusLevels?FIELD.isActiveAward[7]=1:FIELD.isActiveAward[7]=0,FIELD.forceOpen){for(n=0;n<LEVELS.names.length;n++)PERSIST0[LEVELS.names[n]].available=!0;return u}for(e=0,n=0;n<LEVELS.groups.length;n++)for(l=0;l<LEVELS.groups[n];l++)PERSIST0[LEVELS.names[e]].available=1===n?0===l||(PERSIST0[LEVELS.names[e-1]].complete||FIELD.forceOpenRing[1]):9===n?PERSIST0[LEVELS.names[e-6]].complete||FIELD.forceOpenRing[9]||PERSIST0[LEVELS.names[e]].complete:0===n&&2==l||(0===n&&3==l?u[7]||FIELD.forceOpenRing[7]:0===n&&4==l?u[2]||FIELD.forceOpenRing[8]:0===n&&5==l?u[3]||FIELD.forceOpenRing[3]:0===n&&6==l?u[4]||FIELD.forceOpenRing[4]:u[n]||FIELD.forceOpenRing[n]||PERSIST0[LEVELS.names[e]].complete),e+=1;return u}initialize(){FIELD.tileWidth;var e=new Array(LEVELS.numTotal).fill(-1),t=new Array(LEVELS.numTotal).fill(13);e[0]=1,t[0]=12,e[1]=1,t[1]=13,e[2]=2.5,t[2]=12.5,e[3]=18.5,t[3]=6,e[4]=13,t[4]=4.7,e[5]=2.7,t[5]=9,e[6]=7,t[6]=10.5;for(var i=[0,2.5,7,2.7,7,11.5,16.5,18.5,13,13],a=[0,4,5.5,9,10.5,11.2,11.2,6,4.7,4.7],r=[0,1.2,1.4,1.4,1.3,1.6,1.6,1.4,1.3,2.7],s=3+FIELD.numBonusLevels,o=1;o<LEVELS.groups.length;o++){for(var n=2*Math.PI/LEVELS.groups[o],l=0;l<LEVELS.groups[o];l++)e[s+l]=i[o]+r[o]*Math.sin(l*n-Math.PI/LEVELS.groups[o]),t[s+l]=a[o]-r[o]*Math.cos(l*n-Math.PI/LEVELS.groups[o]);s+=LEVELS.groups[o]}var h=[4,0,1,1,1,2,2,2,3,3];this.tokenList=[];for(s=0,o=0;o<LEVELS.groups.length;o++)for(l=0;l<LEVELS.groups[o];l++){var d=!1,u=!1,c=!1;null!=PERSIST0[LEVELS.names[s]].star&&(d=PERSIST0[LEVELS.names[s]].star),null!=PERSIST0[LEVELS.names[s]].complete&&(u=PERSIST0[LEVELS.names[s]].complete),null!=PERSIST0[LEVELS.names[s]].available&&(c=PERSIST0[LEVELS.names[s]].available);var I=PathsC.tokenBase(LEVELS.tags[s],d,u,c,h[o],LEVELS.hidden[s]),E=new Token(LEVELS.tags[s],s,LEVELS.names[s],e[s],t[s],I,c,u,d,LEVELS.hidden[s]);this.addToken(E),s+=1}var f=3,S=.6,p=[" ","Tutorial","Classic I","Classic II","Classic III","Quantum I","Quantum II","Quantum III"," ","Hybrid"];this.plaqueList=[];for(o=0;o<p.length;o++){var T=.5+i[o]-f/2,R=a[o]-r[o]-.6;if(8===o||0===o)var m=new SelectPlaque(p[o],"plaque"+String(o),T,R,0,0,p[o]);else m=new SelectPlaque(p[o],"plaque"+String(o),T,R,f,S,p[o]);this.addPlaque(m)}}drawText(e){e.clear();var t=e.ctx,i=Math.round(FIELD.selBoxW-1.3*FIELD.tileWidth);t.save(),t.textAlign="center",t.font=1.4*FIELD.tileWidth/3+"px Courier New",t.fillStyle="antiquewhite",t.fillText("Progression",i/2,9*FIELD.tileWidth),t.restore();var a=9.6*FIELD.tileWidth;t.save(),t.lineWidth=FIELD.tileWidth/20,t.fillStyle="antiquewhite",t.strokeStyle="antiquewhite",t.beginPath(),t.moveTo(i/12,a),t.lineTo(i/2,a-FIELD.tileWidth/24),t.lineTo(i-i/12,a),t.lineTo(i/2,a+FIELD.tileWidth/24),t.closePath(),t.fill(),t.stroke(),t.restore();var r=["Floor Hand","Jr. Factory Assistant","Sr. Factory Assistant","Jr. Factory Engineer","Sr. Factory Engineer","Jr. Quantum Engineer","Sr. Quantum Engineer","HD Quantum Tech.","The Flammia","The Poulin","The Preskill"],s=Math.ceil(100*(FIELD.totComplete+FIELD.totStar)/(2*LEVELS.numStandard));if(t.save(),t.textAlign="center",t.fillStyle="antiquewhite",t.font=1.2*FIELD.tileWidth/3+"px Courier New",FIELD.hiddenComplete>0){t.textAlign="left";var o="Completed: "+FIELD.totComplete,n=t.measureText(o).width,l=t.measureText(o+"   of "+LEVELS.numStandard).width;t.fillText(o+"   of "+LEVELS.numStandard,i/2-l/2,10.4*FIELD.tileWidth),t.fillStyle="goldenrod",t.fillText("+"+FIELD.hiddenComplete,i/2-l/2+n,10.4*FIELD.tileWidth),t.fillStyle="antiquewhite",t.textAlign="center"}else t.fillText("Completed: "+FIELD.totComplete+" of "+LEVELS.numStandard,i/2,10.4*FIELD.tileWidth);if(FIELD.hiddenStar>0){t.textAlign="left";o="Starred: "+FIELD.totComplete,n=t.measureText(o).width,l=t.measureText(o+"   of "+LEVELS.numStandard).width;t.fillText(o+"   of "+LEVELS.numStandard,i/2-l/2,11*FIELD.tileWidth),t.fillStyle="goldenrod",t.fillText("+"+FIELD.hiddenComplete,i/2-l/2+n,11*FIELD.tileWidth),t.fillStyle="antiquewhite",t.textAlign="center"}else t.fillText("Starred: "+FIELD.totStar+" of "+LEVELS.numStandard,i/2,11*FIELD.tileWidth);if(t.font=1.2*FIELD.tileWidth/3+"px Courier New",t.fillText("Rank: "+r[Math.floor(s/10)],i/2,12.2*FIELD.tileWidth),t.restore(),t.save(),t.beginPath(),t.strokeStyle="antiquewhite",t.lineWidth=FIELD.tileWidth/32,t.stroke(Helper.roundRect(i/32,11.6*FIELD.tileWidth,i-i/16,.95*FIELD.tileWidth,FIELD.tileWidth/4)),t.restore(),"token"===STATE.under.type||"selectPlaque"===STATE.under.type||"selectButton"===STATE.under.type||"selectAward"===STATE.under.type){if("token"===STATE.under.type)var h=STATE.under.k0,d=DESCRIPTIONS[h.link];else if("selectPlaque"===STATE.under.type){var u=STATE.under.k0;d=DESCRIPTIONS[u.link]}else if("selectButton"===STATE.under.type)STATE.under.i0,d=["Repeat Dialogue"];else if("selectAward"===STATE.under.type){d=JSON.parse(JSON.stringify(DESCRIPTIONS["award"+STATE.under.k0]));FIELD.isActiveAward[STATE.under.k0]?d[0]="Award":(d[0]="Award (locked)",6!==STATE.under.k0&&7!==STATE.under.k0||FIELD.isActiveAward[STATE.under.k0]||(d[1]="  ??? "))}t.save(),t.textBaseline="top",t.fillStyle="antiquewhite",t.shadowBlur=2,t.shadowOffsetX=2,t.shadowOffsetY=2;a=0;t.textAlign="center",t.font=1.4*FIELD.tileWidth/3+"px Courier New";var c=Helper.parseText(t,d[0],FIELD.selBoxW-1.3*FIELD.tileWidth);t.fillText(c[0],(FIELD.selBoxW-1.3*FIELD.tileWidth)/2,a),a+=SCENARIO.yPad;i=FIELD.selBoxW-1.3*FIELD.tileWidth;t.save(),t.lineWidth=FIELD.tileWidth/20,t.fillStyle="antiquewhite",t.strokeStyle="antiquewhite",t.beginPath(),t.moveTo(i/12,a),t.lineTo(i/2,a-FIELD.tileWidth/24),t.lineTo(i-i/12,a),t.lineTo(i/2,a+FIELD.tileWidth/24),t.closePath(),t.fill(),t.stroke(),t.restore(),a+=SCENARIO.yPad2,t.textAlign="left",t.font=1.2*FIELD.tileWidth/3+"px Courier New";for(var I=1;I<d.length;I++){c=Helper.parseText(t,d[I],FIELD.selBoxW-1.3*FIELD.tileWidth);for(var E=0;E<c.length;E++)t.fillText(c[E],0,a),E<c.length-1&&(a+=SCENARIO.yPad2);a+=SCENARIO.yPad}t.restore()}if("selectPlaque"===STATE.under.type){u=STATE.under.k0,d=DESCRIPTIONS[u.link+"U"];if(d){if(t.save(),t.textBaseline="top",t.fillStyle="antiquewhite",t.strokeStyle="antiquewhite",t.shadowBlur=2,t.shadowOffsetX=2,t.shadowOffsetY=2,"Hybrid"===u._name)var f=.4*FIELD.tileWidth;else f=0;i=FIELD.selBoxW-1.3*FIELD.tileWidth;t.textAlign="center",t.font=1.4*FIELD.tileWidth/3+"px Courier New",t.fillText(d[0],i/2,6*FIELD.tileWidth-f),t.lineWidth=FIELD.tileWidth/32,t.textAlign="center",t.font=1.2*FIELD.tileWidth/3+"px Courier New",t.fillText(d[1],i/2,6.7*FIELD.tileWidth-f),"Hybrid"===u._name?(t.fillText(d[2],i/2,7.2*FIELD.tileWidth-f),t.beginPath(),t.stroke(Helper.roundRect(i/32,5.8*FIELD.tileWidth-f,i-i/16,2.1*FIELD.tileWidth,FIELD.tileWidth/4))):(t.beginPath(),t.stroke(Helper.roundRect(i/32,5.8*FIELD.tileWidth,i-i/16,1.6*FIELD.tileWidth,FIELD.tileWidth/4))),t.restore()}}}draw(e){e.clear();for(var t=e.ctx,i=FIELD.tileWidth,a=-1,r=0;r<this.plaqueList.length;r++)if(8!==r&&this.plaqueList[r].isHover){a=r;break}if(a>=0){var s=this.plaqueList[a],o=[i/6,i/6,i/6,i/6],n=i*s.i0,l=i*s.j0,h=i*s.w0,d=i*s.h0,u=[n,n,n+h,n+h],c=[l,l+d,l+d,l],I=new Path2D(Helper.makeRoundedPath(u,c,o,1,0,0));t.save(),t.lineWidth=i/16,t.strokeStyle="darkred",t.beginPath(),t.stroke(I),t.restore()}for(var E=.9*(1+.2*Math.cos(12*Math.PI*TIMER.qubitGlowRatio)),f=.4*Math.sin(2*Math.PI*TIMER.blinkRatio),S=0;S<this.tokenList.length;S++){var p=this.tokenList[S],T=(n=p.i0*this.scale*FIELD.tileWidth,l=p.j0*this.scale*FIELD.tileWidth,PathsC.token(p.name,p._isStar,p._isComplete,p._isAvailable,E,f,p._isHidden));if(T.draw(t,n,l,this.scale*FIELD.tileWidth,this.scale*FIELD.tileHeight,1,!0),p.isHover){var R=Paths.qubitHalo(t,0,!0,-1),m=1.3*(1+.1*Math.cos(8*Math.PI*TIMER.qubitGlowRatio));R.draw(t,n-(m-1)/2*FIELD.tileWidth,l-(m-1)/2*FIELD.tileHeight,m*SELECTOR.scale*FIELD.tileWidth,m*SELECTOR.scale*FIELD.tileHeight)}}this.drawConceptArrow(e)}drawBase(e){e.clear();var t=e.ctx,i=FIELD.tileWidth,a=[2.5,7,2.7,7,11.5,16.5,18.5,13,13],r=[4,5.5,9,10.5,11.2,11.2,6,4.7,4.7],s=[1.2,1.4,1.4,1.3,1.6,1.6,1.4,1.3,2.7];t.save(),t.strokeStyle="grey",t.lineWidth=2,t.setLineDash([5,5]);for(var o=0;o<a.length;o++)t.beginPath(),7!==o&&t.arc((a[o]+.5)*i,(r[o]+.5)*i,(s[o]+.6)*i,0,2*Math.PI),t.stroke();t.beginPath(),t.arc(3*i,13*i,.8*i,0,2*Math.PI),t.stroke(),t.restore();for(o=0;o<this.plaqueList.length;o++)if(8!==o){t.save(),t.lineWidth=i/8,t.strokeStyle="slategrey",t.beginPath();var n=this.plaqueList[o];n.isHover?t.fillStyle="#555":t.fillStyle="#2b2b2b";var l=[i/6,i/6,i/6,i/6],h=i*n.i0,d=i*n.j0,u=i*n.w0,c=i*n.h0,I=[h,h,h+u,h+u],E=[d,d+c,d+c,d],f=new Path2D(Helper.makeRoundedPath(I,E,l,1,0,0));t.fill(f),t.save(),t.clip(f,"evenodd"),Textures.drawFiber(t,h,d,u,c,FIELD.tileWidth/48,.5),t.restore(),t.fillStyle="antiquewhite",t.textBaseline="middle",t.textAlign="center",t.font=1.2*i/3+"px Courier New",t.fillText(n.name,h+u/2,d+c/2),t.restore()}var S=[4.5,5.9,4,9,13.8,18.5,17.1,9.2],p=[5.8,7.5,11.5,7.5,10.1,10,7.5,9.9],T=[5.2,5,5.4,10.3,15.2,19.6,16.2,10.7],R=[6,8.1,11.7,9.9,10.1,8.8,7.6,7.4],m=[4.9,5.7,4.7,10.2,14.5,19.7,16.7,10.6],g=[6,8.2,12.1,8.4,9.6,9.3,7.9,8.5],A=[.03,.35,-.1,.5,.1,-.5,-.8,.9];t.save(),t.strokeStyle="slategrey",t.lineWidth=i/8;for(o=0;o<S.length;o++)t.beginPath(),t.moveTo(S[o]*i,p[o]*i),t.quadraticCurveTo(m[o]*i,g[o]*i,T[o]*i,R[o]*i),t.stroke();t.restore(),t.save(),t.fillStyle="slategrey",t.strokeStyle="slategrey",t.lineWidth=i/24,t.lineJoin="round";for(o=0;o<S.length;o++)t.beginPath(),Helper.arrowHead(t,T[o]*i,R[o]*i,i/5,A[o]*Math.PI),t.fill(),t.stroke();t.restore();for(var C=0;C<this.tokenList.length;C++){var L=this.tokenList[C];h=L.i0*this.scale*FIELD.tileWidth,d=L.j0*this.scale*FIELD.tileWidth;L.pathInfo.drawSelect(t,h,d,this.scale*FIELD.tileWidth,this.scale*FIELD.tileHeight,!0)}}drawConceptArrow(e){if("token"===STATE.under.type){for(var t=STATE.under.k0,i=t.label,a=e.ctx,r=FIELD.tileWidth,s=[[17,24],[17,25],[21,46],[22,61],[9,33],[25,39],[24,40],[37,41],[48,59],[38,49],[20,54]],o=0;o<s.length;o++)s[o][0]+=FIELD.numBonusLevels,s[o][1]+=FIELD.numBonusLevels;var n=[];for(o=0;o<s.length;o++)s[o][1]===i&&n.push(s[o]);a.save(),a.setLineDash([r/6,r/6]),a.lineWidth=r/24;for(o=0;o<n.length;o++){var l=this.tokenList[n[o][0]],h=this.tokenList[n[o][1]],d=l.i0*this.scale*r+.5*r,u=l.j0*this.scale*r+.5*r,c=h.i0*this.scale*r+.5*r,I=h.j0*this.scale*r+.5*r,E=Math.atan2(I-u,c-d),f=.6*r*Math.cos(E),S=.6*r*Math.sin(E),p=Math.sqrt((d-c)**2+(u-I)**2),T=.01*p*(.5*r*Math.cos(E-Math.PI/2)),R=.01*p*(.5*r*Math.sin(E-Math.PI/2)),m=T+d+.5*(c-d),g=R+u+.5*(I-u);a.beginPath(),a.moveTo(d+f,u+S),a.quadraticCurveTo(m,g,c-f,I-S),a.strokeStyle="limegreen",a.lineDashOffset=-2*TIMER.dashRatio*r/6,a.stroke(),a.strokeStyle="grey",a.lineDashOffset=-2*TIMER.dashRatio*r/6-r/6,a.stroke()}a.restore()}}}class Token{constructor(e,t,i,a,r,s,o,n,l,h){this._name=e,this._label=t,this._link=i,this._i0=a,this._j0=r,this._pathInfo=s,this._isHover=!1,this._isAvailable=o,this._isComplete=n,this._isStar=l,this._isHidden=h}get name(){return this._name}get label(){return this._label}get link(){return this._link}get i0(){return this._i0}get j0(){return this._j0}get pathInfo(){return this._pathInfo}get isHover(){return this._isHover}get isHidden(){return this._isHidden}get isAvailable(){return this._isAvailable}set name(e){this._name=e}set label(e){this._label=e}set link(e){this._link=e}set i0(e){this._i0=e}set j0(e){this._j0=e}set pathInfo(e){this._pathInfo=e}set isHover(e){this._isHover=e}set isAvailable(e){this._isAvailable=e}}class SelectPlaque{constructor(e,t,i,a,r,s){this._name=e,this._link=t,this._i0=i,this._j0=a,this._w0=r,this._h0=s,this._isHover=!1}get name(){return this._name}get link(){return this._link}get i0(){return this._i0}get j0(){return this._j0}get w0(){return this._w0}get h0(){return this._h0}get isHover(){return this._isHover}set name(e){this._name=e}set link(e){this._link=e}set i0(e){this._i0=e}set j0(e){this._j0=e}set w0(e){this._w0=e}set h0(e){this._h0=e}set isHover(e){this._isHover=e}}class SoundData{constructor(e,t,i,a){this._url=e,this._name=t,this._delay=i,this._lastTime=-1,this._volAmp=a,SoundData.createBuffer(e,t)}get url(){return this._url}get name(){return this._name}get delay(){return this._delay}get lastTime(){return this._lastTime}get lastPlayed(){return this._lastPlayed}get volAmp(){return this._volAmp}set lastTime(e){this._lastTime=e}set lastPlayed(e){this._lastPlayed=e}load(){console.log("sfxloaded")}pause(){console.log("sfxpaused")}static createBuffer(e,t){fetch(e).then(e=>e.arrayBuffer()).then(e=>audioContext.decodeAudioData(e)).then(e=>SOUNDBUFFER[t]=e).catch(e=>console.error("Error loading sound:",e))}play(){if(OPTS.sfxOn&&SFX.enabled&&performance.now()-this.lastTime>this.delay){this.lastTime=performance.now();const e=audioContext.createBufferSource();e.buffer=SOUNDBUFFER[this.name];const t=audioContext.createGain();t.gain.value=Math.min(1,this.volAmp*OPTS.sfx),e.connect(t),t.connect(audioContext.destination),e.start()}}static initAll(e){SFX.rightBeeped=!0,SFX.wrongBeeped=!0,SFX.tickBeeped=!1,SFX.laserBeeped=!0,SFX.fireBeeped=!0,SFX.createBeeped=!0,SFX.transBeeped=!0,SFX.laserBeeped=!0,SFX.anyBeeped=!1,SFX.title=new Array(47).fill(4),SFX.title[3]=2,SFX.title[7]=1,SFX.title[9]=0,SFX.title[14]=2,SFX.title[15]=2,SFX.title[19]=1,SFX.title[20]=2,SFX.title[22]=1,SFX.title[24]=1,SFX.title[26]=2,SFX.title[29]=1,SFX.title[31]=1,SFX.title[33]=2,SFX.title[35]=1,SFX.title[37]=0,SFX.title[38]=1,SFX.title[39]=2,SFX.title[40]=0,SFX.title[44]=2,SFX.title[46]=1,SFX.background.volume=OPTS.music,SFX.background.loop=!0,SFX.listAll=["mbeep","fbeep","wire","destroy","right","wrong","ntick","ttick","startup","stopdown","create","laser","transform","fire","success","loser","finlaser","manip2","manip","invalid","click","click2","select2","hover"],SoundData.init(e)}static init(e){SFX.background.load(),SFX.background.volume=OPTS.music,OPTS.musicOn&&SFX.enabled?SFX.background.play():SFX.background.pause(),SFX.mbeep=new SoundData(e+"sfx/fembeep4.wav","mbeep",50,.8),SFX.fbeep=new SoundData(e+"sfx/fembeep7.wav","fbeep",50,.8),SFX.wire=new SoundData(e+"sfx/wire.wav","wire",50,.7),SFX.destroy=new SoundData(e+"sfx/destroy2.wav","destroy",50,.7),SFX.right=new SoundData(e+"sfx/right6.wav","right",50,.8),SFX.wrong=new SoundData(e+"sfx/wrong4.wav","wrong",100,.8),SFX.ntick=new SoundData(e+"sfx/ntick3.wav","ntick",200,.4),SFX.ttick=new SoundData(e+"sfx/ntick3.wav","ttick",100,.3),SFX.startup=new SoundData(e+"sfx/startup.wav","startup",0,1),SFX.stopdown=new SoundData(e+"sfx/startup2.wav","stopdown",0,1),SFX.create=new SoundData(e+"sfx/create2.wav","create",80,.8),SFX.laser=new SoundData(e+"sfx/laser5.wav","laser",80,.8),SFX.transform=new SoundData(e+"sfx/transform.wav","transform",80,.7),SFX.fire=new SoundData(e+"sfx/fire.wav","fire",80,.8),SFX.success=new SoundData(e+"sfx/complete.wav","success",0,1),SFX.loser=new SoundData(e+"sfx/loser.wav","loser",0,1),SFX.finlaser=new SoundData(e+"sfx/laser3.wav","finlaser",0,.75),SFX.manip2=new SoundData(e+"sfx/transform3.wav","manip2",350,1.5),SFX.manip=new SoundData(e+"sfx/transform2.wav","manip",350,1),SFX.invalid=new SoundData(e+"sfx/wrong5.wav","invalid",50,1),SFX.click=new SoundData(e+"sfx/click1.wav","click",50,.8),SFX.click2=new SoundData(e+"sfx/click2.wav","click2",50,1),SFX.select2=new SoundData(e+"sfx/select2.wav","select2",50,.6),SFX.hover=new SoundData(e+"sfx/hover3.wav","hover",50,.3),SFX.hover2=new SoundData(e+"sfx/hover2.wav","hover2",50,.6)}static setMusicFull(e){OPTS.musicOn=!OPTS.musicOn,SFX.background.volume=OPTS.music,OPTS.musicOn?SFX.background.play():SFX.background.pause()}static setMusic(){SFX.background.volume=OPTS.music,OPTS.musicOn?SFX.background.play():SFX.background.pause()}static setSFX(){}}class SpeechDump{static grabAll(){var e=["intro0","intro1","intro2","intro3","intro4","intro5","intro6"];e=e.concat(LEVELS.names);for(var t=[],i=0;i<e.length;i++){var a=RobotSpeech.grab(e[i],0,!1,!0),r=RobotSpeech.grab(e[i],1,!1,!0),s=RobotSpeech.grab(e[i],2,!1,!0);a&&t.push(SpeechDump.clean(a)),r&&t.push(SpeechDump.clean(r)),s&&t.push(SpeechDump.clean(s))}return t}static clean(e){if(0!==e.length){for(var t=[],i=0;i<e.length;i++){for(var a=[],r=e[i].split(" "),s=0;s<r.length;s++){var o=r[s];if(o){if("$"===o[0]&&"$"===o[1]){o=o.slice(7);var n=o.length,l=o.slice(-1);"|"===l&&(o=o.slice(0,n-1))}o=o.replace(/`/g,"'"),a+=o+" "}}a&&t.push(a)}return t}}}class Storage{static saveGeneric(){
PERSIST0.generic.music=OPTS.music,PERSIST0.generic.musicOn=OPTS.musicOn,PERSIST0.generic.sfx=OPTS.sfx,PERSIST0.generic.sfxOn=OPTS.sfxOn,PERSIST0.generic.disableBriefs=FIELD.disableBriefs,PERSIST0.generic.fancyGraphics=OPTS.fancyGraphics,PERSIST0.generic.autoResize=OPTS.autoResize,PERSIST0.generic.availableBriefs=FIELD.availableBriefs,localStorage.setItem("generic",JSON.stringify(PERSIST0.generic))}static loadGeneric(){var e=localStorage.getItem("generic");return null!=e&&(PERSIST0.generic=JSON.parse(e),OPTS.music=PERSIST0.generic.music,OPTS.sfx=PERSIST0.generic.sfx,OPTS.musicOn=PERSIST0.generic.musicOn,OPTS.sfxOn=PERSIST0.generic.sfxOn,FIELD.disableBriefs=PERSIST0.generic.disableBriefs,OPTS.fancyGraphics=PERSIST0.generic.fancyGraphics,OPTS.autoResize=PERSIST0.generic.autoResize,FIELD.availableBriefs=[...PERSIST0.generic.availableBriefs],!0)}static save(e,t,i=0,a=!0){var r=t+String(i);localStorage.setItem(r,JSON.stringify(e)),a&&Storage.saveGeneric()}static load(e,t,i=0){var a=t+String(i),r=localStorage.getItem(a);return null!=r&&(e[t]=JSON.parse(r),!0)}static loadFromAll(){var e=localStorage.getItem("allSavedData");if(e){e=JSON.parse(localStorage.getItem("allSavedData"));for(var t=0;t<LEVELS.names.length;t++){var i=e[LEVELS.names[t]];null!=i&&(PERSIST0[LEVELS.names[t]]=i)}i=e.generic;null!=i&&(PERSIST0.generic=i,OPTS.music=PERSIST0.generic.music,OPTS.sfx=PERSIST0.generic.sfx,OPTS.musicOn=PERSIST0.generic.musicOn,OPTS.sfxOn=PERSIST0.generic.sfxOn,FIELD.disableBriefs=PERSIST0.generic.disableBriefs,OPTS.fancyGraphics=PERSIST0.generic.fancyGraphics,OPTS.autoResize=PERSIST0.generic.autoResize,FIELD.isCleanSlate=!1,FIELD.availableBriefs=[...PERSIST0.generic.availableBriefs])}}}class Svgs{constructor(e,t){this._name=t,this._svg=document.getElementById(e),this._x0=0,this._y0=0,this._h0=0,this._w0=0,this._box=0,this._isActive=!1,document.getElementById(e).style.left="0px",document.getElementById(e).style.top="0px",document.getElementById(e).setAttribute("width","100px"),document.getElementById(e).setAttribute("height","100px"),document.getElementById(e).style.width=100,document.getElementById(e).style.height=100}get name(){return this._name}get svg(){return this._svg}get x0(){return this._x0}get y0(){return this._y0}get h0(){return this._h0}get w0(){return this._w0}get box(){return this._box}get isActive(){return this._isActive}set x0(e){this.svg.style.left=e+"px",this._x0=e}set y0(e){this.svg.style.top=e+"px",this._y0=e}set h0(e){this.svg.setAttribute("height",e+"px"),this.svg.style.height=e+"px",this._h0=e}set w0(e){this.svg.setAttribute("width",e+"px"),this.svg.style.width=e+"px",this._w0=e}set box(e){this.svg.setAttribute("viewBox",e),this._box=e}set isActive(e){this._isActive=e}resize(){var e=this.getDims();this.isActive&&(e.x0&&(this.x0=e.x0),e.y0&&(this.y0=e.y0),e.w0&&(this.w0=e.w0),e.h0&&(this.h0=e.h0),e.box&&(this.box=e.box))}static translateAll(e){for(var t=Object.entries(e),i=0;i<t.length;i++)t[i][1].translate()}translate(){var e=this.getDims();this.isActive&&(this.x0=e.x0,this.y0=e.y0)}activate(){this.isActive=!0,this.svg.style.display="block",this.resize()}deactivate(){this.w0=0,this.h0=0,this.x0=0,this.y0=0,this.isActive=!1,this.svg.style.display="none"}static deactivateAll(e){for(var t=Object.entries(e),i=0;i<t.length;i++)t[i][1].deactivate()}getDims(){var e={};if("safariicon"===this.name)e.w0=4.4*FIELD.tileWidth/3,e.h0=4.4*FIELD.tileHeight/3,e.x0=FIELD.leftPad+5*FIELD.tileWidth+0*FIELD.tileWidth,e.y0=FIELD.topPad+.5*FIELD.tileHeight/4+13.75*FIELD.tileHeight/2,e.box="0 0 256 256";else if("fireicon"===this.name)e.w0=3.5*FIELD.tileWidth/3,e.h0=3.5*FIELD.tileHeight/3,e.x0=FIELD.leftPad+4.5*FIELD.tileWidth+0*FIELD.tileWidth,e.y0=FIELD.topPad+.5*FIELD.tileHeight/4+13.75*FIELD.tileHeight/2,e.box="0 0 256 256";else if("operaicon"===this.name)e.w0=3.5*FIELD.tileWidth/3,e.h0=3.5*FIELD.tileHeight/3,e.x0=FIELD.leftPad+2.95*FIELD.tileWidth+.5*FIELD.tileWidth+0*FIELD.tileWidth,e.y0=FIELD.topPad+.5*FIELD.tileHeight/4+13.75*FIELD.tileHeight/2,e.box="0 0 256 256";else if("braveicon"===this.name)e.w0=FIELD.tileWidth/3,e.h0=FIELD.tileHeight/3,e.x0=FIELD.leftPad+2.5*FIELD.tileWidth+.5*FIELD.tileWidth+0*FIELD.tileWidth,e.y0=FIELD.topPad+.5*FIELD.tileHeight/4+13.75*FIELD.tileHeight/2,e.box="0 0 256 256";else if("edgeicon"===this.name)e.w0=FIELD.tileWidth/3,e.h0=FIELD.tileHeight/3,e.x0=FIELD.leftPad+2*FIELD.tileWidth+.5*FIELD.tileWidth+0*FIELD.tileWidth,e.y0=FIELD.topPad+.5*FIELD.tileHeight/4+13.75*FIELD.tileHeight/2,e.box="0 0 256 256";else if("chromeicon"===this.name)e.w0=FIELD.tileWidth/3,e.h0=FIELD.tileHeight/3,e.x0=FIELD.leftPad+1.5*FIELD.tileWidth+.5*FIELD.tileWidth+0*FIELD.tileWidth,e.y0=FIELD.topPad+.5*FIELD.tileHeight/4+13.75*FIELD.tileHeight/2,e.box="0 0 190.5 190.5";else if("awsicon"===this.name)e.w0=2.5*FIELD.tileWidth/3,e.h0=2.5*FIELD.tileHeight/3,e.x0=FIELD.leftPad+9.4*FIELD.tileWidth,e.y0=FIELD.topPad+.5*FIELD.tileHeight/4+13.8*FIELD.tileHeight/2,e.box="0 0 256 512";else if("title"===this.name)e.w0=9.5*FIELD.tileWidth+35*FIELD.tileWidth/8,e.h0=14.5*FIELD.tileHeight/2,e.x0=FIELD.leftPad+.5*FIELD.tileWidth/4,e.y0=FIELD.topPad+.5*FIELD.tileHeight/4;else if("select"===this.name)e.w0=29*FIELD.tileWidth,e.h0=14*FIELD.tileHeight,e.x0=FIELD.leftPad+FIELD.tileWidth/2,e.y0=FIELD.topPad+FIELD.tileHeight/2;else if("board"===this.name){var t=48/FIELD.tileWidth;e.w0=FIELD.tileWidth*FIELD.cols,e.h0=FIELD.tileHeight*FIELD.rows,e.x0=FIELD.leftPad+FIELD.tileWidth/2,e.y0=FIELD.topPad+FIELD.tileHeight/2,e.box="0 0 "+6*t*(FIELD.tileWidth*FIELD.cols)+" "+6*t*(FIELD.tileHeight*FIELD.rows)}else if("menu"===this.name){t=48/FIELD.tileWidth;e.x0=FIELD.menu.x0+FIELD.tileWidth/2,e.y0=FIELD.menu.y0+FIELD.tileHeight/2,e.w0=(FIELD.tileWidth+FIELD.menu.pad)*(FIELD.menu.cols+1)-FIELD.tileWidth,e.h0=(FIELD.tileHeight+FIELD.menu.pad)*(FIELD.menu.rows+1)-FIELD.tileHeight+FIELD.menu.topPad,e.box="0 0 "+6*t*e.w0+" "+6*t*e.h0}else if("analysis"===this.name)e.x0=FIELD.analysisLeft,e.y0=FIELD.topPad+FIELD.tileHeight/2,e.w0=FIELD.analysisWidth,e.h0=FIELD.tileHeight*FIELD.rows;else if("tutorial"===this.name){t=48/FIELD.tileWidth;e.x0=TUTORIAL.leftPad+1.5*FIELD.tileWidth,e.y0=TUTORIAL.topPad+1.5*FIELD.tileHeight,e.w0=6*FIELD.tileWidth,e.h0=12*FIELD.tileHeight,e.box="0 0 "+6*t*e.w0+" "+6*t*e.h0}else if("tutorialB"===this.name){t=48/FIELD.tileWidth;e.x0=TUTORIAL.leftPad+1*FIELD.tileWidth,e.y0=TUTORIAL.topPad+1.5*FIELD.tileHeight,e.w0=6*FIELD.tileWidth,e.h0=12*FIELD.tileHeight,e.box="0 0 "+6*t*e.w0+" "+6*t*e.h0}return e}}class TextParser{static box(e,t,i){var a=t.split(" "),r=[],s=a[0];if("$"===s[0]&&"$"===s[1])var o=s.slice(7);else{s="$$w40r:"+s;o=s.slice(7)}for(var n=o,l=[s],h=e.measureText("| ").width,d=0,u=1;u<a.length;u++){s=a[u];if("$"===s[0]&&"$"===s[1])o=s.slice(7);else{s="$$w40r:"+s;o=s.slice(7)}var c=o.slice(-1);"|"===c&&(d+=1);var I=e.measureText(n+" "+o+" ").width-d*h;I<i?(n=n+" "+o,l.push(s)):(r.push(l),n=o,l=[s],d=0)}return r.push(l),r}static process(e){for(var t=[],i=[],a=0;a<e.length;a++){for(var r=0,s=[],o=0;o<e[a].length;o++){var n=e[a][o],l=n.slice(-1);"|"===l&&(n=n.slice(0,-1));var h=parseInt(n[3]),d=4*parseInt(n[4]),u=4/h*(n.length-6)+d;"."!==n[n.length-1]&&'"'!==n[n.length-1]&&"?"!==n[n.length-1]&&"!"!==n[n.length-1]||(u+=RTIMER.sentenceTime),";"!==n[n.length-1]&&":"!==n[n.length-1]&&","!==n[n.length-1]||(u+=.5*RTIMER.sentenceTime),r+=u,s.push(u)}t.push(r),i.push(s)}return{line:t,word:i}}static draw(e,t,i,a,r,s,o,n,l=0){l||(l=new Array(s.length).fill(0));for(var h=0,d=i,u=0;u<s.length;u++){var c=0;if(!(r>h+o[u])){m=t;var I=h;for(g=0;g<s[u].length;g++){if(!(r>I+n[u][g])){var E=s[u][g],f=parseInt(E[3]),S=4/f*(E.length-6);T=s[u][g].slice(7),R=T.slice(-1);"|"===R?T=T.slice(0,-1):T+=" ";var p=Math.max(0,Math.min(1,(r-I)/S));c=Math.floor(p*T.length);e.fillStyle="antiquewhite","r"===E[2]?e.fillStyle="#ff4551":"b"===E[2]?e.fillStyle="cornflowerblue":"d"===E[2]?e.fillStyle="goldenrod":"g"===E[2]?e.fillStyle="limegreen":e.fillStyle="antiquewhite",e.fillText(T.slice(0,c),m,d);break}var T=s[u][g].slice(7),R=T.slice(-1),c=0;"|"===R?T=T.slice(0,-1):T+=" ","r"===s[u][g][2]?e.fillStyle="#ff4551":"b"===s[u][g][2]?e.fillStyle="cornflowerblue":"d"===s[u][g][2]?e.fillStyle="goldenrod":"g"===s[u][g][2]?e.fillStyle="limegreen":e.fillStyle="antiquewhite",e.fillText(T,m,d),m+=e.measureText(T).width,I+=n[u][g]}STATE.lastLetter!==c&&OPTS.sfxOn&&("levelSelect"===ROBOT.oldMode?SFX.fbeep.play():SFX.mbeep.play()),STATE.lastLetter=c;break}1;for(var m=t,g=0;g<s[u].length;g++){"r"===s[u][g][2]?e.fillStyle="#ff4551":"b"===s[u][g][2]?e.fillStyle="cornflowerblue":"d"===s[u][g][2]?e.fillStyle="goldenrod":"g"===s[u][g][2]?e.fillStyle="limegreen":e.fillStyle="antiquewhite";var T=s[u][g].slice(7),R=T.slice(-1);"|"===R?T=T.slice(0,-1):T+=" ",e.fillText(T,m,d),m+=e.measureText(T).width}h+=o[u],0===l[u]?d+=ROBOT.lineGap:d+=ROBOT.paraGap}}}class Textures{static drawHazard(e,t,i,a,r,s,o){e.save();var n=40*s,l=.9;e.strokeStyle="khaki",e.lineWidth=15*s,e.setLineDash([2*s,1.5*s]),e.globalAlpha=o;var h=i,d=i;for(e.beginPath();d<i+r&&d<i+r;)e.moveTo(t,h),e.lineTo(t+a,h-l*a),d=h-l*a,h+=n;e.stroke(),e.restore()}static drawFiber(e,t,i,a,r,s,o){e.save();var n=15*s,l=1;e.strokeStyle="#152424",e.lineWidth=n,e.setLineDash([4*s,2*s]),e.globalAlpha=o;var h=i,d=i;for(e.beginPath();d<i+r&&d<i+r;)e.moveTo(t,h),e.lineTo(t+a,h-l*a),d=h-l*a,h+=n;e.stroke(),e.restore()}}class Ticker{static draw(e,t,i,a,r,s=!1){var o=e.ctx;if(e.clear(),s)var n=0,l=0,h=0,d=0,u=0;else TIMER.ratio,n=TIMER.popRatio,l=TIMER.tick%10,h=Math.floor(TIMER.tick/10)%10,d=Math.floor(TIMER.tick/100)%10,u=Math.floor(TIMER.tick/1e3)%10;if(9===d&&9===h&&9===l)var c=PathsC.tickerDynamic(o,u,n);else c=PathsC.tickerDynamic(o,u,0);if(c.draw(o,t,i,a,r),9===h&&9===l)c=PathsC.tickerDynamic(o,d,n);else c=PathsC.tickerDynamic(o,d,0);if(c.draw(o,t+a,i,a,r),9===l)c=PathsC.tickerDynamic(o,h,n);else c=PathsC.tickerDynamic(o,h,0);c.draw(o,t+2*a,i,a,r);c=PathsC.tickerDynamic(o,l,n);c.draw(o,t+3*a,i,a,r)}static reset(e,t,i,a,r,s){var o=e.ctx;e.clear();var n=(1-Math.cos(Math.PI*s))/2,l=TIMER.tickEnd,h=l%10,d=Math.floor(l/10)%10,u=Math.floor(l/100)%10,c=Math.floor(l/1e3)%10,I=PathsC.tickerDynamic(o,c,n,0);I.draw(o,t,i,a,r);I=PathsC.tickerDynamic(o,u,n,0);I.draw(o,t+a,i,a,r);I=PathsC.tickerDynamic(o,d,n,0);I.draw(o,t+2*a,i,a,r);I=PathsC.tickerDynamic(o,h,n,0);I.draw(o,t+3*a,i,a,r)}}class Tile{constructor(e,t,i){this._name=e,this._w=t,this._h=i,this._paths=[]}get name(){return this._name}get w(){return this._w}get h(){return this._h}get paths(){return this._paths}set paths(e){this._paths=e}addPath(e){this._paths.push(e)}addText(e,t,i,a,r,s,o=0){var n={type:"text",text:e,pos:t,fill:i,size:a,font:r,weight:s,rot:o};this.addPath(n)}addPathRaw(e,t,i,a,r,s,o="none",n="none",l=2,h=0,d=[],u=1,c=0){o||(o="none"),n||(n="none");var I={type:"raw",path:e,fill:t,stroke:i,lineWidth:a,rot:r,lineCap:s,customScale:h,shadowStroke:n,shadowFill:o,shadowY:l,lineDash:d,alpha:u,dashOffset:c};this.addPath(I)}draw(e,t,i,a,r,s=1,o=!1){for(var n=t,l=i,h=[],d=0;d<this.paths.length;d++)if("text"===this.paths[d].type)h.push(d);else if("raw"===this.paths[d].type){e.save();var u=this.paths[d].alpha*s;if(1-u>.001&&(e.globalAlpha=this.paths[d].alpha*s),e.lineCap=this.paths[d].lineCap,e.lineWidth=this.paths[d].lineWidth,e.lineJoin="round",o?(t=n+this.paths[d].shadowY*(a/32)*.3,i=l+this.paths[d].shadowY*(r/32)*.7):(t=n,i=l,e.shadowBlur=0,e.shadowOffsetX=this.paths[d].shadowY*(a/32)*.3,e.shadowOffsetY=this.paths[d].shadowY*(r/32)*.7),this.paths[d].lineDash&&(e.setLineDash(this.paths[d].lineDash),e.lineDashOffset=this.paths[d].dashOffset),this.paths[d].customScale){var c=this.paths[d].customScale.xScale,I=this.paths[d].customScale.yScale,E=this.paths[d].customScale.x0,f=this.paths[d].customScale.y0;e.translate(t+E*(a/c),i+f*(r/I)),e.scale(a/(this.w*c),r/(this.h*I))}else{var S=a/this.w,p=r/this.h;Math.abs(this.paths[d].rot)>.001?(e.scale(S,p),e.translate(t/S+1/S*a/2,i/p+1/p*r/2),e.rotate(this.paths[d].rot),e.translate(-(t/S+1/S*a/2),-(i/p+1/p*r/2)),e.translate(t/S,i/p)):(e.scale(S,p),e.translate(t/S,i/p))}"none"!==this.paths[d].fill&&("cut"===this.paths[d].fill?(e.globalCompositeOperation="destination-out",e.fill(this.paths[d].path),e.globalCompositeOperation="source-over"):"shadow"===this.paths[d].fill?(e.shadowColor=this.paths[d].shadowFill,e.fill(this.paths[d].path)):o?(e.fillStyle=this.paths[d].shadowFill,e.fill(this.paths[d].path)):(e.fillStyle=this.paths[d].fill,"none"!==this.paths[d].shadowFill&&OPTS.useShads?e.shadowColor=this.paths[d].shadowFill:e.shadowColor="transparent",e.fill(this.paths[d].path))),"none"!==this.paths[d].stroke&&("cut"===this.paths[d].stroke?(e.globalCompositeOperation="destination-out",e.stroke(this.paths[d].path),e.globalCompositeOperation="source-over"):o?(e.strokeStyle=this.paths[d].shadowStroke,e.stroke(this.paths[d].path)):(e.strokeStyle=this.paths[d].stroke,"none"!==this.paths[d].shadowStroke&&OPTS.useShads?e.shadowColor=this.paths[d].shadowStroke:e.shadowColor="transparent",e.stroke(this.paths[d].path))),e.restore()}for(const s of h){e.save(),e.textBaseline="middle",e.textAlign="center";var T=this.paths[s].pos.x*(a/32),R=this.paths[s].pos.y*(r/32),m=this.paths[s].size*(a/32);e.font=this.paths[s].weight+" "+m+"px "+this.paths[s].font,e.translate(t+T,i+R),e.rotate(this.paths[s].rot),OPTS.useShads||(e.shadowColor="transparent"),e.fillStyle=this.paths[s].fill,e.fillText(this.paths[s].text,0,0),e.restore()}}}class Timer{static initTitle(){TIMER.previousStamp=-1,TIMER.tick=0,TIMER.totalTime=0,TIMER.boardTime=0,TIMER.timePerTick=800,TIMER.blinkMax=2e3,TIMER.swirlMax=1e3,TIMER.dashMax=200,TIMER.qubitGlowMax=4e3,TIMER.blobMax=2e3,TIMER.glareMax=1500,TIMER.shakeMax=400,TIMER.wireMax=4e3,TIMER.resizeMax=200,TIMER.message=-1,TIMER.messageMax=1200,TIMER.blinkRatio=0,TIMER.swirlRatio=0,TIMER.dashRatio=0,TIMER.qubitGlowRatio=0,TIMER.blob=0,TIMER.shake=-1,TIMER.wireRatio=0,TIMER.glareRatio=0,TIMER.glareRatioTrig=0,TIMER.ratio=0,TIMER.trigRatio=0,TIMER.popRatio=0,TIMER.trigRatioDub=0,TIMER.resize=0,TIMER.FPS=0,TIMER.FPSmid=0,TIMER.seconds=0}static initialize(){TIMER.previousStamp=-1,TIMER.tick=0,TIMER.totalTime=0,TIMER.boardTime=0,TIMER.defaultTimePerTick=512,TIMER.timePerTick=TIMER.defaultTimePerTick,TIMER.victoryTick=99999,TIMER.dt=0,TIMER.allowWheel=!0,TIMER.totalWheel=0,TIMER.whiteMax=400,TIMER.blinkMax=2e3,TIMER.swirlMax=1e3,TIMER.wireMax=4e3,TIMER.dashMax=300,TIMER.iconMax=300,TIMER.qubitGlowMax=4e3,TIMER.blobMax=2e3,TIMER.shakeMax=400,TIMER.glareMax=1500,TIMER.closureMax=300,TIMER.resizeMax=200,TIMER.whiteRatio=0,TIMER.white=-1,TIMER.blinkRatio=0,TIMER.swirlRatio=0,TIMER.wireRatio=0,TIMER.dashRatio=0,TIMER.qubitGlowRatio=0,TIMER.blob=0,TIMER.shake=-1,TIMER.glareRatio=0,TIMER.glareRatioTrig=0,TIMER.resize=-1,TIMER.message=-1,TIMER.messageMax=1500,TIMER.FPS=0,TIMER.FPSmid=0,TIMER.seconds=0,TIMER.time=0,TIMER.tickEnd=0,TIMER.subTick=-1,TIMER.subMax=20,TIMER.ratio=0,TIMER.trigRatio=0,TIMER.popRatio=0,TIMER.trigRatioDub=0,TIMER.constructMax=1e3,TIMER.construct=TIMER.constructMax,TIMER.transTick=0,TIMER.transTime=0,TIMER.transMax=400,TIMER.transRatioDub=0,TIMER.transRatio=0,TIMER.transRatioTrig=0,TIMER.finishMax=1200,TIMER.finishMid=400,TIMER.finishTime=0,TIMER.newSubMax=20,TIMER.subTickLength=20,TIMER.tickInProgress=!1,TIMER.updateInProgress=!1,TIMER.lastTick=0}static mainStep(e){var t=performance.now();if(TIMER.previousStamp<0&&(TIMER.previousStamp=e),TIMER.dt=Math.min(100,e-TIMER.previousStamp),TIMER.totalTime+=TIMER.dt,TIMER.previousStamp=e,SCENARIO.isPaused)if(TIMER.boardTime%1>1e-5){var i=TIMER.boardTime+TIMER.dt/TIMER.timePerTick;Math.floor(i)>Math.floor(TIMER.boardTime)?TIMER.boardTime=Math.floor(i):TIMER.boardTime=i}else TIMER.boardTime=Math.floor(TIMER.boardTime);else TIMER.boardTime+=TIMER.dt/TIMER.timePerTick;if(FIELD.isBlur||"robot"!==STATE.mode&&TIMER.grey>0&&(TIMER.grey-=TIMER.dt,TIMER.grey<=0&&(document.getElementById("greyoverlay").style.visibility="hidden")),TIMER.construct>=0&&("constructing"===STATE.mode?(TIMER.construct/TIMER.constructMax>.8&&(TIMER.construct-TIMER.dt)/TIMER.constructMax<=.8&&SFX.finlaser.play(),TIMER.construct-=TIMER.dt,TIMER.construct<0&&(TIMER.construct=-1,CANV.interface.clear(),CANV.scenarioMask.clear())):"robot"===STATE.mode||(TIMER.construct=-1)),("running"===STATE.mode||"paused"===STATE.mode)&&(TIMER.boardTime>=TIMER.victoryTick||TIMER.boardTime>=SCENARIO.maxTicks))if(SCENARIO.repetitions>1){if(TIMER.boardTime>=SCENARIO.maxTicks){TIMER.victoryTick=SCENARIO.maxTicks;for(var a=TIMER.tick;a<=SCENARIO.maxTicks;a++)RBOARD[a+1]=RBOARD[a].copy().updateOneStep(a)}TIMER.dt=TIMER.victoryTick-TIMER.boardTime,TIMER.boardTime=TIMER.victoryTick,TIMER.tick=TIMER.victoryTick,SCENARIO.isPaused=!0,SCENARIO.lastWasSuccess=!1,SCENARIO.currentRep+=1,RBOARD[TIMER.tick].success>=SCENARIO.numCorrect&&(SCENARIO.lastWasSuccess=!0,SCENARIO.repSuccess=1,SCENARIO.correctReps+=1),SCENARIO.currentRep<=SCENARIO.repetitions?(!SFX.rightBeeped&&e-SFX.rightLast>40&&(SFX.right.play(),SFX.rightBeeped=!0),SFX.wrongBeeped||(SFX.wrong.play(),SFX.wrongBeeped=!0),ControlState.softReset()):Finished.startCelebration()}else if(SCENARIO.victory<0){if(TIMER.boardTime>=SCENARIO.maxTicks){TIMER.victoryTick=SCENARIO.maxTicks;for(a=TIMER.tick;a<=SCENARIO.maxTicks;a++)RBOARD[a+1]=RBOARD[a].copy().updateOneStep(a)}TIMER.dt=TIMER.victoryTick-TIMER.boardTime,TIMER.boardTime=TIMER.victoryTick,TIMER.tick=TIMER.victoryTick,SCENARIO.isPaused=!0,Finished.startCelebration()}if(TIMER.wireRatio=TIMER.totalTime%TIMER.wireMax/TIMER.wireMax,TIMER.glareRatio=TIMER.totalTime%TIMER.glareMax/TIMER.glareMax,TIMER.glareRatioTrig=(1-Math.cos(TIMER.glareRatio*Math.PI)/2)/2,TIMER.blob=TIMER.totalTime%TIMER.blobMax/TIMER.blobMax,TIMER.blinkRatio=TIMER.totalTime%TIMER.blinkMax/TIMER.blinkMax,TIMER.blinkRatioDub=(1-Math.cos(2*Math.PI*TIMER.blinkRatio))/2,TIMER.swirlRatio=TIMER.totalTime%TIMER.swirlMax/TIMER.swirlMax,TIMER.qubitGlowRatio=TIMER.totalTime%TIMER.qubitGlowMax/TIMER.qubitGlowMax,TIMER.dashRatio=TIMER.totalTime%TIMER.dashMax/TIMER.dashMax,TIMER.ratio=Math.round(TIMER.boardTime%1*1e3)/1e3,TIMER.trigRatio=(1-Math.cos(Math.PI*TIMER.ratio))/2,TIMER.trigRatioDub=(1-Math.cos(2*Math.PI*TIMER.ratio))/2,TIMER.popRatio=.5*(4*TIMER.ratio**3-3*TIMER.ratio**4)+.5*(5*TIMER.ratio**4-4*TIMER.ratio**5),TIMER.resize>TIMER.dt)TIMER.resize-=TIMER.dt;else if(TIMER.resize>=0){var r=ResetConsts.resize();r!==FIELD.tileWidth&&(FIELD.tileWidth=r,FIELD.tileHeight=r,ResetConsts.all(),ResetConsts.refresh(),"robot"===STATE.mode&&ResetConsts.robot(-1,!1)),TIMER.resize=-1}if(STATE.newFocus&&(STATE.newFocus=!1,ResetConsts.all(),ResetConsts.refresh(),"robot"===STATE.mode&&ResetConsts.robot(-1,!1)),TIMER.shake>=0&&(TIMER.dt>0&&(TIMER.shake+=TIMER.dt),TIMER.shake>=TIMER.shakeMax&&(TIMER.shake=-1)),TIMER.white>=0&&(TIMER.dt>0&&(TIMER.white+=TIMER.dt),TIMER.whiteRatio=(1-Math.cos(2*Math.PI*(TIMER.white/TIMER.whiteMax)))/2,TIMER.white>=TIMER.whiteMax&&(TIMER.white=-1,TIMER.whiteRatio=0)),"finishtrans"===STATE.mode?(TIMER.finishTime+=TIMER.dt,TIMER.finishTime>=TIMER.finishMax&&(STATE.mode="finished",TIMER.finishTime=TIMER.finishMax,1===SCENARIO.victory&&(ROBOT.oldMode="finished",STATE.mode="robot",ResetConsts.robot()))):"backwardTrans"===STATE.mode&&TIMER.finishTime>0&&(TIMER.finishTime-=TIMER.dt,TIMER.finishTime<0&&(TIMER.finishTime=0,SCENARIO.victory=-1)),!FIELD.channelsDir.every(e=>0===e))for(a=0;a<6;a++)FIELD.channels[a]=Math.min(Math.max(0,FIELD.channels[a]+Math.max(TIMER.dt,1)/16*.05*FIELD.channelsDir[a]),1),0!==FIELD.channels[a]&&1!==FIELD.channels[a]||(FIELD.channelsDir[a]=0),FIELD.channelsTrig[a]=.5-.5*Math.cos(Math.PI*FIELD.channels[a]);if("forwardTrans"===STATE.mode){if(TIMER.transTime+=TIMER.dt,TIMER.transTime>=TIMER.transMax){TIMER.transTime=TIMER.transMax,SCENARIO.isPaused=!1,STATE.mode="running",RBOARD[0]=IBOARD.copy();for(a=0;a<RBOARD[0].gateList.length;a++){var s=RBOARD[0].gateList[a];"switch"===s.type&&1===s.state&&s.rot<2&&(s.rot+=2)}RBOARD[1]=RBOARD[0].copy().updateOneStep(0)}TIMER.transRatio=TIMER.transTime/TIMER.transMax,TIMER.transRatioTrig=(1-Math.cos(Math.PI*TIMER.transRatio))/2,TIMER.transRatioDub=(1-Math.cos(2*Math.PI*TIMER.transRatio))/2,TIMER.tick=0,TIMER.boardTime=0}"backwardTrans"===STATE.mode&&(TIMER.transTime-=TIMER.dt,TIMER.boardTime=0,TIMER.finishTime-=TIMER.dt,TIMER.transTime<=0&&(RBOARD.fill(0),TIMER.transTime=0,SCENARIO.isPaused=!0,SCENARIO.victory=-1,STATE.mode="constructing",TIMER.tick=0,Ticker.draw(CANV.ticker,FIELD.tileWidth/6,-FIELD.tileWidth/6,2*FIELD.tileWidth/3,4*FIELD.tileWidth/3,!0)),TIMER.transRatio=TIMER.transTime/TIMER.transMax,TIMER.transRatioTrig=(1-Math.cos(Math.PI*TIMER.transRatio))/2,TIMER.transRatioDub=(1-Math.cos(2*Math.PI*TIMER.transRatio))/2);var o=Math.floor(TIMER.boardTime);if(o>TIMER.tick&&-1===["constructing","robot","confirming"].indexOf(STATE.mode)){var n=Math.floor(TIMER.boardTime)-TIMER.tick,l=TIMER.tick;TIMER.tick+=n;for(a=0;a<n;a++)if(RBOARD[l+a+2]=RBOARD[l+a+1].copy().updateOneStep(l+a+1),l>1e3&&(RBOARD[l-1e3+a]=0),TIMER.victoryTick>=SCENARIO.maxTicks){if(0===SCENARIO.victoryCond||2===SCENARIO.victoryCond||4===SCENARIO.victoryCond)var h=RBOARD[l+a+2].success,d=RBOARD[l+a+2].failure,u=h+d>=SCENARIO.maxTrials;else if(1===SCENARIO.victoryCond)u=RBOARD[l+a+2].qubitList.length+RBOARD[l+a+2].bitList.length===0;else if(3===SCENARIO.victoryCond)u=RBOARD[l+a+2].qubitList.length<3;if(u){TIMER.victoryTick=l+a+2,RBOARD[TIMER.victoryTick+1]=RBOARD[TIMER.victoryTick].copy().updateOneStep(TIMER.victoryTick),console.log("victory tick: "+TIMER.victoryTick);break}}if(TIMER.tick>TIMER.victoryTick&&(TIMER.tick=TIMER.victoryTick,TIMER.boardTime=TIMER.victoryTick),void 0!==RBOARD[TIMER.tick-n+1]&&(RBOARD[TIMER.tick+1].success>RBOARD[TIMER.tick-n+1].success?SFX.rightBeeped=!1:SFX.rightBeeped=!0),void 0!==RBOARD[TIMER.tick-n+1]&&(RBOARD[TIMER.tick+1].failure>RBOARD[TIMER.tick-n+1].failure?SFX.wrongBeeped=!1:SFX.wrongBeeped=!0),SFX.tickBeeped=!1,SFX.fireBeeped=!1,SFX.createBeeped=!1,SFX.transformBeeped=!1,SFX.laserBeeped=!1,SFX.anyBeeped=!1,("running"===STATE.mode||"paused"===STATE.mode)&&"qubit"===STATE.grab.type){var c=STATE.grab.k0.id,I=RBOARD[TIMER.tick].qubitList,E=!1;for(a=0;a<I.length;a++)if(I[a].id===c){STATE.grab.i0=I[a].i0,STATE.grab.j0=I[a].j0,STATE.grab.k0=I[a],E=!0;break}E||(STATE.grab={type:"none",i0:0,j0:0,k0:0})}}OPTS.sfxOn&&("running"!==STATE.mode&&"paused"!==STATE.mode||(TIMER.boardTime%1>.4&&(SFX.tickBeeped||(SFX.ntick.play(),SFX.tickBeeped=!0)),TIMER.boardTime%1>.3&&(SFX.rightBeeped||(SFX.right.play(),SFX.rightBeeped=!0),SFX.wrongBeeped||(SFX.wrong.play(),SFX.wrongBeeped=!0),!SFX.laserBeeped&&RBOARD[TIMER.tick].sfx[1]&&(SFX.laser.play(),SFX.laserBeeped=!0,SFX.anyBeeped=!0),!SFX.createBeeped&&RBOARD[TIMER.tick].sfx[3]&&(SFX.create.play(),SFX.createBeeped=!0,SFX.anyBeeped=!0),!SFX.fireBeeped&&RBOARD[TIMER.tick].sfx[0]&&(SFX.fire.play(),SFX.fireBeeped=!0,SFX.anyBeeped=!0)),TIMER.boardTime%1>.1&&(SFX.anyBeeped||SFX.transformBeeped||!RBOARD[TIMER.tick].sfx[2]||(SFX.transform.play(),SFX.transformBeeped=!0,SFX.anyBeeped=!0)))),TIMER.message>0&&(TIMER.message-=TIMER.dt,TIMER.message<0&&(CANV.FPS.clear(),TIMER.message=-1)),Math.floor(TIMER.totalTime/1e3)>TIMER.seconds?(TIMER.FPS=TIMER.FPSmid,TIMER.FPSmid=0,TIMER.seconds+=1,PERF.otherTot=PERF.otherMid,PERF.loopTot=PERF.loopMid,PERF.renderTot=PERF.renderMid,PERF.otherMid=0,PERF.loopMid=0,PERF.renderMid=0):(TIMER.FPSmid+=1,PERF.otherMid+=PERF.other,PERF.loopMid+=PERF.loop,PERF.renderMid+=PERF.render),PERF.other=performance.now()-t;t=performance.now();Loop.main(),PERF.loop=performance.now()-t,"title"===STATE.mode?TIMER.frame=window.requestAnimationFrame(Timer.titleStep):"levelSelect"===STATE.mode?TIMER.frame=window.requestAnimationFrame(Timer.selectStep):"tutorial"===STATE.mode?window.requestAnimationFrame(Timer.tutorialStep):TIMER.frame=window.requestAnimationFrame(Timer.mainStep)}static titleStep(e){TIMER.previousStamp<0&&(TIMER.previousStamp=e),Loop.title();const t=Math.min(100,e-TIMER.previousStamp);TIMER.totalTime+=t,TIMER.previousStamp=e,TIMER.boardTime+=t/TIMER.timePerTick;var i=Math.floor(TIMER.boardTime);if(i>TIMER.tick&&(SFX.anyBeeped=!1,SFX.rightBeeped=!1,TIMER.tick+=1,RBOARD[TIMER.tick+1]=RBOARD[TIMER.tick].copy().updateOneStep(TIMER.tick),47===TIMER.tick&&(TIMER.tick=0,TIMER.boardTime=0)),SFX.title,OPTS.sfxOn&&(!SFX.rightBeeped&&TIMER.boardTime%1>.4&&(SFX.ttick.play(),SFX.rightBeeped=!0),SFX.anyBeeped||(TIMER.boardTime%1>.3&&(1===SFX.title[TIMER.tick]&&(SFX.laser.play(),SFX.anyBeeped=!0),0===SFX.title[TIMER.tick]&&(SFX.fire.play(),SFX.anyBeeped=!0)),TIMER.boardTime%1>.1&&2===SFX.title[TIMER.tick]&&(SFX.transform.play(),SFX.anyBeeped=!0))),Math.floor(TIMER.totalTime/1e3)>TIMER.seconds?(TIMER.FPS=TIMER.FPSmid,TIMER.FPSmid=0,TIMER.seconds+=1):TIMER.FPSmid+=1,TIMER.wireRatio=TIMER.totalTime%TIMER.wireMax/TIMER.wireMax,TIMER.glareRatio=TIMER.totalTime%TIMER.glareMax/TIMER.glareMax,TIMER.glareRatioTrig=(1-Math.cos(TIMER.glareRatio*Math.PI)/2)/2,TIMER.blob=TIMER.totalTime%TIMER.blobMax/TIMER.blobMax,TIMER.blinkRatio=TIMER.totalTime%TIMER.blinkMax/TIMER.blinkMax,TIMER.blinkRatioDub=(1-Math.cos(2*Math.PI*TIMER.blinkRatio))/2,TIMER.swirlRatio=TIMER.totalTime%TIMER.swirlMax/TIMER.swirlMax,TIMER.qubitGlowRatio=TIMER.totalTime%TIMER.qubitGlowMax/TIMER.qubitGlowMax,TIMER.dashRatio=(SEL_STYLES.lineGap+SEL_STYLES.lineDash)*(TIMER.totalTime%TIMER.dashMax)/TIMER.dashMax,TIMER.ratio=Math.round(TIMER.boardTime%1*1e3)/1e3,TIMER.trigRatio=(1-Math.cos(Math.PI*TIMER.ratio))/2,TIMER.trigRatioDub=(1-Math.cos(2*Math.PI*TIMER.ratio))/2,TIMER.popRatio=.5*(4*TIMER.ratio**3-3*TIMER.ratio**4)+.5*(5*TIMER.ratio**4-4*TIMER.ratio**5),TIMER.resize>t)TIMER.resize-=t;else if(TIMER.resize>=0){var a=2*ResetConsts.resize();a!==FIELD.tileWidth&&(FIELD.tileWidth=a,FIELD.tileHeight=a,ResetConsts.title()),TIMER.resize=-1}STATE.newFocus&&(STATE.newFocus=!1,ResetConsts.title()),FIELD.isBlur||"confirming"!==STATE.state&&(TIMER.grey-=t,TIMER.grey<=0&&(document.getElementById("greyoverlay").style.visibility="hidden")),SCENARIO.pauseKey||("title"===STATE.mode?TIMER.frame=window.requestAnimationFrame(Timer.titleStep):"levelSelect"===STATE.mode?TIMER.frame=window.requestAnimationFrame(Timer.selectStep):TIMER.frame=window.requestAnimationFrame(Timer.mainStep))}static selectStep(e){FIELD.neededBrief>=0&&(ROBOT.oldMode="levelSelect",STATE.mode="robot",ResetConsts.robot(FIELD.neededBrief),FIELD.neededBrief=-1,STATE.under={type:"none",i0:-1,j0:-1,k0:-1},CANV.selectText.clear(),SELECTOR.drawText(CANV.selectText)),TIMER.previousStamp<0&&(TIMER.previousStamp=e),Loop.select();const t=Math.min(100,e-TIMER.previousStamp);TIMER.totalTime+=t,TIMER.previousStamp=e,TIMER.boardTime+=t/TIMER.timePerTick;var i=Math.floor(TIMER.boardTime);if(i>TIMER.tick&&(TIMER.tick+=1),TIMER.message>0&&(TIMER.message-=t,TIMER.message<0&&(CANV.FPS.clear(),TIMER.message=-1)),Math.floor(TIMER.totalTime/1e3)>TIMER.seconds?(TIMER.FPS=TIMER.FPSmid,TIMER.FPSmid=0,TIMER.seconds+=1):TIMER.FPSmid+=1,TIMER.wireRatio=TIMER.totalTime%TIMER.wireMax/TIMER.wireMax,TIMER.glareRatio=TIMER.totalTime%TIMER.glareMax/TIMER.glareMax,TIMER.glareRatioTrig=(1-Math.cos(TIMER.glareRatio*Math.PI)/2)/2,TIMER.blob=TIMER.totalTime%TIMER.blobMax/TIMER.blobMax,TIMER.blinkRatio=TIMER.totalTime%TIMER.blinkMax/TIMER.blinkMax,TIMER.blinkRatioDub=(1-Math.cos(2*Math.PI*TIMER.blinkRatio))/2,TIMER.swirlRatio=TIMER.totalTime%TIMER.swirlMax/TIMER.swirlMax,TIMER.qubitGlowRatio=TIMER.totalTime%TIMER.qubitGlowMax/TIMER.qubitGlowMax,TIMER.dashRatio=TIMER.totalTime%TIMER.dashMax/TIMER.dashMax,TIMER.ratio=Math.round(TIMER.boardTime%1*1e3)/1e3,TIMER.trigRatio=(1-Math.cos(Math.PI*TIMER.ratio))/2,TIMER.trigRatioDub=(1-Math.cos(2*Math.PI*TIMER.ratio))/2,TIMER.resize>t)TIMER.resize-=t;else if(TIMER.resize>=0){var a=ResetConsts.resize();a!==FIELD.tileWidth&&(FIELD.tileWidth=a,FIELD.tileHeight=a,ResetConsts.levelSelect(),"robot"===STATE.mode&&ResetConsts.robot(-1,!1)),TIMER.resize=-1}FIELD.isBlur||"robot"!==STATE.mode&&TIMER.grey>0&&(TIMER.grey-=t,TIMER.grey<=0?document.getElementById("greyoverlay").style.visibility="hidden":document.getElementById("greyoverlay").style.opacity=TIMER.grey/TIMER.greyMax*.75),STATE.newFocus&&(STATE.newFocus=!1,ResetConsts.levelSelect(),"robot"===STATE.mode&&ResetConsts.robot(-1,!1)),"title"===STATE.mode?TIMER.frame=window.requestAnimationFrame(Timer.titleStep):"constructing"===STATE.mode?TIMER.frame=window.requestAnimationFrame(Timer.mainStep):("levelSelect"===STATE.mode||ROBOT.oldMode,TIMER.frame=window.requestAnimationFrame(Timer.selectStep))}static initTutorial(){UTIMER.previousStamp=-1,UTIMER.tick=0,UTIMER.totalTime=0,UTIMER.boardTime=0,UTIMER.timePerTick=TUTORIAL.timePerTick,UTIMER.qubitGlowMax=4e3,UTIMER.seconds=0,TIMER.ratio=0,TIMER.trigRatio=0,TIMER.popRatio=0,TIMER.trigRatioDub=0,TIMER.qubitGlowRatio=0}static confirmStep(e){ConfirmationBox.loop(),window.requestAnimationFrame(Timer.confirmStep)}static tutorialStep(e){UTIMER.previousStamp<0&&(UTIMER.previousStamp=e),Math.floor(UTIMER.totalTime/1e3)>UTIMER.seconds?(TIMER.FPS=TIMER.FPSmid,TIMER.FPSmid=0,UTIMER.seconds+=1):TIMER.FPSmid+=1,Loop.tutorial();const t=Math.min(100,e-UTIMER.previousStamp);if(UTIMER.totalTime+=t,UTIMER.previousStamp=e,UTIMER.boardTime+=t/UTIMER.timePerTick,TIMER.resize>t)TIMER.resize-=t;else if(TIMER.resize>=0){var i=ResetConsts.resize();i!==FIELD.tileWidth&&(STATE.mode=TUTORIAL.oldMode,TUTORIAL.show=!1,FIELD.cameraX=0,FIELD.cameraY=0,SCENARIO.text0=0,SCENARIO.text1=0,OPTS.basis=TUTORIAL.basis,FIELD.tileWidth=i,FIELD.tileHeight=i,ResetConsts.all(),ResetConsts.refresh(),"running"===STATE.mode?Render.boardDynamic(RBOARD[TIMER.tick],RBOARD[TIMER.tick+1],0,[0,1,1]):"constructing"===STATE.mode&&Render.boardSingle(IBOARD),Analysis.updateSlide(CANV.analysis),STATE.mode="tutorial",ResetConsts.tutorial(),TUTORIAL.show=!0),TIMER.resize=-1}var a=Math.floor(UTIMER.boardTime);a>UTIMER.tick&&("free"===TUTORIAL.type?(UTIMER.tick+=1,UBOARD.shift(),UBOARD.push(UBOARD[0].copy().updateOneStep())):"fixed"===TUTORIAL.type&&(UTIMER.tick+=1)),TIMER.ratio=Math.floor(UTIMER.boardTime%1*1e3)/1e3,TIMER.trigRatio=(1-Math.cos(Math.PI*TIMER.ratio))/2,TIMER.trigRatioDub=(1-Math.cos(2*Math.PI*TIMER.ratio))/2,TIMER.popRatio=.5*(4*TIMER.ratio**3-3*TIMER.ratio**4)+.5*(5*TIMER.ratio**4-4*TIMER.ratio**5),TIMER.qubitGlowRatio=UTIMER.totalTime%UTIMER.qubitGlowMax/UTIMER.qubitGlowMax,TIMER.glareRatio=UTIMER.totalTime%TIMER.glareMax/TIMER.glareMax,TIMER.glareRatioTrig=(1-Math.cos(TIMER.glareRatio*Math.PI)/2)/2,TIMER.dashRatio=UTIMER.totalTime%TIMER.dashMax/TIMER.dashMax,TIMER.blob=UTIMER.totalTime%TIMER.blobMax/TIMER.blobMax,TIMER.blinkRatio=UTIMER.totalTime%TIMER.blinkMax/TIMER.blinkMax,TIMER.blinkRatioDub=(1-Math.cos(2*Math.PI*TIMER.blinkRatio))/2,TIMER.swirlRatio=UTIMER.totalTime%TIMER.swirlMax/TIMER.swirlMax,SCENARIO.pauseKey||("title"===STATE.mode?TIMER.frame=window.requestAnimationFrame(Timer.titleStep):"levelSelect"===STATE.mode?TIMER.frame=window.requestAnimationFrame(Timer.selectStep):"tutorial"===STATE.mode?window.requestAnimationFrame(Timer.tutorialStep):TIMER.frame=window.requestAnimationFrame(Timer.mainStep))}static initRobot(){RTIMER.previousStamp=-1,RTIMER.tick=0,RTIMER.totalTime=-1e3,RTIMER.pageTime=-1e3,RTIMER.seconds=0,RTIMER.pulse=0,RTIMER.pulseMax=1e3,RTIMER.charTime=20,RTIMER.sentenceTime=40,RTIMER.thetaMax=2e3,RTIMER.theta=0,RTIMER.stretchMax=2500,RTIMER.stretch=0,RTIMER.extendMax=2500,RTIMER.extend=0}static robotStep(e){RTIMER.previousStamp<0&&(RTIMER.previousStamp=e),Math.floor(RTIMER.totalTime/1e3)>RTIMER.seconds&&(RTIMER.seconds+=1);const t=Math.min(100,e-RTIMER.previousStamp);RTIMER.totalTime+=t,RTIMER.pageTime+=t,RTIMER.previousStamp=e,RTIMER.boardTime+=t/RTIMER.timePerTick,RTIMER.theta=.5*Math.sin(2*Math.PI*(RTIMER.totalTime%RTIMER.thetaMax)/RTIMER.thetaMax),RTIMER.stretch=Math.sin(2*Math.PI*(RTIMER.totalTime%RTIMER.stretchMax)/RTIMER.stretchMax),RTIMER.extend=Math.sin(2*Math.PI*(RTIMER.totalTime%RTIMER.extendMax)/RTIMER.extendMax),RTIMER.pulse=Math.sin(2*Math.PI*(RTIMER.totalTime%RTIMER.pulseMax)/RTIMER.pulseMax),
RTIMER.pageTime/RTIMER.charTime>ROBOT.totTime&&(ROBOT.isDone=!0)}}class Tooltip{static find(){if("escbutton"!==STATE.under.type)if("archiveButton"!==STATE.under.type)if("journalButton"!==STATE.under.type)if("constructing"!==STATE.mode||"letterButton"!==STATE.under.type){if("constructing"===STATE.mode){if("eraser"===STATE.under.type)return void(STATE.tooltip="Select eraser");if("boardtile"===STATE.under.type&&("erasing"===STATE.state||"destroying"===STATE.state)){var e=STATE.under.i0+STATE.under.j0*FIELD.cols;return void(1===SCENARIO.editable[e]?STATE.tooltip="Clear tile":STATE.tooltip="Cannot clear tile")}}if("paused"===STATE.mode||"constructing"===STATE.mode){if("qubitbasis"===STATE.state)return void(STATE.tooltip="Adjust qubit basis");if("analysisgatecontrolling"===STATE.state)return void(STATE.tooltip="Adjust measurement axis");if("qubit"===STATE.under.type)return void(STATE.tooltip="Select qubit");if("qubiticon"===STATE.under.type)return void(STATE.tooltip="Lock / unlock the basis");if("analysisgate"===STATE.under.type)return void(STATE.tooltip="Select qubit to analyze");if("analysishighlight"===STATE.under.type)return void(STATE.tooltip="Highlight basis states");if("analysisgatecontrol"===STATE.under.type)return void(STATE.tooltip="Adjust measurement axis");if("qubitcontrol"===STATE.under.type)return void(STATE.tooltip="Adjust qubit basis")}if("finished"===STATE.mode){if("ctrlbutton"===STATE.under.type&&0===STATE.under.i0)return void(STATE.tooltip="Reset the factory");if("nextbutton"===STATE.under.type)return void(STATE.tooltip="Return to level select")}else if("paused"===STATE.mode){if("ctrlbutton"===STATE.under.type){if(0===STATE.under.i0)return void(STATE.tooltip="Reset the factory");if(1===STATE.under.i0)return void(STATE.tooltip="Step back");if(3===STATE.under.i0)return void(STATE.tooltip="Step forward");if(4===STATE.under.i0){var t=TIMER.defaultTimePerTick/TIMER.timePerTick;return void(STATE.tooltip="Reset speed (current x"+t+")")}if(2===STATE.under.i0)return void(STATE.tooltip="Unpause")}}else if("running"===STATE.mode){if("ctrlbutton"===STATE.under.type){if(0===STATE.under.i0)return void(STATE.tooltip="Reset the factory");if(1===STATE.under.i0){t=TIMER.defaultTimePerTick/TIMER.timePerTick;return void(STATE.tooltip="Slow down (current x"+t+")")}if(3===STATE.under.i0){t=TIMER.defaultTimePerTick/TIMER.timePerTick;return void(STATE.tooltip="Speed up (current x"+t+")")}if(4===STATE.under.i0){t=TIMER.defaultTimePerTick/TIMER.timePerTick;return void(STATE.tooltip="Reset speed (current x"+t+")")}if(2===STATE.under.i0)return void(STATE.tooltip="Pause")}}else if("constructing"===STATE.mode){if("blueprint"===STATE.under.type)return void(0===STATE.under.i0?STATE.tooltip="Change to blueprint X":1===STATE.under.i0?STATE.tooltip="Change to blueprint Y":2===STATE.under.i0&&(STATE.tooltip="Change to blueprint Z"));if("questionicon"===STATE.under.type)return void(STATE.tooltip="Query gate function");if("none"===STATE.under.type)return void(STATE.tooltip="");if("menubutton"===STATE.under.type){var i=MENU.getButton(STATE.under.i0,STATE.under.j0);return-1!==i?void(STATE.tooltip="Select gate"):void(STATE.tooltip="")}if("ctrlbutton"===STATE.under.type)return 0===STATE.under.i0?void(STATE.tooltip="Start the factory"):void(STATE.tooltip="");if("multiplace"===STATE.state){if("boardtile"===STATE.under.type)return COPYBUFFER.placeable.includes(0)?void(STATE.tooltip="Invalid paste region"):void(STATE.tooltip="Valid paste region")}else if("premultiplace"===STATE.state&&"boardtile"===STATE.under.type)return COPYBUFFER.placeable.includes(0)?void(STATE.tooltip="Invalid copy selection"):void(STATE.tooltip="Valid copy selection");if(["free","gatemanip","pregatemanip","qubiting"].indexOf(STATE.state)>=0){if("boardtile"===STATE.under.type){e=STATE.under.i0+STATE.under.j0*FIELD.cols;if(SCENARIO.editable[e]<1)return void(STATE.tooltip="");var a=IBOARD.getGate(STATE.under.i0,STATE.under.j0,IBOARD.state[e]);return a&&IBOARD._tiles[e]<0&&IBOARD.setGate(a),a?(Tooltip.identifyGate(a),void("sync"!==a.type&&STATE.tooltip&&(STATE.tooltip=STATE.tooltip))):void(STATE.tooltip="")}if("gateicon"===STATE.under.type){if(4===STATE.under.k0)return void(STATE.tooltip="Set control state to '0'");if(5===STATE.under.k0)return void(STATE.tooltip="Set control state to '1'");a=STATE.grab.k0;if(["switch","qControl"].indexOf(a.type)>=0)return void(STATE.tooltip="Toggle target state");if(["cInvert","qFlip"].indexOf(a.type)>=0)return void(STATE.tooltip="Toggle gate function");if(["trash"].indexOf(a.type)>=0)return void(STATE.tooltip="Toggle counter");if(["cCreate","qCreate"].indexOf(a.type)>=0)return"qCreate"===a.type&&2===STATE.under.k0?void(STATE.tooltip="Toggle basis lock"):void(STATE.tooltip="Adjust production")}else if("gatecontrol"===STATE.under.type){a=STATE.grab.k0;return["cCreate","qCreate"].indexOf(a.type)>=0?void(STATE.tooltip="Adjust output"):["delay"].indexOf(a.type)>=0?void(STATE.tooltip="Adjust delay"):void(STATE.tooltip="Adjust rotation")}}else if("gatedrag"===STATE.state){a=STATE.grab.k0;if(["cCreate"].indexOf(a.type)>=0){var r=Math.round(a.rot)%3;return void(STATE.tooltip=0===r?"Fixed output: 0,0,0,0":1===r?"Alternating output: 0,1,0,1":"Randomized output")}if(["qCreate"].indexOf(a.type)>=0){r=Math.round(a.rot)%3;return void(STATE.tooltip=0===r?"Fixed output: +Z":1===r?"Random output: [+Z,-Z]":"Fully randomized output")}if(["delay"].indexOf(a.type)>=0){if(0===a.state){r=Math.round(a.rot+8)%8;STATE.tooltip="Delay: "+r+" ticks"}else STATE.tooltip="Delay: "+a.state+" ticks";return}if(["cCombine","cSplit","qCombine"].indexOf(a.type)>=0){var s=Math.round(2*(1+a.rot/Math.PI))%4,o=["West","North","East","South"];return void(STATE.tooltip="Adjust rotation: "+o[s])}if(["qControl","measure","rotate","qFlip","upgrade"].indexOf(a.type)>=0){var n=a.getRotRad();return void(STATE.tooltip="Adjust rotation: "+n)}return void(STATE.tooltip="Adjust rotation")}if("undobutton"===STATE.under.type)return void(STATE.tooltip="Undo last action (`z`)");if("redobutton"===STATE.under.type)return void(STATE.tooltip="Redo last action (`x`)")}STATE.tooltip=""}else 0===STATE.under.i0?STATE.tooltip="Open handbook":1===STATE.under.i0?RobotSpeech.grab(SCENARIO.name,0,!0)?STATE.tooltip="Repeat level briefing":STATE.tooltip="No briefing unavailable":2===STATE.under.i0?STATE.tooltip="Refresh starting states":3===STATE.under.i0&&(STATE.tooltip="Clear the board");else STATE.tooltip="Ex-employee journal";else STATE.tooltip="View archive (external link)";else 0===STATE.under.i0?STATE.tooltip="Return to Level Select":1===STATE.under.i0?OPTS.musicOn?STATE.tooltip="Mute Music":STATE.tooltip="Unmute Music":2===STATE.under.i0&&(OPTS.sfxOn?STATE.tooltip="Mute Sound Effects":STATE.tooltip="Unmute Sound Effects")}static identifyGate(e){if("upgrade"!==e.type)if("switch"!==e.type)if("cCombine"!==e.type)if("cSplit"!==e.type){if("cInvert"===e.type){if(0===e.state)return 0===e.rot?void(STATE.tooltip="Bit inversion"):void(STATE.tooltip="Bit identity");if(1===e.state)return 0===e.rot?void(STATE.tooltip="Bit re-zero"):void(STATE.tooltip="Bit identity")}else{if("cCreate"===e.type){var t=Math.round(e.rot)%3;return void(STATE.tooltip=0===t?"Bit creation (0,0,0,0)":1===t?"Bit creation (0,1,0,1)":"Bit creation (random)")}if("qCreate"===e.type){t=Math.round(e.rot)%3;return void(STATE.tooltip=0===t?"Qubit creation (+Z)":1===t?"Qubit creation (+Z,-Z)":"Qubit creation (random)")}if("qControl"===e.type){if(0===e.state){i=e.getRotRad(!1);STATE.tooltip="Qubit control ("+i+")"}else{i=e.getRotRad(!1);STATE.tooltip="Qubit control ("+i+")"}return}if("qCombine"===e.type)return void(STATE.tooltip="Qubit wire combiner");if("measure"===e.type){i=e.getRotRad(!1);return void(STATE.tooltip="Qubit measure ("+i+")")}if("qFlip"===e.type){if(0===e.state){i=e.getRotRad(!1);return void(STATE.tooltip="Qubit flip ("+i+")")}return void(STATE.tooltip="Qubit identity")}if("rotate"===e.type){i=e.getRotRad(!1);return void(STATE.tooltip="Qubit rotation ("+i+")")}if("delay"===e.type)return void(STATE.tooltip="Delay ("+e.state+" ticks)");if("sync"===e.type)return void(STATE.tooltip="Sync");if("trash"===e.type)return void(STATE.tooltip="Incinerator")}STATE.tooltip=""}else STATE.tooltip="Bit wire splitter";else STATE.tooltip="Bit wire combiner";else 0===e.rot?STATE.tooltip="Bit control (state '0')":STATE.tooltip="Bit control (state '1')";else{var i=e.getRotRad(!1);STATE.tooltip="Bit-to-qubit ("+i+")"}}static draw(){var e="boardtile"===STATE.under.type&&"constructing"===STATE.mode&&"placing"===STATE.state;e||Tooltip.find(),CANV.tooltip.clear();var t=3.5*FIELD.tileWidth-CANV.tooltip.ctx.measureText(STATE.tooltip).width/2;CANV.tooltip.ctx.fillText(STATE.tooltip,t,FIELD.tileHeight/3)}}class TutControl{static drawSuperposition(){CANV.tutorialExtra.clear();var e=CANV.tutorialExtra.ctx,t=FIELD.tileWidth,i=FIELD.tileHeight,a=.25*i;e=CANV.tutorialExtra.ctx,e.save(),e.translate(.2*i,0),e.save(),e.globalCompositeOperation="lighter",e.strokeStyle="black",e.lineWidth=1,e.fillStyle="#00c7f0",e.beginPath(),e.ellipse(1.25*t,4.5*i-a,t/3,i/2,0,0,2*Math.PI),e.stroke(),e.fill(),e.fillStyle="#0081f0",e.beginPath(),e.ellipse(3*t,(4.1+.3*TIMER.blinkRatioDub)*i-a,t/3,i/2,0,0,2*Math.PI),e.stroke(),e.fill(),e.fillStyle="#004600",e.beginPath(),e.ellipse(3*t,(4.9-.3*TIMER.blinkRatioDub)*i-a,t/3,i/2,0,0,2*Math.PI),e.stroke(),e.fill(),e.fillStyle="#0000f0",e.beginPath(),e.ellipse(4.75*t,(4.1+.3*TIMER.blinkRatioDub)*i-a,t/3,i/2,0,0,2*Math.PI),e.stroke(),e.fill(),e.fillStyle="#00c700",e.beginPath(),e.ellipse(4.75*t,(4.9-.3*TIMER.blinkRatioDub)*i-a,t/3,i/2,0,0,2*Math.PI),e.stroke(),e.fill(),e.restore();var r=[Math.cos(Math.PI/8),Math.sin(Math.PI/8)],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/4,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,1*t,7*i,FIELD.tileWidth,FIELD.tileHeight);r=[1/Math.sqrt(2),-1/Math.sqrt(2)],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,0,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,2.5*t,7*i,FIELD.tileWidth,FIELD.tileHeight);r=[Math.cos(5.5*Math.PI/8),-Math.sin(5.5*Math.PI/8)],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,3*Math.PI/4,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,4*t,7*i,FIELD.tileWidth,FIELD.tileHeight);r=[1,0],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,0,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,.5*t,9.5*i,FIELD.tileWidth,FIELD.tileHeight);r=[1/Math.sqrt(2),0],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/2,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,1.9*t,(8.9+.2*TIMER.blinkRatioDub)*i,FIELD.tileWidth,FIELD.tileHeight);r=[0,1/Math.sqrt(2)],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/2,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,1.9*t,(10.1-.2*TIMER.blinkRatioDub)*i,FIELD.tileWidth,FIELD.tileHeight);r=[0,1],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,0,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,2.85*t,9.5*i,FIELD.tileWidth,FIELD.tileHeight);r=[1/Math.sqrt(2),0],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/2,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,4.25*t,(8.9+.2*TIMER.blinkRatioDub)*i,FIELD.tileWidth,FIELD.tileHeight);r=[0,-1/Math.sqrt(2)],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/2,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,4.25*t,(10.1-.2*TIMER.blinkRatioDub)*i,FIELD.tileWidth,FIELD.tileHeight);r=[1,0],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,0,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,.75*t,2.5*i-1*i,FIELD.tileWidth,FIELD.tileHeight);r=[Math.cos(Math.PI/8),0],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/4,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,2.5*t,(1.9+.2*TIMER.blinkRatioDub)*i-1*i,FIELD.tileWidth,FIELD.tileHeight);r=[0,Math.sin(Math.PI/8)],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/4,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,2.5*t,(3.1-.2*TIMER.blinkRatioDub)*i-1*i,FIELD.tileWidth,FIELD.tileHeight);r=[1/Math.sqrt(2),0],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/2,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,4.25*t,(1.9+.2*TIMER.blinkRatioDub)*i-1*i,FIELD.tileWidth,FIELD.tileHeight);r=[0,1/Math.sqrt(2)],s=Qubit.computeAlfsManual(TIMER.blinkRatio,r),o=Paths.newQubit(e,Math.PI/2,0,TIMER.glareRatio,0,s[1],r,[0,r[1]**2],s,!1);o.draw(e,4.25*t,(3.1-.2*TIMER.blinkRatioDub)*i-1*i,FIELD.tileWidth,FIELD.tileHeight),e.save(),e.beginPath(),e.lineWidth=FIELD.tileWidth/24,Helper.squareBracket(e,2.6,2),Helper.squareBracket(e,4.35,2),Helper.squareBracket(e,2,10),Helper.squareBracket(e,4.35,10),e.stroke(),e.restore(),e.save(),e.textBaseline="middle",e.textAlign="center",e.font=FIELD.tileWidth/2+"px Verdana",e.fillStyle="black",e.fillText("=",2.1*t,3*i-1*i),e.fillText("=",3.9*t,3*i-1*i),e.fillText("=",2.1*t,4.5*i-a),e.fillText("=",3.9*t,4.5*i-a),e.fillText("=",1.6*t,10*i),e.fillText("=",3.9*t,10*i),e.font=FIELD.tileWidth/4+"px Verdana",e.fillText("0.92",3*t,2*i-1*i),e.fillText("0.38",3*t,4*i-1*i),e.fillText("0.71",4.75*t,2*i-1*i),e.fillText("0.71",4.75*t,4*i-1*i),e.fillText("0.71",4.75*t,2*i+7*i),e.fillText("-0.71",4.75*t,4*i+7*i),e.fillText("0.71",4.75*t-2.35*t,2*i+7*i),e.fillText("0.71",4.75*t-2.35*t,4*i+7*i),e.font=FIELD.tileWidth/3+"px Verdana",e.fillText("+",3*t,3*i-1*i),e.fillText("+",4.75*t,3*i-1*i),e.fillText("+",3*t,4.5*i-a),e.fillText("+",4.75*t,4.5*i-a),e.fillText("+",4.75*t-2.35*t,10*i),e.fillText("+",4.75*t,10*i),e.restore(),e.restore()}static draw(){CANV.tutorialHeader.clear();var e=CANV.tutorialHeader.ctx,t=0,i=0,a=0,r=0;if("tutbutton"===STATE.pressed.type){var s=Date.now()-STATE.pressed.i0;s>TIMER.iconMax&&(STATE.pressed={type:"none",i0:0,j0:0,k0:0})}if("tutbutton"===STATE.pressed.type){var o=.5*(1-Math.cos(2*Math.PI*(s/TIMER.iconMax)))*(FIELD.tileWidth/48);1===STATE.pressed.k0?(t=8*o/4,a=8*o/4):2===STATE.pressed.k0&&(i=8*o/4,r=8*o/4)}var n="tbutton"===STATE.under.type&&1===STATE.under.i0,l=PathsI.icon(e,"leftRightIcon",{type:0,hover:n});l.draw(e,2.75*FIELD.tileWidth,.875*FIELD.tileHeight,FIELD.tileHeight/2+t,FIELD.tileHeight/2+a);var h=10*FIELD.tileWidth+TUTORIAL.boxWidth;n="tbutton"===STATE.under.type&&2===STATE.under.i0,l=PathsI.icon(e,"leftRightIcon",{type:1,hover:n});l.draw(e,h-3.25*FIELD.tileWidth,.875*FIELD.tileHeight,FIELD.tileHeight/2+i,FIELD.tileHeight/2+r);n="tbutton"===STATE.under.type&&3===STATE.under.i0,l=PathsI.icon(e,"leftRightIcon",{type:2,hover:n});l.draw(e,h-1.5*FIELD.tileWidth,.5*FIELD.tileHeight,FIELD.tileHeight/2,FIELD.tileHeight/2)}static click(){var e="tbutton"===STATE.under.type&&1===STATE.under.i0;if(e)return SFX.click.play(),TUTORIAL.current-=1,TUTORIAL.current<0&&(TUTORIAL.current=TUTORIAL.currentMax),ResetConsts.tutorial(),void(STATE.pressed={type:"tutbutton",i0:Date.now(),j0:-1,k0:1});FIELD.tileWidth,TUTORIAL.boxWidth,e="tbutton"===STATE.under.type&&2===STATE.under.i0;if(e)return SFX.click.play(),TUTORIAL.current+=1,TUTORIAL.current>TUTORIAL.currentMax&&(TUTORIAL.current=0),ResetConsts.tutorial(),void(STATE.pressed={type:"tutbutton",i0:Date.now(),j0:-1,k0:2});e="tbutton"===STATE.under.type&&3===STATE.under.i0;return e?(SFX.click.play(),void TutControl.close()):void 0}static close(){TUTORIAL.default=TUTORIAL.current,STATE.mode=TUTORIAL.oldMode,TUTORIAL.show=!1,FIELD.cameraX=0,FIELD.cameraY=0,SCENARIO.text0=0,SCENARIO.text1=0,SCENARIO.text2=0,OPTS.basis=TUTORIAL.basis,SCENARIO.channelsCol=[...TUTORIAL.channelsCol],ResetConsts.all(),ResetConsts.refresh(),TIMER.grey=TIMER.greyMax,document.getElementById("greyoverlay").style.opacity=.75,document.getElementById("greyoverlay").style.visibility="visible",INPUTS.keydown=0}}class UndoRedo{constructor(e){this._boardStorage=new Array(e).fill(0),this._numKept=e,this._numCurr=0,this._numAvail=0,this._numFwd=0,this._leftExtend=0,this._rightExtend=0}get numKept(){return this._numKept}get numCurr(){return this._numCurr}get numAvail(){return this._numAvail}get numFwd(){return this._numFwd}get boardStorage(){return this._boardStorage}get leftExtend(){return this._leftExtend}get rightExtend(){return this._rightExtend}set numKept(e){this._numKept=e}set numCurr(e){this._numCurr=e}set numAvail(e){this._numAvail=e}set numFwd(e){this._numFwd=e}set boardStorage(e){this._boardStorage=e}set leftExtend(e){this._leftExtend=e}set rightExtend(e){this._rightExtend=e}reset(e=!1){this.boardStorage=new Array(this.numKept).fill(0),this.boardStorage[0]=IBOARD.copy(),this.numCurr=0,this.numAvail=0,this.numFwd=0,e||(this.leftExtend=0,this.rightExtend=0,CANV.undos.clear())}add(){this.boardStorage[this.numCurr].serialize()!==IBOARD.serialize()&&(this.numCurr+1>=this.numKept?this.numCurr=0:this.numCurr+=1,this.numAvail+1>=this.numKept?this.numAvail=this.numKept-1:this.numAvail+=1,this.numFwd=0,this.boardStorage[this.numCurr]=IBOARD.copy())}replace(){this.boardStorage[this.numCurr]=IBOARD.copy()}advance(){this.numFwd>0&&(SFX.click.play(),this.numCurr+1>=this.numKept?this.numCurr=0:this.numCurr+=1,this.numFwd-=1,this.numAvail+=1,this.boardStorage[this.numCurr]&&(IBOARD=this.boardStorage[this.numCurr].copy()))}retreat(){"gatemanip"!==STATE.state&&"qubiting"!==STATE.state||(STATE.grab={type:"none",i0:-1,j0:-1,k0:-1},STATE.state="free"),this.numAvail>0&&(SFX.click.play(),0===this.numCurr?this.numCurr=this.numKept-1:this.numCurr-=1,this.numFwd+=1,this.numAvail-=1,this.boardStorage[this.numCurr]&&(IBOARD=this.boardStorage[this.numCurr].copy()))}}const STATE=new ControlState,FIELD={},OPTS={},SCENARIO={},CANV={},SVG={},ANALYSIS={},OVERLAY={},SEL_STYLES={},DEBUG={},INPUTS={},TIMER={},UTIMER={},RTIMER={},FLARES={},GRADS={},PERF={},TUTORIAL={},ROBOT={},BLUEPRINT={},RBOARD=new Array(1e4).fill(0),UBOARD=new Array(2).fill(0),PERSIST0={},SFX={},audioContext=new(window.AudioContext||window.webkitAudioContext),UNDOREDO=new UndoRedo(10),SOUNDBUFFER={},COPYBUFFER=new CopyBuffer,POPWINDOW={},RANDS={};RANDS.all=Array.from({length:11e4},()=>Math.random()),RANDS.locs=Array(1e4).fill(0),RANDS.count=0,RANDS.tick=-1;var IBOARD=0,GLOBAL_ID=0,GLOBAL_IDG=0,GLOBAL_IDE=0;const MENU=new Menu(0,0,0,0,0,0,0),SELECTOR=new SelectLevel(0),CTRLMENU=CtrlMenu.initialize(),ENTBLOBS=new EntBlob;ENTBLOBS.makeBlobs(),TIMER.greyMax=600,TIMER.grey=-1,STATE.profile=0,FIELD.isOnHarmony=!1,FIELD.developerMode=!1,FIELD.feedBack="https://github.com/awslabs/the-qubit-factory/wiki",FIELD.version="v1.1.2",FIELD.totFrames=0,FIELD.forced=!1,FIELD.forceOpen=!1,FIELD.forceOpenRing=[!1,!1,!1,!1,!1,!1,!1,!1,!1],FIELD.neededBrief=-1,FIELD.disableBriefs=!1,FIELD.defaultWidth=ResetConsts.resize(!0),FIELD.tileWidth=ResetConsts.resize(!0),FIELD.tileHeight=ResetConsts.resize(!0),FIELD.availableBriefs=[0,0,0,0,0,0,0],FIELD.isActiveAward=[0,0,0,0,0,0],FIELD.showTitleMenu=!0,FIELD.numBonusLevels=4,FIELD.message="",FIELD.cleanTiles=0,FIELD.totStar=0,FIELD.totComplete=0,FIELD.hiddenStar=0,FIELD.hiddenComplete=0,FIELD.isBlur=!1,"ontouchstart"in window||navigator.maxTouchPoints?FIELD.isTouch=!0:FIELD.isTouch=!1,OPTS.musicOn=!0,OPTS.music=.5,OPTS.sfxOn=!0,OPTS.sfx=.5,OPTS.autoResize=!0,OPTS.showFPS=!1,OPTS.fancyGraphics=!0,OPTS.fancyGears=!0,OPTS.attemptDowngrade=!0,BLUEPRINT.selected=-1,BLUEPRINT.lastSelected=-1,BLUEPRINT.hovered=-1,BLUEPRINT.lastHovered=-1,ROBOT.oldMode="none",TUTORIAL.default=0,TUTORIAL.current=0,TUTORIAL.currentMax=16,TUTORIAL.entStateQ0=new Qubit(0,0,0,-1,"halt",0*Math.PI/4),TUTORIAL.entStateQ1=new Qubit(0,0,0,-1,"halt",1*Math.PI/2),TUTORIAL.entState=new Entangled(2),TUTORIAL.entState.setQubits([TUTORIAL.entStateQ0,TUTORIAL.entStateQ1]),TUTORIAL.entState.ampsComp=[1/Math.sqrt(2),0,0,1/Math.sqrt(2)],TUTORIAL.entState.computeRotAmps(),TUTORIAL.entState.computeAllEnts(),CANV.interface=new Canvs("canvasInterface","interface"),CANV.FPS=new Canvs("canvasFPS","FPS"),CANV.confirm=new Canvs("canvasConfirm","confirm"),CANV.undos=new Canvs("canvasUndos","undos"),CANV.controls=new Canvs("canvasControls","controls"),CANV.debug=new Canvs("canvasDebug","debug"),CANV.ticker=new Canvs("canvasTicker","ticker"),CANV.toggles=new Canvs("canvasToggles","toggles"),CANV.tooltip=new Canvs("canvasTooltip","tooltip"),CANV.letterButton=new Canvs("canvasLetterButton","letterButton"),CANV.blueprint=new Canvs("canvasBlueprint","blueprint"),CANV.overlay=new Canvs("canvasOverlay","overlay"),CANV.overlayLeft=new Canvs("canvasOverlayLeft","overlayLeft"),CANV.overlayRight=new Canvs("canvasOverlayRight","overlayRight"),CANV.overlayBottom=new Canvs("canvasOverlayBottom","overlayBottom"),CANV.victoryText=new Canvs("canvasVictoryText","victoryText"),CANV.victoryBase=new Canvs("canvasVictoryBase","victoryBase"),CANV.menu2=new Canvs("canvasMenu2","menu2"),CANV.analysisOverlay=new Canvs("canvasAnalysisOverlay","analysisOverlay"),CANV.analysis=new Canvs("canvasAnalysis","analysis"),CANV.menuEraser=new Canvs("canvasMenuEraser","menuEraser"),CANV.menuText=new Canvs("canvasMenuText","menuText"),CANV.scenario=new Canvs("canvasScenario","scenario"),CANV.menuOverlay=new Canvs("canvasMenuOverlay","menuOverlay"),CANV.scenarioOverlay=new Canvs("canvasScenarioOverlay","scenarioOverlay"),CANV.scenarioMask=new Canvs("canvasScenarioMask","scenarioMask"),CANV.score=new Canvs("canvasScore","score"),CANV.scoreBase=new Canvs("canvasScoreBase","scoreBase"),CANV.menu=new Canvs("canvasMenu","menu"),CANV.menuBack=new Canvs("canvasMenuBack","menuBack"),CANV.titleLearn=new Canvs("canvasTitleLearn","titleLearn"),CANV.titleText=new Canvs("canvasTitleText","titleText"),CANV.titleAbout=new Canvs("canvasTitleAbout","titleAbout"),CANV.title=new Canvs("canvasTitle","title"),CANV.underlay=new Canvs("canvasUnderlay","underlay"),CANV.effects=new Canvs("canvasEffects","effects"),CANV.base=new Canvs("canvasBase","base"),CANV.baseWires=new Canvs("canvasBaseWires","baseWires"),CANV.selectButtons=new Canvs("canvasSelectButtons","selectButtons"),CANV.selectOverlay=new Canvs("canvasSelectOverlay","selectOverlay"),CANV.select=new Canvs("canvasSelect","select"),CANV.selectBase=new Canvs("canvasSelectBase","selectBase"),CANV.selectAward=new Canvs("canvasSelectAward","selectAward"),CANV.selectText=new Canvs("canvasSelectText","selectText"),CANV.tutorialExtra=new Canvs("canvasTutExtra","tutorialExtra"),CANV.tutorialBase=new Canvs("canvasTutBase","tutorialBase"),CANV.tutorialGates=new Canvs("canvasTutGates","tutorialGates"),CANV.tutorialEffects=new Canvs("canvasTutEffects","tutorialEffects"),CANV.tutorialControls=new Canvs("canvasTutControls","tutorialControls"),CANV.tutorialHeader=new Canvs("canvasTutHeader","tutorialHeader"),CANV.robotText=new Canvs("canvasRobText","robotText"),CANV.robotScreen=new Canvs("canvasRobScreen","robotScreen"),CANV.robotScreenBase=new Canvs("canvasRobScreenBase","robotScreenBase"),CANV.robotBase=new Canvs("canvasRobBase","robotBase"),CANV.robotButton=new Canvs("canvasRobButton","robotButton"),CANV.archive=new Canvs("canvasArchive","archive"),CANV.journal=new Canvs("canvasJournal","journal"),SVG.title=new Svgs("svgtitle","title"),SVG.board=new Svgs("svgboard","board"),SVG.menu=new Svgs("svgmenu","menu"),SVG.analysis=new Svgs("svganalysis","analysis"),SVG.select=new Svgs("svgselect","select"),SVG.tutorial=new Svgs("svgtutorial","tutorial"),SVG.tutorialB=new Svgs("svgtutorialB","tutorialB"),SVG.chromeicon=new Svgs("chromeicon","chromeicon"),SVG.edgeicon=new Svgs("edgeicon","edgeicon"),SVG.braveicon=new Svgs("braveicon","braveicon"),SVG.operaicon=new Svgs("operaicon","operaicon"),SVG.fireicon=new Svgs("fireicon","fireicon"),SVG.safariicon=new Svgs("safariicon","safariicon"),window.addEventListener("mousemove",e=>INPUTS.mousemove=e),window.addEventListener("mousedown",e=>INPUTS.mousedown=e),window.addEventListener("dblclick",e=>INPUTS.dblclick=e),window.addEventListener("mouseup",e=>INPUTS.mouseup=e),window.addEventListener("contextmenu",e=>e.preventDefault()),window.addEventListener("wheel",e=>INPUTS.wheel=e),document.getElementById("canvasInterface").addEventListener("wheel",e=>INPUTS.wheel=e),window.addEventListener("keydown",e=>INPUTS.keydown=e),window.addEventListener("keyup",e=>{"erasing"===STATE.state&&0===STATE.heldKey&&(STATE.state="free"),STATE.heldKey=-1}),window.addEventListener("resize",e=>{INPUTS.resize=e,FIELD.isBlur=!1}),window.addEventListener("keydown",async e=>{var t=Helper.copyCurrentBoard(e);t&&navigator.clipboard.writeText(t)}),window.addEventListener("keydown",async e=>{Helper.pasteCurrentBoard(e)}),window.addEventListener("keydown",async e=>{Helper.openExternalLink(e)}),window.addEventListener("mousedown",async e=>{if(0===e.button)if("escbutton"===STATE.under.type)1===STATE.under.i0&&SoundData.setMusicFull(e);else if("archiveButton"===STATE.under.type)0!==SCENARIO.archive&&window.open(SCENARIO.archive,"_blank");else if("robbutton"===STATE.under.type)1===STATE.under.i0&&0!==SCENARIO.archive&&(SFX.click.play(),window.open(SCENARIO.archive,"_blank"));else if("title"===STATE.mode){if("learnbutton"===STATE.under.type)return window.open("https://github.com/awslabs/the-qubit-factory/wiki/Walkthrough/","_blank"),void(STATE.under={type:"none",i0:-1,j0:-1,k0:-1});if("titlebutton"===STATE.under.type&&2===STATE.under.i0)return SFX.select2.play(),void window.open(FIELD.feedBack,"_blank")}}),SCENARIO.default="levelSelect",InitScenario.loadAll(),SCENARIO.whichOne="title",InitScenario.load(SCENARIO.whichOne,!1),Graphics.init(),Graphics.initFlares(),Helper.findStorageSize(),FIELD.isOnHarmony?(SFX.background=new Audio("qubitfactory/sfx/grumpy.wav"),SoundData.initAll("qubitfactory/")):(SFX.background=new Audio("sfx/grumpy.mp3"),SoundData.initAll("")),SFX.enabled=!1,window.addEventListener("click",()=>{SFX.enabled=!0,OPTS.musicOn&&SFX.background.play()},{once:!0}),window.addEventListener("beforeunload",e=>{"constructing"===STATE.mode&&(PERSIST0[SCENARIO.name].tiles[STATE.blueprint]=[...IBOARD._tiles],PERSIST0[SCENARIO.name].gates[STATE.blueprint]=IBOARD.getAllGates(),Storage.save(PERSIST0[SCENARIO.name],SCENARIO.name,0,!1))}),PopWindow.init(),PopWindow.reset(),TIMER.frame=window.requestAnimationFrame(Timer.titleStep);